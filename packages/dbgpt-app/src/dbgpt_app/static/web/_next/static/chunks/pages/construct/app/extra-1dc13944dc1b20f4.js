(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[516],{3089:function(e,a,t){"use strict";t.d(a,{Z:function(){return o}});var l=t(87462),n=t(67294),r={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M696 480H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h368c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"minus-circle",theme:"outlined"},s=t(13401),o=n.forwardRef(function(e,a){return n.createElement(s.Z,(0,l.Z)({},e,{ref:a,icon:r}))})},74294:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/construct/app/extra",function(){return t(90334)}])},99743:function(e,a,t){"use strict";var l=t(85893);t(67294);var n=t(36851);a.Z=e=>{let{id:a,sourceX:t,sourceY:r,targetX:s,targetY:o,sourcePosition:i,targetPosition:d,style:c={},markerEnd:u}=e,[m,p,f]=(0,n.OQ)({sourceX:t,sourceY:r,sourcePosition:i,targetX:s,targetY:o,targetPosition:d}),v=(0,n._K)();return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.u5,{id:a,style:c,path:m,markerEnd:u}),(0,l.jsx)("foreignObject",{width:40,height:40,x:p-20,y:f-20,className:"bg-transparent w-10 h-10 relative",requiredExtensions:"http://www.w3.org/1999/xhtml",children:(0,l.jsx)("button",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-5 h-5 rounded-full bg-stone-400 dark:bg-zinc-700 cursor-pointer text-sm",onClick:e=>{e.stopPropagation(),v.setEdges(v.getEdges().filter(e=>e.id!==a))},children:"\xd7"})})]})}},37082:function(e,a,t){"use strict";t.r(a);var l=t(85893),n=t(76212),r=t(65654),s=t(31418),o=t(99859),i=t(28459),d=t(85576),c=t(74330),u=t(25278),m=t(96074),p=t(93967),f=t.n(p),v=t(25675),_=t.n(v),x=t(11163),h=t(67294),g=t(67421),b=t(79903),j=t.n(b);let y=e=>{let{disable:a=!1,options:t=[],value:n,onChange:r}=e,[s,o]=(0,h.useState)(n||{}),{i18n:i}=(0,g.$G)(),d=e=>a?f()("flex items-center p-4 border rounded-lg border-[#d9d9d9]  cursor-not-allowed relative transition-all duration-500 ease-in-out",{"bg-[rgba(0,0,0,0.04)] dark:bg-[#606264]":e.value===(null==s?void 0:s.value)}):"flex items-center p-4  border dark:border-[rgba(217,217,217,0.85)] rounded-lg cursor-pointer hover:border-[#0c75fc] hover:bg-[#f5faff] dark:hover:border-[rgba(12,117,252,0.85)] dark:hover:bg-[#606264] relative transition-all duration-300 ease-in-out ".concat(e.value===(null==s?void 0:s.value)?"border-[#0c75fc] bg-[#f5faff] dark:bg-[#606264] dark:border-[#0c75fc]":"border-[#d9d9d9]"," "),c="en"===i.language;return(0,l.jsx)("div",{className:"grid grid-cols-2 gap-4",children:t.map(e=>(0,l.jsxs)("div",{className:d(e),onClick:()=>{a||(o(e),null==r||r({...n,...e}))},children:[(0,l.jsx)(_(),{src:"/icons/app/".concat(e.value,".png"),width:48,height:48,alt:e.value}),(0,l.jsxs)("div",{className:"flex flex-col ml-3",children:[(0,l.jsx)("span",{className:"text-xs font-medium text-[rgba(0,0,0,0.85)] dark:text-[rgba(255,255,255,0.85)] first-line:leading-6",children:c?e.name_en:e.name_cn}),(0,l.jsx)("span",{className:"text-xs text-[rgba(0,0,0,0.45)] dark:text-[rgba(255,255,255,0.85)]",children:c?e.description_en:e.description})]}),e.value===(null==s?void 0:s.value)&&(0,l.jsx)("div",{className:"w-3 h-3 rounded-tr-md absolute top-[1px] right-[1px] transition-all duration-300 ease-in-out",style:{background:"linear-gradient(to right top, transparent 50%, transparent 50%, ".concat(a?"#d0d0d0":"#0c75fc"," 0)")}})]},e.value))})};a.default=e=>{let{open:a,onCancel:t,type:p="add",refresh:f}=e,{t:v,i18n:_}=(0,g.$G)(),b=JSON.parse(localStorage.getItem("new_app_info")||"{}"),{message:w}=s.Z.useApp(),[N]=o.default.useForm(),k=o.default.useWatch("team_mode",N),Z=(0,x.useRouter)(),C="en"===_.language,{data:V,loading:q}=(0,r.Z)(async()=>{let[e,a]=await (0,n.Vx)((0,n.lz)());return null!=a?a:[]}),{run:I,loading:S}=(0,r.Z)(async e=>"edit"===p?await (0,n.Vx)((0,n.KT)({app_code:null==b?void 0:b.app_code,language:"zh",...e})):await (0,n.Vx)((0,n.L5)({language:"zh",...e})),{manual:!0,onSuccess:async e=>{let[a,l]=e;if(a)w.error("edit"===p?v("Update_failure"):v("Create_failure"));else if("edit"===p){var r;let[,e]=await (0,n.Vx)((0,n.yk)({})),a=null==e?void 0:null===(r=e.app_list)||void 0===r?void 0:r.find(e=>e.app_code===(null==b?void 0:b.app_code));localStorage.setItem("new_app_info",JSON.stringify({...a,isEdit:!0})),w.success(v("Update_successfully"))}else w.success(v("Create_successfully")),localStorage.setItem("new_app_info",JSON.stringify(l)),Z.push("/construct/app/extra");await (null==f?void 0:f()),t()}}),E=(0,h.useMemo)(()=>{var e;return null===(e=null==V?void 0:V.filter(e=>e.value===(null==b?void 0:b.team_mode)))||void 0===e?void 0:e[0]},[b,V]);return q?null:(0,l.jsx)(i.ZP,{theme:{components:{Button:{defaultBorderColor:"#d9d9d9"}}},children:(0,l.jsx)(d.default,{className:j()["create-app-modal-container"],title:v("create_app"),width:900,open:a,onOk:async()=>{N.validateFields().then(async e=>{var a;await I({app_name:null==e?void 0:e.app_name,app_describe:null==e?void 0:e.app_describe,team_mode:null==e?void 0:null===(a=e.team_mode)||void 0===a?void 0:a.value})})},onCancel:t,centered:!0,children:(0,l.jsx)(c.Z,{spinning:S,children:(0,l.jsxs)("div",{className:"flex flex-1",children:[(0,l.jsxs)(o.default,{layout:"vertical",className:"w-3/5",form:N,initialValues:{team_mode:E||(null==V?void 0:V[0]),app_name:null==b?void 0:b.app_name,app_describe:null==b?void 0:b.app_describe},children:[(0,l.jsx)(o.default.Item,{label:v("team_modal"),name:"team_mode",required:!0,rules:[{required:!0,message:v("Please_input_the_work_modal")}],children:(0,l.jsx)(y,{disable:"edit"===p,options:V||[]})}),(0,l.jsx)(o.default.Item,{label:"".concat(v("app_name"),"："),name:"app_name",required:!0,rules:[{required:!0,message:v("input_app_name")}],children:(0,l.jsx)(u.default,{placeholder:v("input_app_name"),autoComplete:"off",className:"h-8"})}),(0,l.jsx)(o.default.Item,{label:"".concat(v("Description"),"："),name:"app_describe",required:!0,rules:[{required:!0,message:v("Please_input_the_description")}],children:(0,l.jsx)(u.default.TextArea,{autoComplete:"off",placeholder:v("Please_input_the_description"),autoSize:{minRows:2.5}})})]}),(0,l.jsx)(m.Z,{type:"vertical",className:"h-auto mx-6 bg-[rgba(0,0,0,0.06)] dark:bg-[rgba(255,255,255,0.5)] "}),(0,l.jsxs)("div",{className:"flex flex-col w-2/5 pl-6 pt-8 ",children:[(0,l.jsx)("span",{className:"text-base text-[rgba(0,0,0,0.85)] font-medium mb-6 dark:text-[rgba(255,255,255,0.85)]",children:C?null==k?void 0:k.name_en:null==k?void 0:k.name_cn}),(0,l.jsxs)("div",{className:"flex items-start",children:[(0,l.jsx)("span",{className:"flex flex-shrink-0 w-1 h-1 rounded-full bg-[rgba(0,0,0,0.45)] mt-2 mr-1 dark:bg-[rgba(255,255,255,0.65)]"}),(0,l.jsx)("span",{className:"text-xs leading-5 text-[rgba(0,0,0,0.45)] dark:text-[rgba(255,255,255,0.65)]",children:C?null==k?void 0:k.remark_en:null==k?void 0:k.remark})]})]})]})})})})}},7380:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return x}});var l=t(85893),n=t(76212),r=t(67919),s=t(67294),o=t(36851),i=t(59819);t(4583);var d=t(99743),c=e=>{let{flowData:a,minZoom:t}=e,n=(0,r.z5)(a);return(0,l.jsx)(o.x$,{nodes:n.nodes,edges:n.edges,edgeTypes:{buttonedge:d.Z},fitView:!0,minZoom:t||.1,children:(0,l.jsx)(i.A,{color:"#aaa",gap:16})})},u=t(65654),m=t(99859),p=t(34041),f=t(93967),v=t.n(f),_=t(67421),x=e=>{let{initValue:a,updateData:t,classNames:r}=e,{t:o}=(0,_.$G)(),[i]=m.default.useForm(),d=m.default.useWatch("flow",i),{data:f,loading:x}=(0,u.Z)(async()=>{let[,e]=await (0,n.Vx)((0,n.Wf)({page:1,page_size:1e4}));return i.setFieldsValue({flow:null==a?void 0:a.name}),null!=e?e:{}}),h=(0,s.useMemo)(()=>{var e;return(null==f?void 0:null===(e=f.items)||void 0===e?void 0:e.map(e=>({label:e.label,value:e.name})))||[]},[f]),g=(0,s.useMemo)(()=>{var e,a;return null===(e=null==f?void 0:null===(a=f.items)||void 0===a?void 0:a.find(e=>e.name===d))||void 0===e?void 0:e.flow_data},[null==f?void 0:f.items,d]);return(0,s.useEffect)(()=>{var e;t([x,null==f?void 0:null===(e=f.items)||void 0===e?void 0:e.find(e=>e.name===d)])},[null==f?void 0:f.items,d,x,t]),(0,l.jsx)("div",{className:v()(r,"mb-6"),children:(0,l.jsxs)(m.default,{form:i,style:{width:"100%"},children:[(0,l.jsx)(m.default.Item,{label:o("select_workflow"),name:"flow",children:(0,l.jsx)(p.default,{className:"w-1/4",placeholder:o("please_select_workflow"),options:h,allowClear:!0})}),g&&(0,l.jsx)("div",{className:"w-full h-[600px] mx-auto border-[0.5px] border-dark-gray",children:(0,l.jsx)(c,{flowData:g})})]})})}},76054:function(e,a,t){"use strict";t.r(a);var l=t(85893),n=t(76212),r=t(48218),s=t(65654),o=t(99859),i=t(83062),d=t(34041),c=t(13457),u=t(93967),m=t.n(u),p=t(67294),f=t(67421),v=t(23024);a.default=e=>{var a,t;let{classNames:u,initValue:_,updateData:x}=e,{t:h}=(0,f.$G)(),[g]=o.default.useForm(),b=o.default.useWatch("chat_scene",g),j=o.default.useWatch("bind_value",g),y=o.default.useWatch("model",g),w=o.default.useWatch("temperature",g),N=o.default.useWatch("max_new_tokens",g),k=o.default.useWatch("prompt_template",g),{team_context:Z,param_need:C}=_||{},{data:V,loading:q}=(0,s.Z)(async()=>{var e,a,t,l,r;let s=await Promise.all([(0,n.Vx)((0,n.tM)()),(0,n.Vx)((0,n.m9)("priority"))]),[o,i]=s;return g.setFieldValue("chat_scene",null==Z?void 0:Z.chat_scene),g.setFieldValue("model",null===(e=null==C?void 0:C.find(e=>"model"===e.type))||void 0===e?void 0:e.value),g.setFieldValue("temperature",null===(a=null==C?void 0:C.find(e=>"temperature"===e.type))||void 0===a?void 0:a.value),g.setFieldValue("max_new_tokens",null===(t=null==C?void 0:C.find(e=>"max_new_tokens"===e.type))||void 0===t?void 0:t.value),g.setFieldValue("prompt_template",null===(l=null==C?void 0:C.find(e=>"prompt_template"===e.type))||void 0===l?void 0:l.value),await O((null===(r=null==C?void 0:C.find(e=>"resource"===e.type))||void 0===r?void 0:r.value)||""),[o,i]}),{data:I}=(0,s.Z)(async()=>{let[,e]=await (0,n.Vx)((0,n.xA)({page:1,page_size:1e5}));return null!=e?e:{items:[]}}),{data:S,loading:E,run:O}=(0,s.Z)(async e=>{var a,t,l;let[,r]=await (0,n.Vx)((0,n.RX)({type:e}));return b===(null==Z?void 0:Z.chat_scene)&&(null===(a=null==C?void 0:C.find(e=>"resource"===e.type))||void 0===a?void 0:a.bind_value)&&g.setFieldsValue({bind_value:null===(t=null==C?void 0:C.find(e=>"resource"===e.type))||void 0===t?void 0:t.bind_value}),null!==(l=null==r?void 0:r.map(e=>({...e,value:e.key})))&&void 0!==l?l:[]},{manual:!0}),T=(0,p.useMemo)(()=>{var e;let a=null==V?void 0:null===(e=V[0])||void 0===e?void 0:e[1];return(null==a?void 0:a.map(e=>{var a;return{...e,label:(0,l.jsxs)("div",{className:"flex items-center gap-1",children:[(0,l.jsx)(r.Z,{width:4,height:4,scene:e.chat_scene}),(0,l.jsx)(i.Z,{title:"资源类型".concat(null===(a=e.param_need.find(e=>"resource"===e.type))||void 0===a?void 0:a.value),children:(0,l.jsx)("span",{className:"text-[#525964] dark:text-[rgba(255,255,255,0.65)]  ml-1",children:e.scene_name})})]}),value:e.chat_scene}}))||[]},[V]);return(0,p.useEffect)(()=>{var e,a,t,l;let n=g.getFieldsValue();x([q,[{chat_scene:n.chat_scene,scene_name:null===(e=T.find(e=>e.chat_scene===n.chat_scene))||void 0===e?void 0:e.scene_name},[{type:"model",value:n.model},{type:"temperature",value:n.temperature},{type:"max_new_tokens",value:n.max_new_tokens},{type:"resource",value:null===(a=null===(t=T.find(e=>e.chat_scene===n.chat_scene))||void 0===t?void 0:null===(l=t.param_need)||void 0===l?void 0:l.find(e=>"resource"===e.type))||void 0===a?void 0:a.value,bind_value:n.bind_value},{type:"prompt_template",value:n.prompt_template}]]])},[g,b,j,y,w,N,k,x,T,q]),(0,p.useEffect)(()=>{var e,a,t,l,n;let r=null===(e=null===(a=null==V?void 0:null===(t=V[0])||void 0===t?void 0:null===(l=t[1])||void 0===l?void 0:l.find(e=>e.chat_scene===b))||void 0===a?void 0:null===(n=a.param_need)||void 0===n?void 0:n.find(e=>"resource"===e.type))||void 0===e?void 0:e.value;O(r||"")},[b,V,O]),(0,l.jsx)("div",{className:m()(u),children:(0,l.jsxs)(o.default,{form:g,autoComplete:"off",style:{width:"100%"},labelCol:{span:3},wrapperCol:{span:21},children:[(0,l.jsx)(o.default.Item,{label:h("native_type"),tooltip:!0,name:"chat_scene",children:(0,l.jsx)(d.default,{className:"w-1/2",options:T,placeholder:h("app_type_select"),onChange:()=>g.setFieldsValue({bind_value:void 0})})}),"chat_excel"!==b&&(0,l.jsx)(o.default.Item,{label:h("Arguments"),name:"bind_value",children:(0,l.jsx)(d.default,{placeholder:h("please_select_param"),allowClear:!0,className:"w-1/2",options:S,loading:E})}),(0,l.jsx)(o.default.Item,{label:h("model"),tooltip:!0,name:"model",children:(0,l.jsx)(d.default,{placeholder:h("please_select_model"),allowClear:!0,options:null==V?void 0:null===(a=V[1])||void 0===a?void 0:null===(t=a[1])||void 0===t?void 0:t.map(e=>({label:e,value:e})),className:"w-1/2"})}),(0,l.jsx)(o.default.Item,{label:h("prompt"),name:"prompt_template",children:(0,l.jsx)(v.default,{promptList:(null==I?void 0:I.items)||[]})}),(0,l.jsx)(o.default.Item,{label:h("temperature"),tooltip:!0,name:"temperature",children:(0,l.jsx)(c.Z,{className:"w-1/5 h-8",max:1,min:0,step:.1,placeholder:h("please_input_temperature")})}),(0,l.jsx)(o.default.Item,{label:h("max_new_tokens"),tooltip:!0,name:"max_new_tokens",children:(0,l.jsx)(c.Z,{className:"w-1/5 h-8",min:1,placeholder:h("please_input_max_new_tokens")})})]})})}},82257:function(e,a,t){"use strict";t.r(a);var l=t(85893),n=t(3089),r=t(24969),s=t(99859),o=t(25278),i=t(72269),d=t(14726),c=t(93967),u=t.n(c),m=t(67294),p=t(67421),f=t(11118),v=t.n(f);a.default=e=>{let{initValue:a,updateData:t,classNames:c,formStyle:f,labelCol:_=!0}=e,{t:x}=(0,p.$G)(),[h]=s.default.useForm(),g=s.default.useWatch("recommend_questions",h);return(0,m.useEffect)(()=>{t(null==g?void 0:g.filter(e=>!!e.question))},[g,t]),(0,l.jsx)("div",{className:u()(v()["recommend-questions-container"],c),children:(0,l.jsx)(s.default,{style:{width:"100%"},form:h,initialValues:{recommend_questions:a||[{question:"",valid:!1}]},autoComplete:"off",wrapperCol:{span:20},..._&&{labelCol:{span:4}},children:(0,l.jsx)(s.default.Item,{label:x("recommended_questions"),children:(0,l.jsx)(s.default.List,{name:"recommend_questions",children:(e,a)=>{let{add:t,remove:c}=a;return(0,l.jsxs)(l.Fragment,{children:[e.map((e,a)=>{var t;let{key:r,name:d}=e;return(0,l.jsxs)("div",{className:u()("flex flex-1 items-center gap-8 mb-6",f),children:[(0,l.jsx)(s.default.Item,{label:"".concat(x("question")," ").concat(a+1),name:[d,"question"],className:"grow",children:(0,l.jsx)(o.default,{placeholder:x("please_input_recommended_questions")})}),(0,l.jsx)(s.default.Item,{label:x("is_effective"),name:[d,"valid"],children:(0,l.jsx)(i.Z,{style:{background:(null==g?void 0:null===(t=g[a])||void 0===t?void 0:t.valid)?"#1677ff":"#ccc"}})}),(0,l.jsx)(s.default.Item,{children:(0,l.jsx)(n.Z,{onClick:()=>{c(d)}})})]},r)}),(0,l.jsx)(s.default.Item,{className:u()(f),children:(0,l.jsx)(d.ZP,{type:"dashed",onClick:()=>{t({question:"",valid:!1})},block:!0,icon:(0,l.jsx)(r.Z,{}),children:x("add_question")})})]})}})})})})}},23024:function(e,a,t){"use strict";t.r(a);var l=t(85893),n=t(18102),r=t(11475),s=t(34041),o=t(85576),i=t(67294);a.default=e=>{let{value:a,onChange:t,promptList:d}=e,[c,u]=(0,i.useState)(!1),[m,p]=(0,i.useState)();return(0,i.useEffect)(()=>{if(a){let e=null==d?void 0:d.filter(e=>e.prompt_code===a)[0];p(e)}},[d,a]),(0,l.jsxs)("div",{className:"w-2/5 flex items-center gap-2",children:[(0,l.jsx)(s.default,{className:"w-1/2",placeholder:"select prompt",options:d,fieldNames:{label:"prompt_name",value:"prompt_code"},onChange:e=>{let a=null==d?void 0:d.filter(a=>a.prompt_code===e)[0];p(a),null==t||t(e)},value:a,allowClear:!0,showSearch:!0}),m&&(0,l.jsxs)("span",{className:"text-sm text-blue-500 cursor-pointer",onClick:()=>u(!0),children:[(0,l.jsx)(r.Z,{className:"mr-1"}),"查看详情"]}),(0,l.jsx)(o.default,{title:"Prompt",open:c,footer:!1,width:"60%",onCancel:()=>u(!1),children:(0,l.jsx)(n.default,{children:null==m?void 0:m.content})})]})}},78174:function(e,a,t){"use strict";t.r(a);var l=t(85893),n=t(76212),r=t(25035),s=t(65654),o=t(84567),i=t(83062),d=t(99859),c=t(42075),u=t(93967),m=t.n(u),p=t(96486),f=t(67294),v=t(67421),_=t(83072),x=t(77451);let h=e=>{let{value:a,onChange:t,agents:n,selectedTab:s,setSelectedTab:d}=e;return(0,l.jsx)(o.Z.Group,{className:"grid grid-cols-4 gap-4",onChange:e=>{null==t||t(e)},value:a,children:n.map(e=>(0,l.jsxs)("div",{className:"flex grow h-8 items-center px-3 border ".concat(e.name===s?"border-[#0c75fc]":"border-[#d6d8da]"," rounded-md hover:border-[#0c75fc] cursor-pointer"),onClick:()=>{d(e.name||"")},children:[(0,l.jsx)(o.Z,{value:e.name}),(0,l.jsxs)("div",{className:"flex items-center flex-1 justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"ml-2 mr-1",children:_.agentIcon[e.name||""]}),(0,l.jsx)("span",{className:"text-sm text-[rgba(0,10,26,0.68)] dark:text-[rgba(255,255,255,0.85)]",children:e.label})]}),(0,l.jsx)(i.Z,{title:e.desc,children:(0,l.jsx)(r.Z,{className:"text-sm"})})]})]},e.name))})};a.default=e=>{var a,t,r;let{initValue:o,updateData:i,classNames:u}=e,{t:g,i18n:b}=(0,v.$G)(),[j]=d.default.useForm(),y=d.default.useWatch("agent_name",j),[w,N]=(0,f.useState)(""),k=(0,f.useRef)([]),Z="en"===b.language,{data:C,loading:V}=(0,s.Z)(async()=>{var e,a;let t=await Promise.all([(0,n.Vx)((0,n.j8)()),(0,n.Vx)((0,n.Vd)()),(0,n.Vx)((0,n.Q5)())]),[,l]=(null==t?void 0:t[0])||[];return k.current=(null==l?void 0:l.map(e=>({agent_name:e.name,llm_strategy:"",llm_strategy_value:"",prompt_template:"",resources:[]})))||[],j.setFieldsValue({agent_name:null==o?void 0:o.map(e=>e.agent_name)}),N((null===(e=null==o?void 0:o.map(e=>e.agent_name))||void 0===e?void 0:e[0])||(null==l?void 0:null===(a=l[0])||void 0===a?void 0:a.name)||""),null!=t?t:[]}),{data:q}=(0,s.Z)(async()=>{let[,e]=await (0,n.Vx)((0,n.xA)({page:1,page_size:1e5}));return null!=e?e:{items:[]}}),I=(0,f.useMemo)(()=>{let[,e]=(null==C?void 0:C[1])||[];return(null==e?void 0:e.length)?e.map(e=>({label:Z?e.name:e.name_cn,value:e.value})):[]},[C]),S=(0,f.useMemo)(()=>{let[,e]=(null==C?void 0:C[2])||[];if(null==e?void 0:e.length){let a=e.map(e=>({label:(0,l.jsxs)(c.Z,{children:[_.resourceTypeIcon[e],e]}),value:e}));return(0,p.concat)([{label:(0,l.jsxs)("div",{className:"flex items-center text-sm",children:[_.resourceTypeIcon.all,(0,l.jsx)("span",{className:"ml-2 text-[rgba(0,10,26,0.68)] dark:text-[#ffffffD9]",children:g("All")})]}),value:"all"}],a)}return[]},[C]);return(0,f.useEffect)(()=>{i([V,k.current.filter(e=>null==y?void 0:y.includes(e.agent_name))])},[V,y,i]),(0,l.jsxs)("div",{className:m()(u),children:[(0,l.jsx)(d.default,{form:j,style:{width:"100%"},labelCol:{span:4},wrapperCol:{span:20},children:(0,l.jsx)(d.default.Item,{label:"".concat(g("choose")," agent"),name:"agent_name",required:!0,rules:[{required:!0,message:g("please_choose")+" agent"}],children:(0,l.jsx)(h,{agents:(null==C?void 0:null===(a=C[0])||void 0===a?void 0:a[1])||[],selectedTab:w,setSelectedTab:N})})}),null==C?void 0:null===(t=C[0])||void 0===t?void 0:null===(r=t[1])||void 0===r?void 0:r.map(e=>(0,l.jsx)(x.default,{classNames:e.name===w?"block":"hidden",updateData:e=>{k.current=k.current.map(a=>a.agent_name===(null==e?void 0:e.agent_name)?{...a,...e}:{...a}),i([V,k.current.filter(e=>null==y?void 0:y.includes(e.agent_name))])},initValue:o,name:e.name,modelStrategyOptions:I,resourceTypeOptions:S,promptList:(null==q?void 0:q.items)||[]},e.name))]})}},90334:function(e,a,t){"use strict";t.r(a);var l=t(85893),n=t(76212),r=t(48218),s=t(6171),o=t(86548),i=t(65654),d=t(31418),c=t(74330),u=t(42075),m=t(14726),p=t(93967),f=t.n(p),v=t(11163),_=t(67294),x=t(67421),h=t(37082),g=t(7380),b=t(76054),j=t(82257),y=t(78174),w=t(11118),N=t.n(w);a.default=()=>{var e;let a=JSON.parse(localStorage.getItem("new_app_info")||"{}"),{t}=(0,x.$G)(),{message:p}=d.Z.useApp(),w=(0,v.useRouter)(),[k,Z]=(0,_.useState)(!1),[C,V]=(0,_.useState)(!1),q=(0,_.useRef)({}),{run:I,loading:S}=(0,i.Z)(async e=>await (0,n.Vx)((0,n.KT)({app_code:null==a?void 0:a.app_code,app_describe:null==a?void 0:a.app_describe,team_mode:null==a?void 0:a.team_mode,app_name:null==a?void 0:a.app_name,language:null==a?void 0:a.language,...e})),{manual:!0,onSuccess:e=>{let[,a]=e;a?(p.success(t("update_success")),w.replace("/construct/app")):p.error(t("update_failed"))}}),E=async()=>{await I({...q.current})},O=(0,_.useMemo)(()=>(null==a?void 0:a.team_mode)==="awel_layout"?"px-6":(null==a?void 0:a.team_mode)==="auto_plan"?"w-3/4 mx-auto":"w-3/5 mx-auto",[null==a?void 0:a.team_mode]);return(0,l.jsxs)(d.Z,{children:[(0,l.jsx)(c.Z,{spinning:k,children:(0,l.jsxs)("div",{className:f()("flex flex-col  h-screen w-screen dark:bg-gradient-dark bg-gradient-light bg-cover bg-center",N()["extra-container"]),children:[(0,l.jsxs)("header",{className:"flex items-center justify-between px-6 py-2 h-14 border-b border-[#edeeef]",children:[(0,l.jsxs)(u.Z,{className:"flex items-center",children:[(0,l.jsx)(s.Z,{className:"text-base cursor-pointer hover:text-[#0c75fc]",onClick:()=>{w.replace("/construct/app")}}),(0,l.jsx)("div",{className:"flex items-center justify-center w-10 h-10 border border-[#d6d8da] rounded-lg",children:(0,l.jsx)(r.Z,{scene:(null==a?void 0:null===(e=a.team_context)||void 0===e?void 0:e.chat_scene)||"chat_agent"})}),(0,l.jsx)("span",{children:null==a?void 0:a.app_name}),(0,l.jsx)(o.Z,{className:"cursor-pointer hover:text-[#0c75fc]",onClick:()=>V(!0)})]}),(0,l.jsx)(m.ZP,{type:"primary",onClick:E,loading:S,children:(null==a?void 0:a.isEdit)?t("update"):t("save")})]}),(0,l.jsxs)("div",{className:"flex flex-1 flex-col py-12 max-h-full overflow-y-auto",children:[["single_agent","auto_plan"].includes(null==a?void 0:a.team_mode)&&(0,l.jsx)(y.default,{classNames:"w-3/4 mx-auto",updateData:e=>{Z(null==e?void 0:e[0]),q.current.details=null==e?void 0:e[1]},initValue:null==a?void 0:a.details}),(null==a?void 0:a.team_mode)==="awel_layout"&&(0,l.jsx)(g.default,{initValue:null==a?void 0:a.team_context,updateData:e=>{Z(null==e?void 0:e[0]),q.current.team_context=null==e?void 0:e[1]},classNames:"px-6"}),(null==a?void 0:a.team_mode)==="native_app"&&(0,l.jsx)(b.default,{initValue:{team_context:null==a?void 0:a.team_context,param_need:null==a?void 0:a.param_need},classNames:"w-3/5 mx-auto",updateData:e=>{var a,t;Z(null==e?void 0:e[0]),q.current.team_context=null==e?void 0:null===(a=e[1])||void 0===a?void 0:a[0],q.current.param_need=null==e?void 0:null===(t=e[1])||void 0===t?void 0:t[1]}}),(0,l.jsx)(j.default,{updateData:e=>{q.current.recommend_questions=e},classNames:O,initValue:null==a?void 0:a.recommend_questions,labelCol:(null==a?void 0:a.team_mode)!=="awel_layout"})]})]})}),(0,l.jsx)(h.default,{type:"edit",open:C,onCancel:()=>V(!1)})]})}},67919:function(e,a,t){"use strict";t.d(a,{Av:function(){return m},It:function(){return u},Rv:function(){return c},VZ:function(){return l},Wf:function(){return r},_g:function(){return n},z5:function(){return s}});let l=(e,a)=>{let t=0;return a.forEach(a=>{a.data.name===e.name&&t++}),"".concat(e.id,"_").concat(t)},n=e=>e.replace(/_\d+$/,""),r=e=>{let{nodes:a,edges:t,...l}=e,n=a.map(e=>{let{positionAbsolute:a,...t}=e;return{position_absolute:a,...t}}),r=t.map(e=>{let{sourceHandle:a,targetHandle:t,...l}=e;return{source_handle:a,target_handle:t,...l}});return{nodes:n,edges:r,...l}},s=e=>{let{nodes:a,edges:t,...l}=e,n=a.map(e=>{let{position_absolute:a,...t}=e;return{positionAbsolute:a,...t}}),r=t.map(e=>{let{source_handle:a,target_handle:t,...l}=e;return{sourceHandle:a,targetHandle:t,...l}});return{nodes:n,edges:r,...l}},o=(e,a,t,l,n)=>{let r="".concat(e,"|").concat(a,"|"),s=l.filter(e=>{let t="inputs"===a?e.targetHandle:e.sourceHandle;return!!t&&t.startsWith(r)}).length;return s>=n},i=e=>{let a={};return e.forEach(e=>{if(e.dynamic){let t=e.name.replace(/_\d+$/,"");a[t]||(a[t]=[]),a[t].push(e)}}),a},d=e=>{if(!e.data.parameters||0===e.data.parameters.length)return[!0,""];let a=i(e.data.parameters);for(let[t,l]of Object.entries(a)){let a=l[0].dynamic_minimum||0;if(0===a)continue;if(l.length<a)return[!1,"The dynamic parameter ".concat(t," of node ").concat(e.data.label," requires at least ").concat(a," parameters")];let n=l.filter(e=>!e.optional);for(let a of n)if(void 0===a.value||null===a.value)return[!1,"The parameter ".concat(a.name," of node ").concat(e.data.label," is required")]}return[!0,""]},c=e=>{let{nodes:a,edges:t}=e,l=[!0,a[0],""];e:for(let e=0;e<a.length;e++){let n=a[e].data,{inputs:r=[],parameters:s=[]}=n,c=i(r);for(let[r,s]of Object.entries(c)){let i=s[0].dynamic_minimum||0;if(i>0){let s=o(a[e].id,"inputs",0,t,i);if(!s){l=[!1,a[e],"The dynamic input ".concat(r," of node ").concat(n.label," requires at least ").concat(i," connections")];break e}}}for(let s=0;s<r.length;s++){let o=r[s];if(o.dynamic)continue;let i=!o.optional;if(i&&!t.some(t=>t.targetHandle==="".concat(a[e].id,"|inputs|").concat(s))){l=[!1,a[e],"The input ".concat(r[s].type_name," of node ").concat(n.label," is required")];break e}}let[u,m]=d(a[e]);if(!u){l=[!1,a[e],m];break}let p=i(s);for(let[r,s]of Object.entries(p)){let i=s[0].dynamic_minimum||0;if(i>0&&"resource"===s[0].category){let s=o(a[e].id,"parameters",0,t,i);if(!s){l=[!1,a[e],"The dynamic parameter ".concat(r," of node ").concat(n.label," requires at least ").concat(i," connections")];break e}}}for(let r=0;r<s.length;r++){let o=s[r];if(!o.dynamic){if(o.optional||"resource"!==o.category||t.some(t=>t.targetHandle==="".concat(a[e].id,"|parameters|").concat(r))){if(!o.optional&&"common"===o.category&&(void 0===o.value||null===o.value)){l=[!1,a[e],"The parameter ".concat(o.type_name," of node ").concat(n.label," is required")];break e}}else{l=[!1,a[e],"The parameter ".concat(o.type_name," of node ").concat(n.label," is required")];break e}}}let f=i(n.outputs||[]);for(let[r,s]of Object.entries(f)){let i=s[0].dynamic_minimum||0;if(i>0){let s=o(a[e].id,"outputs",0,t,i);if(!s){l=[!1,a[e],"The dynamic output ".concat(r," of node ").concat(n.label," requires at least ").concat(i," connections")];break e}}}}return l},u=e=>(function e(a){if(Array.isArray(a))return a.map(a=>e(a));if(a&&"object"==typeof a&&!Array.isArray(a)){let t={};for(let l in a)if(Object.prototype.hasOwnProperty.call(a,l)){let n=l.replace(/_([a-z])/g,(e,a)=>a.toUpperCase());t[n]=e(a[l])}return t}return a})(e);function m(e){let a=new Set(["@","#","%",":"]),t={key:e.key||"",name:e.name||"",scope:e.scope||"",scope_key:e.scope_key||"",sys_code:e.sys_code||"",user_name:e.user_name||""};for(let[e,l]of Object.entries(t))l&&[...a].some(e=>l.includes(e))&&(t[e]=l.replace(/@/g,"\\@").replace(/#/g,"\\#").replace(/%/g,"\\%").replace(/:/g,"\\:"));let{key:l,name:n,scope:r,scope_key:s,sys_code:o,user_name:i}=t,d="".concat(l);return n&&(d+="".concat(":").concat(n)),(r||s)&&(d+="".concat("@").concat(r),s&&(d+="".concat(":").concat(s))),o&&(d+="".concat("#").concat(o)),i&&(d+="".concat("%").concat(i)),"${".concat(d,"}")}},79903:function(e){e.exports={"create-app-modal-container":"styles_create-app-modal-container___tIEs"}},11118:function(e){e.exports={"extra-container":"styles_extra-container__OYZKD","recommend-questions-container":"styles_recommend-questions-container__Zjnkd"}}},function(e){e.O(0,[3662,7034,6106,8674,3166,2837,2168,8163,8241,2913,3791,5278,8791,4330,7611,1049,5030,2783,2398,3457,2622,5914,4567,7124,9859,1300,4633,9773,4035,152,2510,8592,9202,1585,1278,7249,626,9200,9774,2888,179],function(){return e(e.s=74294)}),_N_E=e.O()}]);