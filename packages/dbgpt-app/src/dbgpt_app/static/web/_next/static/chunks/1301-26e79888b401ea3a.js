(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1301],{90936:function(e,t,l){"use strict";l.d(t,{ZP:function(){return eV},dx:function(){return eY},CE:function(){return eI}});var r=l(85893),a=l(29158),s=l(98165),n=l(14079),c=l(85813),i=l(32975),d=l(57020),o=l(66309);l(59178);var m=l(24557),u=l(12384),x=l(78600),h=l(77437),g=l(18102),p=l(45030),j=l(96074),v=l(85265),b=l(92398),y=l(11163),f=l(67294);let w=e=>{let{references:t}=e,l=(0,y.useRouter)(),[s,n]=(0,f.useState)(!1),c=(0,f.useMemo)(()=>l.pathname.includes("/mobile"),[l]),i=(0,f.useMemo)(()=>{var e;return null==t?void 0:null===(e=t.knowledge)||void 0===e?void 0:e.map(e=>{var t;return{label:(0,r.jsx)("div",{style:{maxWidth:"120px"},children:(0,r.jsx)(p.Z.Text,{ellipsis:{tooltip:e.name},children:decodeURIComponent(e.name).split("_")[0]})}),key:e.name,children:(0,r.jsx)("div",{className:"h-full overflow-y-auto",children:null==e?void 0:null===(t=e.chunks)||void 0===t?void 0:t.map(e=>(0,r.jsx)(g.default,{children:e.content},e.id))})}})},[t]);return(0,r.jsxs)("div",{children:[(0,r.jsx)(j.Z,{className:"mb-1 mt-0",dashed:!0}),(0,r.jsxs)("div",{className:"flex text-sm gap-2 text-blue-400",onClick:()=>n(!0),children:[(0,r.jsx)(a.Z,{}),(0,r.jsx)("span",{className:"text-sm",children:"查看回复引用"})]}),(0,r.jsx)(v.Z,{open:s,title:"回复引用",placement:c?"bottom":"right",onClose:()=>n(!1),destroyOnClose:!0,className:"p-0",...!c&&{width:"30%"},children:(0,r.jsx)(b.Z,{items:i,size:"small"})})]})};var N=e=>{let{references:t}=e;try{let e=JSON.parse(t);return(0,r.jsx)(w,{references:e})}catch(e){return null}},k=l(48218),Z=l(24019),_=l(18429),C=l(8751),S=l(50888),E=l(74330),P=e=>{let{data:t}=e,l=(0,f.useMemo)(()=>{switch(t.status){case"todo":return(0,r.jsx)(Z.Z,{});case"failed":return(0,r.jsx)(_.Z,{className:"text-[rgb(255,77,79)]"});case"complete":return(0,r.jsx)(C.Z,{className:"text-[rgb(82,196,26)]"});case"running":return(0,r.jsx)(E.Z,{indicator:(0,r.jsx)(S.Z,{style:{fontSize:24},spin:!0})});default:return null}},[t]);return t?(0,r.jsxs)("div",{className:"flex flex-col p-2 border pr-4 rounded-md min-w-fit w-2/5",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(k.Z,{scene:"chat_agent",width:8,height:8}),(0,r.jsxs)("div",{className:"flex flex-col flex-1 ml-2",children:[(0,r.jsx)("div",{className:"flex items-center text-sm dark:text-[rgba(255,255,255,0.85)] gap-2",children:null==t?void 0:t.app_name}),(0,r.jsx)(p.Z.Text,{className:"text-sm text-[#525964] dark:text-[rgba(255,255,255,0.65)] leading-6",ellipsis:{tooltip:!0},children:null==t?void 0:t.app_desc})]})]}),(0,r.jsx)("div",{className:"text-2xl ml-1",children:l})]}),"failed"===t.status&&t.msg&&(0,r.jsx)(p.Z.Text,{type:"danger",className:"pl-12 text-xs mt-2",children:t.msg})]}):null},O=l(57249),L=l(73913),R=l(14726),F=e=>{let{children:t,msg:l}=e,{handleChat:a}=(0,f.useContext)(O.ChatContentContext),{handleChat:s}=(0,f.useContext)(L.MobileChatContext);return(0,r.jsx)(R.ZP,{className:"ml-1 inline text-xs",onClick:()=>{null==s||s(l),null==a||a(l)},type:"dashed",size:"small",children:t||"点击分析当前异常"})},$=l(41468),U=l(12576),T=l(63086),z=l(54143),M=l(40056),q=l(93967),J=l.n(q),D=e=>{let{data:t}=e,{mode:l}=(0,f.useContext)($.p),a=(0,f.useMemo)(()=>{switch(t.status){case"complete":return"success";case"failed":return"error";case"running":return"warning";default:return}},[t]);if(!t)return null;let s="dark"===l?T.R:z.K;return(0,r.jsxs)("div",{className:"flex flex-1 flex-col",children:[(0,r.jsx)(M.Z,{className:J()("mb-4",{"bg-[#fafafa] border-[transparent]":!a}),message:t.name,type:a,...a&&{showIcon:!0},..."warning"===a&&{icon:(0,r.jsx)(E.Z,{indicator:(0,r.jsx)(S.Z,{spin:!0})})}}),t.result&&(0,r.jsx)(U.ZP,{style:{...s,width:"100%",padding:10},className:J()({"bg-[#fafafa]":"light"===l}),value:JSON.parse(t.result||"{}"),enableClipboard:!1,displayDataTypes:!1,objectSortKeys:!1}),t.err_msg&&(0,r.jsx)(i.Z,{components:eV,...eY,children:t.err_msg})]})},B=l(39718),A=l(32198),I=function(e){let{data:t}=e;return t&&t.length?(0,r.jsx)(r.Fragment,{children:t.map((e,t)=>(0,r.jsxs)("div",{className:"rounded",children:[(0,r.jsxs)("div",{className:"flex items-center mb-3 text-sm",children:[e.model?(0,r.jsx)(B.Z,{model:e.model}):(0,r.jsx)("div",{className:"rounded-full w-6 h-6 bg-gray-100"}),(0,r.jsxs)("div",{className:"ml-2 opacity-70",children:[e.sender,(0,r.jsx)(A.Z,{className:"mx-2 text-base"}),e.receiver]})]}),(0,r.jsx)("div",{className:"whitespace-normal text-sm mb-3",children:(0,r.jsx)(i.Z,{components:eV,...eY,children:eI(e.markdown)})}),e.resource&&"null"!==e.resource&&(0,r.jsx)(N,{references:e.resource})]},t))}):null},G=l(14313),H=l(63606),K=l(47221),Y=function(e){let{data:t}=e;return t&&t.length?(0,r.jsx)(K.Z,{bordered:!0,className:"my-3",expandIcon:e=>{let{isActive:t}=e;return(0,r.jsx)(G.Z,{rotate:t?90:0})},items:t.map((e,t)=>({key:t,label:(0,r.jsxs)("div",{children:[(0,r.jsxs)("span",{children:[e.name," - ",e.agent]}),"complete"===e.status?(0,r.jsx)(H.Z,{className:"!text-green-500 ml-2"}):(0,r.jsx)(Z.Z,{className:"!text-gray-500 ml-2"})]}),children:(0,r.jsx)(i.Z,{components:eV,...eY,children:eI(e.markdown)})}))}):null},V=l(49296),W=l(62418),Q=l(84105);let X=(e,t)=>{if(t&&t.trim())return"".concat(t.trim(),".").concat(e);let l=new Date().toISOString().slice(0,19).replace(/:/g,"-");return"chat_table_".concat(l,".").concat(e)},ee=(e,t)=>{if(!e||0===e.length){console.warn("No data to export");return}try{let l=Q.P6.book_new(),r=Q.P6.json_to_sheet(e),a=e[0]?Object.keys(e[0]):[],s=a.map(e=>({wch:Math.max(e.length,15)}));r["!cols"]=s,Q.P6.book_append_sheet(l,r,"Data"),Q.NC(l,X("xlsx",t))}catch(e){throw console.error("Export to Excel failed:",e),Error("Failed to export Excel file")}},et=(e,t)=>{if(!e||0===e.length){console.warn("No data to export");return}try{let l=Q.P6.json_to_sheet(e),r=Q.P6.sheet_to_csv(l),a=new Blob([r],{type:"text/csv;charset=utf-8;"}),s=document.createElement("a"),n=URL.createObjectURL(a);s.setAttribute("href",n),s.setAttribute("download",X("csv",t)),s.style.visibility="hidden",document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(n)}catch(e){throw console.error("Export to CSV failed:",e),Error("Failed to export CSV file")}},el=(e,t)=>{if(!e||0===e.length){console.warn("No data to export");return}try{let l=JSON.stringify(e,null,2),r=new Blob([l],{type:"application/json;charset=utf-8;"}),a=document.createElement("a"),s=URL.createObjectURL(r);a.setAttribute("href",s),a.setAttribute("download",X("json",t)),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(s)}catch(e){throw console.error("Export to JSON failed:",e),Error("Failed to export JSON file")}},er=e=>{let{data:t,fileName:l,format:r}=e;switch(r){case"excel":ee(t,l);break;case"csv":et(t,l);break;case"json":el(t,l);break;default:throw Error("Unsupported export format: ".concat(r))}};var ea=l(51046),es=l(85418),en=l(39773),ec=l(85576),ei=l(25278),ed=l(57132),eo=l(45360),em=l(20640),eu=l.n(em),ex=l(84502),eh=l(94969),eg=l(12187);function ep(e){let{code:t,light:l,dark:a,language:s,customStyle:n}=e,{mode:c}=(0,f.useContext)($.p);return(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(R.ZP,{className:"absolute right-3 top-2 text-gray-300 hover:!text-gray-200 bg-gray-700",type:"text",icon:(0,r.jsx)(ed.Z,{}),onClick:()=>{let e=eu()(t);eo.ZP[e?"success":"error"](e?"复制成功":"复制失败")}}),(0,r.jsx)(ex.Z,{customStyle:n,language:s,style:"dark"===c?null!=a?a:eh.Z:null!=l?l:eg.Z,children:t})]})}let ej=e=>{let t={"，":",","。":".","？":"?","！":"!","：":":","；":";","“":'"',"”":'"',"‘":"'","’":"'","（":"(","）":")","【":"[","】":"]","《":"<","》":">","—":"-","、":",","…":"..."},l=RegExp(Object.keys(t).join("|"),"g");return e.replace(l,e=>t[e])};var ev=function(e){var t,l,a;let s,{data:n,type:c,sql:i,content:d,children:o}=e,[m,u]=(0,f.useState)(!1),[x,h]=(0,f.useState)("excel"),[g,p]=(0,f.useState)("");if(d)try{s=JSON.parse(d)}catch(e){console.log(e,d),s={type:"response_table",sql:"",data:[]}}else s={data:n||[],type:c||"response_table",sql:i||""};let j=(null==s?void 0:null===(t=s.data)||void 0===t?void 0:t[0])?null===(l=Object.keys(null==s?void 0:null===(a=s.data)||void 0===a?void 0:a[0]))||void 0===l?void 0:l.map(e=>({title:e,dataIndex:e,key:e})):[],v=e=>{h(e),p(""),u(!0)},y=()=>{try{er({data:s.data,format:x,fileName:g}),u(!1)}catch(e){console.error("Export failed:",e)}},w=(0,r.jsx)(es.Z,{menu:{items:[{key:"excel",label:"Export as Excel (.xlsx)",onClick:()=>v("excel")},{key:"csv",label:"Export as CSV (.csv)",onClick:()=>v("csv")},{key:"json",label:"Export as JSON (.json)",onClick:()=>v("json")}]},placement:"bottomRight",disabled:!(null==s?void 0:s.data)||0===s.data.length,children:(0,r.jsx)(R.ZP,{type:"primary",size:"small",icon:(0,r.jsx)(ea.Z,{}),disabled:!(null==s?void 0:s.data)||0===s.data.length,children:"Export Data"})}),N={key:"chart",label:"Chart",children:(0,r.jsx)(V._z,{data:null==s?void 0:s.data,chartType:(0,V.aG)(null==s?void 0:s.type)})},k={key:"sql",label:"SQL",children:(0,r.jsx)(ep,{code:(0,W._m)(ej(null==s?void 0:s.sql),"mysql"),language:"sql"})},Z={key:"data",label:"Data",children:(0,r.jsx)(en.Z,{dataSource:null==s?void 0:s.data,columns:j,scroll:{x:!0},virtual:!0})},_=(null==s?void 0:s.type)==="response_table"?[Z,k]:[N,k,Z];return(0,r.jsxs)("div",{children:[(0,r.jsx)(b.Z,{defaultActiveKey:(null==s?void 0:s.type)==="response_table"?"data":"chart",items:_,size:"small",tabBarExtraContent:w}),(0,r.jsxs)(ec.default,{title:"Export as ".concat(x.toUpperCase()),open:m,onOk:y,onCancel:()=>u(!1),okText:"Export",cancelText:"Cancel",children:[(0,r.jsxs)("div",{style:{marginBottom:16},children:[(0,r.jsx)("label",{style:{display:"block",marginBottom:8},children:"File Name (optional):"}),(0,r.jsx)(ei.default,{placeholder:"Leave empty to use default name (chat_table_timestamp.".concat(x,")"),value:g,onChange:e=>p(e.target.value),onPressEnter:y})]}),(0,r.jsxs)("div",{style:{fontSize:"12px",color:"#666"},children:["Default name format: chat_table_YYYY-MM-DDTHH-mm-ss.",x]})]}),o]})},eb=l(11713),ey=l(27732),ef=l(74842),ew=l(67421),eN=e=>{let{code:t,language:l="html"}=e,[a,s]=(0,f.useState)(!1),[n,c]=(0,f.useState)(!1),[i,d]=(0,f.useState)(!1),o=(0,f.useRef)(null),{t:m}=(0,ew.$G)(),[u,x]=(0,f.useState)({html:"",css:"",js:"",fullCode:""});(0,f.useEffect)(()=>{x((e=>{let t=e,l="",r="",a=[...e.matchAll(/<style[^>]*>([\s\S]*?)<\/style>/gi)];a.length>0&&a.forEach(e=>{l+=e[1]+"\n",t=t.replace(e[0],"")});let s=[...e.matchAll(/<script[^>]*>([\s\S]*?)<\/script>/gi)];s.length>0&&s.forEach(e=>{r+=e[1]+"\n",t=t.replace(e[0],"")});let n=e;return e.includes("<!DOCTYPE html>")||e.includes("<html")||(n='\n<!DOCTYPE html>\n<html>\n<head>\n  <meta charset="UTF-8">\n  <meta name="viewport" content="width=device-width, initial-scale=1.0">\n  <title>HTML Preview</title>\n  '.concat(a.length>0?a.map(e=>e[0]).join("\n"):"","\n</head>\n<body>\n  ").concat(t,"\n  ").concat(s.length>0?s.map(e=>e[0]).join("\n"):"","\n</body>\n</html>")),{html:t,css:l,js:r,fullCode:n}})(t))},[t]),(0,f.useEffect)(()=>{let e=()=>{d(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)};return document.addEventListener("fullscreenchange",e),document.addEventListener("webkitfullscreenchange",e),document.addEventListener("mozfullscreenchange",e),document.addEventListener("MSFullscreenChange",e),()=>{document.removeEventListener("fullscreenchange",e),document.removeEventListener("webkitfullscreenchange",e),document.removeEventListener("mozfullscreenchange",e),document.removeEventListener("MSFullscreenChange",e)}},[]);let h=()=>{i&&v(),s(!1)},g=()=>{let e=new Blob([u.fullCode],{type:"text/html"}),t=URL.createObjectURL(e),l=document.createElement("a");l.href=t,l.download="preview.html",document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(t)},p=()=>{i?v():j()},j=()=>{let e=o.current;e&&(e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.mozRequestFullScreen&&e.mozRequestFullScreen())},v=()=>{document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen&&document.mozCancelFullScreen()};return(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(ep,{code:t,language:l}),(0,r.jsxs)("div",{className:"absolute bottom-2 right-2 flex gap-2",children:[(0,r.jsx)(R.ZP,{type:"text",icon:(0,r.jsx)(ed.Z,{}),onClick:()=>{navigator.clipboard.writeText(t).then(()=>{c(!0),setTimeout(()=>c(!1),2e3)})},className:"flex items-center justify-center bg-opacity-70 hover:bg-opacity-100 transition-all",size:"small",children:n?m("code_preview_already_copied"):m("code_preview_copy")}),(0,r.jsx)(R.ZP,{type:"text",icon:(0,r.jsx)(ea.Z,{}),onClick:g,className:"flex items-center justify-center bg-opacity-70 hover:bg-opacity-100 transition-all",size:"small",children:m("code_preview_download")}),(0,r.jsx)(R.ZP,{type:"primary",icon:(0,r.jsx)(ef.Z,{}),onClick:()=>{s(!0)},className:"flex items-center justify-center bg-opacity-70 hover:bg-opacity-100 transition-all",size:"small",children:m("code_preview_run")})]}),(0,r.jsx)(ec.default,{title:"HTML "+m("code_preview"),open:a,onCancel:h,footer:[(0,r.jsxs)(R.ZP,{icon:(0,r.jsx)(ea.Z,{}),onClick:g,children:[m("code_preview_download")," HTML"]},"download"),(0,r.jsx)(R.ZP,{icon:i?(0,r.jsx)(eb.Z,{}):(0,r.jsx)(ey.Z,{}),onClick:p,children:i?m("code_preview_exit_full_screen"):m("code_preview_full_screen")},"fullscreen"),(0,r.jsx)(R.ZP,{onClick:h,children:m("code_preview_close")},"close")],width:800,bodyStyle:{padding:0},children:(0,r.jsx)(b.Z,{defaultActiveKey:"preview",items:(()=>{let e=[{key:"preview",label:m("code_preview"),children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("iframe",{ref:o,srcDoc:u.fullCode,style:{width:"100%",height:"60vh",border:"none"},sandbox:"allow-scripts allow-same-origin",title:"HTML Preview"}),(0,r.jsx)(R.ZP,{type:"primary",icon:i?(0,r.jsx)(eb.Z,{}):(0,r.jsx)(ey.Z,{}),onClick:p,className:"absolute top-2 right-2 z-10",size:"small",children:i?m("code_preview_exit_full_screen"):m("code_preview_full_screen")})]})}];return(u.html||u.css||u.js)&&e.push({key:"code",label:m("code_preview_code"),children:(0,r.jsxs)("div",{className:"p-4",children:[u.html&&(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("h3",{className:"text-lg font-medium mb-2",children:"HTML"}),(0,r.jsx)(ep,{code:u.html,language:"html"})]}),u.css&&(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("h3",{className:"text-lg font-medium mb-2",children:"CSS"}),(0,r.jsx)(ep,{code:u.css,language:"css"})]}),u.js&&(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("h3",{className:"text-lg font-medium mb-2",children:"JavaScript"}),(0,r.jsx)(ep,{code:u.js,language:"javascript"})]})]})}),e})()})})]})},ek=l(15668),eZ=l(35598),e_=l(33160),eC=l(42075),eS=l(30568),eE=e=>{let{code:t,language:l="svg"}=e,[a,s]=(0,f.useState)(!1),[n,c]=(0,f.useState)(!1),[i,d]=(0,f.useState)(100),{t:o}=(0,ew.$G)(),m=e=>{let t=e.replace(/<\?xml[^>]*\?>/g,"");if(t.includes("<svg")||(t='<svg xmlns="http://www.w3.org/2000/svg">'.concat(t,"</svg>")),!t.includes("xmlns=")&&t.includes("<svg")&&(t=t.replace("<svg",'<svg xmlns="http://www.w3.org/2000/svg"')),!t.includes("viewBox")&&t.includes("<svg")){let e=t.match(/width=["']([^"']*)["']/),l=t.match(/height=["']([^"']*)["']/);if(e&&l){let r=e[1].replace(/[^\d.]/g,""),a=l[1].replace(/[^\d.]/g,"");r&&a&&(t=t.replace("<svg",'<svg viewBox="0 0 '.concat(r," ").concat(a,'"')))}else t=t.replace("<svg",'<svg viewBox="0 0 800 600"')}return t.includes("</svg>")||(t="".concat(t,"</svg>")),t},u=()=>{let e=t.match(/<svg[\s\S]*<\/svg>/im);return e?m(e[0]):m(t)},x=()=>{s(!1),d(100)},h=()=>{let e=new Blob([u()],{type:"image/svg+xml"}),t=URL.createObjectURL(e),l=document.createElement("a");l.href=t,l.download="image.svg",document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(t)},g=e=>{d(e)},p=()=>{d(Math.min(i+10,200))},j=()=>{d(Math.max(i-10,50))},v=()=>{d(100)};return(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(ep,{code:t,language:l}),(0,r.jsxs)("div",{className:"absolute bottom-2 right-2 flex gap-2",children:[(0,r.jsx)(R.ZP,{type:"text",icon:(0,r.jsx)(ed.Z,{}),onClick:()=>{navigator.clipboard.writeText(t).then(()=>{c(!0),setTimeout(()=>c(!1),2e3)})},className:"flex items-center justify-center bg-opacity-70 hover:bg-opacity-100 transition-all",size:"small",children:n?o("code_preview_already_copied"):o("code_preview_copy")}),(0,r.jsx)(R.ZP,{type:"text",icon:(0,r.jsx)(ea.Z,{}),onClick:h,className:"flex items-center justify-center bg-opacity-70 hover:bg-opacity-100 transition-all",size:"small",children:o("code_preview_download")}),(0,r.jsx)(R.ZP,{type:"primary",icon:(0,r.jsx)(ef.Z,{}),onClick:()=>{s(!0)},className:"flex items-center justify-center bg-opacity-70 hover:bg-opacity-100 transition-all",size:"small",children:o("code_preview")})]}),(0,r.jsx)(ec.default,{title:"SVG "+o("code_preview"),open:a,onCancel:x,footer:[(0,r.jsxs)(R.ZP,{icon:(0,r.jsx)(ea.Z,{}),onClick:h,children:[o("code_preview_download")," SVG"]},"svg"),(0,r.jsxs)(R.ZP,{onClick:()=>{let e=document.createElement("canvas"),t=e.getContext("2d"),l=new Image,r=new Blob([u()],{type:"image/svg+xml"}),a=URL.createObjectURL(r);l.onload=()=>{e.width=l.width,e.height=l.height,t.drawImage(l,0,0);try{let t=e.toDataURL("image/png"),l=document.createElement("a");l.href=t,l.download="image.png",document.body.appendChild(l),l.click(),document.body.removeChild(l)}catch(e){console.error("PNG export failed:",e)}URL.revokeObjectURL(a)},l.src=a},children:[o("code_preview_download")," PNG"]},"png"),(0,r.jsx)(R.ZP,{onClick:x,children:o("code_preview_close")},"close")],width:800,bodyStyle:{padding:0},children:(0,r.jsx)(b.Z,{defaultActiveKey:"preview",items:(()=>{let e=[{key:"preview",label:o("code_preview"),children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"flex justify-center items-center p-4 bg-gray-100 dark:bg-gray-800 min-h-[60vh] overflow-auto",children:(0,r.jsx)("div",{className:"relative bg-white dark:bg-gray-700 p-4 shadow-md rounded flex items-center justify-center",children:(0,r.jsx)("div",{className:"transition-transform duration-200",style:{transform:"scale(".concat(i/100,")"),transformOrigin:"center center",maxWidth:"100%",maxHeight:"100%"},children:(0,r.jsx)("div",{className:"svg-container",dangerouslySetInnerHTML:{__html:u()},style:{maxWidth:"100%",margin:"0 auto",display:"flex",alignItems:"center",justifyContent:"center"}})})})}),(0,r.jsx)("div",{className:"flex items-center justify-center p-4 border-t border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800",children:(0,r.jsxs)(eC.Z,{children:[(0,r.jsx)(R.ZP,{icon:(0,r.jsx)(ek.Z,{}),onClick:j,disabled:i<=50}),(0,r.jsx)(eS.Z,{min:50,max:200,value:i,onChange:g,style:{width:200}}),(0,r.jsx)(R.ZP,{icon:(0,r.jsx)(eZ.Z,{}),onClick:p,disabled:i>=200}),(0,r.jsx)(R.ZP,{icon:(0,r.jsx)(e_.Z,{}),onClick:v,disabled:100===i}),(0,r.jsxs)("span",{className:"text-sm text-gray-500 dark:text-gray-400 min-w-[50px]",children:[i,"%"]})]})})]})},{key:"code",label:o("code_preview_code"),children:(0,r.jsx)("div",{className:"p-4",children:(0,r.jsx)(ep,{code:t,language:"svg"})})}];return e})()})})]})},eP=function(e){let{data:t}=e;return t?(0,r.jsx)(ev,{data:null==t?void 0:t.data,type:null==t?void 0:t.type,sql:null==t?void 0:t.sql}):null},eO=l(47727),eL=l(15273),eR=l(89144),eF=function(e){let{data:t}=e,{t:l}=(0,ew.$G)(),[a,s]=(0,f.useState)(0);return(0,r.jsxs)("div",{className:"bg-[#EAEAEB] rounded overflow-hidden border border-theme-primary dark:bg-theme-dark text-sm",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"flex",children:t.code.map((e,t)=>(0,r.jsxs)("div",{className:J()("px-4 py-2 text-[#121417] dark:text-white cursor-pointer",{"bg-white dark:bg-theme-dark-container":t===a}),onClick:()=>{s(t)},children:["CODE ",t+1,": ",e[0]]},t))}),t.code.length&&(0,r.jsx)(ep,{language:t.code[a][0],code:t.code[a][1],customStyle:{maxHeight:300,margin:0},light:eR.Z,dark:eg.Z})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"flex",children:(0,r.jsxs)("div",{className:"bg-white dark:bg-theme-dark-container px-4 py-2 text-[#121417] dark:text-white",children:[l("Terminal")," ",t.exit_success?(0,r.jsx)(eO.Z,{className:"text-green-600"}):(0,r.jsx)(eL.Z,{className:"text-red-600"})]})}),(0,r.jsx)("div",{className:"p-4 max-h-72 overflow-y-auto whitespace-normal bg-white dark:dark:bg-theme-dark",children:(0,r.jsx)(i.Z,{components:eV,remarkPlugins:[x.Z],children:t.log})})]})]})},e$=function(e){let{data:t}=e;return(0,r.jsxs)("div",{className:"rounded overflow-hidden",children:[(0,r.jsx)("div",{className:"p-3 text-white bg-red-500 whitespace-normal",children:t.display_type}),(0,r.jsxs)("div",{className:"p-3 bg-red-50",children:[(0,r.jsx)("div",{className:"mb-2 whitespace-normal",children:t.thought}),(0,r.jsx)(ep,{code:(0,W._m)(t.sql),language:"sql"})]})]})};let eU=[[2],[1,2],[1,3],[2,1,2],[2,1,3],[3,1,3],[3,2,3]];var eT=function(e){let{data:t}=e,l=(0,f.useMemo)(()=>{if(t.chart_count>1){let e=eU[t.chart_count-2],l=0;return e.map(e=>{let r=t.data.slice(l,l+e);return l=e,r})}return[t.data]},[t.data,t.chart_count]);return(0,r.jsx)("div",{className:"flex flex-col gap-3",children:l.map((e,t)=>(0,r.jsx)("div",{className:"flex gap-3",children:e.map((e,t)=>(0,r.jsxs)("div",{className:"flex flex-1 flex-col justify-between p-4 rounded border border-gray-200 dark:border-gray-500 whitespace-normal",children:[(0,r.jsxs)("div",{children:[e.title&&(0,r.jsx)("div",{className:"mb-2 text-lg",children:e.title}),e.describe&&(0,r.jsx)("div",{className:"mb-4 text-sm text-gray-500",children:e.describe})]}),(0,r.jsx)(V._z,{data:e.data,chartType:(0,V.aG)(e.type)})]},"chart-".concat(t)))},"row-".concat(t)))})},ez=l(97937);let eM={todo:{bgClass:"bg-gray-500",icon:(0,r.jsx)(Z.Z,{className:"ml-2"})},runing:{bgClass:"bg-blue-500",icon:(0,r.jsx)(S.Z,{className:"ml-2"})},failed:{bgClass:"bg-red-500",icon:(0,r.jsx)(ez.Z,{className:"ml-2"})},complete:{bgClass:"bg-green-500",icon:(0,r.jsx)(H.Z,{className:"ml-2"})}};var eq=function(e){var t,l;let{data:a}=e,{bgClass:s,icon:n}=null!==(t=eM[a.status])&&void 0!==t?t:{};return(0,r.jsxs)("div",{className:"bg-theme-light dark:bg-theme-dark-container rounded overflow-hidden my-2 flex flex-col",children:[(0,r.jsxs)("div",{className:J()("flex px-4 md:px-6 py-2 items-center text-white text-sm",s),children:[a.name,n]}),a.result?(0,r.jsx)("div",{className:"px-4 md:px-6 py-4 text-sm whitespace-normal",children:(0,r.jsx)(i.Z,{components:eV,rehypePlugins:[u.Z],remarkPlugins:[x.Z],children:null!==(l=a.result)&&void 0!==l?l:""})}):(0,r.jsx)("div",{className:"px-4 md:px-6 py-4 text-sm",children:a.err_msg})]})},eJ=l(80882),eD=l(18073);function eB(e){let{content:t}=e,{t:l}=(0,ew.$G)(),[a,s]=f.useState(!0);return(0,r.jsxs)("div",{className:"my-4 border rounded-lg overflow-hidden dark:border-gray-600",children:[(0,r.jsx)("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 cursor-pointer",onClick:()=>s(!a),children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("span",{className:"mr-2 font-medium text-gray-700 dark:text-gray-300",children:a?(0,r.jsx)(eJ.Z,{}):(0,r.jsx)(eD.Z,{})}),(0,r.jsx)("span",{className:"text-gray-700 dark:text-gray-300",children:l("cot_title")})]})}),a&&(0,r.jsx)("div",{className:"p-4 bg-white dark:bg-gray-900 border-t dark:border-gray-700",children:(0,r.jsx)("div",{className:"py-2 px-4 border-l-4 border-blue-600 rounded bg-gray-50 dark:bg-gray-800 text-gray-600 dark:text-gray-300",children:t||""})})]})}let eA=["custom-view","chart-view","references","summary"];function eI(e){if("string"!=typeof e)return e;let t=[];return e=(e=(e=(e=(e=e.replace(/(```[\s\S]*?```|`[^`\n]+`)/g,e=>(t.push(e),"<<CODE_BLOCK_".concat(t.length-1,">>")))).replace(/\\\\\[/g,"$$").replace(/\\\\\]/g,"$$").replace(/\\\\\(/g,"$").replace(/\\\\\)/g,"$").replace(/\\\[/g,"$$").replace(/\\\]/g,"$$").replace(/\\\(/g,"$").replace(/\\\)/g,"$")).replace(/([^\n])\$\$/g,"$1\n\n$$").replace(/\$\$([^\n])/g,"$$\n\n$1")).replace(/\$(?=\d)/g,"\\$")).replace(/<<CODE_BLOCK_(\d+)>>/g,(e,l)=>t[parseInt(l)])}let eG={code:(0,c.r)({languageRenderers:{"agent-plans":e=>{let{className:t,children:l}=e,a=String(l),s=(null==t?void 0:t.replace("language-",""))||"javascript";try{let e=JSON.parse(a);return(0,r.jsx)(Y,{data:e})}catch(e){return(0,r.jsx)(ep,{language:s,code:a})}},"agent-messages":e=>{let{className:t,children:l}=e,a=String(l),s=(null==t?void 0:t.replace("language-",""))||"javascript";try{let e=JSON.parse(a);return(0,r.jsx)(I,{data:e})}catch(e){return(0,r.jsx)(ep,{language:s,code:a})}},"vis-convert-error":e=>{let{className:t,children:l}=e,a=String(l),s=(null==t?void 0:t.replace("language-",""))||"javascript";try{let e=JSON.parse(a);return(0,r.jsx)(e$,{data:e})}catch(e){return(0,r.jsx)(ep,{language:s,code:a})}},"vis-dashboard":e=>{let{className:t,children:l}=e,a=String(l),s=(null==t?void 0:t.replace("language-",""))||"javascript";try{let e=JSON.parse(a);return(0,r.jsx)(eT,{data:e})}catch(e){return(0,r.jsx)(ep,{language:s,code:a})}},"vis-db-chart":e=>{let{className:t,children:l}=e,a=String(l),s=(null==t?void 0:t.replace("language-",""))||"javascript";try{let e=JSON.parse(a);return(0,r.jsx)(eP,{data:e})}catch(e){return(0,r.jsx)(ep,{language:s,code:a})}},"vis-plugin":e=>{let{className:t,children:l}=e,a=String(l),s=(null==t?void 0:t.replace("language-",""))||"javascript";try{let e=JSON.parse(a);return(0,r.jsx)(eq,{data:e})}catch(e){return(0,r.jsx)(ep,{language:s,code:a})}},"vis-code":e=>{let{className:t,children:l}=e,a=String(l),s=(null==t?void 0:t.replace("language-",""))||"javascript";try{let e=JSON.parse(a);return(0,r.jsx)(eF,{data:e})}catch(e){return(0,r.jsx)(ep,{language:s,code:a})}},"vis-app-link":e=>{let{className:t,children:l}=e,a=String(l),s=(null==t?void 0:t.replace("language-",""))||"javascript";try{let e=JSON.parse(a);return(0,r.jsx)(P,{data:e})}catch(e){return(0,r.jsx)(ep,{language:s,code:a})}},"vis-api-response":e=>{let{className:t,children:l}=e,a=String(l),s=(null==t?void 0:t.replace("language-",""))||"javascript";try{let e=JSON.parse(a);return(0,r.jsx)(D,{data:e})}catch(e){return(0,r.jsx)(ep,{language:s,code:a})}},"vis-thinking":e=>{let{className:t,children:l}=e,a=String(l);return null==t||t.replace("language-",""),(0,r.jsx)(eB,{content:a})},html:e=>{let{className:t,children:l}=e,a=String(l);return(0,r.jsx)(eN,{code:a,language:"html"})},web:e=>{let{className:t,children:l}=e,a=String(l);return(0,r.jsx)(eN,{code:a,language:"html"})},svg:e=>{let{className:t,children:l}=e,a=String(l);return(0,r.jsx)(eE,{code:a,language:"svg"})},xml:e=>{let{className:t,children:l}=e,a=String(l);return a.includes("<svg")&&a.includes("</svg>")?(0,r.jsx)(eE,{code:a,language:"svg"}):(0,r.jsx)(ep,{code:a,language:"xml"})}},defaultRenderer(e){let{node:t,className:l,children:a,style:s,...n}=e,c=String(a),d=(null==l?void 0:l.replace("language-",""))||"",{context:o,matchValues:g}=function(e){let t=eA.reduce((t,l)=>{let r=RegExp("<".concat(l,"[^>]*/?>"),"gi");return e=e.replace(r,e=>(t.push(e),"")),t},[]);return{context:e,matchValues:t}}(c);return(0,r.jsxs)(r.Fragment,{children:[d?(0,r.jsx)(ep,{code:o,language:d||"javascript"}):(0,r.jsx)("code",{...n,style:s,className:"p-1 mx-1 rounded bg-theme-light dark:bg-theme-dark text-sm",children:a}),(0,r.jsx)(i.Z,{components:eK,rehypePlugins:[u.Z,m.Z],remarkPlugins:[x.Z,h.Z],children:g.join("\n")})]})}})},eH={...eG,ul(e){let{children:t}=e;return(0,r.jsx)("ul",{className:"py-1",children:t})},ol(e){let{children:t}=e;return(0,r.jsx)("ol",{className:"py-1",children:t})},li(e){let{children:t,ordered:l}=e;return(0,r.jsx)("li",{className:"text-sm leading-7 ml-5 pl-2 text-gray-600 dark:text-gray-300 ".concat(l?"list-decimal":"list-disc"),children:t})},table(e){let{children:t}=e;return(0,r.jsx)("table",{className:"my-2 rounded-tl-md rounded-tr-md  bg-white dark:bg-gray-800 text-sm rounded-lg overflow-hidden",children:t})},thead(e){let{children:t}=e;return(0,r.jsx)("thead",{className:"bg-[#fafafa] dark:bg-black font-semibold",children:t})},th(e){let{children:t}=e;return(0,r.jsx)("th",{className:"!text-left p-4",children:t})},td(e){let{children:t}=e;return(0,r.jsx)("td",{className:"p-4 border-t border-[#f0f0f0] dark:border-gray-700",children:t})},h1(e){let{children:t}=e;return(0,r.jsx)("h3",{className:"text-2xl font-bold my-4 border-b border-slate-300 pb-4",children:t})},h2(e){let{children:t}=e;return(0,r.jsx)("h3",{className:"text-xl font-bold my-3",children:t})},h3(e){let{children:t}=e;return(0,r.jsx)("h3",{className:"text-lg font-semibold my-2",children:t})},h4(e){let{children:t}=e;return(0,r.jsx)("h3",{className:"text-base font-semibold my-1",children:t})},a(e){let{children:t,href:l}=e;return(0,r.jsxs)("div",{className:"inline-block text-blue-600 dark:text-blue-400",children:[(0,r.jsx)(a.Z,{className:"mr-1"}),(0,r.jsx)("a",{href:l,target:"_blank",rel:"noreferrer",children:t})]})},img(e){let{src:t,alt:l}=e;return(0,r.jsx)("div",{children:(0,r.jsx)(d.Z,{className:"min-h-[1rem] max-w-full max-h-full border rounded",src:t,alt:l,placeholder:(0,r.jsx)(o.Z,{icon:(0,r.jsx)(s.Z,{spin:!0}),color:"processing",children:"Image Loading..."}),fallback:"/pictures/fallback.png"})})},blockquote(e){let{children:t}=e;return(0,r.jsx)("blockquote",{className:"py-4 px-6 border-l-4 border-blue-600 rounded bg-white my-2 text-gray-500 dark:bg-slate-800 dark:text-gray-200 dark:border-white shadow-sm",children:t})},button(e){let{children:t,className:l,...a}=e;if("chat-link"===l){let e=null==a?void 0:a["data-msg"];return(0,r.jsx)(F,{msg:e,children:t})}return(0,r.jsx)("button",{className:l,...a,children:t})}},eK={...eH,"chart-view":function(e){let{content:t,children:l}=e;return(0,r.jsx)(ev,{content:t,children:l})},references:function(e){let{children:t}=e;if(t)try{let e=JSON.parse(t),l=e.references;return(0,r.jsx)(N,{references:l})}catch(e){return null}},summary:function(e){let{children:t}=e;return(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"mb-2",children:[(0,r.jsx)(n.Z,{className:"mr-2"}),(0,r.jsx)("span",{className:"font-semibold",children:"Document Summary"})]}),(0,r.jsx)("div",{children:t})]})}},eY={remarkPlugins:[x.Z,[h.Z,{singleDollarTextMath:!0}]],rehypePlugins:[u.Z,[m.Z,{output:"htmlAndMathml"}]]};var eV=eK},18102:function(e,t,l){"use strict";l.r(t);var r=l(85893),a=l(90936),s=l(32975);l(67294),t.default=e=>{let{children:t}=e;return(0,r.jsx)(s.Z,{components:{...a.ZP},...a.dx,children:(0,a.CE)(t)})}},20067:function(){},72061:function(){}}]);