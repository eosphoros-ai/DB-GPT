(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1113],{47329:function(e,l,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/construct/models",function(){return t(33706)}])},81799:function(e,l,t){"use strict";t.d(l,{A:function(){return u}});var a=t(85893),s=t(41468),n=t(19284),r=t(34041),i=t(25675),d=t.n(i),o=t(67294),c=t(67421);let m="/models/huggingface.svg";function u(e,l){var t,s;let{width:r,height:i}=l||{};return e?(0,a.jsx)(d(),{className:"rounded-full border border-gray-200 object-contain bg-white inline-block",width:r||24,height:i||24,src:(null===(t=n.Hf[e])||void 0===t?void 0:t.icon)||m,alt:"llm"},(null===(s=n.Hf[e])||void 0===s?void 0:s.icon)||m):null}l.Z=function(e){let{onChange:l}=e,{t}=(0,c.$G)(),{modelList:i,model:d}=(0,o.useContext)(s.p);return!i||i.length<=0?null:(0,a.jsx)(r.default,{value:d,placeholder:t("choose_model"),className:"w-52",onChange:e=>{null==l||l(e)},children:i.map(e=>{var l;return(0,a.jsx)(r.default.Option,{children:(0,a.jsxs)("div",{className:"flex items-center",children:[u(e),(0,a.jsx)("span",{className:"ml-2",children:(null===(l=n.Hf[e])||void 0===l?void 0:l.label)||e})]})},e)})})}},48218:function(e,l,t){"use strict";var a=t(85893),s=t(82353),n=t(16165),r=t(67294);l.Z=e=>{let{width:l,height:t,scene:i}=e,d=(0,r.useCallback)(()=>{switch(i){case"chat_knowledge":return s.je;case"chat_with_db_execute":return s.zM;case"chat_excel":return s.DL;case"chat_with_db_qa":case"chat_dba":return s.RD;case"chat_dashboard":return s.In;case"chat_agent":return s.si;case"chat_normal":return s.O7;default:return}},[i]);return(0,a.jsx)(n.Z,{className:"w-".concat(l||7," h-").concat(t||7),component:d()})}},91467:function(e,l,t){"use strict";t.d(l,{TH:function(){return x},ZS:function(){return f}});var a=t(85893),s=t(89705),n=t(83062),r=t(96074),i=t(45030),d=t(85418),o=t(93967),c=t.n(o),m=t(36609),u=t(25675),p=t.n(u);t(67294);var h=t(48218);t(11873);let x=e=>{let{onClick:l,Icon:t="/pictures/card_chat.png",text:s=(0,m.t)("start_chat")}=e;return"string"==typeof t&&(t=(0,a.jsx)(p(),{src:t,alt:t,width:17,height:15})),(0,a.jsxs)("div",{className:"flex items-center gap-1 text-default",onClick:e=>{e.stopPropagation(),l&&l()},children:[t,(0,a.jsx)("span",{children:s})]})},f=e=>{let{menu:l}=e;return(0,a.jsx)(d.Z,{menu:l,getPopupContainer:e=>e.parentNode,placement:"bottomRight",autoAdjustOverflow:!1,children:(0,a.jsx)(s.Z,{className:"p-2 hover:bg-white hover:dark:bg-black rounded-md"})})};l.ZP=e=>{let{RightTop:l,Tags:t,LeftBottom:s,RightBottom:d,onClick:o,rightTopHover:m=!0,logo:u,name:x,description:f,className:_,scene:v,code:j}=e;return"string"==typeof f&&(f=(0,a.jsx)("p",{className:"line-clamp-2 relative bottom-4 text-ellipsis min-h-[42px] text-sm text-[#525964] dark:text-[rgba(255,255,255,0.65)]",children:f})),(0,a.jsx)("div",{className:c()("hover-underline-gradient flex justify-center mt-6 relative group w-1/3 px-2 mb-6",_),children:(0,a.jsxs)("div",{onClick:o,className:"backdrop-filter backdrop-blur-lg cursor-pointer  bg-white bg-opacity-70 border-2 border-white rounded-lg shadow p-4 relative w-full h-full dark:border-[#6f7f95] dark:bg-[#6f7f95] dark:bg-opacity-60",children:[(0,a.jsxs)("div",{className:"flex items-end relative bottom-8 justify-between w-full",children:[(0,a.jsxs)("div",{className:"flex items-end gap-4 w-11/12  flex-1",children:[(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm w-14 h-14 flex items-center p-3",children:v?(0,a.jsx)(h.Z,{scene:v,width:14,height:14}):u&&(0,a.jsx)(p(),{src:u,width:44,height:44,alt:x,className:"w-8 min-w-8 rounded-full max-w-none"})}),(0,a.jsx)("div",{className:"flex-1",children:x.length>6?(0,a.jsx)(n.Z,{title:x,children:(0,a.jsx)("span",{className:"line-clamp-1 text-ellipsis font-semibold text-base",style:{maxWidth:"60%"},children:x})}):(0,a.jsx)("span",{className:"line-clamp-1 text-ellipsis font-semibold text-base",style:{maxWidth:"60%"},children:x})})]}),(0,a.jsx)("span",{className:c()("shrink-0",{hidden:m,"group-hover:block":m}),onClick:e=>{e.stopPropagation()},children:l})]}),f,(0,a.jsx)("div",{className:"relative bottom-2",children:t}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("div",{children:s}),(0,a.jsx)("div",{children:d})]}),j&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.Z,{className:"my-3"}),(0,a.jsx)(i.Z.Text,{copyable:!0,className:"absolute bottom-1 right-4 text-xs text-gray-500",children:j})]})]})})}},1771:function(e,l,t){"use strict";var a=t(85893),s=t(82353),n=t(41156),r=t(9641),i=t(16165),d=t(9020),o=t(92962),c=t(38545),m=t(50067),u=t(28459),p=t(92398),h=t(36609),x=t(11163);t(67294),t(53878),l.Z=function(e){let{children:l}=e,t=[{key:"app",name:(0,h.t)("App"),path:"/app",icon:(0,a.jsx)(n.Z,{})},{key:"flow",name:(0,h.t)("awel_flow"),icon:(0,a.jsx)(r.Z,{}),path:"/flow"},{key:"models",name:(0,h.t)("model_manage"),path:"/models",icon:(0,a.jsx)(i.Z,{component:s.IN})},{key:"database",name:(0,h.t)("Database"),icon:(0,a.jsx)(d.Z,{}),path:"/database"},{key:"knowledge",name:(0,h.t)("Knowledge_Space"),icon:(0,a.jsx)(o.Z,{}),path:"/knowledge"},{key:"prompt",name:(0,h.t)("Prompt"),icon:(0,a.jsx)(c.Z,{}),path:"/prompt"},{key:"dbgpts",name:(0,h.t)("dbgpts_community"),path:"/dbgpts",icon:(0,a.jsx)(m.Z,{})}],f=(0,x.useRouter)(),_=f.pathname.split("/")[2];return(0,a.jsx)("div",{className:"flex flex-col h-full w-full  dark:bg-gradient-dark bg-gradient-light bg-cover bg-center",children:(0,a.jsx)(u.ZP,{theme:{components:{Button:{},Segmented:{itemSelectedBg:"#2867f5",itemSelectedColor:"white"}}},children:(0,a.jsx)(p.Z,{activeKey:_,items:t.map(e=>({key:e.key,label:e.name,children:l,icon:e.icon})),onTabClick:e=>{f.push("/construct/".concat(e))}})})})}},33706:function(e,l,t){"use strict";t.r(l),t.d(l,{default:function(){return E}});var a=t(85893),s=t(76212),n=t(81799),r=t(34041),i=t(99859),d=t(45360),o=t(49288),c=t(83062),m=t(14726),u=t(67294),p=t(67421),h=t(72510),x=t(25278),f=t(13457),_=t(84567),v=e=>{let{parentName:l,fields:t,form:s}=e,[n,d]=(0,u.useState)(null);(0,u.useEffect)(()=>{let e=s.getFieldValue(l);(null==e?void 0:e.type)&&!n&&d(e.type)},[s,l]);let o=e=>{var t,s;let n;let d=e.param_type.toLowerCase(),o=[l,e.param_name].join("."),c=null===(t=e.ext_metadata)||void 0===t?void 0:null===(s=t.tags)||void 0===s?void 0:s.includes("fixed");return n="str"===d||"string"===d?e.valid_values?(0,a.jsx)(r.default,{disabled:c,children:e.valid_values.map(e=>(0,a.jsx)(r.default.Option,{value:e,children:e},e))}):(0,a.jsx)(x.default,{disabled:c}):"int"===d||"integer"===d||"number"===d||"float"===d?(0,a.jsx)(f.Z,{className:"w-full",disabled:c}):"bool"===d||"boolean"===d?(0,a.jsx)(_.Z,{disabled:c}):(0,a.jsx)(x.default,{disabled:c}),(0,a.jsx)(i.default.Item,{label:(0,a.jsx)("p",{className:"whitespace-normal overflow-wrap-break-word",children:e.label||e.param_name}),name:o,initialValue:e.default_value,valuePropName:"bool"===d||"boolean"===d?"checked":"value",tooltip:e.description,rules:[{required:e.required,message:"Please input ".concat(e.param_name)}],children:n},o)};return(0,a.jsxs)("div",{className:"space-y-4 border rounded-md p-4",children:[(0,a.jsx)(i.default.Item,{label:"Type",name:"".concat(l,".type"),required:!0,tooltip:"Select the type to see specific configuration options",children:(0,a.jsx)(r.default,{value:n,onChange:e=>{d(e);let a=t[e]||[],n={type:e,...Object.fromEntries(a.map(e=>[e.param_name,e.default_value]))};s.setFieldValue(l,n)},placeholder:"Select a type",className:"w-full",children:Object.keys(t).map(e=>(0,a.jsx)(r.default.Option,{value:e,children:e},e))})}),n&&(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsxs)("h4",{className:"mb-4 text-base font-medium",children:[n," Configuration"]}),(0,a.jsx)("div",{className:"space-y-4",children:t[n].map(e=>o(e))})]})]})},j=function(e){let{params:l,form:t}=e;if((0,u.useEffect)(()=>{if(l){let e={};l.forEach(l=>{l.nested_fields||(e[l.param_name]=l.default_value)}),t.setFieldsValue(e)}},[l,t]),!l||(null==l?void 0:l.length)<1)return null;let s=e=>{let t={...e};return null==l||l.forEach(e=>{if(e.nested_fields&&t[e.param_name]){let l=t[e.param_name];if(l.type){let a=l.type;t[e.param_name]={type:a,...l}}}}),t},n=t.submit;return t.submit=()=>{let e=t.getFieldsValue(),l=s(e);t.setFieldsValue(l),n.call(t)},(0,a.jsx)("div",{className:"space-y-4",children:null==l?void 0:l.map(e=>(0,a.jsx)(i.default.Item,{label:(0,a.jsx)("p",{className:"whitespace-normal overflow-wrap-break-word",children:e.label||e.param_name}),name:e.param_name,initialValue:e.default_value,valuePropName:"bool"===e.param_type.toLowerCase()||"boolean"===e.param_type.toLowerCase()?"checked":"value",tooltip:e.description,rules:[{required:e.required,message:"Please input ".concat(e.param_name)}],children:function(e){var l,s;if(e.nested_fields)return(0,a.jsx)(v,{parentName:e.param_name,fields:e.nested_fields,form:t});let n=e.param_type.toLowerCase(),i=null===(l=e.ext_metadata)||void 0===l?void 0:null===(s=l.tags)||void 0===s?void 0:s.includes("fixed");return"str"===n||"string"===n?e.valid_values?(0,a.jsx)(r.default,{disabled:i,children:e.valid_values.map(e=>(0,a.jsx)(r.default.Option,{value:e,children:e},e))}):(0,a.jsx)(x.default,{disabled:i}):"int"===n||"integer"===n||"number"===n||"float"===n?(0,a.jsx)(f.Z,{className:"w-full",disabled:i}):"bool"===n||"boolean"===n?(0,a.jsx)(_.Z,{disabled:i}):(0,a.jsx)(x.default,{disabled:i})}(e)},e.param_name))})};let{Option:b}=r.default,g=i.default.Item,w=["llm","text2vec","reranker"];var y=function(e){var l;let{onCancel:t,onSuccess:x}=e,{t:f}=(0,p.$G)(),[_,v]=(0,u.useState)([]),[y,N]=(0,u.useState)(),[k,Z]=(0,u.useState)(),[C,P]=(0,u.useState)(null),[S,O]=(0,u.useState)(!1),[V]=i.default.useForm(),[E,F]=(0,u.useState)({}),[H,T]=(0,u.useState)([]);async function q(){let[,e]=await (0,s.Vx)((0,s.xv)());if(e&&e.length){let l=e.sort((e,l)=>e.enabled&&!l.enabled?-1:!e.enabled&&l.enabled?1:e.model.localeCompare(l.model));v(l);let t=l.reduce((e,l)=>{let t=l.provider;return e[t]||(e[t]=[]),e[t].push(l),e},{});F(t),T([])}}async function A(e){if(k&&y){O(!0);try{var l;let t=null===(l=E[k])||void 0===l?void 0:l.find(l=>l.model===e.name),a={host:(null==t?void 0:t.host)||"",port:(null==t?void 0:t.port)||0,model:e.name,worker_type:y,params:e},[,,n]=await (0,s.Vx)((0,s.NY)(a));(null==n?void 0:n.success)&&(d.ZP.success(f("start_model_success")),null==x||x())}catch(e){d.ZP.error(f("start_model_failed"))}finally{O(!1)}}}(0,u.useEffect)(()=>{q()},[]);let I=e=>(0,a.jsxs)("div",{className:"max-w-md",children:[(0,a.jsx)("div",{className:"whitespace-pre-wrap markdown-body",children:(0,a.jsx)(h.U,{children:e.description||e.model})}),(0,a.jsx)("div",{className:"mt-2 text-xs opacity-75",children:e.enabled?"".concat(e.host,":").concat(e.port):f("download_model_tip")})]});return(0,a.jsxs)(i.default,{form:V,labelCol:{span:8},wrapperCol:{span:16},onFinish:A,children:[(0,a.jsx)(g,{label:"Worker Type",name:"worker_type",rules:[{required:!0,message:f("worker_type_select_tips")}],children:(0,a.jsx)(r.default,{onChange:function(e){N(e),Z(void 0),V.resetFields(),V.setFieldValue("worker_type",e),function(e){let l=new Set;Object.entries(E).forEach(t=>{let[a,s]=t;s.some(l=>l.worker_type===e)&&l.add(a)}),T(Array.from(l).sort())}(e)},placeholder:f("model_select_worker_type"),children:w.map(e=>(0,a.jsx)(b,{value:e,children:e},e))})}),y&&(0,a.jsx)(g,{label:"Provider",name:"provider",rules:[{required:!0,message:f("provider_select_tips")}],children:(0,a.jsx)(r.default,{onChange:function(e){Z(e),V.setFieldValue("provider",e);let l=E[e]||[],t=l.filter(e=>e.worker_type===y);if(t.length>0){let e=t[0];(null==e?void 0:e.params)&&P(Array.isArray(e.params)?e.params:[e.params])}},placeholder:f("model_select_provider"),value:k,children:H.map(e=>(0,a.jsx)(b,{value:e,children:e},e))})}),k&&y&&C&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(g,{label:f("model_deploy_name"),name:"name",rules:[{required:!0,message:f("model_please_input_name")}],children:(0,a.jsx)(o.Z,{style:{width:"100%"},placeholder:f("model_select_or_input_model"),options:null===(l=E[k])||void 0===l?void 0:l.filter(e=>e.worker_type===y).map(e=>({value:e.model,label:(0,a.jsx)("div",{className:"flex items-center w-full",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,n.A)(e.model),(0,a.jsx)(c.Z,{title:I(e),placement:"right",children:(0,a.jsx)("span",{className:"ml-2",children:e.model})})]})})})),filterOption:(e,l)=>-1!==l.value.toUpperCase().indexOf(e.toUpperCase())})}),(0,a.jsx)(j,{params:C.filter(e=>"name"!==e.param_name),form:V})]}),(0,a.jsxs)("div",{className:"flex justify-center space-x-4",children:[(0,a.jsx)(m.ZP,{type:"primary",htmlType:"submit",loading:S,children:f("submit")}),(0,a.jsx)(m.ZP,{onClick:t,children:f("cancel")})]})]})},N=t(91467),k=t(1771),Z=t(19284),C=t(24969),P=t(85576),S=t(66309),O=t(30381),V=t.n(O),E=function(){let{t:e}=(0,p.$G)(),[l,t]=(0,u.useState)([]),[n,r]=(0,u.useState)(!1),[i,o]=(0,u.useState)(!1);async function c(){let[,e]=await (0,s.Vx)((0,s.fZ)());t(null!=e?e:[])}async function h(l){if(i)return;let t=e("confirm_start_model")+l.model_name;f(e("start_model"),t,async()=>{o(!0);let[,,t]=await (0,s.Vx)((0,s.vA)({host:l.host,port:l.port,model:l.model_name,worker_type:l.worker_type,delete_after:!1,params:{}}));o(!1),(null==t?void 0:t.success)&&(d.ZP.success(e("start_model_success")),await c())})}async function x(l){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(i)return;let a=t?"stop_and_delete":"stop",n=e("confirm_".concat(a,"_model"))+l.model_name;f(e("".concat(a,"_model")),n,async()=>{o(!0);let[,,n]=await (0,s.Vx)((0,s.kU)({host:l.host,port:l.port,model:l.model_name,worker_type:l.worker_type,delete_after:t,params:{}}));o(!1),(null==n?void 0:n.success)===!0&&(d.ZP.success(e("".concat(a,"_model_success"))),await c())})}let f=(e,l,t)=>{P.default.confirm({title:e,content:l,onOk:async()=>{await t()},okButtonProps:{className:"bg-button-gradient"}})};(0,u.useEffect)(()=>{c()},[]);let _=e=>{let l=null==e?void 0:e.replaceAll("-","_").split("_")[0],t=Object.keys(Z.Me);for(let e=0;e<t.length;e++){let a=t[e];if(null==l?void 0:l.includes(a))return Z.Me[a]}return"/pictures/model.png"};return(0,a.jsx)(k.Z,{children:(0,a.jsxs)("div",{className:"px-6 overflow-y-auto",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("div",{className:"flex items-center gap-4"}),(0,a.jsx)("div",{className:"flex items-center gap-4",children:(0,a.jsx)(m.ZP,{className:"border-none text-white bg-button-gradient",icon:(0,a.jsx)(C.Z,{}),onClick:()=>{r(!0)},children:e("create_model")})})]}),(0,a.jsx)("div",{className:"flex flex-wrap mx-[-8px] ",children:l.map(l=>(0,a.jsx)(N.ZP,{logo:_(l.model_name),description:(0,a.jsxs)("div",{className:"flex flex-col gap-1 relative text-xs bottom-4",children:[(0,a.jsxs)("div",{className:"flex overflow-hidden",children:[(0,a.jsx)("p",{className:"w-28 text-gray-500 mr-2",children:"Host:"}),(0,a.jsx)("p",{className:"flex-1 text-ellipsis",children:l.host})]}),(0,a.jsxs)("div",{className:"flex overflow-hidden",children:[(0,a.jsx)("p",{className:"w-28 text-gray-500 mr-2",children:"Manage Host:"}),(0,a.jsxs)("p",{className:"flex-1 text-ellipsis",children:[l.manager_host,":",l.manager_port]})]}),(0,a.jsxs)("div",{className:"flex overflow-hidden",children:[(0,a.jsx)("p",{className:"w-28 text-gray-500 mr-2",children:"Last Heart Beat:"}),(0,a.jsx)("p",{className:"flex-1 text-ellipsis",children:V()(l.last_heartbeat).format("YYYY-MM-DD HH:mm:ss")})]})]}),name:l.model_name,RightTop:(0,a.jsx)(N.ZS,{menu:{items:[{key:"stop_model",label:(0,a.jsx)("span",{className:"text-red-400",onClick:()=>x(l),children:e("stop_model")})},{key:"start_model",label:(0,a.jsx)("span",{className:"text-green-400",onClick:()=>h(l),children:e("start_model")})},{key:"stop_and_delete_model",label:(0,a.jsx)("span",{className:"text-red-400",onClick:()=>x(l,!0),children:e("stop_and_delete_model")})}]}}),rightTopHover:!1,Tags:(0,a.jsxs)("div",{children:[(0,a.jsx)(S.Z,{color:l.healthy?"green":"red",children:l.healthy?"Healthy":"Unhealthy"}),(0,a.jsx)(S.Z,{children:l.worker_type})]})},l.model_name))}),(0,a.jsx)(P.default,{width:800,open:n,title:e("create_model"),onCancel:()=>{r(!1)},footer:null,children:(0,a.jsx)(y,{onCancel:()=>{r(!1)},onSuccess:()=>{r(!1),c()}})})]})})}},11873:function(){},53878:function(){}},function(e){e.O(0,[2913,3791,5278,8791,1049,5030,4041,2398,9859,4567,3457,2510,2658,9774,2888,179],function(){return e(e.s=47329)}),_N_E=e.O()}]);