(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1113],{6171:function(e,t,l){"use strict";l.d(t,{Z:function(){return i}});var a=l(87462),n=l(67294),r={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M724 218.3V141c0-6.7-7.7-10.4-12.9-6.3L260.3 486.8a31.86 31.86 0 000 50.3l450.8 352.1c5.3 4.1 12.9.4 12.9-6.3v-77.3c0-4.9-2.3-9.6-6.1-12.6l-360-281 360-281.1c3.8-3 6.1-7.7 6.1-12.6z"}}]},name:"left",theme:"outlined"},s=l(13401),i=n.forwardRef(function(e,t){return n.createElement(s.Z,(0,a.Z)({},e,{ref:t,icon:r}))})},98065:function(e,t,l){"use strict";function a(e){return["small","middle","large"].includes(e)}function n(e){return!!e&&"number"==typeof e&&!Number.isNaN(e)}l.d(t,{T:function(){return n},n:function(){return a}})},96074:function(e,t,l){"use strict";l.d(t,{Z:function(){return f}});var a=l(67294),n=l(93967),r=l.n(n),s=l(53124),i=l(25446),o=l(14747),d=l(83559),c=l(83262);let m=e=>{let{componentCls:t,sizePaddingEdgeHorizontal:l,colorSplit:a,lineWidth:n,textPaddingInline:r,orientationMargin:s,verticalMarginInline:d}=e;return{[t]:Object.assign(Object.assign({},(0,o.Wf)(e)),{borderBlockStart:`${(0,i.bf)(n)} solid ${a}`,"&-vertical":{position:"relative",top:"-0.06em",display:"inline-block",height:"0.9em",marginInline:d,marginBlock:0,verticalAlign:"middle",borderTop:0,borderInlineStart:`${(0,i.bf)(n)} solid ${a}`},"&-horizontal":{display:"flex",clear:"both",width:"100%",minWidth:"100%",margin:`${(0,i.bf)(e.dividerHorizontalGutterMargin)} 0`},[`&-horizontal${t}-with-text`]:{display:"flex",alignItems:"center",margin:`${(0,i.bf)(e.dividerHorizontalWithTextGutterMargin)} 0`,color:e.colorTextHeading,fontWeight:500,fontSize:e.fontSizeLG,whiteSpace:"nowrap",textAlign:"center",borderBlockStart:`0 ${a}`,"&::before, &::after":{position:"relative",width:"50%",borderBlockStart:`${(0,i.bf)(n)} solid transparent`,borderBlockStartColor:"inherit",borderBlockEnd:0,transform:"translateY(50%)",content:"''"}},[`&-horizontal${t}-with-text-left`]:{"&::before":{width:`calc(${s} * 100%)`},"&::after":{width:`calc(100% - ${s} * 100%)`}},[`&-horizontal${t}-with-text-right`]:{"&::before":{width:`calc(100% - ${s} * 100%)`},"&::after":{width:`calc(${s} * 100%)`}},[`${t}-inner-text`]:{display:"inline-block",paddingBlock:0,paddingInline:r},"&-dashed":{background:"none",borderColor:a,borderStyle:"dashed",borderWidth:`${(0,i.bf)(n)} 0 0`},[`&-horizontal${t}-with-text${t}-dashed`]:{"&::before, &::after":{borderStyle:"dashed none none"}},[`&-vertical${t}-dashed`]:{borderInlineStartWidth:n,borderInlineEnd:0,borderBlockStart:0,borderBlockEnd:0},"&-dotted":{background:"none",borderColor:a,borderStyle:"dotted",borderWidth:`${(0,i.bf)(n)} 0 0`},[`&-horizontal${t}-with-text${t}-dotted`]:{"&::before, &::after":{borderStyle:"dotted none none"}},[`&-vertical${t}-dotted`]:{borderInlineStartWidth:n,borderInlineEnd:0,borderBlockStart:0,borderBlockEnd:0},[`&-plain${t}-with-text`]:{color:e.colorText,fontWeight:"normal",fontSize:e.fontSize},[`&-horizontal${t}-with-text-left${t}-no-default-orientation-margin-left`]:{"&::before":{width:0},"&::after":{width:"100%"},[`${t}-inner-text`]:{paddingInlineStart:l}},[`&-horizontal${t}-with-text-right${t}-no-default-orientation-margin-right`]:{"&::before":{width:"100%"},"&::after":{width:0},[`${t}-inner-text`]:{paddingInlineEnd:l}}})}};var u=(0,d.I$)("Divider",e=>{let t=(0,c.IX)(e,{dividerHorizontalWithTextGutterMargin:e.margin,dividerHorizontalGutterMargin:e.marginLG,sizePaddingEdgeHorizontal:0});return[m(t)]},e=>({textPaddingInline:"1em",orientationMargin:.05,verticalMarginInline:e.marginXS}),{unitless:{orientationMargin:!0}}),p=function(e,t){var l={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&0>t.indexOf(a)&&(l[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,a=Object.getOwnPropertySymbols(e);n<a.length;n++)0>t.indexOf(a[n])&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(l[a[n]]=e[a[n]]);return l},f=e=>{let{getPrefixCls:t,direction:l,divider:n}=a.useContext(s.E_),{prefixCls:i,type:o="horizontal",orientation:d="center",orientationMargin:c,className:m,rootClassName:f,children:h,dashed:x,variant:v="solid",plain:b,style:g}=e,_=p(e,["prefixCls","type","orientation","orientationMargin","className","rootClassName","children","dashed","variant","plain","style"]),j=t("divider",i),[y,w,N]=u(j),k=!!h,$="left"===d&&null!=c,O="right"===d&&null!=c,C=r()(j,null==n?void 0:n.className,w,N,`${j}-${o}`,{[`${j}-with-text`]:k,[`${j}-with-text-${d}`]:k,[`${j}-dashed`]:!!x,[`${j}-${v}`]:"solid"!==v,[`${j}-plain`]:!!b,[`${j}-rtl`]:"rtl"===l,[`${j}-no-default-orientation-margin-left`]:$,[`${j}-no-default-orientation-margin-right`]:O},m,f),S=a.useMemo(()=>"number"==typeof c?c:/^\d+$/.test(c)?Number(c):c,[c]),Z=Object.assign(Object.assign({},$&&{marginLeft:S}),O&&{marginRight:S});return y(a.createElement("div",Object.assign({className:C,style:Object.assign(Object.assign({},null==n?void 0:n.style),g)},_,{role:"separator"}),h&&"vertical"!==o&&a.createElement("span",{className:`${j}-inner-text`,style:Z},h)))}},42075:function(e,t,l){"use strict";l.d(t,{Z:function(){return x}});var a=l(67294),n=l(93967),r=l.n(n),s=l(50344),i=l(98065),o=l(53124),d=l(4173);let c=a.createContext({latestIndex:0}),m=c.Provider;var u=e=>{let{className:t,index:l,children:n,split:r,style:s}=e,{latestIndex:i}=a.useContext(c);return null==n?null:a.createElement(a.Fragment,null,a.createElement("div",{className:t,style:s},n),l<i&&r&&a.createElement("span",{className:`${t}-split`},r))},p=l(51916),f=function(e,t){var l={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&0>t.indexOf(a)&&(l[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,a=Object.getOwnPropertySymbols(e);n<a.length;n++)0>t.indexOf(a[n])&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(l[a[n]]=e[a[n]]);return l};let h=a.forwardRef((e,t)=>{var l,n,d;let{getPrefixCls:c,space:h,direction:x}=a.useContext(o.E_),{size:v=null!==(l=null==h?void 0:h.size)&&void 0!==l?l:"small",align:b,className:g,rootClassName:_,children:j,direction:y="horizontal",prefixCls:w,split:N,style:k,wrap:$=!1,classNames:O,styles:C}=e,S=f(e,["size","align","className","rootClassName","children","direction","prefixCls","split","style","wrap","classNames","styles"]),[Z,E]=Array.isArray(v)?v:[v,v],P=(0,i.n)(E),z=(0,i.n)(Z),I=(0,i.T)(E),T=(0,i.T)(Z),B=(0,s.Z)(j,{keepEmpty:!0}),M=void 0===b&&"horizontal"===y?"center":b,H=c("space",w),[V,F,W]=(0,p.Z)(H),A=r()(H,null==h?void 0:h.className,F,`${H}-${y}`,{[`${H}-rtl`]:"rtl"===x,[`${H}-align-${M}`]:M,[`${H}-gap-row-${E}`]:P,[`${H}-gap-col-${Z}`]:z},g,_,W),G=r()(`${H}-item`,null!==(n=null==O?void 0:O.item)&&void 0!==n?n:null===(d=null==h?void 0:h.classNames)||void 0===d?void 0:d.item),L=0,D=B.map((e,t)=>{var l,n;null!=e&&(L=t);let r=(null==e?void 0:e.key)||`${G}-${t}`;return a.createElement(u,{className:G,key:r,index:t,split:N,style:null!==(l=null==C?void 0:C.item)&&void 0!==l?l:null===(n=null==h?void 0:h.styles)||void 0===n?void 0:n.item},e)}),R=a.useMemo(()=>({latestIndex:L}),[L]);if(0===B.length)return null;let q={};return $&&(q.flexWrap="wrap"),!z&&T&&(q.columnGap=Z),!P&&I&&(q.rowGap=E),V(a.createElement("div",Object.assign({ref:t,className:A,style:Object.assign(Object.assign(Object.assign({},q),null==h?void 0:h.style),k)},S),a.createElement(m,{value:R},D)))});h.Compact=d.ZP;var x=h},47329:function(e,t,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/construct/models",function(){return l(10262)}])},81799:function(e,t,l){"use strict";l.d(t,{A:function(){return u}});var a=l(85893),n=l(41468),r=l(19284),s=l(34041),i=l(25675),o=l.n(i),d=l(67294),c=l(67421);let m="/models/huggingface.svg";function u(e,t){var l,n;let{width:s,height:i}=t||{};return e?(0,a.jsx)(o(),{className:"rounded-full border border-gray-200 object-contain bg-white inline-block",width:s||24,height:i||24,src:(null===(l=r.Hf[e])||void 0===l?void 0:l.icon)||m,alt:"llm"},(null===(n=r.Hf[e])||void 0===n?void 0:n.icon)||m):null}t.Z=function(e){let{onChange:t}=e,{t:l}=(0,c.$G)(),{modelList:i,model:o}=(0,d.useContext)(n.p);return!i||i.length<=0?null:(0,a.jsx)(s.default,{value:o,placeholder:l("choose_model"),className:"w-52",onChange:e=>{null==t||t(e)},children:i.map(e=>{var t;return(0,a.jsx)(s.default.Option,{children:(0,a.jsxs)("div",{className:"flex items-center",children:[u(e),(0,a.jsx)("span",{className:"ml-2",children:(null===(t=r.Hf[e])||void 0===t?void 0:t.label)||e})]})},e)})})}},98198:function(e,t,l){"use strict";l.d(t,{Z:function(){return m}});var a=l(85893),n=l(34041),r=l(25278),s=l(13457),i=l(84567),o=l(99859),d=l(67294),c=e=>{let{parentName:t,fields:l,form:c}=e,[m,u]=(0,d.useState)(null);(0,d.useEffect)(()=>{let e=c.getFieldValue(t);(null==e?void 0:e.type)&&!m&&u(e.type)},[c,t]);let p=e=>{let l;let d=e.param_type.toLowerCase(),c=[t,e.param_name];return l="str"===d||"string"===d?e.valid_values?(0,a.jsx)(n.default,{children:e.valid_values.map(e=>(0,a.jsx)(n.default.Option,{value:e,children:e},e))}):(0,a.jsx)(r.default,{}):"int"===d||"integer"===d||"number"===d||"float"===d?(0,a.jsx)(s.Z,{className:"w-full"}):"bool"===d||"boolean"===d?(0,a.jsx)(i.Z,{}):(0,a.jsx)(r.default,{}),(0,a.jsx)(o.default.Item,{label:e.label||e.param_name,name:c,valuePropName:"bool"===d||"boolean"===d?"checked":"value",tooltip:e.description,rules:m&&e.required?[{required:!0,message:"Please input ".concat(e.param_name)}]:[],children:l},e.param_name)};return(0,a.jsxs)("div",{className:"space-y-4 border rounded-md p-4",children:[(0,a.jsx)(o.default.Item,{label:"Type",name:[t,"type"],children:(0,a.jsx)(n.default,{onChange:e=>{u(e);let a=l[e]||[],n={type:e};a.forEach(e=>{n[e.param_name]=e.default_value}),c.setFieldsValue({[t]:n})},placeholder:"Select a type",children:Object.keys(l).map(e=>(0,a.jsx)(n.default.Option,{value:e,children:e},e))})}),m&&l[m]&&(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsxs)("h4",{className:"mb-4 text-base font-medium",children:[m," Configuration"]}),(0,a.jsx)("div",{className:"space-y-4",children:l[m].map(e=>p(e))})]})]})},m=function(e){let{params:t,form:l}=e;if((0,d.useEffect)(()=>{if(t){let e={};t.forEach(t=>{if(!t.nested_fields){let a=l.getFieldValue(t.param_name);void 0===a&&(e[t.param_name]=t.default_value)}}),l.setFieldsValue(e)}},[t,l]),!t||(null==t?void 0:t.length)<1)return null;let m=e=>{let l={...e};return null==t||t.forEach(e=>{if(e.nested_fields&&l[e.param_name]){let t=l[e.param_name];if(t.type){let a=e.nested_fields[t.type]||[],n={};a.forEach(e=>{void 0!==t[e.param_name]&&(n[e.param_name]=t[e.param_name])}),l[e.param_name]={type:t.type,...n}}}}),l},u=l.submit;return l.submit=()=>{let e=l.getFieldsValue(),t=m(e);l.setFieldsValue(t),u.call(l)},(0,a.jsx)("div",{className:"space-y-4",children:null==t?void 0:t.map(e=>(0,a.jsx)(o.default.Item,{label:(0,a.jsx)("p",{className:"whitespace-normal overflow-wrap-break-word",children:e.label||e.param_name}),name:e.param_name,initialValue:e.default_value,valuePropName:"bool"===e.param_type.toLowerCase()||"boolean"===e.param_type.toLowerCase()?"checked":"value",tooltip:e.description,rules:e.required?[{required:!0,message:"Please input ".concat(e.param_name)}]:[],children:function(e){var t,o,d,m;if(e.nested_fields)return(0,a.jsx)(c,{parentName:e.param_name,fields:e.nested_fields,form:l});let u=e.param_type.toLowerCase(),p=null===(t=e.ext_metadata)||void 0===t?void 0:null===(o=t.tags)||void 0===o?void 0:o.includes("fixed"),f=null===(d=e.ext_metadata)||void 0===d?void 0:null===(m=d.tags)||void 0===m?void 0:m.includes("privacy");return"str"===u||"string"===u?e.valid_values?(0,a.jsx)(n.default,{disabled:p,children:e.valid_values.map(e=>(0,a.jsx)(n.default.Option,{value:e,children:e},e))}):f?(0,a.jsx)(r.default.Password,{disabled:p,autoComplete:"new-password",placeholder:"请输入密码"}):(0,a.jsx)(r.default,{disabled:p}):"int"===u||"integer"===u||"number"===u||"float"===u?(0,a.jsx)(s.Z,{className:"w-full",disabled:p}):"bool"===u||"boolean"===u?(0,a.jsx)(i.Z,{disabled:p}):(0,a.jsx)(r.default,{disabled:p})}(e)},e.param_name))})}},48218:function(e,t,l){"use strict";var a=l(85893),n=l(82353),r=l(16165),s=l(67294);t.Z=e=>{let{width:t,height:l,scene:i}=e,o=(0,s.useCallback)(()=>{switch(i){case"chat_knowledge":return n.je;case"chat_with_db_execute":return n.zM;case"chat_excel":return n.DL;case"chat_with_db_qa":case"chat_dba":return n.RD;case"chat_dashboard":return n.In;case"chat_agent":return n.si;case"chat_normal":return n.O7;default:return}},[i]);return(0,a.jsx)(r.Z,{className:"w-".concat(t||7," h-").concat(l||7),component:o()})}},91467:function(e,t,l){"use strict";l.d(t,{TH:function(){return h},ZS:function(){return x}});var a=l(85893),n=l(89705),r=l(83062),s=l(96074),i=l(45030),o=l(85418),d=l(93967),c=l.n(d),m=l(36609),u=l(25675),p=l.n(u);l(67294);var f=l(48218);l(11873);let h=e=>{let{onClick:t,Icon:l="/pictures/card_chat.png",text:n=(0,m.t)("start_chat")}=e;return"string"==typeof l&&(l=(0,a.jsx)(p(),{src:l,alt:l,width:17,height:15})),(0,a.jsxs)("div",{className:"flex items-center gap-1 text-default",onClick:e=>{e.stopPropagation(),t&&t()},children:[l,(0,a.jsx)("span",{children:n})]})},x=e=>{let{menu:t}=e;return(0,a.jsx)(o.Z,{menu:t,getPopupContainer:e=>e.parentNode,placement:"bottomRight",autoAdjustOverflow:!1,children:(0,a.jsx)(n.Z,{className:"p-2 hover:bg-white hover:dark:bg-black rounded-md"})})};t.ZP=e=>{let{RightTop:t,Tags:l,LeftBottom:n,RightBottom:o,onClick:d,rightTopHover:m=!0,logo:u,name:h,description:x,className:v,scene:b,code:g}=e;return"string"==typeof x&&(x=(0,a.jsx)("p",{className:"line-clamp-2 relative bottom-4 text-ellipsis min-h-[42px] text-sm text-[#525964] dark:text-[rgba(255,255,255,0.65)]",children:x})),(0,a.jsx)("div",{className:c()("hover-underline-gradient flex justify-center mt-6 relative group w-1/3 px-2 mb-6",v),children:(0,a.jsxs)("div",{onClick:d,className:"backdrop-filter backdrop-blur-lg cursor-pointer  bg-white bg-opacity-70 border-2 border-white rounded-lg shadow p-4 relative w-full h-full dark:border-[#6f7f95] dark:bg-[#6f7f95] dark:bg-opacity-60",children:[(0,a.jsxs)("div",{className:"flex items-end relative bottom-8 justify-between w-full",children:[(0,a.jsxs)("div",{className:"flex items-end gap-4 w-11/12  flex-1",children:[(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm w-14 h-14 flex items-center p-3",children:b?(0,a.jsx)(f.Z,{scene:b,width:14,height:14}):u&&(0,a.jsx)(p(),{src:u,width:44,height:44,alt:h,className:"w-8 min-w-8 rounded-full max-w-none"})}),(0,a.jsx)("div",{className:"flex-1",children:h.length>6?(0,a.jsx)(r.Z,{title:h,children:(0,a.jsx)("span",{className:"line-clamp-1 text-ellipsis font-semibold text-base",style:{maxWidth:"60%"},children:h})}):(0,a.jsx)("span",{className:"line-clamp-1 text-ellipsis font-semibold text-base",style:{maxWidth:"60%"},children:h})})]}),(0,a.jsx)("span",{className:c()("shrink-0",{hidden:m,"group-hover:block":m}),onClick:e=>{e.stopPropagation()},children:t})]}),x,(0,a.jsx)("div",{className:"relative bottom-2",children:l}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("div",{children:n}),(0,a.jsx)("div",{children:o})]}),g&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.Z,{className:"my-3"}),(0,a.jsx)(i.Z.Text,{copyable:!0,className:"absolute bottom-1 right-4 text-xs text-gray-500",children:g})]})]})})}},1771:function(e,t,l){"use strict";var a=l(85893),n=l(82353),r=l(41156),s=l(9641),i=l(16165),o=l(9020),d=l(92962),c=l(38545),m=l(50067),u=l(28459),p=l(92398),f=l(36609),h=l(11163);l(67294),l(53878),t.Z=function(e){let{children:t}=e,l=[{key:"app",name:(0,f.t)("App"),path:"/app",icon:(0,a.jsx)(r.Z,{})},{key:"flow",name:(0,f.t)("awel_flow"),icon:(0,a.jsx)(s.Z,{}),path:"/flow"},{key:"models",name:(0,f.t)("model_manage"),path:"/models",icon:(0,a.jsx)(i.Z,{component:n.IN})},{key:"database",name:(0,f.t)("Database"),icon:(0,a.jsx)(o.Z,{}),path:"/database"},{key:"knowledge",name:(0,f.t)("Knowledge_Space"),icon:(0,a.jsx)(d.Z,{}),path:"/knowledge"},{key:"prompt",name:(0,f.t)("Prompt"),icon:(0,a.jsx)(c.Z,{}),path:"/prompt"},{key:"dbgpts",name:(0,f.t)("dbgpts_community"),path:"/dbgpts",icon:(0,a.jsx)(m.Z,{})}],x=(0,h.useRouter)(),v=x.pathname.split("/")[2];return(0,a.jsx)("div",{className:"flex flex-col h-full w-full  dark:bg-gradient-dark bg-gradient-light bg-cover bg-center",children:(0,a.jsx)(u.ZP,{theme:{components:{Button:{},Segmented:{itemSelectedBg:"#2867f5",itemSelectedColor:"white"}}},children:(0,a.jsx)(p.Z,{activeKey:v,items:l.map(e=>({key:e.key,label:e.name,children:t,icon:e.icon})),onTabClick:e=>{x.push("/construct/".concat(e))}})})})}},10262:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return H}});var a=l(85893),n=l(76212),r=l(81799),s=l(34041),i=l(99859),o=l(45360),d=l(67294),c=l(93967),m=l.n(c),u=l(50344),p=l(98423),f=l(87263),h=l(8745),x=l(53124);let{Option:v}=s.default;function b(e){return(null==e?void 0:e.type)&&(e.type.isSelectOption||e.type.isSelectOptGroup)}let g=d.forwardRef((e,t)=>{var l;let a,n;let{prefixCls:r,className:i,popupClassName:o,dropdownClassName:c,children:h,dataSource:g}=e,_=(0,u.Z)(h);1===_.length&&d.isValidElement(_[0])&&!b(_[0])&&([a]=_);let j=a?()=>a:void 0;n=_.length&&b(_[0])?h:g?g.map(e=>{if(d.isValidElement(e))return e;switch(typeof e){case"string":return d.createElement(v,{key:e,value:e},e);case"object":{let{value:t}=e;return d.createElement(v,{key:t,value:t},e.text)}default:return}}):[];let{getPrefixCls:y}=d.useContext(x.E_),w=y("select",r),[N]=(0,f.Cn)("SelectLike",null===(l=e.dropdownStyle)||void 0===l?void 0:l.zIndex);return d.createElement(s.default,Object.assign({ref:t,suffixIcon:null},(0,p.Z)(e,["dataSource","dropdownClassName"]),{prefixCls:w,popupClassName:o||c,dropdownStyle:Object.assign(Object.assign({},e.dropdownStyle),{zIndex:N}),className:m()(`${w}-auto-complete`,i),mode:s.default.SECRET_COMBOBOX_MODE_DO_NOT_USE,getInputElement:j}),n)}),_=(0,h.Z)(g);g.Option=v,g._InternalPanelDoNotUseOrYouWillBeFired=_;var j=l(83062),y=l(14726),w=l(67421),N=l(72510),k=l(98198);let{Option:$}=s.default,O=i.default.Item,C=["llm","text2vec","reranker"];var S=function(e){var t;let{onCancel:l,onSuccess:c}=e,{t:m}=(0,w.$G)(),[u,p]=(0,d.useState)([]),[f,h]=(0,d.useState)(),[x,v]=(0,d.useState)(),[b,_]=(0,d.useState)(null),[S,Z]=(0,d.useState)(!1),[E]=i.default.useForm(),[P,z]=(0,d.useState)({}),[I,T]=(0,d.useState)([]);async function B(){let[,e]=await (0,n.Vx)((0,n.xv)());if(e&&e.length){let t=e.sort((e,t)=>e.enabled&&!t.enabled?-1:!e.enabled&&t.enabled?1:e.model.localeCompare(t.model));p(t);let l=t.reduce((e,t)=>{let l=t.provider;return e[l]||(e[l]=[]),e[l].push(t),e},{});z(l),T([])}}async function M(e){if(x&&f){Z(!0);try{var t;let l=(e=>{let t={...e};return null==b||b.forEach(e=>{if(e.nested_fields&&t[e.param_name]){let l=t[e.param_name];if(l.type){let a=e.nested_fields[l.type]||[],n={};a.forEach(e=>{void 0!==l[e.param_name]&&(n[e.param_name]=l[e.param_name])}),t[e.param_name]={...n,type:l.type}}}}),t})(e),a=null===(t=P[x])||void 0===t?void 0:t.find(e=>e.model===l.name),r={host:(null==a?void 0:a.host)||"",port:(null==a?void 0:a.port)||0,model:l.name,worker_type:f,params:l},[,,s]=await (0,n.Vx)((0,n.NY)(r));(null==s?void 0:s.success)&&(o.ZP.success(m("start_model_success")),E.resetFields(),null==c||c())}catch(e){o.ZP.error(m("start_model_failed"))}finally{Z(!1)}}}(0,d.useEffect)(()=>{B()},[]);let H=e=>(0,a.jsxs)("div",{className:"max-w-md",children:[(0,a.jsx)("div",{className:"whitespace-pre-wrap markdown-body",children:(0,a.jsx)(N.U,{children:e.description||e.model})}),(0,a.jsx)("div",{className:"mt-2 text-xs opacity-75",children:e.enabled?"".concat(e.host,":").concat(e.port):m("download_model_tip")})]});return(0,a.jsxs)(i.default,{form:E,labelCol:{span:8},wrapperCol:{span:16},onFinish:M,children:[(0,a.jsx)(O,{label:"Worker Type",name:"worker_type",rules:[{required:!0,message:m("worker_type_select_tips")}],children:(0,a.jsx)(s.default,{onChange:function(e){h(e),v(void 0),E.resetFields(),E.setFieldValue("worker_type",e),function(e){let t=new Set;Object.entries(P).forEach(l=>{let[a,n]=l;n.some(t=>t.worker_type===e)&&t.add(a)}),T(Array.from(t).sort())}(e)},placeholder:m("model_select_worker_type"),children:C.map(e=>(0,a.jsx)($,{value:e,children:e},e))})}),f&&(0,a.jsx)(O,{label:"Provider",name:"provider",rules:[{required:!0,message:m("provider_select_tips")}],children:(0,a.jsx)(s.default,{onChange:function(e){v(e),E.setFieldValue("provider",e);let t=P[e]||[],l=t.filter(e=>e.worker_type===f);if(l.length>0){let e=l[0];(null==e?void 0:e.params)&&_(Array.isArray(e.params)?e.params:[e.params])}},placeholder:m("model_select_provider"),value:x,children:I.map(e=>(0,a.jsx)($,{value:e,children:e},e))})}),x&&f&&b&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(O,{label:m("model_deploy_name"),name:"name",rules:[{required:!0,message:m("model_please_input_name")}],children:(0,a.jsx)(g,{style:{width:"100%"},placeholder:m("model_select_or_input_model"),options:null===(t=P[x])||void 0===t?void 0:t.filter(e=>e.worker_type===f).map(e=>({value:e.model,label:(0,a.jsx)("div",{className:"flex items-center w-full",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,r.A)(e.model),(0,a.jsx)(j.Z,{title:H(e),placement:"right",children:(0,a.jsx)("span",{className:"ml-2",children:e.model})})]})})})),filterOption:(e,t)=>-1!==t.value.toUpperCase().indexOf(e.toUpperCase())})}),(0,a.jsx)(k.Z,{params:b.filter(e=>"name"!==e.param_name),form:E})]}),(0,a.jsxs)("div",{className:"flex justify-center space-x-4",children:[(0,a.jsx)(y.ZP,{type:"primary",htmlType:"submit",loading:S,children:m("submit")}),(0,a.jsx)(y.ZP,{onClick:l,children:m("cancel")})]})]})},Z=l(91467),E=l(1771),P=l(19284),z=l(24969),I=l(85576),T=l(66309),B=l(30381),M=l.n(B),H=function(){let{t:e}=(0,w.$G)(),[t,l]=(0,d.useState)([]),[r,s]=(0,d.useState)(!1),[i,c]=(0,d.useState)(!1);async function m(){let[,e]=await (0,n.Vx)((0,n.fZ)());l(null!=e?e:[])}async function u(t){if(i)return;let l=e("confirm_start_model")+t.model_name;f(e("start_model"),l,async()=>{c(!0);let[,,l]=await (0,n.Vx)((0,n.vA)({host:t.host,port:t.port,model:t.model_name,worker_type:t.worker_type,delete_after:!1,params:{}}));c(!1),(null==l?void 0:l.success)&&(o.ZP.success(e("start_model_success")),await m())})}async function p(t){let l=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(i)return;let a=l?"stop_and_delete":"stop",r=e("confirm_".concat(a,"_model"))+t.model_name;f(e("".concat(a,"_model")),r,async()=>{c(!0);let[,,r]=await (0,n.Vx)((0,n.kU)({host:t.host,port:t.port,model:t.model_name,worker_type:t.worker_type,delete_after:l,params:{}}));c(!1),(null==r?void 0:r.success)===!0&&(o.ZP.success(e("".concat(a,"_model_success"))),await m())})}let f=(e,t,l)=>{I.default.confirm({title:e,content:t,onOk:async()=>{await l()},okButtonProps:{className:"bg-button-gradient"}})};(0,d.useEffect)(()=>{m()},[]);let h=e=>{let t=null==e?void 0:e.replaceAll("-","_").split("_")[0],l=Object.keys(P.Me);for(let e=0;e<l.length;e++){let a=l[e];if(null==t?void 0:t.includes(a))return P.Me[a]}return"/pictures/model.png"};return(0,a.jsx)(E.Z,{children:(0,a.jsxs)("div",{className:"px-6 overflow-y-auto",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("div",{className:"flex items-center gap-4"}),(0,a.jsx)("div",{className:"flex items-center gap-4",children:(0,a.jsx)(y.ZP,{className:"border-none text-white bg-button-gradient",icon:(0,a.jsx)(z.Z,{}),onClick:()=>{s(!0)},children:e("create_model")})})]}),(0,a.jsx)("div",{className:"flex flex-wrap mx-[-8px] ",children:t.map(t=>(0,a.jsx)(Z.ZP,{logo:h(t.model_name),description:(0,a.jsxs)("div",{className:"flex flex-col gap-1 relative text-xs bottom-4",children:[(0,a.jsxs)("div",{className:"flex overflow-hidden",children:[(0,a.jsx)("p",{className:"w-28 text-gray-500 mr-2",children:"Host:"}),(0,a.jsx)("p",{className:"flex-1 text-ellipsis",children:t.host})]}),(0,a.jsxs)("div",{className:"flex overflow-hidden",children:[(0,a.jsx)("p",{className:"w-28 text-gray-500 mr-2",children:"Manage Host:"}),(0,a.jsxs)("p",{className:"flex-1 text-ellipsis",children:[t.manager_host,":",t.manager_port]})]}),(0,a.jsxs)("div",{className:"flex overflow-hidden",children:[(0,a.jsx)("p",{className:"w-28 text-gray-500 mr-2",children:"Last Heart Beat:"}),(0,a.jsx)("p",{className:"flex-1 text-ellipsis",children:M()(t.last_heartbeat).format("YYYY-MM-DD HH:mm:ss")})]})]}),name:t.model_name,RightTop:(0,a.jsx)(Z.ZS,{menu:{items:[{key:"stop_model",label:(0,a.jsx)("span",{className:"text-red-400",onClick:()=>p(t),children:e("stop_model")})},{key:"start_model",label:(0,a.jsx)("span",{className:"text-green-400",onClick:()=>u(t),children:e("start_model")})},{key:"stop_and_delete_model",label:(0,a.jsx)("span",{className:"text-red-400",onClick:()=>p(t,!0),children:e("stop_and_delete_model")})}]}}),rightTopHover:!1,Tags:(0,a.jsxs)("div",{children:[(0,a.jsx)(T.Z,{color:t.healthy?"green":"red",children:t.healthy?"Healthy":"Unhealthy"}),(0,a.jsx)(T.Z,{children:t.worker_type})]})},t.model_name))}),(0,a.jsx)(I.default,{width:800,open:r,title:e("create_model"),onCancel:()=>{s(!1)},footer:null,children:(0,a.jsx)(S,{onCancel:()=>{s(!1)},onSuccess:()=>{s(!1),m()}})})]})})}},11873:function(){},53878:function(){}},function(e){e.O(0,[2913,3791,5278,8791,1049,5030,4041,2398,4567,9859,3457,2510,7896,9774,2888,179],function(){return e(e.s=47329)}),_N_E=e.O()}]);