(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3575],{36531:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(87462),a=n(67294),c={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32zm-622.3-84c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9z"}}]},name:"edit",theme:"filled"},l=n(84089),o=a.forwardRef(function(e,t){return a.createElement(l.Z,(0,r.Z)({},e,{ref:t,icon:c}))})},48907:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/flow",function(){return n(24363)}])},45247:function(e,t,n){"use strict";var r=n(85893),a=n(50888);t.Z=function(e){let{visible:t}=e;return t?(0,r.jsx)("div",{className:"absolute w-full h-full top-0 left-0 flex justify-center items-center z-10 bg-white dark:bg-black bg-opacity-50 dark:bg-opacity-50 backdrop-blur-sm text-3xl animate-fade animate-duration-200",children:(0,r.jsx)(a.Z,{})}):null}},24363:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return M}});var r=n(85893),a=n(89182),c=n(91085),l=n(45247),o=n(28058),s=n(87462),i=n(67294),u={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 688a48 48 0 1096 0 48 48 0 10-96 0zm24-112h48c4.4 0 8-3.6 8-8V296c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8z"}}]},name:"exclamation-circle",theme:"outlined"},d=n(84089),f=i.forwardRef(function(e,t){return i.createElement(d.Z,(0,s.Z)({},e,{ref:t,icon:u}))}),m=n(37017),p=n(36531),h={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM382 896h-.2L232 746.2v-.2h150v150z"}}]},name:"copy",theme:"filled"},x=i.forwardRef(function(e,t){return i.createElement(d.Z,(0,s.Z)({},e,{ref:t,icon:h}))}),v=n(27704),b=n(17788),y=n(83062),j=n(67421),g=n(23391),w=n(11163),_=n(26892),Z=n(41468),C=n(97334),N=n.n(C),k=e=>{let{flow:t,onCopy:n,deleteCallback:c}=e,{model:l}=(0,i.useContext)(Z.p),{t:s}=(0,j.$G)(),[u,d]=b.default.useModal(),h=(0,w.useRouter)();async function C(){let[,,e]=await (0,a.Vx)((0,a.Jq)(t.uid));(null==e?void 0:e.success)&&c&&c(t.uid)}let k=async()=>{let[,e]=await (0,a.Vx)((0,a.sW)({chat_mode:"chat_agent"}));if(e){let n=N().stringify({scene:"chat_flow",id:e.conv_uid,model:l,select_param:t.uid});h.push("/chat?".concat(n))}};return(0,r.jsxs)(r.Fragment,{children:[d,(0,r.jsx)(_.Z,{className:"w-[26rem] max-w-full",title:t.name,desc:t.description,tags:[{text:t.source,color:"DBGPT-WEB"===t.source?"green":"blue",border:!0},{text:t.editable?"Editable":"Can not Edit",color:t.editable?"green":"gray",border:!0},{text:(0,r.jsx)(r.Fragment,{children:t.error_message?(0,r.jsxs)(y.Z,{placement:"bottom",title:t.error_message,children:[t.state,(0,r.jsx)(f,{className:"ml-1"})]}):t.state}),color:"load_failed"===t.state?"red":"running"===t.state?"green":"blue",border:!0}],operations:[{label:s("Chat"),children:(0,r.jsx)(m.Z,{}),onClick:k},{label:s("Edit"),children:(0,r.jsx)(p.Z,{}),onClick:function(){h.push("/flow/canvas?id="+t.uid)}},{label:s("Copy"),children:(0,r.jsx)(x,{}),onClick:()=>{n(t)}},{label:s("Delete"),children:(0,r.jsx)(v.Z,{}),onClick:()=>{u.confirm({title:s("Tips"),icon:(0,r.jsx)(o.Z,{}),content:s("delete_flow_confirm"),okText:"Yes",okType:"danger",cancelText:"No",async onOk(){C()}})}}],children:(0,r.jsx)("div",{className:"w-full h-40 shadow-[inset_0_0_16px_rgba(50,50,50,.05)]",children:(0,r.jsx)(g.Z,{flowData:t.flow_data})})})]})},E=n(24969),R=n(2453),z=n(23323),O=n(14726),I=n(79531),F=n(84567),V=n(41664),A=n.n(V),M=function(){let{t:e}=(0,j.$G)(),[t,n]=(0,i.useState)(!1),[o,s]=(0,i.useState)(!1),[u,d]=(0,i.useState)([]),[f,m]=(0,i.useState)(!1),[p,h]=R.ZP.useMessage(),[x]=z.Z.useForm(),v=(0,i.useRef)();async function y(){var e;s(!0);let[t,n]=await (0,a.Vx)((0,a.Wf)());s(!1),d(null!==(e=null==n?void 0:n.items)&&void 0!==e?e:[])}function g(e){d(t=>t.filter(t=>t.uid!==e))}(0,i.useEffect)(()=>{y()},[]);let w=e=>{v.current=e,x.setFieldValue("label","".concat(e.label," Copy")),x.setFieldValue("name","".concat(e.name,"_copy")),m(!1),n(!0)},_=async t=>{if(!v.current)return;let{source:r,uid:c,dag_id:l,gmt_created:o,gmt_modified:s,state:i,...u}=v.current,d={...u,editable:!0,state:f?"deployed":"developing",...t},[m]=await (0,a.Vx)((0,a.zd)(d));m||(p.success(e("save_flow_success")),n(!1),y())};return(0,r.jsxs)("div",{className:"relative p-4 md:p-6 min-h-full overflow-y-auto",children:[h,(0,r.jsx)(l.Z,{visible:o}),(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsx)(A(),{href:"/flow/canvas",children:(0,r.jsx)(O.ZP,{type:"primary",className:"flex items-center",icon:(0,r.jsx)(E.Z,{}),children:"New AWEL Flow"})})}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-2 md:gap-4 justify-start items-stretch",children:[u.map(e=>(0,r.jsx)(k,{flow:e,deleteCallback:g,onCopy:w},e.uid)),0===u.length&&(0,r.jsx)(c.Z,{description:"No flow found"})]}),(0,r.jsx)(b.default,{open:t,title:"Copy AWEL Flow",onCancel:()=>{n(!1)},footer:!1,children:(0,r.jsxs)(z.Z,{form:x,onFinish:_,className:"mt-6",children:[(0,r.jsx)(z.Z.Item,{name:"name",label:"Name",rules:[{required:!0}],children:(0,r.jsx)(I.default,{})}),(0,r.jsx)(z.Z.Item,{name:"label",label:"Label",rules:[{required:!0}],children:(0,r.jsx)(I.default,{})}),(0,r.jsx)(z.Z.Item,{label:"Deploy",children:(0,r.jsx)(F.Z,{value:f,onChange:e=>{let t=e.target.checked;m(t)}})}),(0,r.jsx)("div",{className:"flex justify-end",children:(0,r.jsx)(O.ZP,{type:"primary",htmlType:"submit",children:e("Submit")})})]})})]})}},97334:function(e){!function(){"use strict";var t={815:function(e){e.exports=function(e,n,r,a){n=n||"&",r=r||"=";var c={};if("string"!=typeof e||0===e.length)return c;var l=/\+/g;e=e.split(n);var o=1e3;a&&"number"==typeof a.maxKeys&&(o=a.maxKeys);var s=e.length;o>0&&s>o&&(s=o);for(var i=0;i<s;++i){var u,d,f,m,p=e[i].replace(l,"%20"),h=p.indexOf(r);(h>=0?(u=p.substr(0,h),d=p.substr(h+1)):(u=p,d=""),f=decodeURIComponent(u),m=decodeURIComponent(d),Object.prototype.hasOwnProperty.call(c,f))?t(c[f])?c[f].push(m):c[f]=[c[f],m]:c[f]=m}return c};var t=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},577:function(e){var t=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,c,l,o){return(c=c||"&",l=l||"=",null===e&&(e=void 0),"object"==typeof e)?r(a(e),function(a){var o=encodeURIComponent(t(a))+l;return n(e[a])?r(e[a],function(e){return o+encodeURIComponent(t(e))}).join(c):o+encodeURIComponent(t(e[a]))}).join(c):o?encodeURIComponent(t(o))+l+encodeURIComponent(t(e)):""};var n=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function r(e,t){if(e.map)return e.map(t);for(var n=[],r=0;r<e.length;r++)n.push(t(e[r],r));return n}var a=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}}},n={};function r(e){var a=n[e];if(void 0!==a)return a.exports;var c=n[e]={exports:{}},l=!0;try{t[e](c,c.exports,r),l=!1}finally{l&&delete n[e]}return c.exports}r.ab="//";var a={};a.decode=a.parse=r(815),a.encode=a.stringify=r(577),e.exports=a}()}},function(e){e.O(0,[8241,6274,5503,3323,4567,9924,6165,9774,2888,179],function(){return e(e.s=48907)}),_N_E=e.O()}]);