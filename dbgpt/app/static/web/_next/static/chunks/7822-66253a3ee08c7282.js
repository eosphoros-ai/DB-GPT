"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7822],{27704:function(e,a,l){l.d(a,{Z:function(){return c}});var t=l(87462),s=l(67294),r={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M864 256H736v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zm-200 0H360v-72h304v72z"}}]},name:"delete",theme:"filled"},n=l(84089),c=s.forwardRef(function(e,a){return s.createElement(n.Z,(0,t.Z)({},e,{ref:a,icon:r}))})},36531:function(e,a,l){l.d(a,{Z:function(){return c}});var t=l(87462),s=l(67294),r={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32zm-622.3-84c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9z"}}]},name:"edit",theme:"filled"},n=l(84089),c=s.forwardRef(function(e,a){return s.createElement(n.Z,(0,t.Z)({},e,{ref:a,icon:r}))})},87740:function(e,a,l){l.d(a,{Z:function(){return c}});var t=l(87462),s=l(67294),r={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M758.2 839.1C851.8 765.9 912 651.9 912 523.9 912 303 733.5 124.3 512.6 124 291.4 123.7 112 302.8 112 523.9c0 125.2 57.5 236.9 147.6 310.2 3.5 2.8 8.6 2.2 11.4-1.3l39.4-50.5c2.7-3.4 2.1-8.3-1.2-11.1-8.1-6.6-15.9-13.7-23.4-21.2a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-9.3 9.3-19.1 18-29.3 26L668.2 724a8 8 0 00-14.1 3l-39.6 162.2c-1.2 5 2.6 9.9 7.7 9.9l167 .8c6.7 0 10.5-7.7 6.3-12.9l-37.3-47.9z"}}]},name:"redo",theme:"outlined"},n=l(84089),c=s.forwardRef(function(e,a){return s.createElement(n.Z,(0,t.Z)({},e,{ref:a,icon:r}))})},2093:function(e,a,l){var t=l(97582),s=l(67294),r=l(92770);a.Z=function(e,a){(0,s.useEffect)(function(){var a=e(),l=!1;return!function(){(0,t.mG)(this,void 0,void 0,function(){return(0,t.Jh)(this,function(e){switch(e.label){case 0:if(!(0,r.mf)(a[Symbol.asyncIterator]))return[3,4];e.label=1;case 1:return[4,a.next()];case 2:if(e.sent().done||l)return[3,3];return[3,1];case 3:return[3,6];case 4:return[4,a];case 5:e.sent(),e.label=6;case 6:return[2]}})})}(),function(){l=!0}},a)}},26892:function(e,a,l){var t=l(85893),s=l(67294),r=l(66309),n=l(55241),c=l(83062),i=l(93967),d=l.n(i),o=l(25675),u=l.n(o);a.Z=(0,s.memo)(function(e){let{icon:a,iconBorder:l=!0,title:i,desc:o,tags:m,children:f,disabled:x,operations:h,className:b,extraContent:p,...j}=e,v=(0,s.useMemo)(()=>a?"string"==typeof a?(0,t.jsx)(u(),{className:d()("w-11 h-11 rounded-full mr-4 object-contain bg-white",{"border border-gray-200":l}),width:48,height:48,src:a,alt:i}):a:null,[a]),y=(0,s.useMemo)(()=>m&&m.length?(0,t.jsx)("div",{className:"flex items-center mt-1 flex-wrap",children:m.map((e,a)=>{var l;return"string"==typeof e?(0,t.jsx)(r.Z,{className:"text-xs",bordered:!1,color:"default",children:e},a):(0,t.jsx)(r.Z,{className:"text-xs",bordered:null!==(l=e.border)&&void 0!==l&&l,color:e.color,children:e.text},a)})}):null,[m]);return(0,t.jsxs)("div",{className:d()("group/card relative flex flex-col w-72 rounded justify-between text-black bg-white shadow-[0_8px_16px_-10px_rgba(100,100,100,.08)] hover:shadow-[0_14px_20px_-10px_rgba(100,100,100,.15)] dark:bg-[#232734] dark:text-white dark:hover:border-white transition-[transfrom_shadow] duration-300 hover:-translate-y-1 min-h-fit",{"grayscale cursor-no-drop":x,"cursor-pointer":!x&&!!j.onClick},b),...j,children:[(0,t.jsxs)("div",{className:"p-4 0",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[v,(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)(n.Z,{title:i,children:(0,t.jsx)("h2",{className:"text-sm font-semibold line-clamp-1 pr-8",children:i})}),y]})]}),o&&(0,t.jsx)(c.Z,{title:o,children:(0,t.jsx)("p",{className:"mt-2 text-sm text-gray-500 font-normal line-clamp-2",children:o})})]}),(0,t.jsxs)("div",{children:[f,h&&!!h.length&&(0,t.jsx)("div",{className:"flex flex-wrap items-center justify-center border-t border-solid border-gray-100 dark:border-theme-dark",children:h.map((e,a)=>(0,t.jsx)(c.Z,{title:e.label,children:(0,t.jsxs)("div",{className:"relative flex flex-1 items-center justify-center h-11 text-gray-400 hover:text-blue-500 transition-colors duration-300 cursor-pointer",onClick:a=>{var l;a.stopPropagation(),null===(l=e.onClick)||void 0===l||l.call(e)},children:[e.children,a<h.length-1&&(0,t.jsx)("div",{className:"w-[1px] h-6 absolute top-2 right-0 bg-gray-100 rounded dark:bg-theme-dark"})]})},"operation-".concat(a)))})]}),(0,t.jsx)("div",{className:"absolute top-2 right-4 ",children:p})]})})},45247:function(e,a,l){var t=l(85893),s=l(50888);a.Z=function(e){let{visible:a}=e;return a?(0,t.jsx)("div",{className:"absolute w-full h-full top-0 left-0 flex justify-center items-center z-10 bg-white dark:bg-black bg-opacity-50 dark:bg-opacity-50 backdrop-blur-sm text-3xl animate-fade animate-duration-200",children:(0,t.jsx)(s.Z,{})}):null}},30081:function(e,a,l){var t=l(85893),s=l(99859),r=l(45360),n=l(85576),c=l(66184),i=l(83062),d=l(75081),o=l(79531),u=l(10418),m=l(14726),f=l(67294),x=l(76212),h=l(86655),b=l(67421),p=l(85980);a.Z=function(e){let{open:a,choiceDBType:l,dbTypeList:j,editValue:v,dbNames:y,onClose:g,onSuccess:_}=e,[N,Z]=(0,f.useState)(!1),{t:w}=(0,b.$G)(),[k]=s.default.useForm(),C=s.default.useWatch("db_type",k),[S,P]=(0,f.useState)([]),[F,V]=(0,f.useState)(!1),E=(0,f.useMemo)(()=>(0,h.isFileDb)(j,C),[j,C]);(0,f.useEffect)(()=>{l&&k.setFieldValue("db_type",l)},[l]),(0,f.useEffect)(()=>{v&&(k.setFieldsValue({...v}),"omc"===v.db_type&&k.setFieldValue("db_arn",v.db_path))},[v]),(0,f.useEffect)(()=>{a||k.resetFields()},[a]);let I=async e=>{let{db_host:a,db_path:l,db_port:t,db_type:s,...n}=e;if(Z(!0),"omc"===s){let a=null==S?void 0:S.find(a=>a.arn===e.db_name);try{let[l]=await (0,x.Vx)((0,x.Jm)({db_type:"omc",file_path:e.db_arn||"",comment:e.comment,db_name:(null==a?void 0:a.dbName)||e.db_name}));if(l){r.ZP.error(l.message);return}r.ZP.success("success"),null==_||_()}catch(e){r.ZP.error(e.message)}finally{Z(!1)}}if(!v&&y.some(e=>e===n.db_name)){r.ZP.error("The database already exists!");return}let c={db_host:E?void 0:a,db_port:E?void 0:t,db_type:s,file_path:E?l:void 0,...n};try{let[e]=await (0,x.Vx)((0,x.KS)(c));if(e)return;let[a]=await (0,x.Vx)((v?x.mR:x.b_)(c));if(a){r.ZP.error(a.message);return}r.ZP.success("success"),null==_||_()}catch(e){r.ZP.error(e.message)}finally{Z(!1)}};console.log(k.getFieldValue("db_type"));let{run:D}=(0,p.Z)(async e=>{V(!0);let[a,l=[]]=await (0,x.Vx)((0,x.bf)(e));V(!1),P(l.map(e=>({...e,label:e.dbName,value:e.arn})))},{wait:500});console.log("omcDBList",S);let T=(0,f.useMemo)(()=>!!v||!!l,[v,l]);return(0,t.jsx)(n.default,{open:a,width:400,title:w(v?"Edit":"create_database"),maskClosable:!1,footer:null,onCancel:g,children:(0,t.jsxs)(s.default,{form:k,className:"pt-2",labelCol:{span:6},labelAlign:"left",onFinish:I,children:[(0,t.jsx)(s.default.Item,{name:"db_type",label:"DB Type",className:"mb-3",rules:[{required:!0}],children:(0,t.jsx)(c.default,{"aria-readonly":T,disabled:T,options:j})}),"omc"===k.getFieldValue("db_type")?(0,t.jsx)(s.default.Item,{name:"db_name",label:"DB Name",className:"mb-3",rules:[{required:!0}],children:(0,t.jsx)(c.default,{optionRender:(e,a)=>{let{index:l}=a,s=S[l];return(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"text-[18px]",children:null==s?void 0:s.dbName}),(0,t.jsxs)("span",{children:[(0,t.jsx)("span",{children:"env: "}),(0,t.jsx)("span",{className:"text-gray-500",children:s.env})]}),(0,t.jsxs)("span",{children:[(0,t.jsx)("span",{children:"account: "}),(0,t.jsx)("span",{className:"text-gray-500",children:s.account})]}),(0,t.jsxs)("span",{children:[(0,t.jsx)("span",{children:"searchName: "}),(0,t.jsx)(i.Z,{title:s.searchName,children:(0,t.jsx)("span",{className:"text-gray-500",children:s.searchName})})]})]},e.value)},notFoundContent:F?(0,t.jsx)(d.Z,{size:"small"}):null,showSearch:!0,options:S,onSearch:D,onSelect:e=>{console.log(e,"searchName");let a=null==S?void 0:S.find(a=>a.value===e);k.setFieldsValue({db_arn:null==a?void 0:a.arn})}})}):(0,t.jsx)(s.default.Item,{name:"db_name",label:"DB Name",className:"mb-3",rules:[{required:!0}],children:(0,t.jsx)(o.default,{readOnly:!!v,disabled:!!v})}),!0===E&&(0,t.jsx)(s.default.Item,{name:"db_path",label:"Path",className:"mb-3",rules:[{required:!0}],children:(0,t.jsx)(o.default,{})}),!1===E&&"omc"!==k.getFieldValue("db_type")&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.default.Item,{name:"db_user",label:"Username",className:"mb-3",rules:[{required:!0}],children:(0,t.jsx)(o.default,{})}),(0,t.jsx)(s.default.Item,{name:"db_pwd",label:"Password",className:"mb-3",rules:[{required:!1}],children:(0,t.jsx)(o.default,{type:"password"})}),(0,t.jsx)(s.default.Item,{name:"db_host",label:"Host",className:"mb-3",rules:[{required:!0}],children:(0,t.jsx)(o.default,{})}),(0,t.jsx)(s.default.Item,{name:"db_port",label:"Port",className:"mb-3",rules:[{required:!0}],children:(0,t.jsx)(u.Z,{min:1,step:1,max:65535})})]}),"omc"===k.getFieldValue("db_type")&&(0,t.jsx)(s.default.Item,{name:"db_arn",label:"Arn",className:"mb-3",rules:[{required:!0}],children:(0,t.jsx)(o.default,{})}),(0,t.jsx)(s.default.Item,{name:"comment",label:"Remark",className:"mb-3",children:(0,t.jsx)(o.default,{})}),(0,t.jsxs)(s.default.Item,{className:"flex flex-row-reverse pt-1 mb-0",children:[(0,t.jsx)(m.ZP,{htmlType:"submit",type:"primary",size:"middle",className:"mr-1",loading:N,children:"Save"}),(0,t.jsx)(m.ZP,{size:"middle",onClick:g,children:"Cancel"})]})]})})}},86655:function(e,a,l){l.r(a),l.d(a,{isFileDb:function(){return Z}});var t=l(85893),s=l(67294),r=l(2093),n=l(85576),c=l(45360),i=l(14726),d=l(40411),o=l(85265),u=l(75081),m=l(4393),f=l(32983),x=l(30081),h=l(76212),b=l(24969),p=l(87740),j=l(36531),v=l(27704),y=l(45247),g=l(62418),_=l(26892),N=l(67421);function Z(e,a){var l;return null===(l=e.find(e=>e.value===a))||void 0===l?void 0:l.isFileDb}a.default=function(){var e;let{t:a}=(0,N.$G)(),[l,Z]=(0,s.useState)([]),[w,k]=(0,s.useState)([]),[C,S]=(0,s.useState)(!1),[P,F]=(0,s.useState)({open:!1}),[V,E]=(0,s.useState)({open:!1}),[I,D]=(0,s.useState)(!1),T=async()=>{let[,e]=await (0,h.Vx)((0,h.t$)());k(null!=e?e:[])},M=async()=>{S(!0);let[,e]=await (0,h.Vx)((0,h.Bw)());Z(null!=e?e:[]),S(!1)},q=(0,s.useMemo)(()=>{let e=w.map(e=>{let{db_type:a,is_file_db:l}=e;return{...g.S$[a],value:a,isFileDb:l}}),a=Object.keys(g.S$).filter(a=>!e.some(e=>e.value===a)).map(e=>({...g.S$[e],value:g.S$[e].label,disabled:!0}));return[...e,...a]},[w]),z=e=>{F({open:!0,info:e})},B=e=>{n.default.confirm({title:"Tips",content:"Do you Want to delete the ".concat(e.db_name,"?"),onOk:()=>new Promise(async(a,l)=>{try{let[t]=await (0,h.Vx)((0,h.J5)(e.db_name));if(t){c.ZP.error(t.message),l();return}c.ZP.success("success"),M(),a()}catch(e){l()}})})},L=async e=>{D(!0);let[,l]=await (0,h.Vx)((0,h.yx)({db_name:e.db_name,db_type:e.db_type}));l&&c.ZP.success(a("refreshSuccess")),D(!1)},H=(0,s.useMemo)(()=>{let e=q.reduce((e,a)=>(e[a.value]=l.filter(e=>e.db_type===a.value),e),{});return e},[l,q]);(0,r.Z)(async()=>{await M(),await T()},[]);let R=e=>{let a=l.filter(a=>a.db_type===e.value);E({open:!0,dbList:a,name:e.label,type:e.value})};return(0,t.jsxs)("div",{className:"relative p-4 md:p-6 min-h-full overflow-y-auto",children:[(0,t.jsx)(y.Z,{visible:C}),(0,t.jsx)("div",{className:"mb-4",children:(0,t.jsx)(i.ZP,{type:"primary",className:"flex items-center",icon:(0,t.jsx)(b.Z,{}),onClick:()=>{F({open:!0})},children:a("create")})}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2 md:gap-4",children:q.map(a=>(0,t.jsx)(d.Z,{count:H[a.value].length,className:"min-h-fit",children:(0,t.jsx)(_.Z,{className:"h-full",title:a.label,desc:null!==(e=a.desc)&&void 0!==e?e:"",disabled:a.disabled,icon:a.icon,onClick:()=>{a.disabled||R(a)}})},a.value))}),(0,t.jsx)(x.Z,{open:P.open,dbTypeList:q,choiceDBType:P.dbType,editValue:P.info,dbNames:l.map(e=>e.db_name),onSuccess:()=>{F({open:!1}),M()},onClose:()=>{F({open:!1})}}),(0,t.jsx)(o.Z,{title:V.name,placement:"right",onClose:()=>{E({open:!1})},open:V.open,children:V.type&&H[V.type]&&H[V.type].length?(0,t.jsxs)(u.Z,{spinning:I,children:[(0,t.jsx)(i.ZP,{type:"primary",className:"mb-4 flex items-center",icon:(0,t.jsx)(b.Z,{}),onClick:()=>{F({open:!0,dbType:V.type})},children:"Create"}),H[V.type].map(e=>(0,t.jsxs)(m.Z,{title:e.db_name,extra:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(p.Z,{style:{color:"gray"},onClick:()=>{L(e)}}),(0,t.jsx)(j.Z,{className:"mr-2",style:{color:"#1b7eff"},onClick:()=>{z(e)}}),(0,t.jsx)(v.Z,{style:{color:"#ff1b2e"},onClick:()=>{B(e)}})]}),className:"mb-4",children:[e.db_path?(0,t.jsxs)("p",{children:["path: ",e.db_path]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("p",{children:["host: ",e.db_host]}),(0,t.jsxs)("p",{children:["username: ",e.db_user]}),(0,t.jsxs)("p",{children:["port: ",e.db_port]})]}),(0,t.jsxs)("p",{children:["remark: ",e.comment]})]},e.db_name))]}):(0,t.jsx)(f.Z,{image:f.Z.PRESENTED_IMAGE_DEFAULT,children:(0,t.jsx)(i.ZP,{type:"primary",className:"flex items-center mx-auto",icon:(0,t.jsx)(b.Z,{}),onClick:()=>{F({open:!0,dbType:V.type})},children:"Create Now"})})})]})}}}]);