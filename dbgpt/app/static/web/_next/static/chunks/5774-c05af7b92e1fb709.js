"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5774],{71483:function(e,l,a){var s=a(96469),t=a(38497),r=a(49030),n=a(62971),i=a(60205),d=a(26869),c=a.n(d),o=a(23852),m=a.n(o);l.Z=(0,t.memo)(function(e){let{icon:l,iconBorder:a=!0,title:d,desc:o,tags:u,children:x,disabled:b,operations:p,className:h,extraContent:f,...j}=e,y=(0,t.useMemo)(()=>l?"string"==typeof l?(0,s.jsx)(m(),{className:c()("w-11 h-11 rounded-full mr-4 object-contain bg-white",{"border border-gray-200":a}),width:48,height:48,src:l,alt:d}):l:null,[l]),v=(0,t.useMemo)(()=>u&&u.length?(0,s.jsx)("div",{className:"flex items-center mt-1 flex-wrap",children:u.map((e,l)=>{var a;return"string"==typeof e?(0,s.jsx)(r.Z,{className:"text-xs",bordered:!1,color:"default",children:e},l):(0,s.jsx)(r.Z,{className:"text-xs",bordered:null!==(a=e.border)&&void 0!==a&&a,color:e.color,children:e.text},l)})}):null,[u]);return(0,s.jsxs)("div",{className:c()("group/card relative flex flex-col w-72 rounded justify-between text-black bg-white shadow-[0_8px_16px_-10px_rgba(100,100,100,.08)] hover:shadow-[0_14px_20px_-10px_rgba(100,100,100,.15)] dark:bg-[#232734] dark:text-white dark:hover:border-white transition-[transfrom_shadow] duration-300 hover:-translate-y-1 min-h-fit",{"grayscale cursor-no-drop":b,"cursor-pointer":!b&&!!j.onClick},h),...j,children:[(0,s.jsxs)("div",{className:"p-4 0",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[y,(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)(n.Z,{title:d,children:(0,s.jsx)("h2",{className:"text-sm font-semibold line-clamp-1 pr-8",children:d})}),v]})]}),o&&(0,s.jsx)(i.Z,{title:o,children:(0,s.jsx)("p",{className:"mt-2 text-sm text-gray-500 font-normal line-clamp-2",children:o})})]}),(0,s.jsxs)("div",{children:[x,p&&!!p.length&&(0,s.jsx)("div",{className:"flex flex-wrap items-center justify-center border-t border-solid border-gray-100 dark:border-theme-dark",children:p.map((e,l)=>(0,s.jsx)(i.Z,{title:e.label,children:(0,s.jsxs)("div",{className:"relative flex flex-1 items-center justify-center h-11 text-gray-400 hover:text-blue-500 transition-colors duration-300 cursor-pointer",onClick:l=>{var a;l.stopPropagation(),null===(a=e.onClick)||void 0===a||a.call(e)},children:[e.children,l<p.length-1&&(0,s.jsx)("div",{className:"w-[1px] h-6 absolute top-2 right-0 bg-gray-100 rounded dark:bg-theme-dark"})]})},"operation-".concat(l)))})]}),(0,s.jsx)("div",{className:"absolute top-2 right-4 ",children:f})]})})},18458:function(e,l,a){var s=a(96469),t=a(37022);l.Z=function(e){let{visible:l}=e;return l?(0,s.jsx)("div",{className:"absolute w-full h-full top-0 left-0 flex justify-center items-center z-10 bg-white dark:bg-black bg-opacity-50 dark:bg-opacity-50 backdrop-blur-sm text-3xl animate-fade animate-duration-200",children:(0,s.jsx)(t.Z,{})}):null}},18758:function(e,l,a){var s=a(96469),t=a(55360),r=a(70351),n=a(79839),i=a(16156),d=a(60205),c=a(42786),o=a(41999),m=a(99631),u=a(27691),x=a(38497),b=a(27623),p=a(22505),h=a(56841),f=a(47019);l.Z=function(e){let{open:l,choiceDBType:a,dbTypeList:j,editValue:y,dbNames:v,onClose:_,onSuccess:N}=e,[g,Z]=(0,x.useState)(!1),{t:w}=(0,h.$G)(),[k]=t.default.useForm(),C=t.default.useWatch("db_type",k),[P,S]=(0,x.useState)([]),[F,V]=(0,x.useState)(!1),D=(0,x.useMemo)(()=>(0,p.isFileDb)(j,C),[j,C]);(0,x.useEffect)(()=>{a&&k.setFieldValue("db_type",a)},[a]),(0,x.useEffect)(()=>{y&&(k.setFieldsValue({...y}),"omc"===y.db_type&&k.setFieldValue("db_arn",y.db_path))},[y]),(0,x.useEffect)(()=>{l||k.resetFields()},[l]);let I=async e=>{let{db_host:l,db_path:a,db_port:s,db_type:t,...n}=e;if(Z(!0),"omc"===t){let l=null==P?void 0:P.find(l=>l.arn===e.db_name);try{let[a]=await (0,b.Vx)((0,b.Jm)({db_type:"omc",file_path:e.db_arn||"",comment:e.comment,db_name:(null==l?void 0:l.dbName)||e.db_name}));if(a){r.ZP.error(a.message);return}r.ZP.success("success"),null==N||N()}catch(e){r.ZP.error(e.message)}finally{Z(!1)}}if(!y&&v.some(e=>e===n.db_name)){r.ZP.error("The database already exists!");return}let i={db_host:D?void 0:l,db_port:D?void 0:s,db_type:t,file_path:D?a:void 0,...n};try{let[e]=await (0,b.Vx)((0,b.KS)(i));if(e)return;let[l]=await (0,b.Vx)((y?b.mR:b.b_)(i));if(l){r.ZP.error(l.message);return}r.ZP.success("success"),null==N||N()}catch(e){r.ZP.error(e.message)}finally{Z(!1)}};console.log(k.getFieldValue("db_type"));let{run:E}=(0,f.Z)(async e=>{V(!0);let[l,a=[]]=await (0,b.Vx)((0,b.bf)(e));V(!1),S(a.map(e=>({...e,label:e.dbName,value:e.arn})))},{wait:500});console.log("omcDBList",P);let T=(0,x.useMemo)(()=>!!y||!!a,[y,a]);return(0,s.jsx)(n.default,{open:l,width:400,title:w(y?"Edit":"create_database"),maskClosable:!1,footer:null,onCancel:_,children:(0,s.jsxs)(t.default,{form:k,className:"pt-2",labelCol:{span:6},labelAlign:"left",onFinish:I,children:[(0,s.jsx)(t.default.Item,{name:"db_type",label:"DB Type",className:"mb-3",rules:[{required:!0}],children:(0,s.jsx)(i.default,{"aria-readonly":T,disabled:T,options:j})}),"omc"===k.getFieldValue("db_type")?(0,s.jsx)(t.default.Item,{name:"db_name",label:"DB Name",className:"mb-3",rules:[{required:!0}],children:(0,s.jsx)(i.default,{optionRender:(e,l)=>{let{index:a}=l,t=P[a];return(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[18px]",children:null==t?void 0:t.dbName}),(0,s.jsxs)("span",{children:[(0,s.jsx)("span",{children:"env: "}),(0,s.jsx)("span",{className:"text-gray-500",children:t.env})]}),(0,s.jsxs)("span",{children:[(0,s.jsx)("span",{children:"account: "}),(0,s.jsx)("span",{className:"text-gray-500",children:t.account})]}),(0,s.jsxs)("span",{children:[(0,s.jsx)("span",{children:"searchName: "}),(0,s.jsx)(d.Z,{title:t.searchName,children:(0,s.jsx)("span",{className:"text-gray-500",children:t.searchName})})]})]},e.value)},notFoundContent:F?(0,s.jsx)(c.Z,{size:"small"}):null,showSearch:!0,options:P,onSearch:E,onSelect:e=>{console.log(e,"searchName");let l=null==P?void 0:P.find(l=>l.value===e);k.setFieldsValue({db_arn:null==l?void 0:l.arn})}})}):(0,s.jsx)(t.default.Item,{name:"db_name",label:"DB Name",className:"mb-3",rules:[{required:!0}],children:(0,s.jsx)(o.default,{readOnly:!!y,disabled:!!y})}),!0===D&&(0,s.jsx)(t.default.Item,{name:"db_path",label:"Path",className:"mb-3",rules:[{required:!0}],children:(0,s.jsx)(o.default,{})}),!1===D&&"omc"!==k.getFieldValue("db_type")&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.default.Item,{name:"db_user",label:"Username",className:"mb-3",rules:[{required:!0}],children:(0,s.jsx)(o.default,{})}),(0,s.jsx)(t.default.Item,{name:"db_pwd",label:"Password",className:"mb-3",rules:[{required:!1}],children:(0,s.jsx)(o.default,{type:"password"})}),(0,s.jsx)(t.default.Item,{name:"db_host",label:"Host",className:"mb-3",rules:[{required:!0}],children:(0,s.jsx)(o.default,{})}),(0,s.jsx)(t.default.Item,{name:"db_port",label:"Port",className:"mb-3",rules:[{required:!0}],children:(0,s.jsx)(m.Z,{min:1,step:1,max:65535})})]}),"omc"===k.getFieldValue("db_type")&&(0,s.jsx)(t.default.Item,{name:"db_arn",label:"Arn",className:"mb-3",rules:[{required:!0}],children:(0,s.jsx)(o.default,{})}),(0,s.jsx)(t.default.Item,{name:"comment",label:"Remark",className:"mb-3",children:(0,s.jsx)(o.default,{})}),(0,s.jsxs)(t.default.Item,{className:"flex flex-row-reverse pt-1 mb-0",children:[(0,s.jsx)(u.ZP,{htmlType:"submit",type:"primary",size:"middle",className:"mr-1",loading:g,children:"Save"}),(0,s.jsx)(u.ZP,{size:"middle",onClick:_,children:"Cancel"})]})]})})}},22505:function(e,l,a){a.r(l),a.d(l,{isFileDb:function(){return Z}});var s=a(96469),t=a(38497),r=a(77200),n=a(79839),i=a(70351),d=a(27691),c=a(67853),o=a(51657),m=a(42786),u=a(67343),x=a(97818),b=a(18758),p=a(27623),h=a(97511),f=a(72828),j=a(55861),y=a(46584),v=a(18458),_=a(7289),N=a(71483),g=a(56841);function Z(e,l){var a;return null===(a=e.find(e=>e.value===l))||void 0===a?void 0:a.isFileDb}l.default=function(){var e;let{t:l}=(0,g.$G)(),[a,Z]=(0,t.useState)([]),[w,k]=(0,t.useState)([]),[C,P]=(0,t.useState)(!1),[S,F]=(0,t.useState)({open:!1}),[V,D]=(0,t.useState)({open:!1}),[I,E]=(0,t.useState)(!1),T=async()=>{let[,e]=await (0,p.Vx)((0,p.t$)());k(null!=e?e:[])},q=async()=>{P(!0);let[,e]=await (0,p.Vx)((0,p.Bw)());Z(null!=e?e:[]),P(!1)},M=(0,t.useMemo)(()=>{let e=w.map(e=>{let{db_type:l,is_file_db:a}=e;return{..._.S$[l],value:l,isFileDb:a}}),l=Object.keys(_.S$).filter(l=>!e.some(e=>e.value===l)).map(e=>({..._.S$[e],value:_.S$[e].label,disabled:!0}));return[...e,...l]},[w]),$=e=>{F({open:!0,info:e})},B=e=>{n.default.confirm({title:"Tips",content:"Do you Want to delete the ".concat(e.db_name,"?"),onOk:()=>new Promise(async(l,a)=>{try{let[s]=await (0,p.Vx)((0,p.J5)(e.db_name));if(s){i.ZP.error(s.message),a();return}i.ZP.success("success"),q(),l()}catch(e){a()}})})},z=async e=>{E(!0);let[,a]=await (0,p.Vx)((0,p.yx)({db_name:e.db_name,db_type:e.db_type}));a&&i.ZP.success(l("refreshSuccess")),E(!1)},A=(0,t.useMemo)(()=>{let e=M.reduce((e,l)=>(e[l.value]=a.filter(e=>e.db_type===l.value),e),{});return e},[a,M]);(0,r.Z)(async()=>{await q(),await T()},[]);let L=e=>{let l=a.filter(l=>l.db_type===e.value);D({open:!0,dbList:l,name:e.label,type:e.value})};return(0,s.jsxs)("div",{className:"relative p-4 md:p-6 min-h-full overflow-y-auto",children:[(0,s.jsx)(v.Z,{visible:C}),(0,s.jsx)("div",{className:"mb-4",children:(0,s.jsx)(d.ZP,{type:"primary",className:"flex items-center",icon:(0,s.jsx)(h.Z,{}),onClick:()=>{F({open:!0})},children:l("create")})}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2 md:gap-4",children:M.map(l=>(0,s.jsx)(c.Z,{count:A[l.value].length,className:"min-h-fit",children:(0,s.jsx)(N.Z,{className:"h-full",title:l.label,desc:null!==(e=l.desc)&&void 0!==e?e:"",disabled:l.disabled,icon:l.icon,onClick:()=>{l.disabled||L(l)}})},l.value))}),(0,s.jsx)(b.Z,{open:S.open,dbTypeList:M,choiceDBType:S.dbType,editValue:S.info,dbNames:a.map(e=>e.db_name),onSuccess:()=>{F({open:!1}),q()},onClose:()=>{F({open:!1})}}),(0,s.jsx)(o.Z,{title:V.name,placement:"right",onClose:()=>{D({open:!1})},open:V.open,children:V.type&&A[V.type]&&A[V.type].length?(0,s.jsxs)(m.Z,{spinning:I,children:[(0,s.jsx)(d.ZP,{type:"primary",className:"mb-4 flex items-center",icon:(0,s.jsx)(h.Z,{}),onClick:()=>{F({open:!0,dbType:V.type})},children:"Create"}),A[V.type].map(e=>(0,s.jsxs)(u.Z,{title:e.db_name,extra:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(f.Z,{style:{color:"gray"},onClick:()=>{z(e)}}),(0,s.jsx)(j.Z,{className:"mr-2",style:{color:"#1b7eff"},onClick:()=>{$(e)}}),(0,s.jsx)(y.Z,{style:{color:"#ff1b2e"},onClick:()=>{B(e)}})]}),className:"mb-4",children:[e.db_path?(0,s.jsxs)("p",{children:["path: ",e.db_path]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("p",{children:["host: ",e.db_host]}),(0,s.jsxs)("p",{children:["username: ",e.db_user]}),(0,s.jsxs)("p",{children:["port: ",e.db_port]})]}),(0,s.jsxs)("p",{children:["remark: ",e.comment]})]},e.db_name))]}):(0,s.jsx)(x.Z,{image:x.Z.PRESENTED_IMAGE_DEFAULT,children:(0,s.jsx)(d.ZP,{type:"primary",className:"flex items-center mx-auto",icon:(0,s.jsx)(h.Z,{}),onClick:()=>{F({open:!0,dbType:V.type})},children:"Create Now"})})})]})}}}]);