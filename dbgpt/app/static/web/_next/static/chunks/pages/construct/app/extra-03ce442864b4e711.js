(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[516],{3936:function(e,a,l){"use strict";l.d(a,{Z:function(){return d}});var t=l(42096),n=l(38497),r={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M696 480H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h368c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"minus-circle",theme:"outlined"},s=l(55032),d=n.forwardRef(function(e,a){return n.createElement(s.Z,(0,t.Z)({},e,{ref:a,icon:r}))})},43547:function(e,a,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/construct/app/extra",function(){return l(39998)}])},35748:function(e,a,l){"use strict";var t=l(96469);l(38497);var n=l(71554);a.Z=e=>{let{id:a,sourceX:l,sourceY:r,targetX:s,targetY:d,sourcePosition:i,targetPosition:o,style:u={},markerEnd:c}=e,[m,p,v]=(0,n.OQ)({sourceX:l,sourceY:r,sourcePosition:i,targetX:s,targetY:d,targetPosition:o}),f=(0,n._K)();return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.u5,{id:a,style:u,path:m,markerEnd:c}),(0,t.jsx)("foreignObject",{width:40,height:40,x:p-20,y:v-20,className:"bg-transparent w-10 h-10 relative",requiredExtensions:"http://www.w3.org/1999/xhtml",children:(0,t.jsx)("button",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-5 h-5 rounded-full bg-stone-400 dark:bg-zinc-700 cursor-pointer text-sm",onClick:e=>{e.stopPropagation(),f.setEdges(f.getEdges().filter(e=>e.id!==a))},children:"\xd7"})})]})}},2997:function(e,a,l){"use strict";l.r(a);var t=l(96469),n=l(27623),r=l(16602),s=l(95891),d=l(55360),i=l(42518),o=l(79839),u=l(42786),c=l(71841),m=l(87674),p=l(26869),v=l.n(p),f=l(23852),x=l.n(f),_=l(87313),h=l(38497),g=l(56841),b=l(80017),j=l.n(b);let w=e=>{let{disable:a=!1,options:l=[],value:n,onChange:r}=e,[s,d]=(0,h.useState)(n||{}),{i18n:i}=(0,g.$G)(),o=e=>a?v()("flex items-center p-4 border rounded-lg border-[#d9d9d9]  cursor-not-allowed relative transition-all duration-500 ease-in-out",{"bg-[rgba(0,0,0,0.04)] dark:bg-[#606264]":e.value===(null==s?void 0:s.value)}):"flex items-center p-4  border dark:border-[rgba(217,217,217,0.85)] rounded-lg cursor-pointer hover:border-[#0c75fc] hover:bg-[#f5faff] dark:hover:border-[rgba(12,117,252,0.85)] dark:hover:bg-[#606264] relative transition-all duration-300 ease-in-out ".concat(e.value===(null==s?void 0:s.value)?"border-[#0c75fc] bg-[#f5faff] dark:bg-[#606264] dark:border-[#0c75fc]":"border-[#d9d9d9]"," "),u="en"===i.language;return(0,t.jsx)("div",{className:"grid grid-cols-2 gap-4",children:l.map(e=>(0,t.jsxs)("div",{className:o(e),onClick:()=>{a||(d(e),null==r||r({...n,...e}))},children:[(0,t.jsx)(x(),{src:"/icons/app/".concat(e.value,".png"),width:48,height:48,alt:e.value}),(0,t.jsxs)("div",{className:"flex flex-col ml-3",children:[(0,t.jsx)("span",{className:"text-xs font-medium text-[rgba(0,0,0,0.85)] dark:text-[rgba(255,255,255,0.85)] first-line:leading-6",children:u?e.name_en:e.name_cn}),(0,t.jsx)("span",{className:"text-xs text-[rgba(0,0,0,0.45)] dark:text-[rgba(255,255,255,0.85)]",children:u?e.description_en:e.description})]}),e.value===(null==s?void 0:s.value)&&(0,t.jsx)("div",{className:"w-3 h-3 rounded-tr-md absolute top-[1px] right-[1px] transition-all duration-300 ease-in-out",style:{background:"linear-gradient(to right top, transparent 50%, transparent 50%, ".concat(a?"#d0d0d0":"#0c75fc"," 0)")}})]},e.value))})};a.default=e=>{let{open:a,onCancel:l,type:p="add",refresh:v}=e,{t:f,i18n:x}=(0,g.$G)(),b=JSON.parse(localStorage.getItem("new_app_info")||"{}"),{message:y}=s.Z.useApp(),[N]=d.default.useForm(),k=d.default.useWatch("team_mode",N),Z=(0,_.useRouter)(),C="en"===x.language,{data:V,loading:q}=(0,r.Z)(async()=>{let[e,a]=await (0,n.Vx)((0,n.lz)());return null!=a?a:[]}),{run:I,loading:E}=(0,r.Z)(async e=>"edit"===p?await (0,n.Vx)((0,n.KT)({app_code:null==b?void 0:b.app_code,language:"zh",...e})):await (0,n.Vx)((0,n.L5)({language:"zh",...e})),{manual:!0,onSuccess:async e=>{let[a,t]=e;if(a)y.error("edit"===p?f("Update_failure"):f("Create_failure"));else if("edit"===p){var r;let[,e]=await (0,n.Vx)((0,n.yk)({})),a=null==e?void 0:null===(r=e.app_list)||void 0===r?void 0:r.find(e=>e.app_code===(null==b?void 0:b.app_code));localStorage.setItem("new_app_info",JSON.stringify({...a,isEdit:!0})),y.success(f("Update_successfully"))}else y.success(f("Create_successfully")),localStorage.setItem("new_app_info",JSON.stringify(t)),Z.push("/construct/app/extra");await (null==v?void 0:v()),l()}}),S=(0,h.useMemo)(()=>{var e;return null===(e=null==V?void 0:V.filter(e=>e.value===(null==b?void 0:b.team_mode)))||void 0===e?void 0:e[0]},[b,V]);return q?null:(0,t.jsx)(i.ZP,{theme:{components:{Button:{defaultBorderColor:"#d9d9d9"}}},children:(0,t.jsx)(o.default,{className:j()["create-app-modal-container"],title:f("create_app"),width:900,open:a,onOk:async()=>{N.validateFields().then(async e=>{var a;await I({app_name:null==e?void 0:e.app_name,app_describe:null==e?void 0:e.app_describe,team_mode:null==e?void 0:null===(a=e.team_mode)||void 0===a?void 0:a.value})})},onCancel:l,centered:!0,children:(0,t.jsx)(u.Z,{spinning:E,children:(0,t.jsxs)("div",{className:"flex flex-1",children:[(0,t.jsxs)(d.default,{layout:"vertical",className:"w-3/5",form:N,initialValues:{team_mode:S||(null==V?void 0:V[0]),app_name:null==b?void 0:b.app_name,app_describe:null==b?void 0:b.app_describe},children:[(0,t.jsx)(d.default.Item,{label:f("team_modal"),name:"team_mode",required:!0,rules:[{required:!0,message:f("Please_input_the_work_modal")}],children:(0,t.jsx)(w,{disable:"edit"===p,options:V||[]})}),(0,t.jsx)(d.default.Item,{label:"".concat(f("app_name"),"："),name:"app_name",required:!0,rules:[{required:!0,message:f("input_app_name")}],children:(0,t.jsx)(c.default,{placeholder:f("input_app_name"),autoComplete:"off",className:"h-8"})}),(0,t.jsx)(d.default.Item,{label:"".concat(f("Description"),"："),name:"app_describe",required:!0,rules:[{required:!0,message:f("Please_input_the_description")}],children:(0,t.jsx)(c.default.TextArea,{autoComplete:"off",placeholder:f("Please_input_the_description"),autoSize:{minRows:2.5}})})]}),(0,t.jsx)(m.Z,{type:"vertical",className:"h-auto mx-6 bg-[rgba(0,0,0,0.06)] dark:bg-[rgba(255,255,255,0.5)] "}),(0,t.jsxs)("div",{className:"flex flex-col w-2/5 pl-6 pt-8 ",children:[(0,t.jsx)("span",{className:"text-base text-[rgba(0,0,0,0.85)] font-medium mb-6 dark:text-[rgba(255,255,255,0.85)]",children:C?null==k?void 0:k.name_en:null==k?void 0:k.name_cn}),(0,t.jsxs)("div",{className:"flex items-start",children:[(0,t.jsx)("span",{className:"flex flex-shrink-0 w-1 h-1 rounded-full bg-[rgba(0,0,0,0.45)] mt-2 mr-1 dark:bg-[rgba(255,255,255,0.65)]"}),(0,t.jsx)("span",{className:"text-xs leading-5 text-[rgba(0,0,0,0.45)] dark:text-[rgba(255,255,255,0.65)]",children:C?null==k?void 0:k.remark_en:null==k?void 0:k.remark})]})]})]})})})})}},1318:function(e,a,l){"use strict";l.r(a),l.d(a,{default:function(){return _}});var t=l(96469),n=l(27623),r=l(27970),s=l(38497),d=l(71554),i=l(19125);l(14636);var o=l(35748),u=e=>{let{flowData:a,minZoom:l}=e,n=(0,r.z5)(a);return(0,t.jsx)(d.x$,{nodes:n.nodes,edges:n.edges,edgeTypes:{buttonedge:o.Z},fitView:!0,minZoom:l||.1,children:(0,t.jsx)(i.A,{color:"#aaa",gap:16})})},c=l(16602),m=l(55360),p=l(39069),v=l(26869),f=l.n(v),x=l(56841),_=e=>{let{initValue:a,updateData:l,classNames:r}=e,{t:d}=(0,x.$G)(),[i]=m.default.useForm(),o=m.default.useWatch("flow",i),{data:v,loading:_}=(0,c.Z)(async()=>{let[,e]=await (0,n.Vx)((0,n.Wf)({page:1,page_size:1e4}));return i.setFieldsValue({flow:null==a?void 0:a.name}),null!=e?e:{}}),h=(0,s.useMemo)(()=>{var e;return(null==v?void 0:null===(e=v.items)||void 0===e?void 0:e.map(e=>({label:e.label,value:e.name})))||[]},[v]),g=(0,s.useMemo)(()=>{var e,a;return null===(e=null==v?void 0:null===(a=v.items)||void 0===a?void 0:a.find(e=>e.name===o))||void 0===e?void 0:e.flow_data},[null==v?void 0:v.items,o]);return(0,s.useEffect)(()=>{var e;l([_,null==v?void 0:null===(e=v.items)||void 0===e?void 0:e.find(e=>e.name===o)])},[null==v?void 0:v.items,o,_,l]),(0,t.jsx)("div",{className:f()(r,"mb-6"),children:(0,t.jsxs)(m.default,{form:i,style:{width:"100%"},children:[(0,t.jsx)(m.default.Item,{label:d("select_workflow"),name:"flow",children:(0,t.jsx)(p.default,{className:"w-1/4",placeholder:d("please_select_workflow"),options:h,allowClear:!0})}),g&&(0,t.jsx)("div",{className:"w-full h-[600px] mx-auto border-[0.5px] border-dark-gray",children:(0,t.jsx)(u,{flowData:g})})]})})}},13709:function(e,a,l){"use strict";l.r(a);var t=l(96469),n=l(27623),r=l(26953),s=l(16602),d=l(55360),i=l(60205),o=l(39069),u=l(91103),c=l(26869),m=l.n(c),p=l(38497),v=l(56841);a.default=e=>{var a,l;let{classNames:c,initValue:f,updateData:x}=e,{t:_}=(0,v.$G)(),[h]=d.default.useForm(),g=d.default.useWatch("chat_scene",h),b=d.default.useWatch("bind_value",h),j=d.default.useWatch("model",h),w=d.default.useWatch("temperature",h),{team_context:y,param_need:N}=f||{},{data:k,loading:Z}=(0,s.Z)(async()=>{var e,a,l;let t=await Promise.all([(0,n.Vx)((0,n.tM)()),(0,n.Vx)((0,n.m9)("priority"))]),[r,s]=t;return h.setFieldValue("chat_scene",null==y?void 0:y.chat_scene),h.setFieldValue("model",null===(e=null==N?void 0:N.find(e=>"model"===e.type))||void 0===e?void 0:e.value),h.setFieldValue("temperature",null===(a=null==N?void 0:N.find(e=>"temperature"===e.type))||void 0===a?void 0:a.value),await q((null===(l=null==N?void 0:N.find(e=>"resource"===e.type))||void 0===l?void 0:l.value)||""),[r,s]}),{data:C,loading:V,run:q}=(0,s.Z)(async e=>{var a,l,t;let[,r]=await (0,n.Vx)((0,n.RX)({type:e}));return g===(null==y?void 0:y.chat_scene)&&(null===(a=null==N?void 0:N.find(e=>"resource"===e.type))||void 0===a?void 0:a.bind_value)&&h.setFieldsValue({bind_value:null===(l=null==N?void 0:N.find(e=>"resource"===e.type))||void 0===l?void 0:l.bind_value}),null!==(t=null==r?void 0:r.map(e=>({...e,value:e.key})))&&void 0!==t?t:[]},{manual:!0}),I=(0,p.useMemo)(()=>{var e;let a=null==k?void 0:null===(e=k[0])||void 0===e?void 0:e[1];return(null==a?void 0:a.map(e=>{var a;return{...e,label:(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(r.Z,{width:4,height:4,scene:e.chat_scene}),(0,t.jsx)(i.Z,{title:"资源类型".concat(null===(a=e.param_need.find(e=>"resource"===e.type))||void 0===a?void 0:a.value),children:(0,t.jsx)("span",{className:"text-[#525964] dark:text-[rgba(255,255,255,0.65)]  ml-1",children:e.scene_name})})]}),value:e.chat_scene}}))||[]},[k]);return(0,p.useEffect)(()=>{var e,a,l,t;let n=h.getFieldsValue();x([Z,[{chat_scene:n.chat_scene,scene_name:null===(e=I.find(e=>e.chat_scene===n.chat_scene))||void 0===e?void 0:e.scene_name},[{type:"model",value:n.model},{type:"temperature",value:n.temperature},{type:"resource",value:null===(a=null===(l=I.find(e=>e.chat_scene===n.chat_scene))||void 0===l?void 0:null===(t=l.param_need)||void 0===t?void 0:t.find(e=>"resource"===e.type))||void 0===a?void 0:a.value,bind_value:n.bind_value}]]])},[h,g,b,j,w,x,I,Z]),(0,p.useEffect)(()=>{var e,a,l,t,n;let r=null===(e=null===(a=null==k?void 0:null===(l=k[0])||void 0===l?void 0:null===(t=l[1])||void 0===t?void 0:t.find(e=>e.chat_scene===g))||void 0===a?void 0:null===(n=a.param_need)||void 0===n?void 0:n.find(e=>"resource"===e.type))||void 0===e?void 0:e.value;q(r||"")},[g,k,q]),(0,t.jsx)("div",{className:m()(c),children:(0,t.jsxs)(d.default,{form:h,autoComplete:"off",style:{width:"100%"},labelCol:{span:3},wrapperCol:{span:21},children:[(0,t.jsx)(d.default.Item,{label:_("native_type"),tooltip:!0,name:"chat_scene",children:(0,t.jsx)(o.default,{className:"w-1/2",options:I,placeholder:_("app_type_select"),onChange:()=>h.setFieldsValue({bind_value:void 0})})}),"chat_excel"!==g&&(0,t.jsx)(d.default.Item,{label:_("Arguments"),name:"bind_value",children:(0,t.jsx)(o.default,{placeholder:_("please_select_param"),allowClear:!0,className:"w-1/2",options:C,loading:V})}),(0,t.jsx)(d.default.Item,{label:_("model"),tooltip:!0,name:"model",children:(0,t.jsx)(o.default,{placeholder:_("please_select_model"),allowClear:!0,options:null==k?void 0:null===(a=k[1])||void 0===a?void 0:null===(l=a[1])||void 0===l?void 0:l.map(e=>({label:e,value:e})),className:"w-1/2"})}),(0,t.jsx)(d.default.Item,{label:_("temperature"),tooltip:!0,name:"temperature",children:(0,t.jsx)(u.Z,{className:"w-1/5 h-8",max:1,min:0,step:.1,placeholder:_("please_input_temperature")})})]})})}},95603:function(e,a,l){"use strict";l.r(a);var t=l(96469),n=l(3936),r=l(97511),s=l(55360),d=l(71841),i=l(73837),o=l(27691),u=l(26869),c=l.n(u),m=l(38497),p=l(56841),v=l(92291),f=l.n(v);a.default=e=>{let{initValue:a,updateData:l,classNames:u,formStyle:v,labelCol:x=!0}=e,{t:_}=(0,p.$G)(),[h]=s.default.useForm(),g=s.default.useWatch("recommend_questions",h);return(0,m.useEffect)(()=>{l(null==g?void 0:g.filter(e=>!!e.question))},[g,l]),(0,t.jsx)("div",{className:c()(f()["recommend-questions-container"],u),children:(0,t.jsx)(s.default,{style:{width:"100%"},form:h,initialValues:{recommend_questions:a||[{question:"",valid:!1}]},autoComplete:"off",wrapperCol:{span:20},...x&&{labelCol:{span:4}},children:(0,t.jsx)(s.default.Item,{label:_("recommended_questions"),children:(0,t.jsx)(s.default.List,{name:"recommend_questions",children:(e,a)=>{let{add:l,remove:u}=a;return(0,t.jsxs)(t.Fragment,{children:[e.map((e,a)=>{var l;let{key:r,name:o}=e;return(0,t.jsxs)("div",{className:c()("flex flex-1 items-center gap-8 mb-6",v),children:[(0,t.jsx)(s.default.Item,{label:"".concat(_("question")," ").concat(a+1),name:[o,"question"],className:"grow",children:(0,t.jsx)(d.default,{placeholder:_("please_input_recommended_questions")})}),(0,t.jsx)(s.default.Item,{label:_("is_effective"),name:[o,"valid"],children:(0,t.jsx)(i.Z,{style:{background:(null==g?void 0:null===(l=g[a])||void 0===l?void 0:l.valid)?"#1677ff":"#ccc"}})}),(0,t.jsx)(s.default.Item,{children:(0,t.jsx)(n.Z,{onClick:()=>{u(o)}})})]},r)}),(0,t.jsx)(s.default.Item,{className:c()(v),children:(0,t.jsx)(o.ZP,{type:"dashed",onClick:()=>{l({question:"",valid:!1})},block:!0,icon:(0,t.jsx)(r.Z,{}),children:_("add_question")})})]})}})})})})}},6718:function(e,a,l){"use strict";l.r(a);var t=l(96469),n=l(27623),r=l(86522),s=l(16602),d=l(29223),i=l(60205),o=l(55360),u=l(10755),c=l(26869),m=l.n(c),p=l(44766),v=l(38497),f=l(56841),x=l(48044),_=l(46837);let h=e=>{let{value:a,onChange:l,agents:n,selectedTab:s,setSelectedTab:o}=e;return(0,t.jsx)(d.Z.Group,{className:"grid grid-cols-4 gap-4",onChange:e=>{null==l||l(e)},value:a,children:n.map(e=>(0,t.jsxs)("div",{className:"flex grow h-8 items-center px-3 border ".concat(e.name===s?"border-[#0c75fc]":"border-[#d6d8da]"," rounded-md hover:border-[#0c75fc] cursor-pointer"),onClick:()=>{o(e.name||"")},children:[(0,t.jsx)(d.Z,{value:e.name}),(0,t.jsxs)("div",{className:"flex items-center flex-1 justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"ml-2 mr-1",children:x.agentIcon[e.name||""]}),(0,t.jsx)("span",{className:"text-sm text-[rgba(0,10,26,0.68)] dark:text-[rgba(255,255,255,0.85)]",children:e.label})]}),(0,t.jsx)(i.Z,{title:e.desc,children:(0,t.jsx)(r.Z,{className:"text-sm"})})]})]},e.name))})};a.default=e=>{var a,l,r;let{initValue:d,updateData:i,classNames:c}=e,{t:g,i18n:b}=(0,f.$G)(),[j]=o.default.useForm(),w=o.default.useWatch("agent_name",j),[y,N]=(0,v.useState)(""),k=(0,v.useRef)([]),Z="en"===b.language,{data:C,loading:V}=(0,s.Z)(async()=>{var e,a;let l=await Promise.all([(0,n.Vx)((0,n.j8)()),(0,n.Vx)((0,n.Vd)()),(0,n.Vx)((0,n.Q5)())]),[,t]=(null==l?void 0:l[0])||[];return k.current=(null==t?void 0:t.map(e=>({agent_name:e.name,llm_strategy:"",llm_strategy_value:"",prompt_template:"",resources:[]})))||[],j.setFieldsValue({agent_name:null==d?void 0:d.map(e=>e.agent_name)}),N((null===(e=null==d?void 0:d.map(e=>e.agent_name))||void 0===e?void 0:e[0])||(null==t?void 0:null===(a=t[0])||void 0===a?void 0:a.name)||""),null!=l?l:[]}),{data:q}=(0,s.Z)(async()=>{let[,e]=await (0,n.Vx)((0,n.xA)({page:1,page_size:1e5}));return null!=e?e:{items:[]}}),I=(0,v.useMemo)(()=>{let[,e]=(null==C?void 0:C[1])||[];return(null==e?void 0:e.length)?e.map(e=>({label:Z?e.name:e.name_cn,value:e.value})):[]},[C]),E=(0,v.useMemo)(()=>{let[,e]=(null==C?void 0:C[2])||[];if(null==e?void 0:e.length){let a=e.map(e=>({label:(0,t.jsxs)(u.Z,{children:[x.resourceTypeIcon[e],e]}),value:e}));return(0,p.concat)([{label:(0,t.jsxs)("div",{className:"flex items-center text-sm",children:[x.resourceTypeIcon.all,(0,t.jsx)("span",{className:"ml-2 text-[rgba(0,10,26,0.68)] dark:text-[#ffffffD9]",children:g("All")})]}),value:"all"}],a)}return[]},[C]);return(0,v.useEffect)(()=>{i([V,k.current.filter(e=>null==w?void 0:w.includes(e.agent_name))])},[V,w,i]),(0,t.jsxs)("div",{className:m()(c),children:[(0,t.jsx)(o.default,{form:j,style:{width:"100%"},labelCol:{span:4},wrapperCol:{span:20},children:(0,t.jsx)(o.default.Item,{label:"".concat(g("choose")," agent"),name:"agent_name",required:!0,rules:[{required:!0,message:g("please_choose")+" agent"}],children:(0,t.jsx)(h,{agents:(null==C?void 0:null===(a=C[0])||void 0===a?void 0:a[1])||[],selectedTab:y,setSelectedTab:N})})}),null==C?void 0:null===(l=C[0])||void 0===l?void 0:null===(r=l[1])||void 0===r?void 0:r.map(e=>(0,t.jsx)(_.default,{classNames:e.name===y?"block":"hidden",updateData:e=>{k.current=k.current.map(a=>a.agent_name===(null==e?void 0:e.agent_name)?{...a,...e}:{...a}),i([V,k.current.filter(e=>null==w?void 0:w.includes(e.agent_name))])},initValue:d,name:e.name,modelStrategyOptions:I,resourceTypeOptions:E,promptList:(null==q?void 0:q.items)||[]},e.name))]})}},39998:function(e,a,l){"use strict";l.r(a);var t=l(96469),n=l(27623),r=l(26953),s=l(72097),d=l(40132),i=l(16602),o=l(95891),u=l(42786),c=l(10755),m=l(27691),p=l(26869),v=l.n(p),f=l(87313),x=l(38497),_=l(56841),h=l(2997),g=l(1318),b=l(13709),j=l(95603),w=l(6718),y=l(92291),N=l.n(y);a.default=()=>{var e;let a=JSON.parse(localStorage.getItem("new_app_info")||"{}"),{t:l}=(0,_.$G)(),{message:p}=o.Z.useApp(),y=(0,f.useRouter)(),[k,Z]=(0,x.useState)(!1),[C,V]=(0,x.useState)(!1),q=(0,x.useRef)({}),{run:I,loading:E}=(0,i.Z)(async e=>await (0,n.Vx)((0,n.KT)({app_code:null==a?void 0:a.app_code,app_describe:null==a?void 0:a.app_describe,team_mode:null==a?void 0:a.team_mode,app_name:null==a?void 0:a.app_name,language:null==a?void 0:a.language,...e})),{manual:!0,onSuccess:e=>{let[,a]=e;a?(p.success(l("update_success")),y.replace("/construct/app")):p.error(l("update_failed"))}}),S=async()=>{await I({...q.current})},F=(0,x.useMemo)(()=>(null==a?void 0:a.team_mode)==="awel_layout"?"px-6":(null==a?void 0:a.team_mode)==="auto_plan"?"w-3/4 mx-auto":"w-3/5 mx-auto",[null==a?void 0:a.team_mode]);return(0,t.jsxs)(o.Z,{children:[(0,t.jsx)(u.Z,{spinning:k,children:(0,t.jsxs)("div",{className:v()("flex flex-col  h-screen w-screen dark:bg-gradient-dark bg-gradient-light bg-cover bg-center",N()["extra-container"]),children:[(0,t.jsxs)("header",{className:"flex items-center justify-between px-6 py-2 h-14 border-b border-[#edeeef]",children:[(0,t.jsxs)(c.Z,{className:"flex items-center",children:[(0,t.jsx)(s.Z,{className:"text-base cursor-pointer hover:text-[#0c75fc]",onClick:()=>{y.replace("/construct/app")}}),(0,t.jsx)("div",{className:"flex items-center justify-center w-10 h-10 border border-[#d6d8da] rounded-lg",children:(0,t.jsx)(r.Z,{scene:(null==a?void 0:null===(e=a.team_context)||void 0===e?void 0:e.chat_scene)||"chat_agent"})}),(0,t.jsx)("span",{children:null==a?void 0:a.app_name}),(0,t.jsx)(d.Z,{className:"cursor-pointer hover:text-[#0c75fc]",onClick:()=>V(!0)})]}),(0,t.jsx)(m.ZP,{type:"primary",onClick:S,loading:E,children:(null==a?void 0:a.isEdit)?l("update"):l("save")})]}),(0,t.jsxs)("div",{className:"flex flex-1 flex-col py-12 max-h-full overflow-y-auto",children:[["single_agent","auto_plan"].includes(null==a?void 0:a.team_mode)&&(0,t.jsx)(w.default,{classNames:"w-3/4 mx-auto",updateData:e=>{Z(null==e?void 0:e[0]),q.current.details=null==e?void 0:e[1]},initValue:null==a?void 0:a.details}),(null==a?void 0:a.team_mode)==="awel_layout"&&(0,t.jsx)(g.default,{initValue:null==a?void 0:a.team_context,updateData:e=>{Z(null==e?void 0:e[0]),q.current.team_context=null==e?void 0:e[1]},classNames:"px-6"}),(null==a?void 0:a.team_mode)==="native_app"&&(0,t.jsx)(b.default,{initValue:{team_context:null==a?void 0:a.team_context,param_need:null==a?void 0:a.param_need},classNames:"w-3/5 mx-auto",updateData:e=>{var a,l;Z(null==e?void 0:e[0]),q.current.team_context=null==e?void 0:null===(a=e[1])||void 0===a?void 0:a[0],q.current.param_need=null==e?void 0:null===(l=e[1])||void 0===l?void 0:l[1]}}),(0,t.jsx)(j.default,{updateData:e=>{q.current.recommend_questions=e},classNames:F,initValue:null==a?void 0:a.recommend_questions,labelCol:(null==a?void 0:a.team_mode)!=="awel_layout"})]})]})}),(0,t.jsx)(h.default,{type:"edit",open:C,onCancel:()=>V(!1)})]})}},27970:function(e,a,l){"use strict";l.d(a,{It:function(){return i},Rv:function(){return d},VZ:function(){return t},Wf:function(){return r},_g:function(){return n},z5:function(){return s}});let t=(e,a)=>{let l=0;return a.forEach(a=>{a.data.name===e.name&&l++}),"".concat(e.id,"_").concat(l)},n=e=>e.replace(/_\d+$/,""),r=e=>{let{nodes:a,edges:l,...t}=e,n=a.map(e=>{let{positionAbsolute:a,...l}=e;return{position_absolute:a,...l}}),r=l.map(e=>{let{sourceHandle:a,targetHandle:l,...t}=e;return{source_handle:a,target_handle:l,...t}});return{nodes:n,edges:r,...t}},s=e=>{let{nodes:a,edges:l,...t}=e,n=a.map(e=>{let{position_absolute:a,...l}=e;return{positionAbsolute:a,...l}}),r=l.map(e=>{let{source_handle:a,target_handle:l,...t}=e;return{sourceHandle:a,targetHandle:l,...t}});return{nodes:n,edges:r,...t}},d=e=>{let{nodes:a,edges:l}=e,t=[!0,a[0],""];e:for(let e=0;e<a.length;e++){let n=a[e].data,{inputs:r=[],parameters:s=[]}=n;for(let s=0;s<r.length;s++)if(!l.some(l=>l.targetHandle==="".concat(a[e].id,"|inputs|").concat(s))){t=[!1,a[e],"The input ".concat(r[s].type_name," of node ").concat(n.label," is required")];break e}for(let r=0;r<s.length;r++){let d=s[r];if(d.optional||"resource"!==d.category||l.some(l=>l.targetHandle==="".concat(a[e].id,"|parameters|").concat(r))){if(!d.optional&&"common"===d.category&&(void 0===d.value||null===d.value)){t=[!1,a[e],"The parameter ".concat(d.type_name," of node ").concat(n.label," is required")];break e}}else{t=[!1,a[e],"The parameter ".concat(d.type_name," of node ").concat(n.label," is required")];break e}}}return t},i=e=>(function e(a){if(Array.isArray(a))return a.map(a=>e(a));if(a&&"object"==typeof a&&!Array.isArray(a)){let l={};for(let t in a)if(Object.prototype.hasOwnProperty.call(a,t)){let n=t.replace(/_([a-z])/g,(e,a)=>a.toUpperCase());l[n]=e(a[t])}return l}return a})(e)},80017:function(e){e.exports={"create-app-modal-container":"styles_create-app-modal-container___tIEs"}},92291:function(e){e.exports={"extra-container":"styles_extra-container__OYZKD","recommend-questions-container":"styles_recommend-questions-container__Zjnkd"}}},function(e){e.O(0,[7521,5197,6668,2394,2003,5677,1841,2786,5722,5851,335,9069,5996,5360,2818,3543,1320,9223,8639,5444,2476,4162,1103,3984,6919,3993,8265,3549,5535,9080,7196,5891,2061,7462,9774,2888,179],function(){return e(e.s=43547)}),_N_E=e.O()}]);