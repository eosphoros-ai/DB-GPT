(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[516,4567],{3089:function(e,a,t){"use strict";t.d(a,{Z:function(){return i}});var l=t(87462),n=t(67294),r={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M696 480H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h368c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"minus-circle",theme:"outlined"},o=t(13401),i=n.forwardRef(function(e,a){return n.createElement(o.Z,(0,l.Z)({},e,{ref:a,icon:r}))})},84567:function(e,a,t){"use strict";t.d(a,{Z:function(){return y}});var l=t(67294),n=t(93967),r=t.n(n),o=t(50132),i=t(45353),s=t(17415),d=t(53124),c=t(98866),u=t(35792),m=t(65223);let p=l.createContext(null);var v=t(63185),f=function(e,a){var t={};for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&0>a.indexOf(l)&&(t[l]=e[l]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,l=Object.getOwnPropertySymbols(e);n<l.length;n++)0>a.indexOf(l[n])&&Object.prototype.propertyIsEnumerable.call(e,l[n])&&(t[l[n]]=e[l[n]]);return t};let x=l.forwardRef((e,a)=>{var t;let{prefixCls:n,className:x,rootClassName:h,children:b,indeterminate:g=!1,style:_,onMouseEnter:y,onMouseLeave:j,skipGroup:w=!1,disabled:k}=e,C=f(e,["prefixCls","className","rootClassName","children","indeterminate","style","onMouseEnter","onMouseLeave","skipGroup","disabled"]),{getPrefixCls:N,direction:$,checkbox:Z}=l.useContext(d.E_),O=l.useContext(p),{isFormItemInput:S}=l.useContext(m.aM),E=l.useContext(c.Z),I=null!==(t=(null==O?void 0:O.disabled)||k)&&void 0!==t?t:E,V=l.useRef(C.value);l.useEffect(()=>{null==O||O.registerValue(C.value)},[]),l.useEffect(()=>{if(!w)return C.value!==V.current&&(null==O||O.cancelValue(V.current),null==O||O.registerValue(C.value),V.current=C.value),()=>null==O?void 0:O.cancelValue(C.value)},[C.value]);let q=N("checkbox",n),P=(0,u.Z)(q),[z,D,T]=(0,v.ZP)(q,P),F=Object.assign({},C);O&&!w&&(F.onChange=function(){C.onChange&&C.onChange.apply(C,arguments),O.toggleOption&&O.toggleOption({label:b,value:C.value})},F.name=O.name,F.checked=O.value.includes(C.value));let M=r()(`${q}-wrapper`,{[`${q}-rtl`]:"rtl"===$,[`${q}-wrapper-checked`]:F.checked,[`${q}-wrapper-disabled`]:I,[`${q}-wrapper-in-form-item`]:S},null==Z?void 0:Z.className,x,h,T,P,D),R=r()({[`${q}-indeterminate`]:g},s.A,D);return z(l.createElement(i.Z,{component:"Checkbox",disabled:I},l.createElement("label",{className:M,style:Object.assign(Object.assign({},null==Z?void 0:Z.style),_),onMouseEnter:y,onMouseLeave:j},l.createElement(o.Z,Object.assign({"aria-checked":g?"mixed":void 0},F,{prefixCls:q,className:R,disabled:I,ref:a})),void 0!==b&&l.createElement("span",null,b))))});var h=t(74902),b=t(98423),g=function(e,a){var t={};for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&0>a.indexOf(l)&&(t[l]=e[l]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,l=Object.getOwnPropertySymbols(e);n<l.length;n++)0>a.indexOf(l[n])&&Object.prototype.propertyIsEnumerable.call(e,l[n])&&(t[l[n]]=e[l[n]]);return t};let _=l.forwardRef((e,a)=>{let{defaultValue:t,children:n,options:o=[],prefixCls:i,className:s,rootClassName:c,style:m,onChange:f}=e,_=g(e,["defaultValue","children","options","prefixCls","className","rootClassName","style","onChange"]),{getPrefixCls:y,direction:j}=l.useContext(d.E_),[w,k]=l.useState(_.value||t||[]),[C,N]=l.useState([]);l.useEffect(()=>{"value"in _&&k(_.value||[])},[_.value]);let $=l.useMemo(()=>o.map(e=>"string"==typeof e||"number"==typeof e?{label:e,value:e}:e),[o]),Z=y("checkbox",i),O=`${Z}-group`,S=(0,u.Z)(Z),[E,I,V]=(0,v.ZP)(Z,S),q=(0,b.Z)(_,["value","disabled"]),P=o.length?$.map(e=>l.createElement(x,{prefixCls:Z,key:e.value.toString(),disabled:"disabled"in e?e.disabled:_.disabled,value:e.value,checked:w.includes(e.value),onChange:e.onChange,className:`${O}-item`,style:e.style,title:e.title,id:e.id,required:e.required},e.label)):n,z={toggleOption:e=>{let a=w.indexOf(e.value),t=(0,h.Z)(w);-1===a?t.push(e.value):t.splice(a,1),"value"in _||k(t),null==f||f(t.filter(e=>C.includes(e)).sort((e,a)=>{let t=$.findIndex(a=>a.value===e),l=$.findIndex(e=>e.value===a);return t-l}))},value:w,disabled:_.disabled,name:_.name,registerValue:e=>{N(a=>[].concat((0,h.Z)(a),[e]))},cancelValue:e=>{N(a=>a.filter(a=>a!==e))}},D=r()(O,{[`${O}-rtl`]:"rtl"===j},s,c,V,S,I);return E(l.createElement("div",Object.assign({className:D,style:m},q,{ref:a}),l.createElement(p.Provider,{value:z},P)))});x.Group=_,x.__ANT_CHECKBOX=!0;var y=x},63185:function(e,a,t){"use strict";t.d(a,{C2:function(){return s}});var l=t(25446),n=t(14747),r=t(83262),o=t(83559);let i=e=>{let{checkboxCls:a}=e,t=`${a}-wrapper`;return[{[`${a}-group`]:Object.assign(Object.assign({},(0,n.Wf)(e)),{display:"inline-flex",flexWrap:"wrap",columnGap:e.marginXS,[`> ${e.antCls}-row`]:{flex:1}}),[t]:Object.assign(Object.assign({},(0,n.Wf)(e)),{display:"inline-flex",alignItems:"baseline",cursor:"pointer","&:after":{display:"inline-block",width:0,overflow:"hidden",content:"'\\a0'"},[`& + ${t}`]:{marginInlineStart:0},[`&${t}-in-form-item`]:{'input[type="checkbox"]':{width:14,height:14}}}),[a]:Object.assign(Object.assign({},(0,n.Wf)(e)),{position:"relative",whiteSpace:"nowrap",lineHeight:1,cursor:"pointer",borderRadius:e.borderRadiusSM,alignSelf:"center",[`${a}-input`]:{position:"absolute",inset:0,zIndex:1,cursor:"pointer",opacity:0,margin:0,[`&:focus-visible + ${a}-inner`]:Object.assign({},(0,n.oN)(e))},[`${a}-inner`]:{boxSizing:"border-box",display:"block",width:e.checkboxSize,height:e.checkboxSize,direction:"ltr",backgroundColor:e.colorBgContainer,border:`${(0,l.bf)(e.lineWidth)} ${e.lineType} ${e.colorBorder}`,borderRadius:e.borderRadiusSM,borderCollapse:"separate",transition:`all ${e.motionDurationSlow}`,"&:after":{boxSizing:"border-box",position:"absolute",top:"50%",insetInlineStart:"25%",display:"table",width:e.calc(e.checkboxSize).div(14).mul(5).equal(),height:e.calc(e.checkboxSize).div(14).mul(8).equal(),border:`${(0,l.bf)(e.lineWidthBold)} solid ${e.colorWhite}`,borderTop:0,borderInlineStart:0,transform:"rotate(45deg) scale(0) translate(-50%,-50%)",opacity:0,content:'""',transition:`all ${e.motionDurationFast} ${e.motionEaseInBack}, opacity ${e.motionDurationFast}`}},"& + span":{paddingInlineStart:e.paddingXS,paddingInlineEnd:e.paddingXS}})},{[`
        ${t}:not(${t}-disabled),
        ${a}:not(${a}-disabled)
      `]:{[`&:hover ${a}-inner`]:{borderColor:e.colorPrimary}},[`${t}:not(${t}-disabled)`]:{[`&:hover ${a}-checked:not(${a}-disabled) ${a}-inner`]:{backgroundColor:e.colorPrimaryHover,borderColor:"transparent"},[`&:hover ${a}-checked:not(${a}-disabled):after`]:{borderColor:e.colorPrimaryHover}}},{[`${a}-checked`]:{[`${a}-inner`]:{backgroundColor:e.colorPrimary,borderColor:e.colorPrimary,"&:after":{opacity:1,transform:"rotate(45deg) scale(1) translate(-50%,-50%)",transition:`all ${e.motionDurationMid} ${e.motionEaseOutBack} ${e.motionDurationFast}`}}},[`
        ${t}-checked:not(${t}-disabled),
        ${a}-checked:not(${a}-disabled)
      `]:{[`&:hover ${a}-inner`]:{backgroundColor:e.colorPrimaryHover,borderColor:"transparent"}}},{[a]:{"&-indeterminate":{[`${a}-inner`]:{backgroundColor:`${e.colorBgContainer} !important`,borderColor:`${e.colorBorder} !important`,"&:after":{top:"50%",insetInlineStart:"50%",width:e.calc(e.fontSizeLG).div(2).equal(),height:e.calc(e.fontSizeLG).div(2).equal(),backgroundColor:e.colorPrimary,border:0,transform:"translate(-50%, -50%) scale(1)",opacity:1,content:'""'}},[`&:hover ${a}-inner`]:{backgroundColor:`${e.colorBgContainer} !important`,borderColor:`${e.colorPrimary} !important`}}}},{[`${t}-disabled`]:{cursor:"not-allowed"},[`${a}-disabled`]:{[`&, ${a}-input`]:{cursor:"not-allowed",pointerEvents:"none"},[`${a}-inner`]:{background:e.colorBgContainerDisabled,borderColor:e.colorBorder,"&:after":{borderColor:e.colorTextDisabled}},"&:after":{display:"none"},"& + span":{color:e.colorTextDisabled},[`&${a}-indeterminate ${a}-inner::after`]:{background:e.colorTextDisabled}}}]};function s(e,a){let t=(0,r.IX)(a,{checkboxCls:`.${e}`,checkboxSize:a.controlInteractiveSize});return[i(t)]}a.ZP=(0,o.I$)("Checkbox",(e,a)=>{let{prefixCls:t}=a;return[s(t,e)]})},74294:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/construct/app/extra",function(){return t(90334)}])},99743:function(e,a,t){"use strict";var l=t(85893);t(67294);var n=t(36851);a.Z=e=>{let{id:a,sourceX:t,sourceY:r,targetX:o,targetY:i,sourcePosition:s,targetPosition:d,style:c={},markerEnd:u}=e,[m,p,v]=(0,n.OQ)({sourceX:t,sourceY:r,sourcePosition:s,targetX:o,targetY:i,targetPosition:d}),f=(0,n._K)();return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.u5,{id:a,style:c,path:m,markerEnd:u}),(0,l.jsx)("foreignObject",{width:40,height:40,x:p-20,y:v-20,className:"bg-transparent w-10 h-10 relative",requiredExtensions:"http://www.w3.org/1999/xhtml",children:(0,l.jsx)("button",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-5 h-5 rounded-full bg-stone-400 dark:bg-zinc-700 cursor-pointer text-sm",onClick:e=>{e.stopPropagation(),f.setEdges(f.getEdges().filter(e=>e.id!==a))},children:"\xd7"})})]})}},37082:function(e,a,t){"use strict";t.r(a);var l=t(85893),n=t(76212),r=t(65654),o=t(31418),i=t(99859),s=t(28459),d=t(85576),c=t(74330),u=t(25278),m=t(96074),p=t(93967),v=t.n(p),f=t(25675),x=t.n(f),h=t(11163),b=t(67294),g=t(67421),_=t(79903),y=t.n(_);let j=e=>{let{disable:a=!1,options:t=[],value:n,onChange:r}=e,[o,i]=(0,b.useState)(n||{}),{i18n:s}=(0,g.$G)(),d=e=>a?v()("flex items-center p-4 border rounded-lg border-[#d9d9d9]  cursor-not-allowed relative transition-all duration-500 ease-in-out",{"bg-[rgba(0,0,0,0.04)] dark:bg-[#606264]":e.value===(null==o?void 0:o.value)}):"flex items-center p-4  border dark:border-[rgba(217,217,217,0.85)] rounded-lg cursor-pointer hover:border-[#0c75fc] hover:bg-[#f5faff] dark:hover:border-[rgba(12,117,252,0.85)] dark:hover:bg-[#606264] relative transition-all duration-300 ease-in-out ".concat(e.value===(null==o?void 0:o.value)?"border-[#0c75fc] bg-[#f5faff] dark:bg-[#606264] dark:border-[#0c75fc]":"border-[#d9d9d9]"," "),c="en"===s.language;return(0,l.jsx)("div",{className:"grid grid-cols-2 gap-4",children:t.map(e=>(0,l.jsxs)("div",{className:d(e),onClick:()=>{a||(i(e),null==r||r({...n,...e}))},children:[(0,l.jsx)(x(),{src:"/icons/app/".concat(e.value,".png"),width:48,height:48,alt:e.value}),(0,l.jsxs)("div",{className:"flex flex-col ml-3",children:[(0,l.jsx)("span",{className:"text-xs font-medium text-[rgba(0,0,0,0.85)] dark:text-[rgba(255,255,255,0.85)] first-line:leading-6",children:c?e.name_en:e.name_cn}),(0,l.jsx)("span",{className:"text-xs text-[rgba(0,0,0,0.45)] dark:text-[rgba(255,255,255,0.85)]",children:c?e.description_en:e.description})]}),e.value===(null==o?void 0:o.value)&&(0,l.jsx)("div",{className:"w-3 h-3 rounded-tr-md absolute top-[1px] right-[1px] transition-all duration-300 ease-in-out",style:{background:"linear-gradient(to right top, transparent 50%, transparent 50%, ".concat(a?"#d0d0d0":"#0c75fc"," 0)")}})]},e.value))})};a.default=e=>{let{open:a,onCancel:t,type:p="add",refresh:v}=e,{t:f,i18n:x}=(0,g.$G)(),_=JSON.parse(localStorage.getItem("new_app_info")||"{}"),{message:w}=o.Z.useApp(),[k]=i.default.useForm(),C=i.default.useWatch("team_mode",k),N=(0,h.useRouter)(),$="en"===x.language,{data:Z,loading:O}=(0,r.Z)(async()=>{let[e,a]=await (0,n.Vx)((0,n.lz)());return null!=a?a:[]}),{run:S,loading:E}=(0,r.Z)(async e=>"edit"===p?await (0,n.Vx)((0,n.KT)({app_code:null==_?void 0:_.app_code,language:"zh",...e})):await (0,n.Vx)((0,n.L5)({language:"zh",...e})),{manual:!0,onSuccess:async e=>{let[a,l]=e;if(a)w.error("edit"===p?f("Update_failure"):f("Create_failure"));else if("edit"===p){var r;let[,e]=await (0,n.Vx)((0,n.yk)({})),a=null==e?void 0:null===(r=e.app_list)||void 0===r?void 0:r.find(e=>e.app_code===(null==_?void 0:_.app_code));localStorage.setItem("new_app_info",JSON.stringify({...a,isEdit:!0})),w.success(f("Update_successfully"))}else w.success(f("Create_successfully")),localStorage.setItem("new_app_info",JSON.stringify(l)),N.push("/construct/app/extra");await (null==v?void 0:v()),t()}}),I=(0,b.useMemo)(()=>{var e;return null===(e=null==Z?void 0:Z.filter(e=>e.value===(null==_?void 0:_.team_mode)))||void 0===e?void 0:e[0]},[_,Z]);return O?null:(0,l.jsx)(s.ZP,{theme:{components:{Button:{defaultBorderColor:"#d9d9d9"}}},children:(0,l.jsx)(d.default,{className:y()["create-app-modal-container"],title:f("create_app"),width:900,open:a,onOk:async()=>{k.validateFields().then(async e=>{var a;await S({app_name:null==e?void 0:e.app_name,app_describe:null==e?void 0:e.app_describe,team_mode:null==e?void 0:null===(a=e.team_mode)||void 0===a?void 0:a.value})})},onCancel:t,centered:!0,children:(0,l.jsx)(c.Z,{spinning:E,children:(0,l.jsxs)("div",{className:"flex flex-1",children:[(0,l.jsxs)(i.default,{layout:"vertical",className:"w-3/5",form:k,initialValues:{team_mode:I||(null==Z?void 0:Z[0]),app_name:null==_?void 0:_.app_name,app_describe:null==_?void 0:_.app_describe},children:[(0,l.jsx)(i.default.Item,{label:f("team_modal"),name:"team_mode",required:!0,rules:[{required:!0,message:f("Please_input_the_work_modal")}],children:(0,l.jsx)(j,{disable:"edit"===p,options:Z||[]})}),(0,l.jsx)(i.default.Item,{label:"".concat(f("app_name"),"："),name:"app_name",required:!0,rules:[{required:!0,message:f("input_app_name")}],children:(0,l.jsx)(u.default,{placeholder:f("input_app_name"),autoComplete:"off",className:"h-8"})}),(0,l.jsx)(i.default.Item,{label:"".concat(f("Description"),"："),name:"app_describe",required:!0,rules:[{required:!0,message:f("Please_input_the_description")}],children:(0,l.jsx)(u.default.TextArea,{autoComplete:"off",placeholder:f("Please_input_the_description"),autoSize:{minRows:2.5}})})]}),(0,l.jsx)(m.Z,{type:"vertical",className:"h-auto mx-6 bg-[rgba(0,0,0,0.06)] dark:bg-[rgba(255,255,255,0.5)] "}),(0,l.jsxs)("div",{className:"flex flex-col w-2/5 pl-6 pt-8 ",children:[(0,l.jsx)("span",{className:"text-base text-[rgba(0,0,0,0.85)] font-medium mb-6 dark:text-[rgba(255,255,255,0.85)]",children:$?null==C?void 0:C.name_en:null==C?void 0:C.name_cn}),(0,l.jsxs)("div",{className:"flex items-start",children:[(0,l.jsx)("span",{className:"flex flex-shrink-0 w-1 h-1 rounded-full bg-[rgba(0,0,0,0.45)] mt-2 mr-1 dark:bg-[rgba(255,255,255,0.65)]"}),(0,l.jsx)("span",{className:"text-xs leading-5 text-[rgba(0,0,0,0.45)] dark:text-[rgba(255,255,255,0.65)]",children:$?null==C?void 0:C.remark_en:null==C?void 0:C.remark})]})]})]})})})})}},7380:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return h}});var l=t(85893),n=t(76212),r=t(67919),o=t(67294),i=t(36851),s=t(59819);t(4583);var d=t(99743),c=e=>{let{flowData:a,minZoom:t}=e,n=(0,r.z5)(a);return(0,l.jsx)(i.x$,{nodes:n.nodes,edges:n.edges,edgeTypes:{buttonedge:d.Z},fitView:!0,minZoom:t||.1,children:(0,l.jsx)(s.A,{color:"#aaa",gap:16})})},u=t(65654),m=t(99859),p=t(34041),v=t(93967),f=t.n(v),x=t(67421),h=e=>{let{initValue:a,updateData:t,classNames:r}=e,{t:i}=(0,x.$G)(),[s]=m.default.useForm(),d=m.default.useWatch("flow",s),{data:v,loading:h}=(0,u.Z)(async()=>{let[,e]=await (0,n.Vx)((0,n.Wf)({page:1,page_size:1e4}));return s.setFieldsValue({flow:null==a?void 0:a.name}),null!=e?e:{}}),b=(0,o.useMemo)(()=>{var e;return(null==v?void 0:null===(e=v.items)||void 0===e?void 0:e.map(e=>({label:e.label,value:e.name})))||[]},[v]),g=(0,o.useMemo)(()=>{var e,a;return null===(e=null==v?void 0:null===(a=v.items)||void 0===a?void 0:a.find(e=>e.name===d))||void 0===e?void 0:e.flow_data},[null==v?void 0:v.items,d]);return(0,o.useEffect)(()=>{var e;t([h,null==v?void 0:null===(e=v.items)||void 0===e?void 0:e.find(e=>e.name===d)])},[null==v?void 0:v.items,d,h,t]),(0,l.jsx)("div",{className:f()(r,"mb-6"),children:(0,l.jsxs)(m.default,{form:s,style:{width:"100%"},children:[(0,l.jsx)(m.default.Item,{label:i("select_workflow"),name:"flow",children:(0,l.jsx)(p.default,{className:"w-1/4",placeholder:i("please_select_workflow"),options:b,allowClear:!0})}),g&&(0,l.jsx)("div",{className:"w-full h-[600px] mx-auto border-[0.5px] border-dark-gray",children:(0,l.jsx)(c,{flowData:g})})]})})}},76054:function(e,a,t){"use strict";t.r(a);var l=t(85893),n=t(76212),r=t(48218),o=t(65654),i=t(99859),s=t(83062),d=t(34041),c=t(13457),u=t(93967),m=t.n(u),p=t(67294),v=t(67421);a.default=e=>{var a,t;let{classNames:u,initValue:f,updateData:x}=e,{t:h}=(0,v.$G)(),[b]=i.default.useForm(),g=i.default.useWatch("chat_scene",b),_=i.default.useWatch("bind_value",b),y=i.default.useWatch("model",b),j=i.default.useWatch("temperature",b),{team_context:w,param_need:k}=f||{},{data:C,loading:N}=(0,o.Z)(async()=>{var e,a,t;let l=await Promise.all([(0,n.Vx)((0,n.tM)()),(0,n.Vx)((0,n.m9)("priority"))]),[r,o]=l;return b.setFieldValue("chat_scene",null==w?void 0:w.chat_scene),b.setFieldValue("model",null===(e=null==k?void 0:k.find(e=>"model"===e.type))||void 0===e?void 0:e.value),b.setFieldValue("temperature",null===(a=null==k?void 0:k.find(e=>"temperature"===e.type))||void 0===a?void 0:a.value),await O((null===(t=null==k?void 0:k.find(e=>"resource"===e.type))||void 0===t?void 0:t.value)||""),[r,o]}),{data:$,loading:Z,run:O}=(0,o.Z)(async e=>{var a,t,l;let[,r]=await (0,n.Vx)((0,n.RX)({type:e}));return g===(null==w?void 0:w.chat_scene)&&(null===(a=null==k?void 0:k.find(e=>"resource"===e.type))||void 0===a?void 0:a.bind_value)&&b.setFieldsValue({bind_value:null===(t=null==k?void 0:k.find(e=>"resource"===e.type))||void 0===t?void 0:t.bind_value}),null!==(l=null==r?void 0:r.map(e=>({...e,value:e.key})))&&void 0!==l?l:[]},{manual:!0}),S=(0,p.useMemo)(()=>{var e;let a=null==C?void 0:null===(e=C[0])||void 0===e?void 0:e[1];return(null==a?void 0:a.map(e=>{var a;return{...e,label:(0,l.jsxs)("div",{className:"flex items-center gap-1",children:[(0,l.jsx)(r.Z,{width:4,height:4,scene:e.chat_scene}),(0,l.jsx)(s.Z,{title:"资源类型".concat(null===(a=e.param_need.find(e=>"resource"===e.type))||void 0===a?void 0:a.value),children:(0,l.jsx)("span",{className:"text-[#525964] dark:text-[rgba(255,255,255,0.65)]  ml-1",children:e.scene_name})})]}),value:e.chat_scene}}))||[]},[C]);return(0,p.useEffect)(()=>{var e,a,t,l;let n=b.getFieldsValue();x([N,[{chat_scene:n.chat_scene,scene_name:null===(e=S.find(e=>e.chat_scene===n.chat_scene))||void 0===e?void 0:e.scene_name},[{type:"model",value:n.model},{type:"temperature",value:n.temperature},{type:"resource",value:null===(a=null===(t=S.find(e=>e.chat_scene===n.chat_scene))||void 0===t?void 0:null===(l=t.param_need)||void 0===l?void 0:l.find(e=>"resource"===e.type))||void 0===a?void 0:a.value,bind_value:n.bind_value}]]])},[b,g,_,y,j,x,S,N]),(0,p.useEffect)(()=>{var e,a,t,l,n;let r=null===(e=null===(a=null==C?void 0:null===(t=C[0])||void 0===t?void 0:null===(l=t[1])||void 0===l?void 0:l.find(e=>e.chat_scene===g))||void 0===a?void 0:null===(n=a.param_need)||void 0===n?void 0:n.find(e=>"resource"===e.type))||void 0===e?void 0:e.value;O(r||"")},[g,C,O]),(0,l.jsx)("div",{className:m()(u),children:(0,l.jsxs)(i.default,{form:b,autoComplete:"off",style:{width:"100%"},labelCol:{span:3},wrapperCol:{span:21},children:[(0,l.jsx)(i.default.Item,{label:h("native_type"),tooltip:!0,name:"chat_scene",children:(0,l.jsx)(d.default,{className:"w-1/2",options:S,placeholder:h("app_type_select"),onChange:()=>b.setFieldsValue({bind_value:void 0})})}),"chat_excel"!==g&&(0,l.jsx)(i.default.Item,{label:h("Arguments"),name:"bind_value",children:(0,l.jsx)(d.default,{placeholder:h("please_select_param"),allowClear:!0,className:"w-1/2",options:$,loading:Z})}),(0,l.jsx)(i.default.Item,{label:h("model"),tooltip:!0,name:"model",children:(0,l.jsx)(d.default,{placeholder:h("please_select_model"),allowClear:!0,options:null==C?void 0:null===(a=C[1])||void 0===a?void 0:null===(t=a[1])||void 0===t?void 0:t.map(e=>({label:e,value:e})),className:"w-1/2"})}),(0,l.jsx)(i.default.Item,{label:h("temperature"),tooltip:!0,name:"temperature",children:(0,l.jsx)(c.Z,{className:"w-1/5 h-8",max:1,min:0,step:.1,placeholder:h("please_input_temperature")})})]})})}},82257:function(e,a,t){"use strict";t.r(a);var l=t(85893),n=t(3089),r=t(24969),o=t(99859),i=t(25278),s=t(72269),d=t(14726),c=t(93967),u=t.n(c),m=t(67294),p=t(67421),v=t(11118),f=t.n(v);a.default=e=>{let{initValue:a,updateData:t,classNames:c,formStyle:v,labelCol:x=!0}=e,{t:h}=(0,p.$G)(),[b]=o.default.useForm(),g=o.default.useWatch("recommend_questions",b);return(0,m.useEffect)(()=>{t(null==g?void 0:g.filter(e=>!!e.question))},[g,t]),(0,l.jsx)("div",{className:u()(f()["recommend-questions-container"],c),children:(0,l.jsx)(o.default,{style:{width:"100%"},form:b,initialValues:{recommend_questions:a||[{question:"",valid:!1}]},autoComplete:"off",wrapperCol:{span:20},...x&&{labelCol:{span:4}},children:(0,l.jsx)(o.default.Item,{label:h("recommended_questions"),children:(0,l.jsx)(o.default.List,{name:"recommend_questions",children:(e,a)=>{let{add:t,remove:c}=a;return(0,l.jsxs)(l.Fragment,{children:[e.map((e,a)=>{var t;let{key:r,name:d}=e;return(0,l.jsxs)("div",{className:u()("flex flex-1 items-center gap-8 mb-6",v),children:[(0,l.jsx)(o.default.Item,{label:"".concat(h("question")," ").concat(a+1),name:[d,"question"],className:"grow",children:(0,l.jsx)(i.default,{placeholder:h("please_input_recommended_questions")})}),(0,l.jsx)(o.default.Item,{label:h("is_effective"),name:[d,"valid"],children:(0,l.jsx)(s.Z,{style:{background:(null==g?void 0:null===(t=g[a])||void 0===t?void 0:t.valid)?"#1677ff":"#ccc"}})}),(0,l.jsx)(o.default.Item,{children:(0,l.jsx)(n.Z,{onClick:()=>{c(d)}})})]},r)}),(0,l.jsx)(o.default.Item,{className:u()(v),children:(0,l.jsx)(d.ZP,{type:"dashed",onClick:()=>{t({question:"",valid:!1})},block:!0,icon:(0,l.jsx)(r.Z,{}),children:h("add_question")})})]})}})})})})}},78174:function(e,a,t){"use strict";t.r(a);var l=t(85893),n=t(76212),r=t(25035),o=t(65654),i=t(84567),s=t(83062),d=t(99859),c=t(42075),u=t(93967),m=t.n(u),p=t(96486),v=t(67294),f=t(67421),x=t(83072),h=t(77451);let b=e=>{let{value:a,onChange:t,agents:n,selectedTab:o,setSelectedTab:d}=e;return(0,l.jsx)(i.Z.Group,{className:"grid grid-cols-4 gap-4",onChange:e=>{null==t||t(e)},value:a,children:n.map(e=>(0,l.jsxs)("div",{className:"flex grow h-8 items-center px-3 border ".concat(e.name===o?"border-[#0c75fc]":"border-[#d6d8da]"," rounded-md hover:border-[#0c75fc] cursor-pointer"),onClick:()=>{d(e.name||"")},children:[(0,l.jsx)(i.Z,{value:e.name}),(0,l.jsxs)("div",{className:"flex items-center flex-1 justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"ml-2 mr-1",children:x.agentIcon[e.name||""]}),(0,l.jsx)("span",{className:"text-sm text-[rgba(0,10,26,0.68)] dark:text-[rgba(255,255,255,0.85)]",children:e.label})]}),(0,l.jsx)(s.Z,{title:e.desc,children:(0,l.jsx)(r.Z,{className:"text-sm"})})]})]},e.name))})};a.default=e=>{var a,t,r;let{initValue:i,updateData:s,classNames:u}=e,{t:g,i18n:_}=(0,f.$G)(),[y]=d.default.useForm(),j=d.default.useWatch("agent_name",y),[w,k]=(0,v.useState)(""),C=(0,v.useRef)([]),N="en"===_.language,{data:$,loading:Z}=(0,o.Z)(async()=>{var e,a;let t=await Promise.all([(0,n.Vx)((0,n.j8)()),(0,n.Vx)((0,n.Vd)()),(0,n.Vx)((0,n.Q5)())]),[,l]=(null==t?void 0:t[0])||[];return C.current=(null==l?void 0:l.map(e=>({agent_name:e.name,llm_strategy:"",llm_strategy_value:"",prompt_template:"",resources:[]})))||[],y.setFieldsValue({agent_name:null==i?void 0:i.map(e=>e.agent_name)}),k((null===(e=null==i?void 0:i.map(e=>e.agent_name))||void 0===e?void 0:e[0])||(null==l?void 0:null===(a=l[0])||void 0===a?void 0:a.name)||""),null!=t?t:[]}),{data:O}=(0,o.Z)(async()=>{let[,e]=await (0,n.Vx)((0,n.xA)({page:1,page_size:1e5}));return null!=e?e:{items:[]}}),S=(0,v.useMemo)(()=>{let[,e]=(null==$?void 0:$[1])||[];return(null==e?void 0:e.length)?e.map(e=>({label:N?e.name:e.name_cn,value:e.value})):[]},[$]),E=(0,v.useMemo)(()=>{let[,e]=(null==$?void 0:$[2])||[];if(null==e?void 0:e.length){let a=e.map(e=>({label:(0,l.jsxs)(c.Z,{children:[x.resourceTypeIcon[e],e]}),value:e}));return(0,p.concat)([{label:(0,l.jsxs)("div",{className:"flex items-center text-sm",children:[x.resourceTypeIcon.all,(0,l.jsx)("span",{className:"ml-2 text-[rgba(0,10,26,0.68)] dark:text-[#ffffffD9]",children:g("All")})]}),value:"all"}],a)}return[]},[$]);return(0,v.useEffect)(()=>{s([Z,C.current.filter(e=>null==j?void 0:j.includes(e.agent_name))])},[Z,j,s]),(0,l.jsxs)("div",{className:m()(u),children:[(0,l.jsx)(d.default,{form:y,style:{width:"100%"},labelCol:{span:4},wrapperCol:{span:20},children:(0,l.jsx)(d.default.Item,{label:"".concat(g("choose")," agent"),name:"agent_name",required:!0,rules:[{required:!0,message:g("please_choose")+" agent"}],children:(0,l.jsx)(b,{agents:(null==$?void 0:null===(a=$[0])||void 0===a?void 0:a[1])||[],selectedTab:w,setSelectedTab:k})})}),null==$?void 0:null===(t=$[0])||void 0===t?void 0:null===(r=t[1])||void 0===r?void 0:r.map(e=>(0,l.jsx)(h.default,{classNames:e.name===w?"block":"hidden",updateData:e=>{C.current=C.current.map(a=>a.agent_name===(null==e?void 0:e.agent_name)?{...a,...e}:{...a}),s([Z,C.current.filter(e=>null==j?void 0:j.includes(e.agent_name))])},initValue:i,name:e.name,modelStrategyOptions:S,resourceTypeOptions:E,promptList:(null==O?void 0:O.items)||[]},e.name))]})}},90334:function(e,a,t){"use strict";t.r(a);var l=t(85893),n=t(76212),r=t(48218),o=t(6171),i=t(86548),s=t(65654),d=t(31418),c=t(74330),u=t(42075),m=t(14726),p=t(93967),v=t.n(p),f=t(11163),x=t(67294),h=t(67421),b=t(37082),g=t(7380),_=t(76054),y=t(82257),j=t(78174),w=t(11118),k=t.n(w);a.default=()=>{var e;let a=JSON.parse(localStorage.getItem("new_app_info")||"{}"),{t}=(0,h.$G)(),{message:p}=d.Z.useApp(),w=(0,f.useRouter)(),[C,N]=(0,x.useState)(!1),[$,Z]=(0,x.useState)(!1),O=(0,x.useRef)({}),{run:S,loading:E}=(0,s.Z)(async e=>await (0,n.Vx)((0,n.KT)({app_code:null==a?void 0:a.app_code,app_describe:null==a?void 0:a.app_describe,team_mode:null==a?void 0:a.team_mode,app_name:null==a?void 0:a.app_name,language:null==a?void 0:a.language,...e})),{manual:!0,onSuccess:e=>{let[,a]=e;a?(p.success(t("update_success")),w.replace("/construct/app")):p.error(t("update_failed"))}}),I=async()=>{await S({...O.current})},V=(0,x.useMemo)(()=>(null==a?void 0:a.team_mode)==="awel_layout"?"px-6":(null==a?void 0:a.team_mode)==="auto_plan"?"w-3/4 mx-auto":"w-3/5 mx-auto",[null==a?void 0:a.team_mode]);return(0,l.jsxs)(d.Z,{children:[(0,l.jsx)(c.Z,{spinning:C,children:(0,l.jsxs)("div",{className:v()("flex flex-col  h-screen w-screen dark:bg-gradient-dark bg-gradient-light bg-cover bg-center",k()["extra-container"]),children:[(0,l.jsxs)("header",{className:"flex items-center justify-between px-6 py-2 h-14 border-b border-[#edeeef]",children:[(0,l.jsxs)(u.Z,{className:"flex items-center",children:[(0,l.jsx)(o.Z,{className:"text-base cursor-pointer hover:text-[#0c75fc]",onClick:()=>{w.replace("/construct/app")}}),(0,l.jsx)("div",{className:"flex items-center justify-center w-10 h-10 border border-[#d6d8da] rounded-lg",children:(0,l.jsx)(r.Z,{scene:(null==a?void 0:null===(e=a.team_context)||void 0===e?void 0:e.chat_scene)||"chat_agent"})}),(0,l.jsx)("span",{children:null==a?void 0:a.app_name}),(0,l.jsx)(i.Z,{className:"cursor-pointer hover:text-[#0c75fc]",onClick:()=>Z(!0)})]}),(0,l.jsx)(m.ZP,{type:"primary",onClick:I,loading:E,children:(null==a?void 0:a.isEdit)?t("update"):t("save")})]}),(0,l.jsxs)("div",{className:"flex flex-1 flex-col py-12 max-h-full overflow-y-auto",children:[["single_agent","auto_plan"].includes(null==a?void 0:a.team_mode)&&(0,l.jsx)(j.default,{classNames:"w-3/4 mx-auto",updateData:e=>{N(null==e?void 0:e[0]),O.current.details=null==e?void 0:e[1]},initValue:null==a?void 0:a.details}),(null==a?void 0:a.team_mode)==="awel_layout"&&(0,l.jsx)(g.default,{initValue:null==a?void 0:a.team_context,updateData:e=>{N(null==e?void 0:e[0]),O.current.team_context=null==e?void 0:e[1]},classNames:"px-6"}),(null==a?void 0:a.team_mode)==="native_app"&&(0,l.jsx)(_.default,{initValue:{team_context:null==a?void 0:a.team_context,param_need:null==a?void 0:a.param_need},classNames:"w-3/5 mx-auto",updateData:e=>{var a,t;N(null==e?void 0:e[0]),O.current.team_context=null==e?void 0:null===(a=e[1])||void 0===a?void 0:a[0],O.current.param_need=null==e?void 0:null===(t=e[1])||void 0===t?void 0:t[1]}}),(0,l.jsx)(y.default,{updateData:e=>{O.current.recommend_questions=e},classNames:V,initValue:null==a?void 0:a.recommend_questions,labelCol:(null==a?void 0:a.team_mode)!=="awel_layout"})]})]})}),(0,l.jsx)(b.default,{type:"edit",open:$,onCancel:()=>Z(!1)})]})}},67919:function(e,a,t){"use strict";t.d(a,{Av:function(){return d},It:function(){return s},Rv:function(){return i},VZ:function(){return l},Wf:function(){return r},_g:function(){return n},z5:function(){return o}});let l=(e,a)=>{let t=0;return a.forEach(a=>{a.data.name===e.name&&t++}),"".concat(e.id,"_").concat(t)},n=e=>e.replace(/_\d+$/,""),r=e=>{let{nodes:a,edges:t,...l}=e,n=a.map(e=>{let{positionAbsolute:a,...t}=e;return{position_absolute:a,...t}}),r=t.map(e=>{let{sourceHandle:a,targetHandle:t,...l}=e;return{source_handle:a,target_handle:t,...l}});return{nodes:n,edges:r,...l}},o=e=>{let{nodes:a,edges:t,...l}=e,n=a.map(e=>{let{position_absolute:a,...t}=e;return{positionAbsolute:a,...t}}),r=t.map(e=>{let{source_handle:a,target_handle:t,...l}=e;return{sourceHandle:a,targetHandle:t,...l}});return{nodes:n,edges:r,...l}},i=e=>{let{nodes:a,edges:t}=e,l=[!0,a[0],""];e:for(let e=0;e<a.length;e++){let n=a[e].data,{inputs:r=[],parameters:o=[]}=n;for(let o=0;o<r.length;o++)if(!t.some(t=>t.targetHandle==="".concat(a[e].id,"|inputs|").concat(o))){l=[!1,a[e],"The input ".concat(r[o].type_name," of node ").concat(n.label," is required")];break e}for(let r=0;r<o.length;r++){let i=o[r];if(i.optional||"resource"!==i.category||t.some(t=>t.targetHandle==="".concat(a[e].id,"|parameters|").concat(r))){if(!i.optional&&"common"===i.category&&(void 0===i.value||null===i.value)){l=[!1,a[e],"The parameter ".concat(i.type_name," of node ").concat(n.label," is required")];break e}}else{l=[!1,a[e],"The parameter ".concat(i.type_name," of node ").concat(n.label," is required")];break e}}}return l},s=e=>(function e(a){if(Array.isArray(a))return a.map(a=>e(a));if(a&&"object"==typeof a&&!Array.isArray(a)){let t={};for(let l in a)if(Object.prototype.hasOwnProperty.call(a,l)){let n=l.replace(/_([a-z])/g,(e,a)=>a.toUpperCase());t[n]=e(a[l])}return t}return a})(e);function d(e){let a=new Set(["@","#","%",":"]),t={key:e.key||"",name:e.name||"",scope:e.scope||"",scope_key:e.scope_key||"",sys_code:e.sys_code||"",user_name:e.user_name||""};for(let[e,l]of Object.entries(t))l&&[...a].some(e=>l.includes(e))&&(t[e]=l.replace(/@/g,"\\@").replace(/#/g,"\\#").replace(/%/g,"\\%").replace(/:/g,"\\:"));let{key:l,name:n,scope:r,scope_key:o,sys_code:i,user_name:s}=t,d="".concat(l);return n&&(d+="".concat(":").concat(n)),(r||o)&&(d+="".concat("@").concat(r),o&&(d+="".concat(":").concat(o))),i&&(d+="".concat("#").concat(i)),s&&(d+="".concat("%").concat(s)),"${".concat(d,"}")}},79903:function(e){e.exports={"create-app-modal-container":"styles_create-app-modal-container___tIEs"}},11118:function(e){e.exports={"extra-container":"styles_extra-container__OYZKD","recommend-questions-container":"styles_recommend-questions-container__Zjnkd"}},50132:function(e,a,t){"use strict";var l=t(87462),n=t(1413),r=t(4942),o=t(97685),i=t(45987),s=t(93967),d=t.n(s),c=t(21770),u=t(67294),m=["prefixCls","className","style","checked","disabled","defaultChecked","type","title","onChange"],p=(0,u.forwardRef)(function(e,a){var t=e.prefixCls,s=void 0===t?"rc-checkbox":t,p=e.className,v=e.style,f=e.checked,x=e.disabled,h=e.defaultChecked,b=e.type,g=void 0===b?"checkbox":b,_=e.title,y=e.onChange,j=(0,i.Z)(e,m),w=(0,u.useRef)(null),k=(0,u.useRef)(null),C=(0,c.Z)(void 0!==h&&h,{value:f}),N=(0,o.Z)(C,2),$=N[0],Z=N[1];(0,u.useImperativeHandle)(a,function(){return{focus:function(e){var a;null===(a=w.current)||void 0===a||a.focus(e)},blur:function(){var e;null===(e=w.current)||void 0===e||e.blur()},input:w.current,nativeElement:k.current}});var O=d()(s,p,(0,r.Z)((0,r.Z)({},"".concat(s,"-checked"),$),"".concat(s,"-disabled"),x));return u.createElement("span",{className:O,title:_,style:v,ref:k},u.createElement("input",(0,l.Z)({},j,{className:"".concat(s,"-input"),ref:w,onChange:function(a){x||("checked"in e||Z(a.target.checked),null==y||y({target:(0,n.Z)((0,n.Z)({},e),{},{type:g,checked:a.target.checked}),stopPropagation:function(){a.stopPropagation()},preventDefault:function(){a.preventDefault()},nativeEvent:a.nativeEvent}))},disabled:x,checked:!!$,type:g})),u.createElement("span",{className:"".concat(s,"-inner")}))});a.Z=p}},function(e){e.O(0,[3662,7034,8674,930,3166,2837,2168,8163,7126,8241,2648,3791,2913,5278,8791,4330,1049,5030,4041,2398,9859,3799,2684,1300,9773,3457,4455,5110,4705,9202,5782,7873,1278,5706,8709,9256,8510,9774,2888,179],function(){return e(e.s=74294)}),_N_E=e.O()}]);