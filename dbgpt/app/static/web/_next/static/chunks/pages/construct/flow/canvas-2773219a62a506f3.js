(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1767],{94617:function(e,t,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/construct/flow/canvas",function(){return l(66084)}])},45247:function(e,t,l){"use strict";var a=l(85893),r=l(50888);t.Z=function(e){let{visible:t}=e;return t?(0,a.jsx)("div",{className:"absolute w-full h-full top-0 left-0 flex justify-center items-center z-10 bg-white dark:bg-black bg-opacity-50 dark:bg-opacity-50 backdrop-blur-sm text-3xl animate-fade animate-duration-200",children:(0,a.jsx)(r.Z,{})}):null}},99743:function(e,t,l){"use strict";var a=l(85893);l(67294);var r=l(36851);t.Z=e=>{let{id:t,sourceX:l,sourceY:n,targetX:s,targetY:i,sourcePosition:o,targetPosition:d,style:c={},markerEnd:u}=e,[p,m,f]=(0,r.OQ)({sourceX:l,sourceY:n,sourcePosition:o,targetX:s,targetY:i,targetPosition:d}),v=(0,r._K)();return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.u5,{id:t,style:c,path:p,markerEnd:u}),(0,a.jsx)("foreignObject",{width:40,height:40,x:m-20,y:f-20,className:"bg-transparent w-10 h-10 relative",requiredExtensions:"http://www.w3.org/1999/xhtml",children:(0,a.jsx)("button",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-5 h-5 rounded-full bg-stone-400 dark:bg-zinc-700 cursor-pointer text-sm",onClick:e=>{e.stopPropagation(),v.setEdges(v.getEdges().filter(e=>e.id!==t))},children:"\xd7"})})]})}},66084:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return e0}});var a=l(85893),r=l(76212),n=l(45247),s=l(41468),i=l(62418),o=l(14313),d=l(94155),c=l(25278),u=l(21612),p=l(40411),m=l(42075),f=l(72269),v=l(47221),x=l(93967),h=l.n(x),g=l(67294),j=l(67421),b=l(2487),w=l(7134),y=l(32983),_=e=>{let{nodes:t}=e,{t:l}=(0,j.$G)();return(null==t?void 0:t.length)>0?(0,a.jsx)(b.Z,{className:"overflow-hidden overflow-y-auto w-full",size:"small",itemLayout:"horizontal",dataSource:t,renderItem:e=>(0,a.jsx)(b.Z.Item,{className:"cursor-move hover:bg-[#F1F5F9] dark:hover:bg-theme-dark p-0 py-2",draggable:!0,onDragStart:t=>{t.dataTransfer.setData("application/reactflow",JSON.stringify(e)),t.dataTransfer.effectAllowed="move"},children:(0,a.jsx)(b.Z.Item.Meta,{className:"flex items-center justify-center",avatar:(0,a.jsx)(w.C,{src:"/icons/node/vis.png",size:"large"}),title:(0,a.jsx)("p",{className:"line-clamp-1 font-medium",children:e.label}),description:(0,a.jsx)("p",{className:"line-clamp-2",children:e.description})})})}):(0,a.jsx)(y.Z,{className:"px-2",description:l("no_node")})};let{Search:N}=c.default,{Sider:Z}=u.default,k=JSON.stringify({order:"higher-order"}),C={display:"flex",alignItems:"center",justifyContent:"center",width:16,height:48,position:"absolute",top:"50%",transform:"translateY(-50%)",border:"1px solid #d6d8da",borderRadius:8,right:-8};var I=()=>{let{t:e}=(0,j.$G)(),{mode:t}=(0,g.useContext)(s.p),[l,n]=(0,g.useState)(!1),[c,u]=(0,g.useState)(""),[x,b]=(0,g.useState)([]),[w,y]=(0,g.useState)([]),[I,S]=(0,g.useState)([]),[F,P]=(0,g.useState)([]),[E,V]=(0,g.useState)(!1);async function z(e){let[t,l]=await (0,r.Vx)((0,r.As)(e));if(l&&l.length>0){localStorage.setItem(i.zN,JSON.stringify(l));let e=l.filter(e=>"operator"===e.flow_type),t=l.filter(e=>"resource"===e.flow_type);b(e),y(t),S(A(e)),P(A(t))}}(0,g.useEffect)(()=>{z(k)},[]);let O=(0,g.useMemo)(()=>l?{...C,right:-16,borderRadius:"0px 8px 8px 0",borderLeft:"1px solid #d5e5f6"}:{...C,borderLeft:"1px solid #d6d8da"},[l]);function A(e){let t=[],l={};return e.forEach(e=>{let{category:a,category_label:r}=e;l[a]||(l[a]={category:a,categoryLabel:r,nodes:[]},t.push(l[a])),l[a].nodes.push(e)}),t}let D=(0,g.useMemo)(()=>{if(!c)return I.map(e=>{let{category:t,categoryLabel:l,nodes:r}=e;return{key:t,label:l,children:(0,a.jsx)(_,{nodes:r}),extra:(0,a.jsx)(p.Z,{showZero:!0,count:r.length||0,style:{backgroundColor:r.length>0?"#52c41a":"#7f9474"}})}});{let e=x.filter(e=>e.label.toLowerCase().includes(c.toLowerCase()));return A(e).map(e=>{let{category:t,categoryLabel:l,nodes:r}=e;return{key:t,label:l,children:(0,a.jsx)(_,{nodes:r}),extra:(0,a.jsx)(p.Z,{showZero:!0,count:r.length||0,style:{backgroundColor:r.length>0?"#52c41a":"#7f9474"}})}})}},[I,c]),T=(0,g.useMemo)(()=>{if(!c)return F.map(e=>{let{category:t,categoryLabel:l,nodes:r}=e;return{key:t,label:l,children:(0,a.jsx)(_,{nodes:r}),extra:(0,a.jsx)(p.Z,{showZero:!0,count:r.length||0,style:{backgroundColor:r.length>0?"#52c41a":"#7f9474"}})}});{let e=w.filter(e=>e.label.toLowerCase().includes(c.toLowerCase()));return A(e).map(e=>{let{category:t,categoryLabel:l,nodes:r}=e;return{key:t,label:l,children:(0,a.jsx)(_,{nodes:r}),extra:(0,a.jsx)(p.Z,{showZero:!0,count:r.length||0,style:{backgroundColor:r.length>0?"#52c41a":"#7f9474"}})}})}},[F,c]);return(0,a.jsx)(Z,{className:"flex justify-center items-start nodrag bg-[#ffffff80] border-r border-[#d5e5f6] dark:bg-[#ffffff29] dark:border-[#ffffff66]",theme:t,width:280,collapsible:!0,collapsed:l,collapsedWidth:0,trigger:l?(0,a.jsx)(o.Z,{className:"text-base"}):(0,a.jsx)(d.Z,{className:"text-base"}),zeroWidthTriggerStyle:O,onCollapse:e=>n(e),children:(0,a.jsxs)(m.Z,{direction:"vertical",className:"w-[280px] pt-4 px-4 overflow-hidden overflow-y-auto scrollbar-default",children:[(0,a.jsxs)("div",{className:"flex justify-between align-middle",children:[(0,a.jsx)("p",{className:"w-full text-base font-semibold text-[#1c2533] dark:text-[rgba(255,255,255,0.85)] line-clamp-1",children:e("add_node")}),(0,a.jsx)(f.Z,{checkedChildren:"高阶",unCheckedChildren:"全部",onClick:function(){E?z(k):z(),V(!E)},className:h()("w-20",{"bg-zinc-400":E}),defaultChecked:!0})]}),(0,a.jsx)(N,{placeholder:"Search node",onSearch:function(e){u(e)},allowClear:!0}),(0,a.jsx)("h2",{className:"font-semibold",children:e("operators")}),(0,a.jsx)(v.Z,{size:"small",bordered:!1,className:"max-h-[calc((100vh-156px)/2)] overflow-hidden overflow-y-auto scrollbar-default",defaultActiveKey:[""],items:D}),(0,a.jsx)("h2",{className:"font-semibold",children:e("resource")}),(0,a.jsx)(v.Z,{size:"small",bordered:!1,className:"max-h-[calc((100vh-156px)/2)] overflow-hidden overflow-y-auto scrollbar-default",defaultActiveKey:[""],items:T})]})})},S=l(99743),F=l(67919),P=l(24969),E=l(3089),V=l(34041),z=l(99859),O=l(3303),A=l(13457),D=l(14726),T=l(85576),L=l(96486);let{Option:M}=V.default,q=["str","int","float","bool","ref"],R=e=>{let{flowInfo:t,setFlowInfo:l}=e,{t:n}=(0,j.$G)(),[s,i]=(0,g.useState)(!1),[o]=z.default.useForm(),[d,u]=(0,g.useState)(["str"]),[p,f]=(0,g.useState)([]);(0,g.useEffect)(()=>{v()},[]);let v=async()=>{let[e,t]=await (0,r.Vx)((0,r.RR)());if(e)return;let l=null==t?void 0:t.map(e=>{let{key:t,label:l,scope:a}=e;return{value:t,label:l,scope:a,isLeaf:!1}});f(l)},x=(e,t)=>{var l,a;let r=e.target.value,n=null===(l=null===(a=null==r?void 0:r.split("_"))||void 0===a?void 0:a.map(e=>e.charAt(0).toUpperCase()+e.slice(1)))||void 0===l?void 0:l.join(" ");o.setFields([{name:["parameters",t,"label"],value:n}])},h=(e,t)=>{let l=[...d];l[t]=e,u(l)},b=e=>{let t=e[e.length-1],{value:l,scope:a}=t;setTimeout(async()=>{let[e,n]=await (0,r.Vx)((0,r.gt)({key:l,scope:a}));if(e)return;if((null==n?void 0:n.total_count)===0){t.isLeaf=!0;return}let s=(0,L.uniqBy)(null==n?void 0:n.items,"name");t.children=null==s?void 0:s.map(e=>({value:null==e?void 0:e.name,label:e.label,item:e})),f([...p])},1e3)},w=(e,t,l)=>{var a,r,n;if((null==e?void 0:e.length)!==2)return;let[s,i]=t,d=null==s?void 0:null===(a=s.children)||void 0===a?void 0:a.find(e=>{let{value:t}=e;return t===(null==i?void 0:i.value)}),c=(0,F.Av)(null==d?void 0:d.item),u=o.getFieldValue("parameters"),p=null==u?void 0:u[l];p&&(p.value=c,p.category=null==d?void 0:null===(r=d.item)||void 0===r?void 0:r.category,p.value_type=null==d?void 0:null===(n=d.item)||void 0===n?void 0:n.value_type,o.setFieldsValue({parameters:[...u]}))},y=(e,t)=>{switch(e){case"ref":return(0,a.jsx)(O.Z,{placeholder:"Select Value",options:p,loadData:b,onChange:(e,l)=>w(e,l,t),changeOnSelect:!0});case"str":default:return(0,a.jsx)(c.default,{placeholder:"Parameter Value"});case"int":return(0,a.jsx)(A.Z,{step:1,placeholder:"Parameter Value",parser:e=>(null==e?void 0:e.replace(/[^\-?\d]/g,""))||0,style:{width:"100%"}});case"float":return(0,a.jsx)(A.Z,{placeholder:"Parameter Value",style:{width:"100%"}});case"bool":return(0,a.jsxs)(V.default,{placeholder:"Select Value",children:[(0,a.jsx)(M,{value:!0,children:"True"}),(0,a.jsx)(M,{value:!1,children:"False"})]})}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(D.ZP,{type:"primary",className:"flex items-center justify-center rounded-full left-4 top-4",style:{zIndex:1050},icon:(0,a.jsx)(P.Z,{}),onClick:()=>i(!0)}),(0,a.jsx)(T.default,{title:n("Add_Global_Variable_of_Flow"),width:1e3,open:s,styles:{body:{minHeight:"40vh",maxHeight:"65vh",overflow:"scroll",backgroundColor:"rgba(0,0,0,0.02)",padding:"0 8px",borderRadius:4}},onCancel:()=>i(!1),footer:[(0,a.jsx)(D.ZP,{onClick:()=>i(!1),children:n("cancel")},"cancel"),(0,a.jsx)(D.ZP,{type:"primary",onClick:()=>o.submit(),children:n("verify")},"submit")],children:(0,a.jsx)(z.default,{name:"dynamic_form_nest_item",onFinish:e=>{let a={...t,variables:(null==e?void 0:e.parameters)||[]};l(a),i(!1)},form:o,autoComplete:"off",layout:"vertical",className:"mt-8",initialValues:{parameters:(null==t?void 0:t.variables)||[{}]},children:(0,a.jsx)(z.default.List,{name:"parameters",children:(e,t)=>{let{add:l,remove:r}=t;return(0,a.jsxs)(a.Fragment,{children:[e.map((e,t)=>{let{key:l,name:n,...s}=e;return(0,a.jsxs)(m.Z,{className:"hover:bg-gray-100 pt-2 pl-2",children:[(0,a.jsx)(z.default.Item,{...s,name:[n,"name"],label:"参数 ".concat(t+1," 名称"),style:{width:140},rules:[{required:!0,message:"Missing parameter name"},{pattern:/^[a-zA-Z0-9]+(_[a-zA-Z0-9]+)*$/,message:"名称必须是字母、数字或下划线，并使用下划线分隔多个单词"}],children:(0,a.jsx)(c.default,{placeholder:"Parameter Name",onChange:e=>x(e,t)})}),(0,a.jsx)(z.default.Item,{...s,name:[n,"label"],label:"标题",style:{width:130},rules:[{required:!0,message:"Missing parameter label"}],children:(0,a.jsx)(c.default,{placeholder:"Parameter Label"})}),(0,a.jsx)(z.default.Item,{...s,name:[n,"value_type"],label:"类型",style:{width:100},rules:[{required:!0,message:"Missing parameter type"}],children:(0,a.jsx)(V.default,{placeholder:"Select",onChange:e=>h(e,t),children:q.map(e=>(0,a.jsx)(M,{value:e,children:e},e))})}),(0,a.jsx)(z.default.Item,{...s,name:[n,"value"],label:"值",style:{width:320},rules:[{required:!0,message:"Missing parameter value"}],children:y(d[t],t)}),(0,a.jsx)(z.default.Item,{...s,name:[n,"description"],label:"描述",style:{width:170},children:(0,a.jsx)(c.default,{placeholder:"Parameter Description"})}),(0,a.jsx)(E.Z,{onClick:()=>r(n)}),(0,a.jsx)(z.default.Item,{name:[n,"key"],hidden:!0,initialValue:"dbgpt.core.flow.params"}),(0,a.jsx)(z.default.Item,{name:[n,"scope"],hidden:!0,initialValue:"flow_priv"}),(0,a.jsx)(z.default.Item,{name:[n,"category"],hidden:!0,initialValue:"common"})]},l)}),(0,a.jsx)(z.default.Item,{children:(0,a.jsx)(D.ZP,{type:"dashed",onClick:()=>l(),block:!0,icon:(0,a.jsx)(P.Z,{}),children:n("Add_Parameter")})})]})}})})})]})};var G=l(45360),$=l(78045),J=l(83454);let B=e=>{let{reactFlow:t,flowInfo:l,isExportFlowModalOpen:r,setIsExportFlowModalOpen:n}=e,{t:s}=(0,j.$G)(),[i]=z.default.useForm(),[o,d]=G.ZP.useMessage(),u=async e=>{if("json"===e.format){let l=t.toObject(),a=new Blob([JSON.stringify(l)],{type:"text/plain;charset=utf-8"}),r=URL.createObjectURL(a),n=document.createElement("a");n.href=r,n.download=e.file_name||"flow.json",n.click()}else{var l;let t="".concat(null!==(l=J.env.API_BASE_URL)&&void 0!==l?l:"","/api/v2/serve/awel/flow/export/").concat(e.uid,"?export_type=").concat(e.export_type,"&format=").concat(e.format);window.open(t)}o.success(s("Export_Flow_Success")),n(!1)};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(T.default,{title:s("Export_Flow"),open:r,onCancel:()=>n(!1),footer:[(0,a.jsx)(D.ZP,{onClick:()=>n(!1),children:s("cancel")},"cancel"),(0,a.jsx)(D.ZP,{type:"primary",onClick:()=>i.submit(),children:s("verify")},"submit")],children:(0,a.jsxs)(z.default,{form:i,className:"mt-6",labelCol:{span:6},wrapperCol:{span:16},onFinish:u,initialValues:{export_type:"json",format:"file",uid:null==l?void 0:l.uid},children:[(0,a.jsx)(z.default.Item,{label:s("Export_File_Type"),name:"export_type",children:(0,a.jsxs)($.ZP.Group,{children:[(0,a.jsx)($.ZP,{value:"json",children:"JSON"}),(0,a.jsx)($.ZP,{value:"dbgpts",children:"DBGPTS"})]})}),(0,a.jsx)(z.default.Item,{label:s("Export_File_Format"),name:"format",children:(0,a.jsxs)($.ZP.Group,{children:[(0,a.jsx)($.ZP,{value:"file",children:"File"}),(0,a.jsx)($.ZP,{value:"json",children:"JSON"})]})}),(0,a.jsx)(z.default.Item,{hidden:!0,name:"uid",children:(0,a.jsx)(c.default,{})})]})}),d]})};var U=l(39773);let H=e=>{let{isFlowTemplateModalOpen:t,setIsFlowTemplateModalOpen:l}=e,{t:n}=(0,j.$G)(),[s,i]=(0,g.useState)([]),o=e=>{(null==e?void 0:e.name)&&(localStorage.setItem("importFlowData",JSON.stringify(e)),e0(),l(!1))},d=[{title:n("Template_Name"),dataIndex:"name",key:"name"},{title:n("Template_Label"),dataIndex:"label",key:"label"},{title:n("Template_Description"),dataIndex:"description",key:"description"},{title:n("Template_Action"),key:"action",render:(e,t)=>(0,a.jsx)(m.Z,{size:"middle",children:(0,a.jsx)(D.ZP,{type:"link",onClick:()=>{o(t)},block:!0,children:n("Import_From_Template")})})}];return(0,g.useEffect)(()=>{(0,r.MJ)().then(e=>{var t,l;console.log(e),i(null==e?void 0:null===(t=e.data)||void 0===t?void 0:null===(l=t.data)||void 0===l?void 0:l.items)})},[]),(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(T.default,{className:"w-[700px]",title:n("Import_From_Template"),open:t,onCancel:()=>l(!1),cancelButtonProps:{className:"hidden"},okButtonProps:{className:"hidden"},children:[(0,a.jsx)(U.Z,{className:"w-full",dataSource:s,columns:d}),";"]})})};var K=l(88484),W=l(23799);let Y=e=>{let{isImportModalOpen:t,setIsImportFlowModalOpen:l}=e,{t:n}=(0,j.$G)(),[s]=z.default.useForm(),[i,o]=G.ZP.useMessage(),[d,c]=(0,g.useState)([]);(0,g.useEffect)(()=>{t&&(s.resetFields(),c([]))},[t,s]);let u=async e=>{var t;e.file=null===(t=e.file)||void 0===t?void 0:t[0];let a=new FormData;d.forEach(t=>{a.append("file",t),a.append("save_flow",e.save_flow)});let[,,s]=await (0,r.Vx)((0,r._Y)(a));(null==s?void 0:s.success)?(i.success(n("Import_Flow_Success")),localStorage.setItem("importFlowData",JSON.stringify(null==s?void 0:s.data)),e0()):(null==s?void 0:s.err_msg)&&i.error(null==s?void 0:s.err_msg),l(!1)};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(T.default,{title:n("Import_Flow"),open:t,onCancel:()=>l(!1),footer:[(0,a.jsx)(D.ZP,{onClick:()=>l(!1),children:n("cancel")},"cancel"),(0,a.jsx)(D.ZP,{type:"primary",onClick:()=>s.submit(),children:n("verify")},"submit")],children:(0,a.jsxs)(z.default,{form:s,className:"mt-6",labelCol:{span:6},wrapperCol:{span:16},onFinish:u,initialValues:{save_flow:!1},children:[(0,a.jsx)(z.default.Item,{name:"file",label:n("Select_File"),valuePropName:"fileList",getValueFromEvent:e=>Array.isArray(e)?e:e&&e.fileList,rules:[{required:!0,message:"Please upload a file"}],children:(0,a.jsx)(W.default,{onRemove:e=>{let t=d.indexOf(e),l=d.slice();l.splice(t,1),c(l)},beforeUpload:e=>(c([...d,e]),!1),fileList:d,accept:".json,.zip",maxCount:1,children:(0,a.jsxs)(D.ZP,{icon:(0,a.jsx)(K.Z,{}),children:[" ",n("Upload")]})})}),(0,a.jsx)(z.default.Item,{name:"save_flow",label:n("Save_After_Import"),hidden:!0,children:(0,a.jsxs)($.ZP.Group,{children:[(0,a.jsx)($.ZP,{value:!0,children:n("Yes")}),(0,a.jsx)($.ZP,{value:!1,children:n("No")})]})})]})}),o]})};var X=l(84567),Q=l(11163);let{TextArea:ee}=c.default,et=e=>{let{reactFlow:t,isSaveFlowModalOpen:l,flowInfo:n,setIsSaveFlowModalOpen:s}=e,{t:i}=(0,j.$G)(),o=(0,Q.useRouter)(),[d]=z.default.useForm(),[u,p]=G.ZP.useMessage(),[m,f]=(0,g.useState)(!1),[v,x]=(0,g.useState)(o.query.id||"");async function h(){let{name:e,label:l,description:a="",editable:c=!1,state:p="deployed"}=d.getFieldsValue(),m=(0,F.Wf)(t.toObject());if(v){let[,,t]=await (0,r.Vx)((0,r.ao)(v.toString(),{name:e,label:l,description:a,editable:c,uid:v.toString(),flow_data:m,state:p,variables:null==n?void 0:n.variables}));(null==t?void 0:t.success)?u.success(i("save_flow_success")):(null==t?void 0:t.err_msg)&&u.error(null==t?void 0:t.err_msg)}else{let[t,s]=await (0,r.Vx)((0,r.zd)({name:e,label:l,description:a,editable:c,flow_data:m,state:p,variables:null==n?void 0:n.variables}));(null==s?void 0:s.uid)&&(u.success(i("save_flow_success")),o.push("/construct/flow/canvas?id=".concat(s.uid),void 0,{shallow:!0}))}s(!1)}return(0,g.useEffect)(()=>{x(o.query.id||"")},[o.query.id]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(T.default,{title:i("flow_modal_title"),open:l,onCancel:()=>s(!1),footer:[(0,a.jsx)(D.ZP,{onClick:()=>s(!1),children:i("cancel")},"cancel"),(0,a.jsx)(D.ZP,{type:"primary",onClick:()=>d.submit(),children:i("verify")},"submit")],children:(0,a.jsxs)(z.default,{name:"flow_form",form:d,labelCol:{span:6},wrapperCol:{span:16},className:"mt-6 max-w-2xl",initialValues:{remember:!0},onFinish:h,autoComplete:"off",children:[(0,a.jsx)(z.default.Item,{label:"Title",name:"label",initialValue:null==n?void 0:n.label,rules:[{required:!0,message:"Please input flow title!"}],children:(0,a.jsx)(c.default,{onChange:function(e){let t=e.target.value,l=t.replace(/\s+/g,"_").replace(/[^a-z0-9_-]/g,"").toLowerCase();d.setFieldsValue({name:l})}})}),(0,a.jsx)(z.default.Item,{label:"Name",name:"name",initialValue:null==n?void 0:n.name,rules:[{required:!0,message:"Please input flow name!"},()=>({validator:(e,t)=>/^[a-zA-Z0-9_\-]+$/.test(t)?Promise.resolve():Promise.reject("Can only contain numbers, letters, underscores, and dashes")})],children:(0,a.jsx)(c.default,{})}),(0,a.jsx)(z.default.Item,{label:"Description",initialValue:null==n?void 0:n.description,name:"description",children:(0,a.jsx)(ee,{rows:3})}),(0,a.jsx)(z.default.Item,{label:"Editable",name:"editable",initialValue:(null==n?void 0:n.editable)||!0,valuePropName:"checked",children:(0,a.jsx)(X.Z,{})}),(0,a.jsx)(z.default.Item,{hidden:!0,name:"state",children:(0,a.jsx)(c.default,{})}),(0,a.jsx)(z.default.Item,{label:"Deploy",children:(0,a.jsx)(X.Z,{defaultChecked:(null==n?void 0:n.state)==="deployed"||(null==n?void 0:n.state)==="running",checked:m,onChange:e=>{let t=e.target.checked;d.setFieldValue("state",t?"deployed":"developing"),f(t)}})})]})}),p]})};var el=l(57132),ea=l(48689),er=l(45605),en=l(55241),es=l(83062),ei=l(25675),eo=l.n(ei),ed=l(36851),ec=e=>{let{children:t,className:l}=e;return(0,a.jsx)("div",{className:h()("flex justify-center items-center w-8 h-8 rounded-full dark:bg-zinc-700 hover:bg-stone-200 dark:hover:bg-zinc-900",l),children:t})},eu=l(45030),ep=l(86738),em=e=>{let{optional:t}=e;return t?null:(0,a.jsx)("span",{className:"text-red-600 align-middle inline-block",children:"\xa0*"})},ef=e=>{let{node:t,data:l,type:r,label:n,index:s}=e,{t:o}=(0,j.$G)(),d=(0,ed._K)(),[c,u]=g.useState([]);function p(){let e=localStorage.getItem(i.zN);if(!e)return;let a=JSON.parse(e),r=l.type_cls,s=[];"inputs"===n?s=a.filter(e=>"operator"===e.flow_type).filter(e=>{var t;return null===(t=e.outputs)||void 0===t?void 0:t.some(e=>e.type_cls===r&&e.is_list===(null==l?void 0:l.is_list))}):"parameters"===n?s=a.filter(e=>"resource"===e.flow_type).filter(e=>{var t;return null===(t=e.parent_cls)||void 0===t?void 0:t.includes(r)}):"outputs"===n&&("operator"===t.flow_type?s=a.filter(e=>"operator"===e.flow_type).filter(e=>{var t;return null===(t=e.inputs)||void 0===t?void 0:t.some(e=>e.type_cls===r&&e.is_list===(null==l?void 0:l.is_list))}):"resource"===t.flow_type&&(s=a.filter(e=>{var l,a;return(null===(l=e.inputs)||void 0===l?void 0:l.some(e=>{var l;return null===(l=t.parent_cls)||void 0===l?void 0:l.includes(e.type_cls)}))||(null===(a=e.parameters)||void 0===a?void 0:a.some(e=>{var l;return null===(l=t.parent_cls)||void 0===l?void 0:l.includes(e.type_cls)}))}))),u(s)}return(0,a.jsxs)("div",{className:h()("relative flex items-center",{"justify-start":"parameters"===n||"inputs"===n,"justify-end":"outputs"===n}),children:[(0,a.jsx)(ed.HH,{className:h()("w-2 h-2","source"===r?"-mr-4":"-ml-4"),type:r,position:"source"===r?ed.Ly.Right:ed.Ly.Left,id:"".concat(t.id,"|").concat(n,"|").concat(s),isValidConnection:e=>(function(e){var t,l;let{sourceHandle:a,targetHandle:r,source:n,target:s}=e,i=d.getNode(n),c=d.getNode(s),{flow_type:u}=null!==(t=null==i?void 0:i.data)&&void 0!==t?t:{},{flow_type:p}=null!==(l=null==c?void 0:c.data)&&void 0!==l?l:{},m=null==a?void 0:a.split("|")[1],f=null==r?void 0:r.split("|")[1],v=null==a?void 0:a.split("|")[2],x=null==r?void 0:r.split("|")[2],h=null==c?void 0:c.data[f][x].type_cls;if(u===p&&"operator"===u){let e=null==i?void 0:i.data[m][v].type_cls,t=null==i?void 0:i.data[m][v].is_list,l=null==c?void 0:c.data[f][x].is_list;return e===h&&t===l}if("resource"===u&&("operator"===p||"resource"===p)){let e=null==i?void 0:i.data.parent_cls;return e.includes(h)}return G.ZP.warning(o("connect_warning")),!1})(e)}),(0,a.jsxs)(eu.Z,{className:h()("bg-white dark:bg-[#232734] w-full px-2 py-1 rounded text-neutral-500",{"text-right":"outputs"===n}),children:[(0,a.jsx)(ep.Z,{placement:"left",icon:null,showCancel:!1,okButtonProps:{className:"hidden"},title:o("related_nodes"),description:(0,a.jsx)("div",{className:"w-60",children:(0,a.jsx)(_,{nodes:c})}),children:["inputs","parameters"].includes(n)&&(0,a.jsx)(P.Z,{className:"cursor-pointer",onClick:p})}),"outputs"!==n&&(0,a.jsx)(em,{optional:l.optional}),l.type_name,l.description&&(0,a.jsx)(es.Z,{title:l.description,children:(0,a.jsx)(er.Z,{className:"ml-2 cursor-pointer"})}),(0,a.jsx)(ep.Z,{placement:"right",icon:null,showCancel:!1,okButtonProps:{className:"hidden"},title:o("related_nodes"),description:(0,a.jsx)("div",{className:"w-60",children:(0,a.jsx)(_,{nodes:c})}),children:["outputs"].includes(n)&&(0,a.jsx)(P.Z,{className:"ml-2 cursor-pointer",onClick:p})})]})]})};let ev=e=>{var t;let l=(0,F.It)((null===(t=e.ui)||void 0===t?void 0:t.attr)||{});return(0,a.jsx)(O.Z,{...l,options:e.options,placeholder:"please select",className:"w-full nodrag"})},ex=e=>{var t,l;let r=(0,F.It)((null===(t=e.ui)||void 0===t?void 0:t.attr)||{});return(null===(l=e.options)||void 0===l?void 0:l.length)>0&&(0,a.jsx)("div",{className:"bg-white p-2 rounded",children:(0,a.jsx)(X.Z.Group,{...r,options:e.options})})};var eh=l(63764);let eg=e=>{var t,l,r,n,s,i,o,d;let{t:c}=(0,j.$G)(),u=(0,F.It)((null===(t=e.ui)||void 0===t?void 0:t.attr)||{}),[p,m]=(0,g.useState)(!1),f=(0,g.useMemo)(()=>{var t,l,a,r;return(null==e?void 0:null===(t=e.ui)||void 0===t?void 0:null===(l=t.editor)||void 0===l?void 0:l.width)?(null==e?void 0:null===(a=e.ui)||void 0===a?void 0:null===(r=a.editor)||void 0===r?void 0:r.width)+100:"80%"},[null==e?void 0:null===(l=e.ui)||void 0===l?void 0:null===(r=l.editor)||void 0===r?void 0:r.width]);return(0,a.jsxs)("div",{className:"p-2 text-sm",children:[(0,a.jsx)(D.ZP,{type:"default",onClick:()=>{m(!0)},children:c("Open_Code_Editor")}),(0,a.jsx)(T.default,{title:c("Code_Editor"),width:f,open:p,onOk:()=>{m(!1)},onCancel:()=>{m(!1)},children:(0,a.jsx)(z.default.Item,{name:null==e?void 0:e.name,children:(0,a.jsx)(eh.ZP,{...u,width:(null==e?void 0:null===(n=e.ui)||void 0===n?void 0:null===(s=n.editor)||void 0===s?void 0:s.width)||"100%",height:(null==e?void 0:null===(i=e.ui)||void 0===i?void 0:null===(o=i.editor)||void 0===o?void 0:o.height)||200,defaultLanguage:null==e?void 0:null===(d=e.ui)||void 0===d?void 0:d.language,theme:"vs-dark",options:{minimap:{enabled:!1},wordWrap:"on"}})})})]})};var ej=l(69935);let eb=e=>{var t;let{data:l,formValuesChange:r}=e,n=(0,F.It)((null===(t=l.ui)||void 0===t?void 0:t.attr)||{});return(0,a.jsx)(ej.default,{onChange:(e,t)=>{r({[l.name]:t})},...n,className:"w-full",placeholder:"please select a date"})};var ew=l(70342);let ey=e=>{let t=e.match(/^icon:(\w+)$/);if(t){let e=t[1],l=ew[e];return l?(0,a.jsx)(l,{}):null}return null},e_=e=>{var t,l,r;let n=(0,F.It)((null===(t=e.ui)||void 0===t?void 0:t.attr)||{});return n.prefix=ey((null===(l=e.ui)||void 0===l?void 0:null===(r=l.attr)||void 0===r?void 0:r.prefix)||""),(0,a.jsx)(c.default,{...n,className:"w-full",placeholder:"please input",allowClear:!0})},{Password:eN}=c.default,eZ=e=>{var t;let l=(0,F.It)((null===(t=e.ui)||void 0===t?void 0:t.attr)||{});return(0,a.jsx)(eN,{...l,placeholder:"input password"})},ek=e=>{var t;let l=(0,F.It)((null===(t=e.ui)||void 0===t?void 0:t.attr)||{});return(0,a.jsx)("div",{className:"bg-white p-2 rounded",children:(0,a.jsx)($.ZP.Group,{...l,options:e.options})})},eC=e=>{var t;let l=(0,F.It)((null==e?void 0:null===(t=e.ui)||void 0===t?void 0:t.attr)||{});return(0,a.jsx)(V.default,{...l,className:"w-full nodrag",placeholder:"please select",options:e.options})};var eI=l(30568);let eS=e=>{var t;let l=(0,F.It)((null===(t=e.ui)||void 0===t?void 0:t.attr)||{});return(0,a.jsx)(a.Fragment,{children:e.is_list?(0,a.jsx)(eI.Z,{range:!0,className:"mt-8 nodrag",...l}):(0,a.jsx)(eI.Z,{className:"mt-8 nodrag",...l})})},{TextArea:eF}=c.default,eP=e=>{var t;let l=(0,F.It)((null===(t=e.ui)||void 0===t?void 0:t.attr)||{});return(0,a.jsx)(eF,{className:"nowheel mb-3",...l})};var eE=l(68351);let eV=e=>{var t;let{data:l,formValuesChange:r}=e,n=(0,F.It)((null===(t=l.ui)||void 0===t?void 0:t.attr)||{});return(0,a.jsx)(eE.Z,{...n,onChange:(e,t)=>{r({time:t},{force:!0})},className:"w-full",placeholder:"please select a moment"})};var ez=l(59847);let eO=e=>{var t;let l=(0,F.It)((null===(t=e.ui)||void 0===t?void 0:t.attr)||{});return(0,a.jsx)(ez.Z,{...l,className:"w-full nodrag",treeDefaultExpandAll:!0,treeData:e.options})};var eA=l(83454);let eD=e=>{var t,l,n,s,i;let{t:o}=(0,j.$G)(),d=(0,g.useRef)([]),{data:c,formValuesChange:u}=e,[p,m]=(0,g.useState)([]);(0,g.useEffect)(()=>{if(c.value){let e=[];"string"==typeof c.value?e.push(c.value):e=c.value;let t={uris:e};(0,r.Jx)(t).then(e=>{let t=[];for(let l=0;l<e.data.data.length;l++){let a=e.data.data[l];t.push({uid:a.file_id,name:a.file_name,status:"done",url:a.uri})}m(t)}).catch(e=>{console.log(e)})}},[]);let f=(0,F.It)((null===(t=c.ui)||void 0===t?void 0:t.attr)||{}),[v,x]=(0,g.useState)(!1),[h,b]=(0,g.useState)(""),w=e=>{d.current.length===c.ui.attr.max_count&&d.current.pop(),d.current.push(e),1===c.ui.attr.max_count?u({[c.name]:d.current.toString()}):u({[c.name]:d.current})},y={name:"files",action:null!==(s=eA.env.API_BASE_URL)&&void 0!==s?s:""+c.ui.action,headers:{authorization:"authorization-text"},defaultFileList:p,onChange(e){x(!0),"uploading"!==e.file.status&&x(!1),"done"===e.file.status?(x(!1),G.ZP.success("".concat(e.file.response.data[0].file_name," ").concat(o("Upload_Data_Successfully"))),w(e.file.response.data[0].uri)):"error"===e.file.status&&(x(!1),G.ZP.error("".concat(e.file.response.data[0].file_name,"  ").concat(o("Upload_Data_Failed"))))}};return!h&&(null===(l=c.ui)||void 0===l?void 0:l.file_types)&&Array.isArray(null===(n=c.ui)||void 0===n?void 0:n.file_types)&&b(null===(i=c.ui)||void 0===i?void 0:i.file_types.toString()),(0,a.jsx)("div",{className:"p-2 text-sm text-center",children:(0,a.jsx)(W.default,{onRemove:e=>{let t=d.current.indexOf(e.response.data[0].uri);-1!==t&&d.current.splice(t,1),x(!1),1===c.ui.attr.max_count?u({[c.name]:d.current.toString()}):u({[c.name]:d.current})},...y,...f,multiple:!!c.is_list,accept:h,children:(0,a.jsx)(D.ZP,{loading:v,icon:(0,a.jsx)(K.Z,{}),children:o("Upload_Data")})})})},eT=e=>{var t;let l=(0,F.It)((null===(t=e.ui)||void 0===t?void 0:t.attr)||{});return(0,a.jsx)(c.default,{...l,className:"w-full",placeholder:"please input",allowClear:!0})};var eL=e=>{let{formValuesChange:t,node:l,paramData:r,label:n,index:s}=e;return"resource"===r.category?(0,a.jsx)(ef,{node:l,data:r,type:"target",label:n,index:s}):"common"===r.category?(null==r?void 0:r.ui)?function(e,t){var l;let{refresh_depends:r,ui_type:n}=e.ui,s=null!==(l=e.value)&&void 0!==l?l:e.default;return"slider"===n&&e.is_list&&(s=[0,1]),(0,a.jsx)(z.default.Item,{className:"mb-2",initialValue:s,name:e.name,rules:[{required:!e.optional}],label:(0,a.jsx)("span",{className:"text-neutral-500",children:e.label}),...r&&{dependencies:r},...e.description&&{tooltip:{title:e.description,icon:(0,a.jsx)(er.Z,{})}},children:function(e,t,l){switch(e){case"select":return eC(t);case"cascader":return ev(t);case"checkbox":return ex(t);case"radio":return ek(t);case"input":return e_(t);case"text_area":return eP(t);case"slider":return eS(t);case"date_picker":return eb({data:t,formValuesChange:l});case"time_picker":return eV({data:t,formValuesChange:l});case"tree_select":return eO(t);case"password":return eZ(t);case"upload":return eD({data:t,formValuesChange:l});case"variables":return eT(t);case"code_editor":return eg(t);default:return null}}(n,e,t)})}(r,t):function(e){var t,l;let r=null!==(t=e.value)&&void 0!==t?t:e.default;switch(e.type_name){case"int":case"float":return(0,a.jsx)(z.default.Item,{className:"mb-2 text-sm",name:e.name,initialValue:r,rules:[{required:!e.optional}],label:(0,a.jsx)("span",{className:"text-neutral-500",children:e.label}),tooltip:e.description?{title:e.description,icon:(0,a.jsx)(er.Z,{})}:"",children:(0,a.jsx)(A.Z,{className:"w-full nodrag"})});case"str":return(0,a.jsx)(z.default.Item,{className:"mb-2 text-sm",name:e.name,initialValue:r,rules:[{required:!e.optional}],label:(0,a.jsx)("span",{className:"text-neutral-500",children:e.label}),tooltip:e.description?{title:e.description,icon:(0,a.jsx)(er.Z,{})}:"",children:(null===(l=e.options)||void 0===l?void 0:l.length)>0?(0,a.jsx)(V.default,{className:"w-full nodrag",options:e.options.map(e=>({label:e.label,value:e.value}))}):(0,a.jsx)(c.default,{className:"w-full"})});case"bool":return r="True"===(r="False"!==r&&r)||r,(0,a.jsx)(z.default.Item,{className:"mb-2 text-sm",name:e.name,initialValue:r,rules:[{required:!e.optional}],label:(0,a.jsx)("span",{className:"text-neutral-500",children:e.label}),tooltip:e.description?{title:e.description,icon:(0,a.jsx)(er.Z,{})}:"",children:(0,a.jsx)(X.Z,{className:"ml-2"})})}}(r):void 0};function eM(e){let{label:t}=e;return(0,a.jsx)("div",{className:"w-full h-8 align-middle font-semibold",children:t})}var eq=l(12906),eR=l(43008),eG=l(57546),e$=l(60219),eJ=l(58638),eB=l(26855),eU=l(96074),eH=l(39332),eK=l(24885),eW=l(59819);l(4583);let eY={customNode:e=>{var t,l,n,s;let{data:i}=e,{inputs:o,outputs:d,parameters:c,flow_type:u}=i,[p,m]=(0,g.useState)(!1),f=(0,ed._K)(),[v]=z.default.useForm();async function x(e,t){let l=c.filter(t=>{var l;let{ui:a}=t;return null==a?void 0:null===(l=a.refresh_depends)||void 0===l?void 0:l.includes(e)});(null==l?void 0:l.length)!==0&&l.forEach(async l=>{let a={id:(0,F._g)(null==i?void 0:i.id),type_name:i.type_name,type_cls:i.type_cls,flow_type:"operator",refresh:[{name:l.name,depends:[{name:e,value:t,has_value:!0}]}]},[n,s]=await (0,r.Vx)((0,r.ks)(a));s&&f.setNodes(e=>e.map(e=>e.id===i.id?{...e,data:{...e.data,parameters:s.parameters}}:e))})}function j(e){let[t,l]=Object.entries(e)[0];c.forEach(e=>{e.name===t&&(e.value=l)}),l&&x(t,l)}return(0,a.jsx)(en.Z,{placement:"rightTop",trigger:["hover"],content:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ec,{className:"hover:text-blue-500",children:(0,a.jsx)(el.Z,{className:"h-full text-lg cursor-pointer",onClick:function(e){e.preventDefault(),e.stopPropagation();let t=f.getNodes(),l=t.find(e=>e.id===i.id);if(l){let e=(0,F.VZ)(l,t),a=(0,L.cloneDeep)(l),r={...a,id:e,position:{x:a.position.x+400,y:a.position.y},positionAbsolute:{x:a.positionAbsolute.x+400,y:a.positionAbsolute.y},data:{...a.data,id:e},selected:!1};f.setNodes(e=>[...e,r])}}})}),(0,a.jsx)(ec,{className:"mt-2 hover:text-red-500",children:(0,a.jsx)(ea.Z,{className:"h-full text-lg cursor-pointer",onClick:function(e){e.preventDefault(),e.stopPropagation(),f.setNodes(e=>e.filter(e=>e.id!==i.id)),f.setEdges(e=>e.filter(e=>e.source!==i.id&&e.target!==i.id))}})}),(0,a.jsx)(ec,{className:"mt-2",children:(0,a.jsx)(es.Z,{title:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("p",{className:"font-bold",children:i.label}),(0,a.jsx)("p",{children:i.description})]}),placement:"right",children:(0,a.jsx)(er.Z,{className:"h-full text-lg cursor-pointer"})})})]}),children:(0,a.jsxs)("div",{className:h()("h-auto rounded-xl shadow-md px-2 py-4 border bg-white dark:bg-zinc-800 cursor-grab flex flex-col space-y-2 text-sm",{"w-80":(null==i?void 0:null===(t=i.tags)||void 0===t?void 0:t.ui_size)==="middle"||!(null==i?void 0:null===(l=i.tags)||void 0===l?void 0:l.ui_size),"w-[256px]":(null==i?void 0:null===(n=i.tags)||void 0===n?void 0:n.ui_size)==="small","w-[530px]":(null==i?void 0:null===(s=i.tags)||void 0===s?void 0:s.ui_size)==="large","border-blue-500":i.selected||p,"border-stone-400 dark:border-white":!i.selected&&!p,"border-dashed":"operator"!==u,"border-red-600":i.invalid}),onMouseEnter:function(){m(!0)},onMouseLeave:function(){m(!1)},children:[(0,a.jsxs)("div",{className:"flex flex-row items-center",children:[(0,a.jsx)(eo(),{src:"/icons/node/vis.png",width:24,height:24,alt:""}),(0,a.jsx)("p",{className:"ml-2 text-lg font-bold text-ellipsis overflow-hidden whitespace-nowrap",children:i.label})]}),(null==o?void 0:o.length)>0&&(0,a.jsxs)("div",{className:"bg-zinc-100 dark:bg-zinc-700 rounded p-2",children:[(0,a.jsx)(eM,{label:"Inputs"}),(0,a.jsx)("div",{className:"flex flex-col space-y-2",children:null==o?void 0:o.map((e,t)=>(0,a.jsx)(ef,{node:i,data:e,type:"target",label:"inputs",index:t},"".concat(i.id,"_input_").concat(t)))})]}),(null==c?void 0:c.length)>0&&(0,a.jsxs)("div",{className:"bg-zinc-100 dark:bg-zinc-700 rounded p-2",children:[(0,a.jsx)(eM,{label:"Parameters"}),(0,a.jsx)(z.default,{form:v,layout:"vertical",onValuesChange:j,className:"flex flex-col space-y-3 text-neutral-500",children:null==c?void 0:c.map((e,t)=>(0,a.jsx)(eL,{formValuesChange:j,node:i,paramData:e,label:"parameters",index:t},"".concat(i.id,"_param_").concat(t)))})]}),"operator"===u&&(null==d?void 0:d.length)>0?(0,a.jsxs)("div",{className:"bg-zinc-100 dark:bg-zinc-700 rounded p-2",children:[(0,a.jsx)(eM,{label:"Outputs"}),null==d?void 0:d.map((e,t)=>(0,a.jsx)(ef,{node:i,data:e,type:"source",label:"outputs",index:t},"".concat(i.id,"_input_").concat(t)))]}):"resource"===u?(0,a.jsxs)("div",{className:"bg-zinc-100 dark:bg-zinc-700 rounded p-2",children:[(0,a.jsx)(eM,{label:"Outputs"}),(0,a.jsx)(ef,{node:i,data:i,type:"source",label:"outputs",index:0},"".concat(i.id,"_input_0"))]}):void 0]})})}},eX={buttonedge:S.Z},eQ=()=>{let{t:e}=(0,j.$G)(),t=(0,eH.useSearchParams)(),l=(null==t?void 0:t.get("id"))||"",s=(0,ed._K)(),[i,o]=G.ZP.useMessage(),d=(0,g.useRef)(null),[c,u,p]=(0,ed.Rr)([]),[f,v,x]=(0,ed.ll)([]),[h,b]=(0,g.useState)(),[w,y]=(0,g.useState)(!1),[_,N]=(0,g.useState)(!1),[Z,k]=(0,g.useState)(!1),[C,S]=(0,g.useState)(!1),[P,E]=(0,g.useState)(!1);if(localStorage.getItem("importFlowData")){let e=JSON.parse(localStorage.getItem("importFlowData")||"");localStorage.removeItem("importFlowData"),y(!0);let t=(0,F.z5)(e.flow_data);b(e),u(t.nodes),v(t.edges),y(!1)}async function V(){y(!0);let[e,t]=await (0,r.Vx)((0,r._d)(l));if(t){let e=(0,F.z5)(t.flow_data);b(t),u(e.nodes),v(e.edges)}y(!1)}(0,g.useEffect)(()=>{l&&V()},[l]),(0,g.useEffect)(()=>{let e=e=>{e.returnValue=G.ZP};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}},[]);let z=(0,g.useCallback)(e=>{var t,l;e.preventDefault();let a=d.current.getBoundingClientRect(),r=null===(t=null===(l=document.getElementsByClassName("ant-layout-sider"))||void 0===l?void 0:l[0])||void 0===t?void 0:t.offsetWidth,n=e.dataTransfer.getData("application/reactflow");if(!n||void 0===n)return;let i=JSON.parse(n),o=s.screenToFlowPosition({x:e.clientX-a.left+r,y:e.clientY-a.top}),c=(0,F.VZ)(i,s.getNodes());i.id=c;let p={id:c,position:o,type:"customNode",data:i};u(e=>e.concat(p).map(e=>(e.id===p.id?e.data={...e.data,selected:!0}:e.data={...e.data,selected:!1},e)))},[s]),O=(0,g.useCallback)(e=>{e.preventDefault(),e.dataTransfer.dropEffect="move"},[]);function A(){let t=s.toObject(),[l,r,n]=(0,F.Rv)(t);if(!r){i.open({type:"warning",content:e("Please_Add_Nodes_First")});return}if(!l&&n)return u(e=>e.map(e=>({...e,data:{...e.data,invalid:e.id===(null==r?void 0:r.id)}}))),eB.ZP.error({message:"Error",description:n,icon:(0,a.jsx)(eq.Z,{className:"text-red-600"})});N(!0)}return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex flex-row",children:[(0,a.jsx)(I,{}),(0,a.jsxs)("div",{className:"flex flex-col flex-1",children:[(0,a.jsx)(m.Z,{className:"my-2 mx-4 flex flex-row justify-end",children:(()=>{let t=[{title:e("template"),icon:(0,a.jsx)(eR.Z,{className:"block text-xl",onClick:()=>E(!0)})},{title:e("Import"),icon:(0,a.jsx)(eG.Z,{className:"block text-xl",onClick:()=>S(!0)})},{title:e("save"),icon:(0,a.jsx)(e$.Z,{className:"block text-xl",onClick:A})}];return""!==l&&t.unshift({title:e("Export"),icon:(0,a.jsx)(eJ.Z,{className:"block text-xl",onClick:()=>k(!0)})}),t})().map(e=>{let{title:t,icon:l}=e;return(0,a.jsx)(es.Z,{title:t,className:"w-8 h-8 rounded-md bg-stone-300 dark:bg-zinc-700 dark:text-zinc-200 hover:text-blue-500 dark:hover:text-zinc-100",children:l},t)})}),(0,a.jsx)(eU.Z,{className:"mt-0 mb-0"}),(0,a.jsx)("div",{className:"h-[calc(100vh-48px)] w-full",ref:d,children:(0,a.jsxs)(ed.x$,{nodes:c,edges:f,nodeTypes:eY,edgeTypes:eX,onNodesChange:p,onEdgesChange:x,onNodeClick:function(e,t){s.setNodes(e=>e.map(e=>(e.id===t.id?e.data={...e.data,selected:!0}:e.data={...e.data,selected:!1},e)))},onConnect:function(e){let t={...e,type:"buttonedge",id:"".concat(e.source,"|").concat(e.target)};v(e=>(0,ed.Z_)(t,e))},onDrop:z,onDragOver:O,minZoom:.1,fitView:!0,deleteKeyCode:["Backspace","Delete"],children:[(0,a.jsx)(eK.Z,{className:"flex flex-row items-center",position:"bottom-center"}),(0,a.jsx)(eW.A,{color:"#aaa",gap:16}),(0,a.jsx)(R,{flowInfo:h,setFlowInfo:b})]})})]})]}),(0,a.jsx)(n.Z,{visible:w}),(0,a.jsx)(et,{reactFlow:s,flowInfo:h,isSaveFlowModalOpen:_,setIsSaveFlowModalOpen:N}),(0,a.jsx)(B,{reactFlow:s,flowInfo:h,isExportFlowModalOpen:Z,setIsExportFlowModalOpen:k}),(0,a.jsx)(Y,{setNodes:u,setEdges:v,isImportModalOpen:C,setIsImportFlowModalOpen:S}),(0,a.jsx)(H,{isFlowTemplateModalOpen:P,setIsFlowTemplateModalOpen:E}),o]})};function e0(){return(0,a.jsx)(ed.tV,{children:(0,a.jsx)(eQ,{})})}},67919:function(e,t,l){"use strict";l.d(t,{Av:function(){return d},It:function(){return o},Rv:function(){return i},VZ:function(){return a},Wf:function(){return n},_g:function(){return r},z5:function(){return s}});let a=(e,t)=>{let l=0;return t.forEach(t=>{t.data.name===e.name&&l++}),"".concat(e.id,"_").concat(l)},r=e=>e.replace(/_\d+$/,""),n=e=>{let{nodes:t,edges:l,...a}=e,r=t.map(e=>{let{positionAbsolute:t,...l}=e;return{position_absolute:t,...l}}),n=l.map(e=>{let{sourceHandle:t,targetHandle:l,...a}=e;return{source_handle:t,target_handle:l,...a}});return{nodes:r,edges:n,...a}},s=e=>{let{nodes:t,edges:l,...a}=e,r=t.map(e=>{let{position_absolute:t,...l}=e;return{positionAbsolute:t,...l}}),n=l.map(e=>{let{source_handle:t,target_handle:l,...a}=e;return{sourceHandle:t,targetHandle:l,...a}});return{nodes:r,edges:n,...a}},i=e=>{let{nodes:t,edges:l}=e,a=[!0,t[0],""];e:for(let e=0;e<t.length;e++){let r=t[e].data,{inputs:n=[],parameters:s=[]}=r;for(let s=0;s<n.length;s++)if(!l.some(l=>l.targetHandle==="".concat(t[e].id,"|inputs|").concat(s))){a=[!1,t[e],"The input ".concat(n[s].type_name," of node ").concat(r.label," is required")];break e}for(let n=0;n<s.length;n++){let i=s[n];if(i.optional||"resource"!==i.category||l.some(l=>l.targetHandle==="".concat(t[e].id,"|parameters|").concat(n))){if(!i.optional&&"common"===i.category&&(void 0===i.value||null===i.value)){a=[!1,t[e],"The parameter ".concat(i.type_name," of node ").concat(r.label," is required")];break e}}else{a=[!1,t[e],"The parameter ".concat(i.type_name," of node ").concat(r.label," is required")];break e}}}return a},o=e=>(function e(t){if(Array.isArray(t))return t.map(t=>e(t));if(t&&"object"==typeof t&&!Array.isArray(t)){let l={};for(let a in t)if(Object.prototype.hasOwnProperty.call(t,a)){let r=a.replace(/_([a-z])/g,(e,t)=>t.toUpperCase());l[r]=e(t[a])}return l}return t})(e);function d(e){let t=new Set(["@","#","%",":"]),l={key:e.key||"",name:e.name||"",scope:e.scope||"",scope_key:e.scope_key||"",sys_code:e.sys_code||"",user_name:e.user_name||""};for(let[e,a]of Object.entries(l))a&&[...t].some(e=>a.includes(e))&&(l[e]=a.replace(/@/g,"\\@").replace(/#/g,"\\#").replace(/%/g,"\\%").replace(/:/g,"\\:"));let{key:a,name:r,scope:n,scope_key:s,sys_code:i,user_name:o}=l,d="".concat(a);return r&&(d+="".concat(":").concat(r)),(n||s)&&(d+="".concat("@").concat(n),s&&(d+="".concat(":").concat(s))),i&&(d+="".concat("#").concat(i)),o&&(d+="".concat("%").concat(o)),"${".concat(d,"}")}}},function(e){e.O(0,[3662,8241,2648,3791,2913,5278,8791,4330,1049,5030,4041,9859,3799,2684,1300,4567,9773,3457,5782,7873,3764,1278,1010,2070,9774,2888,179],function(){return e(e.s=94617)}),_N_E=e.O()}]);