(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4554],{45629:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/construct/knowledge",function(){return a(33408)}])},85070:function(e,t,a){"use strict";var n=a(85893);a(67294);var l=a(28459),s=a(92398),o=a(36609),c=a(41156),i=a(9641),d=a(16165),r=a(9020),p=a(92962),m=a(50067),h=a(38545),u=a(82353),x=a(11163);a(66546),t.Z=function(e){let{children:t}=e,a=[{key:"app",name:(0,o.t)("App"),path:"/app",icon:(0,n.jsx)(c.Z,{})},{key:"flow",name:(0,o.t)("awel_flow"),icon:(0,n.jsx)(i.Z,{}),path:"/flow"},{key:"models",name:(0,o.t)("model_manage"),path:"/models",icon:(0,n.jsx)(d.Z,{component:u.IN})},{key:"database",name:(0,o.t)("Database"),icon:(0,n.jsx)(r.Z,{}),path:"/database"},{key:"knowledge",name:(0,o.t)("Knowledge_Space"),icon:(0,n.jsx)(p.Z,{}),path:"/knowledge"},{key:"agent",name:(0,o.t)("Plugins"),path:"/agent",icon:(0,n.jsx)(m.Z,{})},{key:"prompt",name:(0,o.t)("Prompt"),icon:(0,n.jsx)(h.Z,{}),path:"/prompt"}],g=(0,x.useRouter)(),f=g.pathname.split("/")[2];return window.matchMedia("(prefers-color-scheme: dark)").matches,(0,n.jsx)("div",{className:"flex flex-col h-full w-full  dark:bg-gradient-dark bg-gradient-light bg-cover bg-center",children:(0,n.jsx)(l.ZP,{theme:{components:{Button:{},Segmented:{itemSelectedBg:"#2867f5",itemSelectedColor:"white"}}},children:(0,n.jsx)(s.Z,{activeKey:f,items:a.map(e=>({key:e.key,label:e.name,children:t,icon:e.icon})),onTabClick:e=>{g.push("/construct/".concat(e))}})})})}},33408:function(e,t,a){"use strict";a.r(t);var n=a(85893),l=a(91364),s=a(85070),o=a(41468),c=a(76212),i=a(28001),d=a(10283),r=a(69155),p=a(43257),m=a(88700),h=a(28058),u=a(68795),x=a(24969),g=a(14079),f=a(85576),_=a(75081),j=a(79531),w=a(14726),k=a(66309),y=a(3363),v=a(93967),N=a.n(v),b=a(96486),S=a(30381),Z=a.n(S),C=a(11163),T=a(67294),D=a(67421);t.default=()=>{let{setCurrentDialogInfo:e}=(0,T.useContext)(o.p),[t,a]=(0,T.useState)([]),[v,S]=(0,T.useState)(!1),[O,P]=(0,T.useState)(!1),[E,K]=(0,T.useState)(),[B,R]=(0,T.useState)(0),[V,I]=(0,T.useState)(""),[F,X]=(0,T.useState)([]),[A,G]=(0,T.useState)(""),[H,J]=(0,T.useState)(""),[L,M]=(0,T.useState)(!1),[U,W]=(0,T.useState)(null),{t:Y}=(0,D.$G)(),$=[{title:Y("Knowledge_Space_Config")},{title:Y("Choose_a_Datasource_type")},{title:Y("Upload")},{title:Y("Segmentation")}],q=(0,C.useRouter)();async function z(e){M(!0);let[t,n]=await (0,c.Vx)((0,c.Vm)({...e}));M(!1),a(n)}async function Q(){let[e,t]=await (0,c.Vx)((0,c.mB)());if(!t)return null;W(t.storage)}(0,T.useEffect)(()=>{z(),Q()},[]);let ee=async t=>{let[a,n]=await (0,c.Vx)((0,c.sW)({chat_mode:"chat_knowledge"}));(null==n?void 0:n.conv_uid)&&(null==e||e({chat_scene:n.chat_mode,app_code:n.chat_mode}),localStorage.setItem("cur_dialog_info",JSON.stringify({chat_scene:n.chat_mode,app_code:n.chat_mode})),q.push("/chat?scene=chat_knowledge&id=".concat(null==n?void 0:n.conv_uid,"&knowledge_id=").concat(t.name)))},et=e=>{let{label:t,spaceName:a,docType:n,files:l}=e;"finish"===t?(S(!1),z(),I(""),G(""),J("finish"),localStorage.removeItem("cur_space_id")):"forward"===t?(0===B&&z(),R(e=>e+1)):R(e=>e-1),l&&X(l),a&&I(a),n&&G(n)},ea=e=>{f.default.confirm({title:Y("Tips"),icon:(0,n.jsx)(h.Z,{}),content:"".concat(Y("Del_Knowledge_Tips"),"?"),okText:"Yes",okType:"danger",cancelText:"No",async onOk(){await (0,c.Vx)((0,c.XK)({name:null==e?void 0:e.name})),z()}})},en=async e=>{z({name:e.target.value})};return(0,n.jsx)(s.Z,{children:(0,n.jsxs)(_.Z,{spinning:L,children:[(0,n.jsxs)("div",{className:"page-body p-4 md:p-6 h-[90vh] overflow-auto",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,n.jsx)("div",{className:"flex items-center gap-4",children:(0,n.jsx)(j.default,{variant:"filled",prefix:(0,n.jsx)(u.Z,{}),placeholder:Y("please_enter_the_keywords"),onChange:(0,b.debounce)(en,300),allowClear:!0,className:"w-[230px] h-[40px] border-1 border-white backdrop-filter backdrop-blur-lg bg-white bg-opacity-30 dark:border-[#6f7f95] dark:bg-[#6f7f95] dark:bg-opacity-60"})}),(0,n.jsx)("div",{className:"flex items-center gap-4",children:(0,n.jsx)(w.ZP,{className:"border-none text-white bg-button-gradient",icon:(0,n.jsx)(x.Z,{}),onClick:()=>{S(!0)},children:Y("create_knowledge")})})]}),(0,n.jsx)("div",{className:"flex flex-wrap mt-4 mx-[-8px]",children:null==t?void 0:t.map(e=>(0,n.jsx)(l.ZP,{onClick:()=>{K(e),P(!0),localStorage.setItem("cur_space_id",JSON.stringify(e.id))},description:e.desc,name:e.name,logo:"FinancialReport"===e.domain_type?"/models/fin_report.jpg":"KnowledgeGraph"===e.vector_type?"/models/knowledge-graph.png":"FullText"===e.vector_type?"/models/knowledge-full-text.jpg":"/models/knowledge-default.jpg",RightTop:(0,n.jsx)(l.ZS,{menu:{items:[{key:"del",label:(0,n.jsx)("span",{className:"text-red-400",onClick:()=>ea(e),children:Y("Delete")})}]}}),rightTopHover:!1,Tags:(0,n.jsxs)("div",{className:"flex item-center",children:[(0,n.jsx)(k.Z,{children:(0,n.jsxs)("span",{className:"flex items-center gap-1",children:[(0,n.jsx)(g.Z,{className:"mt-[1px]"}),e.docs]})}),(0,n.jsx)(k.Z,{children:(0,n.jsx)("span",{className:"flex items-center gap-1",children:e.domain_type||"Normal"})}),e.vector_type?(0,n.jsx)(k.Z,{children:(0,n.jsx)("span",{className:"flex items-center gap-1",children:e.vector_type})}):null]}),LeftBottom:(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)("span",{children:e.owner}),(0,n.jsx)("span",{children:"â€¢"}),(null==e?void 0:e.gmt_modified)&&(0,n.jsx)("span",{children:Z()(null==e?void 0:e.gmt_modified).fromNow()+" "+Y("update")})]}),RightBottom:(0,n.jsx)(l.TH,{text:Y("start_chat"),onClick:()=>{ee(e)}})},e.id))})]}),(0,n.jsx)(f.default,{className:"h-5/6 overflow-hidden",open:O,width:"70%",onCancel:()=>P(!1),footer:null,destroyOnClose:!0,children:(0,n.jsx)(i.Z,{space:E,onAddDoc:function(e){I(e),R(1),S(!0),J("start")},onDeleteDoc:z,addStatus:H})}),(0,n.jsxs)(f.default,{title:Y("New_knowledge_base"),centered:!0,open:v,destroyOnClose:!0,onCancel:()=>{S(!1)},width:1e3,afterClose:()=>{R(0),z()},footer:null,children:[(0,n.jsx)(y.Z,{current:B,items:$}),0===B&&(0,n.jsx)(m.Z,{handleStepChange:et,spaceConfig:U}),1===B&&(0,n.jsx)(d.Z,{handleStepChange:et}),(0,n.jsx)(r.Z,{className:N()({hidden:2!==B}),spaceName:V,docType:A,handleStepChange:et}),3===B&&(0,n.jsx)(p.Z,{spaceName:V,docType:A,uploadFiles:F,handleStepChange:et})]})]})})}},66546:function(){}},function(e){e.O(0,[3662,7034,7779,3791,7656,2913,5081,8791,1203,6184,9859,2850,2398,4567,9169,1980,418,7434,8047,3106,5265,2783,3761,7582,9946,7263,1696,7906,9071,342,9774,2888,179],function(){return e(e.s=45629)}),_N_E=e.O()}]);