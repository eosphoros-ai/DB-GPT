(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[657],{31988:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/construct/flow",function(){return a(18419)}])},76592:function(e,t,a){"use strict";var l=a(96469),s=a(6889),n=a(27691),i=a(26869),c=a.n(i),r=a(56841);t.Z=function(e){let{className:t,error:a,description:i,refresh:o}=e,{t:d}=(0,r.$G)();return(0,l.jsx)(s.Z,{image:"/empty.png",imageStyle:{width:320,height:196,margin:"0 auto",maxWidth:"100%",maxHeight:"100%"},className:c()("flex items-center justify-center flex-col h-full w-full",t),description:a?(0,l.jsx)(n.ZP,{type:"primary",onClick:o,children:d("try_again")}):null!=i?i:d("no_data")})}},26953:function(e,t,a){"use strict";var l=a(96469),s=a(67901),n=a(42834),i=a(38497);t.Z=e=>{let{width:t,height:a,scene:c}=e,r=(0,i.useCallback)(()=>{switch(c){case"chat_knowledge":return s.je;case"chat_with_db_execute":return s.zM;case"chat_excel":return s.DL;case"chat_with_db_qa":case"chat_dba":return s.RD;case"chat_dashboard":return s.In;case"chat_agent":return s.si;case"chat_normal":return s.O7;default:return}},[c]);return(0,l.jsx)(n.Z,{className:"w-".concat(t||7," h-").concat(a||7),component:r()})}},52903:function(e,t,a){"use strict";a.d(t,{TH:function(){return p},ZS:function(){return f}});var l=a(96469),s=a(52896),n=a(60205),i=a(87674),c=a(85851),r=a(80335),o=a(26869),d=a.n(o),u=a(83930),h=a(23852),m=a.n(h);a(38497);var x=a(26953);a(96768);let p=e=>{let{onClick:t,Icon:a="/pictures/card_chat.png",text:s=(0,u.t)("start_chat")}=e;return"string"==typeof a&&(a=(0,l.jsx)(m(),{src:a,alt:a,width:17,height:15})),(0,l.jsxs)("div",{className:"flex items-center gap-1 text-default",onClick:e=>{e.stopPropagation(),t&&t()},children:[a,(0,l.jsx)("span",{children:s})]})},f=e=>{let{menu:t}=e;return(0,l.jsx)(r.Z,{menu:t,getPopupContainer:e=>e.parentNode,placement:"bottomRight",autoAdjustOverflow:!1,children:(0,l.jsx)(s.Z,{className:"p-2 hover:bg-white hover:dark:bg-black rounded-md"})})};t.ZP=e=>{let{RightTop:t,Tags:a,LeftBottom:s,RightBottom:r,onClick:o,rightTopHover:u=!0,logo:h,name:p,description:f,className:g,scene:j,code:b}=e;return"string"==typeof f&&(f=(0,l.jsx)("p",{className:"line-clamp-2 relative bottom-4 text-ellipsis min-h-[42px] text-sm text-[#525964] dark:text-[rgba(255,255,255,0.65)]",children:f})),(0,l.jsx)("div",{className:d()("hover-underline-gradient flex justify-center mt-6 relative group w-1/3 px-2 mb-6",g),children:(0,l.jsxs)("div",{onClick:o,className:"backdrop-filter backdrop-blur-lg cursor-pointer  bg-white bg-opacity-70 border-2 border-white rounded-lg shadow p-4 relative w-full h-full dark:border-[#6f7f95] dark:bg-[#6f7f95] dark:bg-opacity-60",children:[(0,l.jsxs)("div",{className:"flex items-end relative bottom-8 justify-between w-full",children:[(0,l.jsxs)("div",{className:"flex items-end gap-4 w-11/12  flex-1",children:[(0,l.jsx)("div",{className:"bg-white rounded-lg shadow-sm w-14 h-14 flex items-center p-3",children:j?(0,l.jsx)(x.Z,{scene:j,width:14,height:14}):h&&(0,l.jsx)(m(),{src:h,width:44,height:44,alt:p,className:"w-8 min-w-8 rounded-full max-w-none"})}),(0,l.jsx)("div",{className:"flex-1",children:p.length>6?(0,l.jsx)(n.Z,{title:p,children:(0,l.jsx)("span",{className:"line-clamp-1 text-ellipsis font-semibold text-base",style:{maxWidth:"60%"},children:p})}):(0,l.jsx)("span",{className:"line-clamp-1 text-ellipsis font-semibold text-base",style:{maxWidth:"60%"},children:p})})]}),(0,l.jsx)("span",{className:d()("shrink-0",{hidden:u,"group-hover:block":u}),onClick:e=>{e.stopPropagation()},children:t})]}),f,(0,l.jsx)("div",{className:"relative bottom-2",children:a}),(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsx)("div",{children:s}),(0,l.jsx)("div",{children:r})]}),b&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(i.Z,{className:"my-3"}),(0,l.jsx)(c.Z.Text,{copyable:!0,className:"absolute bottom-1 right-4 text-xs text-gray-500",children:b})]})]})})}},86059:function(e,t,a){"use strict";var l=a(96469),s=a(67901),n=a(31183),i=a(51382),c=a(42834),r=a(43738),o=a(92026),d=a(61760),u=a(94918),h=a(42518),m=a(5996),x=a(83930),p=a(87313);a(38497),a(41748),t.Z=function(e){let{children:t}=e,a=[{key:"app",name:(0,x.t)("App"),path:"/app",icon:(0,l.jsx)(n.Z,{})},{key:"flow",name:(0,x.t)("awel_flow"),icon:(0,l.jsx)(i.Z,{}),path:"/flow"},{key:"models",name:(0,x.t)("model_manage"),path:"/models",icon:(0,l.jsx)(c.Z,{component:s.IN})},{key:"database",name:(0,x.t)("Database"),icon:(0,l.jsx)(r.Z,{}),path:"/database"},{key:"knowledge",name:(0,x.t)("Knowledge_Space"),icon:(0,l.jsx)(o.Z,{}),path:"/knowledge"},{key:"prompt",name:(0,x.t)("Prompt"),icon:(0,l.jsx)(d.Z,{}),path:"/prompt"},{key:"dbgpts",name:(0,x.t)("dbgpts_community"),path:"/dbgpts",icon:(0,l.jsx)(u.Z,{})}],f=(0,p.useRouter)(),g=f.pathname.split("/")[2];return(0,l.jsx)("div",{className:"flex flex-col h-full w-full  dark:bg-gradient-dark bg-gradient-light bg-cover bg-center",children:(0,l.jsx)(h.ZP,{theme:{components:{Button:{},Segmented:{itemSelectedBg:"#2867f5",itemSelectedColor:"white"}}},children:(0,l.jsx)(m.Z,{activeKey:g,items:a.map(e=>({key:e.key,label:e.name,children:t,icon:e.icon})),onTabClick:e=>{f.push("/construct/".concat(e))}})})})}},18419:function(e,t,a){"use strict";a.r(t);var l=a(96469),s=a(45277),n=a(27623),i=a(76592),c=a(52903),r=a(86059),o=a(97511),d=a(16602),u=a(70351),h=a(55360),m=a(42786),x=a(27691),p=a(13419),f=a(49030),g=a(91320),j=a(79839),b=a(71841),w=a(29223),v=a(83930),y=a(61671),_=a.n(y),k=a(87313),N=a(97323),Z=a.n(N),C=a(38497),P=a(56841);t.default=function(){var e,t;let a=(0,k.useRouter)(),{model:y}=(0,C.useContext)(s.p),[N]=u.ZP.useMessage(),[S]=h.default.useForm(),[T,E]=(0,C.useState)([]),R=(0,C.useRef)(),[B,W]=(0,C.useState)(!1),[F,I]=(0,C.useState)(!1),[V,q]=(0,C.useState)(!1),D=(0,C.useRef)(),O=(0,C.useRef)(null),{run:z,loading:A}=(0,d.Z)(async e=>await (0,n.Vx)((0,n.Wf)({page:1,page_size:12,...e})),{cacheKey:"query-flow-list",onSuccess:e=>{let[,t]=e;E((null==t?void 0:t.items)||[]),D.current={current_page:(null==t?void 0:t.page)||1,total_count:(null==t?void 0:t.total_count)||0,total_page:(null==t?void 0:t.total_pages)||0}},throttleWait:300}),{i18n:H}=(0,P.$G)(),L=async e=>{let[,t]=await (0,n.Vx)((0,n.sW)({chat_mode:"chat_agent"}));if(t){let l=Z().stringify({scene:"chat_flow",id:t.conv_uid,model:y,select_param:e.uid});a.push("/chat?".concat(l))}};async function G(e){let[,,t]=await (0,n.Vx)((0,n.Jq)(e.uid));(null==t?void 0:t.success)&&E(t=>t.filter(t=>t.uid!==e.uid))}let K=e=>{R.current=e,S.setFieldValue("label","".concat(e.label," Copy")),S.setFieldValue("name","".concat(e.name,"_copy")),q(!0),W(!0)},M=async e=>{if(!R.current)return;let{source:t,uid:a,dag_id:l,gmt_created:s,gmt_modified:i,state:c,...r}=R.current,o={...r,editable:V,state:F?"deployed":"developing",...e},[d]=await (0,n.Vx)((0,n.zd)(o));d||(N.success((0,v.t)("save_flow_success")),W(!1),z({}))};return(0,l.jsxs)(r.Z,{children:[(0,l.jsx)(m.Z,{spinning:A,children:(0,l.jsxs)("div",{className:"relative h-screen w-full p-4 md:p-6 overflow-y-auto",ref:O,children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,l.jsx)("div",{className:"flex items-center gap-4"}),(0,l.jsx)("div",{className:"flex items-center gap-4",children:(0,l.jsx)(x.ZP,{className:"border-none text-white bg-button-gradient",icon:(0,l.jsx)(o.Z,{}),onClick:()=>{a.push("/construct/flow/canvas")},children:(0,v.t)("create_flow")})})]}),(0,l.jsxs)("div",{className:"flex flex-wrap mx-[-8px] pb-12 justify-start items-stretch",children:[T.map(e=>(0,l.jsx)(c.ZP,{description:e.description,name:e.name,logo:"/pictures/flow.png",onClick:()=>{a.push("/construct/flow/canvas?id="+e.uid)},RightTop:(0,l.jsx)(c.ZS,{menu:{items:[{key:"copy",label:(0,l.jsx)("span",{onClick:()=>{K(e)},children:(0,v.t)("Copy_Btn")})},{key:"del",label:(0,l.jsx)(p.Z,{title:"Are you sure to delete this flow?",onConfirm:()=>G(e),children:(0,l.jsx)("span",{className:"text-red-400",children:(0,v.t)("Delete_Btn")})})}]}}),rightTopHover:!1,Tags:(0,l.jsxs)("div",{children:[(0,l.jsx)(f.Z,{color:"DBGPT-WEB"===e.source?"green":"blue",children:e.source}),(0,l.jsx)(f.Z,{color:e.editable?"green":"gray",children:e.editable?"Editable":"Can not Edit"}),(0,l.jsx)(f.Z,{color:"load_failed"===e.state?"red":"running"===e.state?"green":"blue",children:e.state})]}),LeftBottom:(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)("span",{children:null==e?void 0:e.nick_name}),(0,l.jsx)("span",{children:"â€¢"}),(null==e?void 0:e.gmt_modified)&&(0,l.jsx)("span",{children:_()(null==e?void 0:e.gmt_modified).fromNow()+" "+(0,v.t)("update")})]},H.language+"flow"),RightBottom:(0,l.jsx)(c.TH,{onClick:()=>{L(e)},text:(0,v.t)("start_chat")})},e.uid)),0===T.length&&(0,l.jsx)(i.Z,{description:"No flow found"}),(0,l.jsx)("div",{className:"w-full flex justify-end shrink-0 pb-12",children:(0,l.jsx)(g.Z,{total:(null===(e=D.current)||void 0===e?void 0:e.total_count)||0,pageSize:12,current:null===(t=D.current)||void 0===t?void 0:t.current_page,onChange:async(e,t)=>{await z({page:e,page_size:t})}})})]})]})}),(0,l.jsx)(j.default,{open:B,destroyOnClose:!0,title:"Copy AWEL Flow",onCancel:()=>{W(!1)},footer:!1,children:(0,l.jsxs)(h.default,{form:S,onFinish:M,className:"mt-6",children:[(0,l.jsx)(h.default.Item,{name:"name",label:"Name",rules:[{required:!0}],children:(0,l.jsx)(b.default,{})}),(0,l.jsx)(h.default.Item,{name:"label",label:"Label",rules:[{required:!0}],children:(0,l.jsx)(b.default,{})}),(0,l.jsx)(h.default.Item,{label:"editable",children:(0,l.jsx)(w.Z,{value:V,checked:V,onChange:e=>{let t=e.target.checked;q(t)}})}),(0,l.jsx)(h.default.Item,{label:"deploy",children:(0,l.jsx)(w.Z,{value:F,checked:F,onChange:e=>{let t=e.target.checked;I(t)}})}),(0,l.jsx)("div",{className:"flex justify-end",children:(0,l.jsx)(x.ZP,{type:"primary",htmlType:"submit",children:(0,v.t)("Submit")})})]})})]})}},96768:function(){},41748:function(){}},function(e){e.O(0,[2394,2003,5677,1841,5722,2786,3223,5851,9069,5996,5360,1320,9223,5103,9774,2888,179],function(){return e(e.s=31988)}),_N_E=e.O()}]);