(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[645],{3125:function(t,e,i){"use strict";i.d(e,{Z:function(){return o}});var n=i(42096),r=i(38497),s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M793 242H366v-74c0-6.7-7.7-10.4-12.9-6.3l-142 112a8 8 0 000 12.6l142 112c5.2 4.1 12.9.4 12.9-6.3v-74h415v470H175c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h618c35.3 0 64-28.7 64-64V306c0-35.3-28.7-64-64-64z"}}]},name:"rollback",theme:"outlined"},a=i(55032),o=r.forwardRef(function(t,e){return r.createElement(a.Z,(0,n.Z)({},t,{ref:e,icon:s}))})},51405:function(t){"undefined"!=typeof self&&self,t.exports=function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=5)}([function(t,e){t.exports={assign:Object.assign,getHeight:function(t,e,i,n){return void 0===n&&(n="height"),"center"===i?(t[n]+e[n])/2:t.height}}},function(t,e,i){var n=i(3),r=function(){function t(t,e){void 0===e&&(e={}),this.options=e,this.rootNode=n(t,e)}return t.prototype.execute=function(){throw Error("please override this method")},t}();t.exports=r},function(t,e,i){var n=i(4),r=["LR","RL","TB","BT","H","V"],s=["LR","RL","H"],a=r[0];t.exports=function(t,e,i){var o=e.direction||a;if(e.isHorizontal=s.indexOf(o)>-1,o&&-1===r.indexOf(o))throw TypeError("Invalid direction: "+o);if(o===r[0])i(t,e);else if(o===r[1])i(t,e),t.right2left();else if(o===r[2])i(t,e);else if(o===r[3])i(t,e),t.bottom2top();else if(o===r[4]||o===r[5]){var l=n(t,e),h=l.left,c=l.right;i(h,e),i(c,e),e.isHorizontal?h.right2left():h.bottom2top(),c.translate(h.x-c.x,h.y-c.y),t.x=h.x,t.y=c.y;var d=t.getBoundingBox();e.isHorizontal?d.top<0&&t.translate(0,-d.top):d.left<0&&t.translate(-d.left,0)}var u=e.fixedRoot;return void 0===u&&(u=!0),u&&t.translate(-(t.x+t.width/2+t.hgap),-(t.y+t.height/2+t.vgap)),function(t,e){if(e.radial){var i=e.isHorizontal?["x","y"]:["y","x"],n=i[0],r=i[1],s={x:1/0,y:1/0},a={x:-1/0,y:-1/0},o=0;t.DFTraverse(function(t){o++;var e=t.x,i=t.y;s.x=Math.min(s.x,e),s.y=Math.min(s.y,i),a.x=Math.max(a.x,e),a.y=Math.max(a.y,i)});var l=a[r]-s[r];if(0!==l){var h=2*Math.PI/o;t.DFTraverse(function(e){var i=(e[r]-s[r])/l*(2*Math.PI-h)+h,a=e[n]-t[n];e.x=Math.cos(i)*a,e.y=Math.sin(i)*a})}}}(t,e),t}},function(t,e,i){var n=i(0),r={getId:function(t){return t.id||t.name},getPreH:function(t){return t.preH||0},getPreV:function(t){return t.preV||0},getHGap:function(t){return t.hgap||18},getVGap:function(t){return t.vgap||18},getChildren:function(t){return t.children},getHeight:function(t){return t.height||36},getWidth:function(t){var e=t.label||" ";return t.width||18*e.split("").length}};function s(t,e){if(this.vgap=this.hgap=0,t instanceof s)return t;this.data=t;var i=e.getHGap(t),n=e.getVGap(t);return this.preH=e.getPreH(t),this.preV=e.getPreV(t),this.width=e.getWidth(t),this.height=e.getHeight(t),this.width+=this.preH,this.height+=this.preV,this.id=e.getId(t),this.x=this.y=0,this.depth=0,this.children||(this.children=[]),this.addGap(i,n),this}n.assign(s.prototype,{isRoot:function(){return 0===this.depth},isLeaf:function(){return 0===this.children.length},addGap:function(t,e){this.hgap+=t,this.vgap+=e,this.width+=2*t,this.height+=2*e},eachNode:function(t){for(var e,i=[this];e=i.shift();)t(e),i=e.children.concat(i)},DFTraverse:function(t){this.eachNode(t)},BFTraverse:function(t){for(var e,i=[this];e=i.shift();)t(e),i=i.concat(e.children)},getBoundingBox:function(){var t={left:Number.MAX_VALUE,top:Number.MAX_VALUE,width:0,height:0};return this.eachNode(function(e){t.left=Math.min(t.left,e.x),t.top=Math.min(t.top,e.y),t.width=Math.max(t.width,e.x+e.width),t.height=Math.max(t.height,e.y+e.height)}),t},translate:function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.eachNode(function(i){i.x+=t,i.y+=e,i.x+=i.preH,i.y+=i.preV})},right2left:function(){var t=this.getBoundingBox();this.eachNode(function(e){e.x=e.x-(e.x-t.left)*2-e.width}),this.translate(t.width,0)},bottom2top:function(){var t=this.getBoundingBox();this.eachNode(function(e){e.y=e.y-(e.y-t.top)*2-e.height}),this.translate(0,t.height)}}),t.exports=function(t,e,i){void 0===e&&(e={}),e=n.assign({},r,e);var a,o=new s(t,e),l=[o];if(!i&&!t.collapsed){for(;a=l.shift();)if(!a.data.collapsed){var h=e.getChildren(a.data),c=h?h.length:0;if(a.children=Array(c),h&&c)for(var d=0;d<c;d++){var u=new s(h[d],e);a.children[d]=u,l.push(u),u.parent=a,u.depth=a.depth+1}}}return o}},function(t,e,i){var n=i(3);t.exports=function(t,e){for(var i=n(t.data,e,!0),r=n(t.data,e,!0),s=t.children.length,a=Math.round(s/2),o=e.getSide||function(t,e){return e<a?"right":"left"},l=0;l<s;l++){var h=t.children[l];"right"===o(h,l)?r.children.push(h):i.children.push(h)}return i.eachNode(function(t){t.isRoot()||(t.side="left")}),r.eachNode(function(t){t.isRoot()||(t.side="right")}),{left:i,right:r}}},function(t,e,i){var n={compactBox:i(6),dendrogram:i(8),indented:i(10),mindmap:i(12)};t.exports=n},function(t,e,i){function n(t,e){return(n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var r=i(1),s=i(7),a=i(2),o=i(0),l=function(t){function e(){return t.apply(this,arguments)||this}return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,n(e,t),e.prototype.execute=function(){return a(this.rootNode,this.options,s)},e}(r),h={};t.exports=function(t,e){return e=o.assign({},h,e),new l(t,e).execute()}},function(t,e){function i(t,e,i,n){void 0===n&&(n=[]),this.w=t||0,this.h=e||0,this.y=i||0,this.x=0,this.c=n||[],this.cs=n.length,this.prelim=0,this.mod=0,this.shift=0,this.change=0,this.tl=null,this.tr=null,this.el=null,this.er=null,this.msel=0,this.mser=0}i.fromNode=function(t,e){if(!t)return null;var n=[];return(t.children.forEach(function(t){n.push(i.fromNode(t,e))}),e)?new i(t.height,t.width,t.x,n):new i(t.width,t.height,t.y,n)},t.exports=function(t,e){void 0===e&&(e={});var n,r=e.isHorizontal;function s(t){0===t.cs?(t.el=t,t.er=t,t.msel=t.mser=0):(t.el=t.c[0].el,t.msel=t.c[0].msel,t.er=t.c[t.cs-1].er,t.mser=t.c[t.cs-1].mser)}function a(t){return t.y+t.h}function o(t,e,i){for(;null!==i&&t>=i.low;)i=i.nxt;return{low:t,index:e,nxt:i}}!function t(e,i,n){void 0===n&&(n=0),i?(e.x=n,n+=e.width):(e.y=n,n+=e.height),e.children.forEach(function(e){t(e,i,n)})}(t,r);var l=i.fromNode(t,r);return function t(e){if(0===e.cs){s(e);return}t(e.c[0]);for(var i=o(a(e.c[0].el),0,null),n=1;n<e.cs;++n){t(e.c[n]);var r=a(e.c[n].er);(function(t,e,i){for(var n=t.c[e-1],r=n.mod,s=t.c[e],o=s.mod;null!==n&&null!==s;){a(n)>i.low&&(i=i.nxt);var l,h,c,d=r+n.prelim+n.w-(o+s.prelim);d>0&&(o+=d,l=i.index,t.c[e].mod+=d,t.c[e].msel+=d,t.c[e].mser+=d,function(t,e,i,n){if(i!==e-1){var r=e-i;t.c[i+1].shift+=n/r,t.c[e].shift-=n/r,t.c[e].change-=n-n/r}}(t,e,l,d));var u=a(n),p=a(s);u<=p&&null!==(n=0===(h=n).cs?h.tr:h.c[h.cs-1])&&(r+=n.mod),u>=p&&null!==(s=0===(c=s).cs?c.tl:c.c[0])&&(o+=s.mod)}!n&&s?function(t,e,i,n){var r=t.c[0].el;r.tl=i;var s=n-i.mod-t.c[0].msel;r.mod+=s,r.prelim-=s,t.c[0].el=t.c[e].el,t.c[0].msel=t.c[e].msel}(t,e,s,o):n&&!s&&function(t,e,i,n){var r=t.c[e].er;r.tr=i;var s=n-i.mod-t.c[e].mser;r.mod+=s,r.prelim-=s,t.c[e].er=t.c[e-1].er,t.c[e].mser=t.c[e-1].mser}(t,e,n,r)})(e,n,i),i=o(r,n,i)}e.prelim=(e.c[0].prelim+e.c[0].mod+e.c[e.cs-1].mod+e.c[e.cs-1].prelim+e.c[e.cs-1].w)/2-e.w/2,s(e)}(l),function t(e,i){i+=e.mod,e.x=e.prelim+i,function(t){for(var e=0,i=0,n=0;n<t.cs;n++)e+=t.c[n].shift,i+=e+t.c[n].change,t.c[n].mod+=i}(e);for(var n=0;n<e.cs;n++)t(e.c[n],i)}(l,0),function t(e,i,n){n?i.y=e.x:i.x=e.x,e.c.forEach(function(e,r){t(e,i.children[r],n)})}(l,t,r),n=function t(e,i){var n=i?e.y:e.x;return e.children.forEach(function(e){n=Math.min(t(e,i),n)}),n}(t,r),function t(e,i,n){n?e.y+=i:e.x+=i,e.children.forEach(function(e){t(e,i,n)})}(t,-n,r),t}},function(t,e,i){function n(t,e){return(n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var r=i(1),s=i(9),a=i(2),o=i(0),l=function(t){function e(){return t.apply(this,arguments)||this}return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,n(e,t),e.prototype.execute=function(){return this.rootNode.width=0,a(this.rootNode,this.options,s)},e}(r),h={};t.exports=function(t,e){return e=o.assign({},h,e),new l(t,e).execute()}},function(t,e,i){var n=i(0);function r(t,e){void 0===t&&(t=0),void 0===e&&(e=[]),this.x=this.y=0,this.leftChild=this.rightChild=null,this.height=0,this.children=e}var s={isHorizontal:!0,nodeSep:20,nodeSize:20,rankSep:200,subTreeSep:10};t.exports=function(t,e){void 0===e&&(e={}),e=n.assign({},s,e);var i,a=0,o=function t(e){if(!e)return null;e.width=0,e.depth&&e.depth>a&&(a=e.depth);var i=e.children,n=i.length,s=new r(e.height,[]);return i.forEach(function(e,i){var r=t(e);s.children.push(r),0===i&&(s.leftChild=r),i===n-1&&(s.rightChild=r)}),s.originNode=e,s.isLeaf=e.isLeaf(),s}(t);return function t(e){if(e.isLeaf||0===e.children.length)e.drawingDepth=a;else{var i=e.children.map(function(e){return t(e)}),n=Math.min.apply(null,i);e.drawingDepth=n-1}return e.drawingDepth}(o),function t(n){n.x=n.drawingDepth*e.rankSep,n.isLeaf?(n.y=0,i&&(n.y=i.y+i.height+e.nodeSep,n.originNode.parent!==i.originNode.parent&&(n.y+=e.subTreeSep)),i=n):(n.children.forEach(function(e){t(e)}),n.y=(n.leftChild.y+n.rightChild.y)/2)}(o),function t(e,i,n){n?(i.x=e.x,i.y=e.y):(i.x=e.y,i.y=e.x),e.children.forEach(function(e,r){t(e,i.children[r],n)})}(o,t,e.isHorizontal),t}},function(t,e,i){function n(t,e){return(n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var r=i(1),s=i(11),a=i(4),o=i(0),l=["LR","RL","H"],h=l[0],c=function(t){function e(){return t.apply(this,arguments)||this}return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,n(e,t),e.prototype.execute=function(){var t=this.options,e=this.rootNode;t.isHorizontal=!0;var i=t.indent,n=void 0===i?20:i,r=t.dropCap,o=void 0===r||r,c=t.direction,d=void 0===c?h:c,u=t.align;if(d&&-1===l.indexOf(d))throw TypeError("Invalid direction: "+d);if(d===l[0])s(e,n,o,u);else if(d===l[1])s(e,n,o,u),e.right2left();else if(d===l[2]){var p=a(e,t),g=p.left,f=p.right;s(g,n,o,u),g.right2left(),s(f,n,o,u);var m=g.getBoundingBox();f.translate(m.width,0),e.x=f.x-e.width/2}return e},e}(r),d={};t.exports=function(t,e){return e=o.assign({},d,e),new c(t,e).execute()}},function(t,e,i){var n=i(0);t.exports=function(t,e,i,r){var s=null;t.eachNode(function(t){(function(t,e,i,r,s){var a="function"==typeof i?i(t):i*t.depth;if(!r)try{if(t.id===t.parent.children[0].id){t.x+=a,t.y=e?e.y:0;return}}catch(t){}if(t.x+=a,e){if(t.y=e.y+n.getHeight(e,t,s),e.parent&&t.parent.id!==e.parent.id){var o=e.parent,l=o.y+n.getHeight(o,t,s);t.y=l>t.y?l:t.y}}else t.y=0})(t,s,e,i,r),s=t})}},function(t,e,i){function n(t,e){return(n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var r=i(1),s=i(13),a=i(2),o=i(0),l=function(t){function e(){return t.apply(this,arguments)||this}return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,n(e,t),e.prototype.execute=function(){return a(this.rootNode,this.options,s)},e}(r),h={};t.exports=function(t,e){return e=o.assign({},h,e),new l(t,e).execute()}},function(t,e,i){var n=i(0),r={getSubTreeSep:function(){return 0}};t.exports=function(t,e){void 0===e&&(e={}),e=n.assign({},r,e),t.parent={x:0,width:0,height:0,y:0},t.BFTraverse(function(t){t.x=t.parent.x+t.parent.width}),t.parent=null,function t(e,i){var n=0;return e.children.length?e.children.forEach(function(e){n+=t(e,i)}):n=e.height,e._subTreeSep=i.getSubTreeSep(e.data),e.totalHeight=Math.max(e.height,n)+2*e._subTreeSep,e.totalHeight}(t,e),t.startY=0,t.y=t.totalHeight/2-t.height/2,t.eachNode(function(t){var e=t.children,i=e.length;if(i){var n=e[0];if(n.startY=t.startY+t._subTreeSep,1===i)n.y=t.y+t.height/2-n.height/2;else{n.y=n.startY+n.totalHeight/2-n.height/2;for(var r=1;r<i;r++){var s=e[r];s.startY=e[r-1].startY+e[r-1].totalHeight,s.y=s.startY+s.totalHeight/2-s.height/2}}}}),function t(e){var i=e.children,n=i.length;if(n){i.forEach(function(e){t(e)});var r=i[0],s=i[n-1],a=s.y-r.y+s.height,o=0;if(i.forEach(function(t){o+=t.totalHeight}),a>e.height)e.y=r.y+a/2-e.height/2;else if(1!==i.length||e.height>o){var l=e.y+(e.height-a)/2-r.y;i.forEach(function(t){t.translate(0,l)})}else e.y=(r.y+r.height/2+s.y+s.height/2)/2-e.height/2}}(t)}}])},27800:function(t){function e(t,e,i){return(e[0]-t[0])*(i[1]-t[1])-(e[1]-t[1])*(i[0]-t[0])}t.exports=function(t){let i=function(t){let i=[];for(let n=0;n<t.length;n++){for(;i.length>=2&&0>=e(i[i.length-2],i[i.length-1],t[n]);)i.pop();i.push(t[n])}return i.pop(),i}(t),n=function(t){let i=t.reverse(),n=[];for(let t=0;t<i.length;t++){for(;n.length>=2&&0>=e(n[n.length-2],n[n.length-1],i[t]);)n.pop();n.push(i[t])}return n.pop(),n}(t),r=n.concat(i);return r.push(t[0]),r}},15925:function(t){t.exports={toXy:function(t,e){return void 0===e?t.slice():t.map(function(t){let i=Function("pt","return [pt"+e[0]+",pt"+e[1]+"];");return i(t)})},fromXy:function(t,e){return void 0===e?t.slice():t.map(function(t){let i=Function("pt","const o = {}; o"+e[0]+"= pt[0]; o"+e[1]+"= pt[1]; return o;");return i(t)})}}},70285:function(t){function e(t,e){this._cells=[],this._cellSize=e,this._reverseCellSize=1/e;for(let e=0;e<t.length;e++){let i=t[e],n=this.coordToCellNum(i[0]),r=this.coordToCellNum(i[1]);if(this._cells[n])this._cells[n][r]?this._cells[n][r].push(i):this._cells[n][r]=[i];else{let t=[];t[r]=[i],this._cells[n]=t}}}e.prototype={cellPoints:function(t,e){return void 0!==this._cells[t]&&void 0!==this._cells[t][e]?this._cells[t][e]:[]},rangePoints:function(t){let e=this.coordToCellNum(t[0]),i=this.coordToCellNum(t[1]),n=this.coordToCellNum(t[2]),r=this.coordToCellNum(t[3]),s=[];for(let t=e;t<=n;t++)for(let e=i;e<=r;e++)for(let i=0;i<this.cellPoints(t,e).length;i++)s.push(this.cellPoints(t,e)[i]);return s},removePoint:function(t){let e;let i=this.coordToCellNum(t[0]),n=this.coordToCellNum(t[1]),r=this._cells[i][n];for(let i=0;i<r.length;i++)if(r[i][0]===t[0]&&r[i][1]===t[1]){e=i;break}return r.splice(e,1),r},trunc:Math.trunc||function(t){return t-t%1},coordToCellNum:function(t){return this.trunc(t*this._reverseCellSize)},extendBbox:function(t,e){return[t[0]-e*this._cellSize,t[1]-e*this._cellSize,t[2]+e*this._cellSize,t[3]+e*this._cellSize]}},t.exports=function(t,i){return new e(t,i)}},47032:function(t,e,i){"use strict";let n=i(67921),r=i(70285),s=i(15925),a=i(27800);function o(t,e){return Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)}function l(t,e,i){let n=[e[0]-t[0],e[1]-t[1]],r=[i[0]-t[0],i[1]-t[1]],s=o(t,e),a=o(t,i),l=n[0]*r[0]+n[1]*r[1];return l/Math.sqrt(s*a)}function h(t,e){for(let i=0;i<e.length-1;i++){let r=[e[i],e[i+1]];if((t[0][0]!==r[0][0]||t[0][1]!==r[0][1])&&(t[0][0]!==r[1][0]||t[0][1]!==r[1][1])&&n(t,r))return!0}return!1}let c=Math.cos(90/(180/Math.PI));t.exports=function(t,e,i){let n=function(t){let e=[t[0]],i=t[0];for(let n=1;n<t.length;n++){let r=t[n];(i[0]!==r[0]||i[1]!==r[1])&&e.push(r),i=r}return e}(s.toXy(t,i).sort(function(t,e){return t[0]-e[0]||t[1]-e[1]}));if(n.length<4){let t=n.concat([n[0]]);return i?s.fromXy(t,i):t}let d=function(t){let e=1/0,i=1/0,n=-1/0,r=-1/0;for(let s=t.length-1;s>=0;s--)t[s][0]<e&&(e=t[s][0]),t[s][1]<i&&(i=t[s][1]),t[s][0]>n&&(n=t[s][0]),t[s][1]>r&&(r=t[s][1]);return[n-e,r-i]}(n),u=[.6*d[0],.6*d[1]],p=a(n),g=n.filter(function(t){return 0>p.indexOf(t)}),f=Math.ceil(1/(n.length/(d[0]*d[1]))),m=function t(e,i,n,r,s){let a=!1;for(let t=0;t<e.length-1;t++){let d,u,p;let g=[e[t],e[t+1]],f=g[0][0]+","+g[0][1]+","+g[1][0]+","+g[1][1];if(o(g[0],g[1])<i||s.has(f))continue;let m=0,y=[Math.min(g[0][0],g[1][0]),Math.min(g[0][1],g[1][1]),Math.max(g[0][0],g[1][0]),Math.max(g[0][1],g[1][1])];do d=(y=r.extendBbox(y,m))[2]-y[0],u=y[3]-y[1],p=function(t,e,i){let n=null,r=c,s=c,a,o;for(let c=0;c<e.length;c++)a=l(t[0],t[1],e[c]),o=l(t[1],t[0],e[c]),a>r&&o>s&&!h([t[0],e[c]],i)&&!h([t[1],e[c]],i)&&(r=a,s=o,n=e[c]);return n}(g,r.rangePoints(y),e),m++;while(null===p&&(n[0]>d||n[1]>u));d>=n[0]&&u>=n[1]&&s.add(f),null!==p&&(e.splice(t+1,0,p),r.removePoint(p),a=!0)}return a?t(e,i,n,r,s):e}(p,Math.pow(e||20,2),u,r(g,f),new Set);return i?s.fromXy(m,i):m}},67921:function(t){function e(t,e,i,n,r,s){let a=(s-e)*(i-t)-(n-e)*(r-t);return a>0||!(a<0)}t.exports=function(t,i){let n=t[0][0],r=t[0][1],s=t[1][0],a=t[1][1],o=i[0][0],l=i[0][1],h=i[1][0],c=i[1][1];return e(n,r,o,l,h,c)!==e(s,a,o,l,h,c)&&e(n,r,s,a,o,l)!==e(n,r,s,a,h,c)}},50198:function(t,e,i){"use strict";let n;i.d(e,{kJ:function(){return oV},jD:function(){return t7}});var r,s,a,o,l,h,c,d,u,p,g,f,m,y,v,b,E,x,w,S,T,C,O,M,D,A,k,P,R,N,L={};i.r(L),i.d(L,{circle:function(){return ri},diamond:function(){return rr},rect:function(){return ra},simple:function(){return rl},triangle:function(){return rn},triangleRect:function(){return ro},vee:function(){return rs}});var I=i(34849),_=i(36348),B=i(84531),F=i(23890),j=i(17375),z=i(44178),Z=i(67495),W=function(t){function e(){var e=t.apply(this,(0,_.ev)([],(0,_.CR)(arguments),!1))||this;return e.landmarks=[],e}return(0,_.ZT)(e,t),e.prototype.rotate=function(t,e,i){if(this.relElevation=(0,I._O)(e),this.relAzimuth=(0,I._O)(t),this.relRoll=(0,I._O)(i),this.elevation+=this.relElevation,this.azimuth+=this.relAzimuth,this.roll+=this.relRoll,this.type===I.iM.EXPLORING){var n=j.yY(j.Ue(),[1,0,0],(0,I.Vl)((this.rotateWorld?1:-1)*this.relElevation)),r=j.yY(j.Ue(),[0,1,0],(0,I.Vl)((this.rotateWorld?1:-1)*this.relAzimuth)),s=j.yY(j.Ue(),[0,0,1],(0,I.Vl)(this.relRoll)),a=j.Jp(j.Ue(),r,n);a=j.Jp(j.Ue(),a,s);var o=z.fromQuat(z.create(),a);z.translate(this.matrix,this.matrix,[0,0,-this.distance]),z.multiply(this.matrix,this.matrix,o),z.translate(this.matrix,this.matrix,[0,0,this.distance])}else{if(Math.abs(this.elevation)>90)return this;this.computeMatrix()}return this._getAxes(),this.type===I.iM.ORBITING||this.type===I.iM.EXPLORING?this._getPosition():this.type===I.iM.TRACKING&&this._getFocalPoint(),this._update(),this},e.prototype.pan=function(t,e){var i=(0,I.O4)(t,e,0),n=Z.d9(this.position);return Z.IH(n,n,Z.bA(Z.Ue(),this.right,i[0])),Z.IH(n,n,Z.bA(Z.Ue(),this.up,i[1])),this._setPosition(n),this.triggerUpdate(),this},e.prototype.dolly=function(t){var e=this.forward,i=Z.d9(this.position),n=t*this.dollyingStep;return n=Math.max(Math.min(this.distance+t*this.dollyingStep,this.maxDistance),this.minDistance)-this.distance,i[0]+=n*e[0],i[1]+=n*e[1],i[2]+=n*e[2],this._setPosition(i),this.type===I.iM.ORBITING||this.type===I.iM.EXPLORING?this._getDistance():this.type===I.iM.TRACKING&&Z.IH(this.focalPoint,i,this.distanceVector),this.triggerUpdate(),this},e.prototype.cancelLandmarkAnimation=function(){void 0!==this.landmarkAnimationID&&this.canvas.cancelAnimationFrame(this.landmarkAnimationID)},e.prototype.createLandmark=function(t,e){void 0===e&&(e={});var i,n,r,s,a=e.position,o=void 0===a?this.position:a,l=e.focalPoint,h=void 0===l?this.focalPoint:l,c=e.roll,d=e.zoom,u=new I.GZ.CameraContribution;u.setType(this.type,void 0),u.setPosition(o[0],null!==(i=o[1])&&void 0!==i?i:this.position[1],null!==(n=o[2])&&void 0!==n?n:this.position[2]),u.setFocalPoint(h[0],null!==(r=h[1])&&void 0!==r?r:this.focalPoint[1],null!==(s=h[2])&&void 0!==s?s:this.focalPoint[2]),u.setRoll(null!=c?c:this.roll),u.setZoom(null!=d?d:this.zoom);var p={name:t,matrix:z.clone(u.getWorldTransform()),right:Z.d9(u.right),up:Z.d9(u.up),forward:Z.d9(u.forward),position:Z.d9(u.getPosition()),focalPoint:Z.d9(u.getFocalPoint()),distanceVector:Z.d9(u.getDistanceVector()),distance:u.getDistance(),dollyingStep:u.getDollyingStep(),azimuth:u.getAzimuth(),elevation:u.getElevation(),roll:u.getRoll(),relAzimuth:u.relAzimuth,relElevation:u.relElevation,relRoll:u.relRoll,zoom:u.getZoom()};return this.landmarks.push(p),p},e.prototype.gotoLandmark=function(t,e){var i=this;void 0===e&&(e={});var n=(0,B.Z)(t)?this.landmarks.find(function(e){return e.name===t}):t;if(n){var r,s=(0,F.Z)(e)?{duration:e}:e,a=s.easing,o=void 0===a?"linear":a,l=s.duration,h=void 0===l?100:l,c=s.easingFunction,d=s.onfinish,u=void 0===d?void 0:d,p=s.onframe,g=void 0===p?void 0:p;this.cancelLandmarkAnimation();var f=n.position,m=n.focalPoint,y=n.zoom,v=n.roll,b=(void 0===c?void 0:c)||I.GZ.EasingFunction(o),E=function(){i.setFocalPoint(m),i.setPosition(f),i.setRoll(v),i.setZoom(y),i.computeMatrix(),i.triggerUpdate(),null==u||u()};if(0===h)return E();var x=function(t){void 0===r&&(r=t);var e=t-r;if(e>=h){E();return}var n=b(e/h),s=Z.Ue(),a=Z.Ue(),o=1,l=0;if(Z.t7(s,i.focalPoint,m,n),Z.t7(a,i.position,f,n),l=i.roll*(1-n)+v*n,o=i.zoom*(1-n)+y*n,i.setFocalPoint(s),i.setPosition(a),i.setRoll(l),i.setZoom(o),Z.TK(s,m)+Z.TK(a,f)<=.01&&void 0==y&&void 0==v)return E();i.computeMatrix(),i.triggerUpdate(),e<h&&(null==g||g(n),i.landmarkAnimationID=i.canvas.requestAnimationFrame(x))};this.canvas.requestAnimationFrame(x)}},e}(I.V1);I.GZ.CameraContribution=W;var G=function(){function t(t,e){this.type=t,this.target=e,this.addedNodes=[],this.attributeName=null,this.attributeNamespace=null,this.nextSibling=null,this.oldValue=null,this.previousSibling=null,this.removedNodes=[]}return t.copy=function(e){var i=new t(e.type,e.target);return i.addedNodes=e.addedNodes.slice(),i.removedNodes=e.removedNodes.slice(),i.previousSibling=e.previousSibling,i.nextSibling=e.nextSibling,i.attributeName=e.attributeName,i.attributeNamespace=e.attributeNamespace,i.oldValue=e.oldValue,i},t}(),H=0,V=new WeakMap,Y=function(){function t(t,e,i){this.observer=t,this.target=e,this.options=i,this.transientObservedNodes=[]}return t.prototype.enqueue=function(t){var e,i=this.observer.records,n=i.length;if(i.length>0){var r,s=(r=i[n-1],r===t?r:b&&(r===b||r===v)?b:null);if(s){i[n-1]=s;return}}else e=this.observer,$.push(e),K||(K=!0,void 0!==I.GZ.globalThis?I.GZ.globalThis.setTimeout(X):X());i[n]=t},t.prototype.addListeners=function(){this.addListeners_(this.target)},t.prototype.addListeners_=function(t){var e=this.options;e.attributes&&t.addEventListener(I.Dk.ATTR_MODIFIED,this,!0),e.childList&&t.addEventListener(I.Dk.INSERTED,this,!0),(e.childList||e.subtree)&&t.addEventListener(I.Dk.REMOVED,this,!0)},t.prototype.removeListeners=function(){this.removeListeners_(this.target)},t.prototype.removeListeners_=function(t){var e=this.options;e.attributes&&t.removeEventListener(I.Dk.ATTR_MODIFIED,this,!0),e.childList&&t.removeEventListener(I.Dk.INSERTED,this,!0),(e.childList||e.subtree)&&t.removeEventListener(I.Dk.REMOVED,this,!0)},t.prototype.removeTransientObservers=function(){var t=this.transientObservedNodes;this.transientObservedNodes=[],t.forEach(function(t){this.removeListeners_(t);for(var e=V.get(t),i=0;i<e.length;i++)if(e[i]===this){e.splice(i,1);break}},this)},t.prototype.handleEvent=function(t){switch(t.stopImmediatePropagation(),t.type){case I.Dk.ATTR_MODIFIED:var e,i,n,r=t.attrName,s=t.relatedNode.namespaceURI;(e=n=t.target,i=v=new G("attributes",e)).attributeName=r,i.attributeNamespace=s;var a=t.attrChange===I.jd.ADDITION?null:t.prevValue;U(n,function(t){if(t.attributes)return t.attributeFilter&&t.attributeFilter.length&&-1===t.attributeFilter.indexOf(r)&&-1===t.attributeFilter.indexOf(s)?void 0:t.attributeOldValue?(b||((b=G.copy(v)).oldValue=a),b):i});break;case I.Dk.REMOVED:case I.Dk.INSERTED:n=t.relatedNode;var o,l=t.target,h=void 0,c=void 0;t.type===I.Dk.INSERTED?(h=[l],c=[]):(h=[],c=[l]);var d=l.previousSibling,u=l.nextSibling;(o=n,i=v=new G("childList",o)).addedNodes=h,i.removedNodes=c,i.previousSibling=d,i.nextSibling=u,U(n,function(t){if(t.childList)return i})}v=b=void 0},t}();function U(t,e){for(var i=t;i;i=i.parentNode){var n=V.get(i);if(n)for(var r=0;r<n.length;r++){var s=n[r],a=s.options;if(i===t||a.subtree){var o=e(a);o&&s.enqueue(o)}}}}!function(){function t(t){this.callback=t,this.nodes=[],this.records=[],this.uid=H++}t.prototype.observe=function(t,e){if(!e.childList&&!e.attributes&&!e.characterData||e.attributeOldValue&&!e.attributes||e.attributeFilter&&e.attributeFilter.length&&!e.attributes||e.characterDataOldValue&&!e.characterData)throw SyntaxError();var i,n=V.get(t);n||V.set(t,n=[]);for(var r=0;r<n.length;r++)if(n[r].observer===this){(i=n[r]).removeListeners(),i.options=e;break}i||(i=new Y(this,t,e),n.push(i),this.nodes.push(t)),i.addListeners()},t.prototype.disconnect=function(){var t=this;this.nodes.forEach(function(e){for(var i=V.get(e),n=0;n<i.length;n++){var r=i[n];if(r.observer===t){r.removeListeners(),i.splice(n,1);break}}},this),this.records=[]},t.prototype.takeRecords=function(){var t=this.records;return this.records=[],t}}();var K=!1,$=[];function X(){K=!1;var t=$;$=[],t.sort(function(t,e){return t.uid-e.uid});var e=!1;t.forEach(function(t){var i=t.takeRecords();(function(t){t.nodes.forEach(function(e){var i=V.get(e);i&&i.forEach(function(e){e.observer===t&&e.removeTransientObservers()})})})(t),i.length&&(t.callback(i,t),e=!0)}),e&&X()}var q=i(1006),J=i(64757),Q=function(t){function e(e,i,n,r){var s=t.call(this,e)||this;return s.currentTime=n,s.timelineTime=r,s.target=i,s.type="finish",s.bubbles=!1,s.currentTarget=i,s.defaultPrevented=!1,s.eventPhase=s.AT_TARGET,s.timeStamp=Date.now(),s.currentTime=n,s.timelineTime=r,s}return(0,_.ZT)(e,t),e}(I.xA),tt=0,te=function(){function t(t,e){var i;this.currentTimePending=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._playbackRate=1,this._inTimeline=!0,this.effect=t,t.animation=this,this.timeline=e,this.id="".concat(tt++),this._inEffect=!!this.effect.update(0),this._totalDuration=Number(null===(i=this.effect)||void 0===i?void 0:i.getComputedTiming().endTime),this._holdTime=0,this._paused=!1,this.oldPlayState="idle",this.updatePromises()}return Object.defineProperty(t.prototype,"pending",{get:function(){return null===this._startTime&&!this._paused&&0!==this.playbackRate||this.currentTimePending},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"playState",{get:function(){return this._idle?"idle":this._isFinished?"finished":this._paused?"paused":"running"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ready",{get:function(){var t=this;return this.readyPromise||(-1===this.timeline.animationsWithPromises.indexOf(this)&&this.timeline.animationsWithPromises.push(this),this.readyPromise=new Promise(function(e,i){t.resolveReadyPromise=function(){e(t)},t.rejectReadyPromise=function(){i(Error())}}),this.pending||this.resolveReadyPromise()),this.readyPromise},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"finished",{get:function(){var t=this;return this.finishedPromise||(-1===this.timeline.animationsWithPromises.indexOf(this)&&this.timeline.animationsWithPromises.push(this),this.finishedPromise=new Promise(function(e,i){t.resolveFinishedPromise=function(){e(t)},t.rejectFinishedPromise=function(){i(Error())}}),"finished"===this.playState&&this.resolveFinishedPromise()),this.finishedPromise},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentTime",{get:function(){return this.updatePromises(),this._idle||this.currentTimePending?null:this._currentTime},set:function(t){var e;if(!isNaN(t=Number(t))){if(this.timeline.restart(),this._paused||null===this._startTime||(this._startTime=Number(null===(e=this.timeline)||void 0===e?void 0:e.currentTime)-t/this.playbackRate),this.currentTimePending=!1,this._currentTime===t)return;this._idle&&(this._idle=!1,this._paused=!0),this.tickCurrentTime(t,!0),this.timeline.applyDirtiedAnimation(this)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"startTime",{get:function(){return this._startTime},set:function(t){null!==t&&(this.updatePromises(),!isNaN(t=Number(t))&&(this._paused||this._idle||(this._startTime=t,this.tickCurrentTime((Number(this.timeline.currentTime)-this._startTime)*this.playbackRate),this.timeline.applyDirtiedAnimation(this),this.updatePromises())))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"playbackRate",{get:function(){return this._playbackRate},set:function(t){if(t!==this._playbackRate){this.updatePromises();var e=this.currentTime;this._playbackRate=t,this.startTime=null,"paused"!==this.playState&&"idle"!==this.playState&&(this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this)),null!==e&&(this.currentTime=e),this.updatePromises()}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_isFinished",{get:function(){return!this._idle&&(this._playbackRate>0&&Number(this._currentTime)>=this._totalDuration||this._playbackRate<0&&0>=Number(this._currentTime))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"totalDuration",{get:function(){return this._totalDuration},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_needsTick",{get:function(){return this.pending||"running"===this.playState||!this._finishedFlag},enumerable:!1,configurable:!0}),t.prototype.updatePromises=function(){var t=this.oldPlayState,e=this.pending?"pending":this.playState;return this.readyPromise&&e!==t&&("idle"===e?(this.rejectReadyPromise(),this.readyPromise=void 0):"pending"===t?this.resolveReadyPromise():"pending"===e&&(this.readyPromise=void 0)),this.finishedPromise&&e!==t&&("idle"===e?(this.rejectFinishedPromise(),this.finishedPromise=void 0):"finished"===e?this.resolveFinishedPromise():"finished"===t&&(this.finishedPromise=void 0)),this.oldPlayState=e,this.readyPromise||this.finishedPromise},t.prototype.play=function(){this.updatePromises(),this._paused=!1,(this._isFinished||this._idle)&&(this.rewind(),this._startTime=null),this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this),-1===this.timeline.animations.indexOf(this)&&this.timeline.animations.push(this),this.updatePromises()},t.prototype.pause=function(){this.updatePromises(),this.currentTime&&(this._holdTime=this.currentTime),this._isFinished||this._paused||this._idle?this._idle&&(this.rewind(),this._idle=!1):this.currentTimePending=!0,this._startTime=null,this._paused=!0,this.updatePromises()},t.prototype.finish=function(){this.updatePromises(),this._idle||(this.currentTime=this._playbackRate>0?this._totalDuration:0,this._startTime=this._totalDuration-this.currentTime,this.currentTimePending=!1,this.timeline.applyDirtiedAnimation(this),this.updatePromises())},t.prototype.cancel=function(){var t=this;if(this.updatePromises(),this._inEffect&&(this._inEffect=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._startTime=null,this.effect.update(null),this.timeline.applyDirtiedAnimation(this),this.updatePromises(),this.oncancel)){var e=new Q(null,this,this.currentTime,null);setTimeout(function(){t.oncancel(e)})}},t.prototype.reverse=function(){this.updatePromises();var t=this.currentTime;this.playbackRate*=-1,this.play(),null!==t&&(this.currentTime=t),this.updatePromises()},t.prototype.updatePlaybackRate=function(t){this.playbackRate=t},t.prototype.targetAnimations=function(){var t;return(null===(t=this.effect)||void 0===t?void 0:t.target).getAnimations()},t.prototype.markTarget=function(){var t=this.targetAnimations();-1===t.indexOf(this)&&t.push(this)},t.prototype.unmarkTarget=function(){var t=this.targetAnimations(),e=t.indexOf(this);-1!==e&&t.splice(e,1)},t.prototype.tick=function(t,e){this._idle||this._paused||(null===this._startTime?e&&(this.startTime=t-this._currentTime/this.playbackRate):this._isFinished||this.tickCurrentTime((t-this._startTime)*this.playbackRate)),e&&(this.currentTimePending=!1,this.fireEvents(t))},t.prototype.rewind=function(){if(this.playbackRate>=0)this.currentTime=0;else if(this._totalDuration<1/0)this.currentTime=this._totalDuration;else throw Error("Unable to rewind negative playback rate animation with infinite duration")},t.prototype.persist=function(){throw Error(I.jf)},t.prototype.addEventListener=function(t,e,i){throw Error(I.jf)},t.prototype.removeEventListener=function(t,e,i){throw Error(I.jf)},t.prototype.dispatchEvent=function(t){throw Error(I.jf)},t.prototype.commitStyles=function(){throw Error(I.jf)},t.prototype.ensureAlive=function(){var t,e;this.playbackRate<0&&0===this.currentTime?this._inEffect=!!(null===(t=this.effect)||void 0===t?void 0:t.update(-1)):this._inEffect=!!(null===(e=this.effect)||void 0===e?void 0:e.update(this.currentTime)),this._inTimeline||!this._inEffect&&this._finishedFlag||(this._inTimeline=!0,this.timeline.animations.push(this))},t.prototype.tickCurrentTime=function(t,e){t!==this._currentTime&&(this._currentTime=t,this._isFinished&&!e&&(this._currentTime=this._playbackRate>0?this._totalDuration:0),this.ensureAlive())},t.prototype.fireEvents=function(t){var e=this;if(this._isFinished){if(!this._finishedFlag){if(this.onfinish){var i=new Q(null,this,this.currentTime,t);setTimeout(function(){e.onfinish&&e.onfinish(i)})}this._finishedFlag=!0}}else{if(this.onframe&&"running"===this.playState){var n=new Q(null,this,this.currentTime,t);this.onframe(n)}this._finishedFlag=!1}},t}(),ti="function"==typeof Float32Array,tn=function(t,e){return 1-3*e+3*t},tr=function(t,e){return 3*e-6*t},ts=function(t){return 3*t},ta=function(t,e,i){return((tn(e,i)*t+tr(e,i))*t+ts(e))*t},to=function(t,e,i){return 3*tn(e,i)*t*t+2*tr(e,i)*t+ts(e)},tl=function(t,e,i,n,r){var s,a,o=0;do(s=ta(a=e+(i-e)/2,n,r)-t)>0?i=a:e=a;while(Math.abs(s)>1e-7&&++o<10);return a},th=function(t,e,i,n){for(var r=0;r<4;++r){var s=to(e,i,n);if(0===s)break;var a=ta(e,i,n)-t;e-=a/s}return e},tc=function(t,e,i,n){if(!(0<=t&&t<=1&&0<=i&&i<=1))throw Error("bezier x values must be in [0, 1] range");if(t===e&&i===n)return function(t){return t};for(var r=ti?new Float32Array(11):Array(11),s=0;s<11;++s)r[s]=ta(.1*s,t,i);var a=function(e){for(var n=0,s=1;10!==s&&r[s]<=e;++s)n+=.1;var a=n+(e-r[--s])/(r[s+1]-r[s])*.1,o=to(a,t,i);return o>=.001?th(e,a,t,i):0===o?a:tl(e,n,n+.1,t,i)};return function(t){return 0===t||1===t?t:ta(a(t),e,n)}},td=function(t){return Math.pow(t,2)},tu=function(t){return Math.pow(t,3)},tp=function(t){return Math.pow(t,4)},tg=function(t){return Math.pow(t,5)},tf=function(t){return Math.pow(t,6)},tm=function(t){return 1-Math.cos(t*Math.PI/2)},ty=function(t){return 1-Math.sqrt(1-t*t)},tv=function(t){return t*t*(3*t-2)},tb=function(t){for(var e,i=4;t<((e=Math.pow(2,--i))-1)/11;);return 1/Math.pow(4,3-i)-7.5625*Math.pow((3*e-2)/22-t,2)},tE=function(t,e){void 0===e&&(e=[]);var i=(0,_.CR)(e,2),n=i[0],r=i[1],s=(0,q.Z)(Number(void 0===n?1:n),1,10),a=(0,q.Z)(Number(void 0===r?.5:r),.1,2);return 0===t||1===t?t:-s*Math.pow(2,10*(t-1))*Math.sin((t-1-a/(2*Math.PI)*Math.asin(1/s))*(2*Math.PI)/a)},tx=function(t,e,i){void 0===e&&(e=[]);var n=(0,_.CR)(e,4),r=n[0],s=void 0===r?1:r,a=n[1],o=void 0===a?100:a,l=n[2],h=void 0===l?10:l,c=n[3],d=void 0===c?0:c;s=(0,q.Z)(s,.1,1e3),o=(0,q.Z)(o,.1,1e3),h=(0,q.Z)(h,.1,1e3),d=(0,q.Z)(d,.1,1e3);var u=Math.sqrt(o/s),p=h/(2*Math.sqrt(o*s)),g=p<1?u*Math.sqrt(1-p*p):0,f=p<1?(p*u+-d)/g:-d+u,m=i?i*t/1e3:t;return(m=p<1?Math.exp(-m*p*u)*(1*Math.cos(g*m)+f*Math.sin(g*m)):(1+f*m)*Math.exp(-m*u),0===t||1===t)?t:1-m},tw=function(t,e){void 0===e&&(e=[]);var i=(0,_.CR)(e,2),n=i[0],r=void 0===n?10:n;return("start"==i[1]?Math.ceil:Math.floor)((0,q.Z)(t,0,1)*r)/r},tS=function(t,e){void 0===e&&(e=[]);var i=(0,_.CR)(e,4);return tc(i[0],i[1],i[2],i[3])(t)},tT=tc(.42,0,1,1),tC=function(t){return function(e,i,n){return void 0===i&&(i=[]),1-t(1-e,i,n)}},tO=function(t){return function(e,i,n){return void 0===i&&(i=[]),e<.5?t(2*e,i,n)/2:1-t(-2*e+2,i,n)/2}},tM=function(t){return function(e,i,n){return void 0===i&&(i=[]),e<.5?(1-t(1-2*e,i,n))/2:(t(2*e-1,i,n)+1)/2}},tD={steps:tw,"step-start":function(t){return tw(t,[1,"start"])},"step-end":function(t){return tw(t,[1,"end"])},linear:function(t){return t},"cubic-bezier":tS,ease:function(t){return tS(t,[.25,.1,.25,1])},in:tT,out:tC(tT),"in-out":tO(tT),"out-in":tM(tT),"in-quad":td,"out-quad":tC(td),"in-out-quad":tO(td),"out-in-quad":tM(td),"in-cubic":tu,"out-cubic":tC(tu),"in-out-cubic":tO(tu),"out-in-cubic":tM(tu),"in-quart":tp,"out-quart":tC(tp),"in-out-quart":tO(tp),"out-in-quart":tM(tp),"in-quint":tg,"out-quint":tC(tg),"in-out-quint":tO(tg),"out-in-quint":tM(tg),"in-expo":tf,"out-expo":tC(tf),"in-out-expo":tO(tf),"out-in-expo":tM(tf),"in-sine":tm,"out-sine":tC(tm),"in-out-sine":tO(tm),"out-in-sine":tM(tm),"in-circ":ty,"out-circ":tC(ty),"in-out-circ":tO(ty),"out-in-circ":tM(ty),"in-back":tv,"out-back":tC(tv),"in-out-back":tO(tv),"out-in-back":tM(tv),"in-bounce":tb,"out-bounce":tC(tb),"in-out-bounce":tO(tb),"out-in-bounce":tM(tb),"in-elastic":tE,"out-elastic":tC(tE),"in-out-elastic":tO(tE),"out-in-elastic":tM(tE),spring:tx,"spring-in":tx,"spring-out":tC(tx),"spring-in-out":tO(tx),"spring-out-in":tM(tx)},tA=function(t){var e;return("-"===(e=(e=t).replace(/([A-Z])/g,function(t){return"-".concat(t.toLowerCase())})).charAt(0)?e.substring(1):e).replace(/^ease-/,"").replace(/(\(|\s).+/,"").toLowerCase().trim()},tk=function(t){return t};function tP(t,e){return function(i){if(i>=1)return 1;var n=1/t;return(i+=e*n)-i%n}}var tR="\\s*(-?\\d+\\.?\\d*|-?\\.\\d+)\\s*",tN=RegExp("cubic-bezier\\("+tR+","+tR+","+tR+","+tR+"\\)"),tL=/steps\(\s*(\d+)\s*\)/,tI=/steps\(\s*(\d+)\s*,\s*(start|middle|end)\s*\)/;function t_(t){var e=tN.exec(t);if(e)return tc.apply(void 0,(0,_.ev)([],(0,_.CR)(e.slice(1).map(Number)),!1));var i=tL.exec(t);if(i)return tP(Number(i[1]),0);var n=tI.exec(t);return n?tP(Number(n[1]),{start:1,middle:.5,end:0}[n[2]]):tD[tA(t)]||tD.linear}function tB(t){return"offset"!==t&&"easing"!==t&&"composite"!==t&&"computedOffset"!==t}var tF=function(t,e,i){return function(n){var r=function t(e,i,n){if("number"==typeof e&&"number"==typeof i)return e*(1-n)+i*n;if("boolean"==typeof e&&"boolean"==typeof i||"string"==typeof e&&"string"==typeof i)return n<.5?e:i;if(Array.isArray(e)&&Array.isArray(i)){for(var r=e.length,s=i.length,a=Math.max(r,s),o=[],l=0;l<a;l++)o.push(t(e[l<r?l:r-1],i[l<s?l:s-1],n));return o}throw Error("Mismatched interpolation arguments "+e+":"+i)}(t,e,n);return!I.GZ.enableCSSParsing&&(0,F.Z)(r)?r:i(r)}},tj=function(){function t(){this.delay=0,this.direction="normal",this.duration="auto",this._easing="linear",this.easingFunction=tk,this.endDelay=0,this.fill="auto",this.iterationStart=0,this.iterations=1,this.currentIteration=null,this.progress=null}return Object.defineProperty(t.prototype,"easing",{get:function(){return this._easing},set:function(t){this.easingFunction=t_(t),this._easing=t},enumerable:!1,configurable:!0}),t}();function tz(t,e){if(null===t)return[];Array.isArray(t)||(t=function(t){var e=[];for(var i in t)if(!(i in["easing","offset","composite"])){var n=t[i];Array.isArray(n)||(n=[n]);for(var r=n.length,s=0;s<r;s++){if(!e[s]){var a={};"offset"in t&&(a.offset=Number(t.offset)),"easing"in t&&(a.easing=t.easing),"composite"in t&&(a.composite=t.composite),e[s]=a}void 0!==n[s]&&null!==n[s]&&(e[s][i]=n[s])}}return e.sort(function(t,e){return(t.computedOffset||0)-(e.computedOffset||0)}),e}(t));for(var i=t.map(function(t){var i={};for(var n in(null==e?void 0:e.composite)&&(i.composite="auto"),t){var r=t[n];if("offset"===n){if(null!==r){if(!isFinite(r=Number(r)))throw Error("Keyframe offsets must be numbers.");if(r<0||r>1)throw Error("Keyframe offsets must be between 0 and 1.");i.computedOffset=r}}else if("composite"===n&&-1===["replace","add","accumulate","auto"].indexOf(r))throw Error("".concat(r," compositing is not supported"));i[n]=r}return void 0===i.offset&&(i.offset=null),void 0===i.easing&&(i.easing=(null==e?void 0:e.easing)||"linear"),void 0===i.composite&&(i.composite="auto"),i}),n=!0,r=-1/0,s=0;s<i.length;s++){var a=i[s].offset;if((0,J.Z)(a))n=!1;else{if(a<r)throw TypeError("Keyframes are not loosely sorted by offset. Sort or specify offsets.");r=a}}return i=i.filter(function(t){return Number(t.offset)>=0&&1>=Number(t.offset)}),n||function(){var t,e,n=i.length;i[n-1].computedOffset=Number(null!==(t=i[n-1].offset)&&void 0!==t?t:1),n>1&&(i[0].computedOffset=Number(null!==(e=i[0].offset)&&void 0!==e?e:0));for(var r=0,s=Number(i[0].computedOffset),a=1;a<n;a++){var o=i[a].computedOffset;if(!(0,J.Z)(o)&&!(0,J.Z)(s)){for(var l=1;l<a-r;l++)i[r+l].computedOffset=s+(Number(o)-s)*l/(a-r);r=a,s=Number(o)}}}(),i}var tZ="backwards|forwards|both|none".split("|"),tW="reverse|alternate|alternate-reverse".split("|"),tG=function(){function t(t,e,i){var n,r,s,a,o,l,h,c,d,u,p,g,f=this;this.composite="replace",this.iterationComposite="replace",this.target=t,this.timing=("number"==typeof(n=null!=(a=i)?a:{duration:"auto"})&&(n=isNaN(n)?{duration:"auto"}:{duration:n}),o=a=n,l=new tj,"number"!=typeof o||isNaN(o)?void 0!==o&&Object.keys(o).forEach(function(t){void 0===o[t]||null===o[t]||"auto"===o[t]||("number"==typeof l[t]||"duration"===t)&&("number"!=typeof o[t]||isNaN(o[t]))||"fill"===t&&-1===tZ.indexOf(o[t])||"direction"===t&&-1===tW.indexOf(o[t])||(l[t]=o[t])}):l.duration=o,l),this.timing.effect=this,this.timing.activeDuration=Math.abs((0===(r=h=this.timing).duration||0===r.iterations?0:("auto"===r.duration?0:Number(r.duration))*(null!==(s=r.iterations)&&void 0!==s?s:1))/(h.playbackRate||1)),this.timing.endTime=Math.max(0,this.timing.delay+this.timing.activeDuration+this.timing.endDelay),this.normalizedKeyframes=tz(e,this.timing),this.interpolations=(c=this.normalizedKeyframes,d=this.timing,u=this.target,g=function(t,e){var i=[];for(var n in t)for(var r=t[n],s=0;s<r.length-1;s++){var a=s,o=s+1,l=r[a].computedOffset,h=r[o].computedOffset,c=l,d=h;0===s&&(c=-1/0,0===h&&(o=a)),s===r.length-2&&(d=1/0,1===l&&(a=o)),i.push({applyFrom:c,applyTo:d,startOffset:r[a].computedOffset,endOffset:r[o].computedOffset,easingFunction:r[a].easingFunction,property:n,interpolation:function(t,e,i,n){var r=I.N1[t];if(r&&r.syntax&&r.int){var s=I.GZ.styleValueRegistry.getPropertySyntax(r.syntax);if(s){var a=void 0,o=void 0;if(I.GZ.enableCSSParsing){var l=I.GZ.styleValueRegistry.parseProperty(t,e,n,!1),h=I.GZ.styleValueRegistry.parseProperty(t,i,n,!1);a=I.GZ.styleValueRegistry.computeProperty(t,l,n,!1),o=I.GZ.styleValueRegistry.computeProperty(t,h,n,!1)}else{var c=s.parserWithCSSDisabled;a=c?c(e,n):e,o=c?c(i,n):i}var d=s.mixer(a,o,n);if(d){var u=tF.apply(void 0,(0,_.ev)([],(0,_.CR)(d),!1));return function(t){return 0===t?e:1===t?i:u(t)}}}}return tF(!1,!0,function(t){return t?i:e})}(n,r[a].value,r[o].value,e)})}return i.sort(function(t,e){return t.startOffset-e.startOffset}),i}(p=function(t,e){for(var i={},n=0;n<t.length;n++)for(var r in t[n])if(tB(r)){var s={offset:t[n].offset,computedOffset:t[n].computedOffset,easing:t[n].easing,easingFunction:t_(t[n].easing)||e.easingFunction,value:t[n][r]};i[r]=i[r]||[],i[r].push(s)}return i}(c,d),u),function(t,e){if(null!==e)g.filter(function(t){return e>=t.applyFrom&&e<t.applyTo}).forEach(function(i){var n=e-i.startOffset,r=i.endOffset-i.startOffset;t.setAttribute(i.property,i.interpolation(0===r?0:n/r),!1,!1)});else for(var i in p)tB(i)&&t.setAttribute(i,null)});var m=I.GZ.globalThis.Proxy;this.computedTiming=m?new m(this.timing,{get:function(t,e){return"duration"===e?"auto"===t.duration?0:t.duration:"fill"===e?"auto"===t.fill?"none":t.fill:"localTime"===e?f.animation&&f.animation.currentTime||null:"currentIteration"===e?f.animation&&"running"===f.animation.playState?t.currentIteration||0:null:"progress"===e?f.animation&&"running"===f.animation.playState?t.progress||0:null:t[e]},set:function(){return!0}}):this.timing}return t.prototype.applyInterpolations=function(){this.interpolations(this.target,Number(this.timeFraction))},t.prototype.update=function(t){return null!==t&&(this.timeFraction=function(t,e,i){var n,r,s,a,o,l,h=function(t,e,i){if(null===e)return 0;var n=i.endTime;return e<Math.min(i.delay,n)?1:e>=Math.min(i.delay+t+i.endDelay,n)?2:3}(t,e,i),c=function(t,e,i,n,r){switch(n){case 1:if("backwards"===e||"both"===e)return 0;return null;case 3:return i-r;case 2:if("forwards"===e||"both"===e)return t;return null;case 0:return null}}(t,i.fill,e,h,i.delay);if(null===c)return null;var d="auto"===i.duration?0:i.duration,u=(n=i.iterations,r=i.iterationStart,0===d?1!==h&&(r+=n):r+=c/d,r),p=(s=i.iterationStart,a=i.iterations,0==(o=u===1/0?s%1:u%1)&&2===h&&0!==a&&(0!==c||0===d)&&(o=1),o),g=(l=i.iterations,2===h&&l===1/0?1/0:1===p?Math.floor(u)-1:Math.floor(u)),f=function(t,e,i){var n=t;if("normal"!==t&&"reverse"!==t){var r=e;"alternate-reverse"===t&&(r+=1),n="normal",r!==1/0&&r%2!=0&&(n="reverse")}return"normal"===n?i:1-i}(i.direction,g,p);return i.currentIteration=g,i.progress=f,i.easingFunction(f)}(this.timing.activeDuration,t,this.timing),null!==this.timeFraction)},t.prototype.getKeyframes=function(){return this.normalizedKeyframes},t.prototype.setKeyframes=function(t){this.normalizedKeyframes=tz(t)},t.prototype.getComputedTiming=function(){return this.computedTiming},t.prototype.getTiming=function(){return this.timing},t.prototype.updateTiming=function(t){var e=this;Object.keys(t||{}).forEach(function(i){e.timing[i]=t[i]})},t}();function tH(t,e){return Number(t.id)-Number(e.id)}var tV=function(){function t(t){var e=this;this.document=t,this.animations=[],this.ticking=!1,this.timelineTicking=!1,this.hasRestartedThisFrame=!1,this.animationsWithPromises=[],this.inTick=!1,this.pendingEffects=[],this.currentTime=null,this.rafId=0,this.rafCallbacks=[],this.webAnimationsNextTick=function(t){e.currentTime=t,e.discardAnimations(),0===e.animations.length?e.timelineTicking=!1:e.requestAnimationFrame(e.webAnimationsNextTick)},this.processRafCallbacks=function(t){var i=e.rafCallbacks;e.rafCallbacks=[],t<Number(e.currentTime)&&(t=Number(e.currentTime)),e.animations.sort(tH),e.animations=e.tick(t,!0,e.animations)[0],i.forEach(function(e){e[1](t)}),e.applyPendingEffects()}}return t.prototype.getAnimations=function(){return this.discardAnimations(),this.animations.slice()},t.prototype.isTicking=function(){return this.inTick},t.prototype.play=function(t,e,i){var n=new tG(t,e,i),r=new te(n,this);return this.animations.push(r),this.restartWebAnimationsNextTick(),r.updatePromises(),r.play(),r.updatePromises(),r},t.prototype.applyDirtiedAnimation=function(t){var e=this;if(!this.inTick){t.markTarget();var i=t.targetAnimations();i.sort(tH),this.tick(Number(this.currentTime),!1,i.slice())[1].forEach(function(t){var i=e.animations.indexOf(t);-1!==i&&e.animations.splice(i,1)}),this.applyPendingEffects()}},t.prototype.restart=function(){return this.ticking||(this.ticking=!0,this.requestAnimationFrame(function(){}),this.hasRestartedThisFrame=!0),this.hasRestartedThisFrame},t.prototype.destroy=function(){this.document.defaultView.cancelAnimationFrame(this.frameId)},t.prototype.applyPendingEffects=function(){this.pendingEffects.forEach(function(t){null==t||t.applyInterpolations()}),this.pendingEffects=[]},t.prototype.updateAnimationsPromises=function(){this.animationsWithPromises=this.animationsWithPromises.filter(function(t){return t.updatePromises()})},t.prototype.discardAnimations=function(){this.updateAnimationsPromises(),this.animations=this.animations.filter(function(t){return"finished"!==t.playState&&"idle"!==t.playState})},t.prototype.restartWebAnimationsNextTick=function(){this.timelineTicking||(this.timelineTicking=!0,this.requestAnimationFrame(this.webAnimationsNextTick))},t.prototype.rAF=function(t){var e=this.rafId++;return 0===this.rafCallbacks.length&&(this.frameId=this.document.defaultView.requestAnimationFrame(this.processRafCallbacks)),this.rafCallbacks.push([e,t]),e},t.prototype.requestAnimationFrame=function(t){var e=this;return this.rAF(function(i){e.updateAnimationsPromises(),t(i),e.updateAnimationsPromises()})},t.prototype.tick=function(t,e,i){var n,r,s=this;this.inTick=!0,this.hasRestartedThisFrame=!1,this.currentTime=t,this.ticking=!1;var a=[],o=[],l=[],h=[];return i.forEach(function(i){i.tick(t,e),i._inEffect?(o.push(i.effect),i.markTarget()):(a.push(i.effect),i.unmarkTarget()),i._needsTick&&(s.ticking=!0);var n=i._inEffect||i._needsTick;i._inTimeline=n,n?l.push(i):h.push(i)}),(n=this.pendingEffects).push.apply(n,(0,_.ev)([],(0,_.CR)(a),!1)),(r=this.pendingEffects).push.apply(r,(0,_.ev)([],(0,_.CR)(o),!1)),this.ticking&&this.requestAnimationFrame(function(){}),this.inTick=!1,[l,h]},t}();I.GZ.EasingFunction=t_,I.GZ.AnimationTimeline=tV;var tY=i(71933),tU=i(96763),tK=i(29729);let t$={duration:500},tX={duration:1e3,easing:"cubic-bezier(0.250, 0.460, 0.450, 0.940)",iterations:1,fill:"both"};(r=E||(E={})).NodeAdded="NodeAdded",r.NodeUpdated="NodeUpdated",r.NodeRemoved="NodeRemoved",r.EdgeAdded="EdgeAdded",r.EdgeUpdated="EdgeUpdated",r.EdgeRemoved="EdgeRemoved",r.ComboAdded="ComboAdded",r.ComboUpdated="ComboUpdated",r.ComboRemoved="ComboRemoved",(s=x||(x={})).DRAW="draw",s.COLLAPSE="collapse",s.EXPAND="expand",s.TRANSFORM="transform",(a=w||(w={})).CLICK="canvas:click",a.DBLCLICK="canvas:dblclick",a.POINTER_OVER="canvas:pointerover",a.POINTER_LEAVE="canvas:pointerleave",a.POINTER_ENTER="canvas:pointerenter",a.POINTER_MOVE="canvas:pointermove",a.POINTER_OUT="canvas:pointerout",a.POINTER_DOWN="canvas:pointerdown",a.POINTER_UP="canvas:pointerup",a.CONTEXT_MENU="canvas:contextmenu",a.DRAG_START="canvas:dragstart",a.DRAG="canvas:drag",a.DRAG_END="canvas:dragend",a.DRAG_ENTER="canvas:dragenter",a.DRAG_OVER="canvas:dragover",a.DRAG_LEAVE="canvas:dragleave",a.DROP="canvas:drop",a.WHEEL="canvas:wheel",(o=S||(S={})).CLICK="combo:click",o.DBLCLICK="combo:dblclick",o.POINTER_OVER="combo:pointerover",o.POINTER_LEAVE="combo:pointerleave",o.POINTER_ENTER="combo:pointerenter",o.POINTER_MOVE="combo:pointermove",o.POINTER_OUT="combo:pointerout",o.POINTER_DOWN="combo:pointerdown",o.POINTER_UP="combo:pointerup",o.CONTEXT_MENU="combo:contextmenu",o.DRAG_START="combo:dragstart",o.DRAG="combo:drag",o.DRAG_END="combo:dragend",o.DRAG_ENTER="combo:dragenter",o.DRAG_OVER="combo:dragover",o.DRAG_LEAVE="combo:dragleave",o.DROP="combo:drop",(l=T||(T={})).CLICK="click",l.DBLCLICK="dblclick",l.POINTER_OVER="pointerover",l.POINTER_LEAVE="pointerleave",l.POINTER_ENTER="pointerenter",l.POINTER_MOVE="pointermove",l.POINTER_OUT="pointerout",l.POINTER_DOWN="pointerdown",l.POINTER_UP="pointerup",l.CONTEXT_MENU="contextmenu",l.DRAG_START="dragstart",l.DRAG="drag",l.DRAG_END="dragend",l.DRAG_ENTER="dragenter",l.DRAG_OVER="dragover",l.DRAG_LEAVE="dragleave",l.DROP="drop",l.KEY_DOWN="keydown",l.KEY_UP="keyup",l.WHEEL="wheel",(h=C||(C={})).KEY_DOWN="keydown",h.KEY_UP="keyup",(c=O||(O={})).CLICK="edge:click",c.DBLCLICK="edge:dblclick",c.POINTER_OVER="edge:pointerover",c.POINTER_LEAVE="edge:pointerleave",c.POINTER_ENTER="edge:pointerenter",c.POINTER_MOVE="edge:pointermove",c.POINTER_OUT="edge:pointerout",c.POINTER_DOWN="edge:pointerdown",c.POINTER_UP="edge:pointerup",c.CONTEXT_MENU="edge:contextmenu",c.DRAG_ENTER="edge:dragenter",c.DRAG_OVER="edge:dragover",c.DRAG_LEAVE="edge:dragleave",c.DROP="edge:drop",(d=M||(M={})).BEFORE_CANVAS_INIT="beforecanvasinit",d.AFTER_CANVAS_INIT="aftercanvasinit",d.BEFORE_SIZE_CHANGE="beforesizechange",d.AFTER_SIZE_CHANGE="aftersizechange",d.BEFORE_ELEMENT_CREATE="beforeelementcreate",d.AFTER_ELEMENT_CREATE="afterelementcreate",d.BEFORE_ELEMENT_UPDATE="beforeelementupdate",d.AFTER_ELEMENT_UPDATE="afterelementupdate",d.BEFORE_ELEMENT_DESTROY="beforeelementdestroy",d.AFTER_ELEMENT_DESTROY="afterelementdestroy",d.BEFORE_ELEMENT_TRANSLATE="beforeelementtranslate",d.AFTER_ELEMENT_TRANSLATE="afterelementtranslate",d.BEFORE_DRAW="beforedraw",d.AFTER_DRAW="afterdraw",d.BEFORE_RENDER="beforerender",d.AFTER_RENDER="afterrender",d.BEFORE_ANIMATE="beforeanimate",d.AFTER_ANIMATE="afteranimate",d.BEFORE_LAYOUT="beforelayout",d.AFTER_LAYOUT="afterlayout",d.BEFORE_STAGE_LAYOUT="beforestagelayout",d.AFTER_STAGE_LAYOUT="afterstagelayout",d.BEFORE_TRANSFORM="beforetransform",d.AFTER_TRANSFORM="aftertransform",d.BATCH_START="batchstart",d.BATCH_END="batchend",d.BEFORE_DESTROY="beforedestroy",d.AFTER_DESTROY="afterdestroy",d.BEFORE_RENDERER_CHANGE="beforerendererchange",d.AFTER_RENDERER_CHANGE="afterrendererchange",(u=D||(D={})).UNDO="undo",u.REDO="redo",u.CANCEL="cancel",u.ADD="add",u.CLEAR="clear",u.CHANGE="change",(p=A||(A={})).CLICK="node:click",p.DBLCLICK="node:dblclick",p.POINTER_OVER="node:pointerover",p.POINTER_LEAVE="node:pointerleave",p.POINTER_ENTER="node:pointerenter",p.POINTER_MOVE="node:pointermove",p.POINTER_OUT="node:pointerout",p.POINTER_DOWN="node:pointerdown",p.POINTER_UP="node:pointerup",p.CONTEXT_MENU="node:contextmenu",p.DRAG_START="node:dragstart",p.DRAG="node:drag",p.DRAG_END="node:dragend",p.DRAG_ENTER="node:dragenter",p.DRAG_OVER="node:dragover",p.DRAG_LEAVE="node:dragleave",p.DROP="node:drop";let tq="combo",tJ="tree";(g=k||(k={})).NODE="node",g.EDGE="edge",g.COMBO="combo",g.THEME="theme",g.PALETTE="palette",g.LAYOUT="layout",g.BEHAVIOR="behavior",g.PLUGIN="plugin",g.ANIMATION="animation",g.TRANSFORM="transform",g.SHAPE="shape";let tQ={animation:{},behavior:{},combo:{},edge:{},layout:{},node:{},palette:{},theme:{},plugin:{},transform:{},shape:{}};function t0(t,e){var i;let n=null===(i=tQ[t])||void 0===i?void 0:i[e];if(n)return n}function t1(t){return"[".concat("G6"," v").concat("5.0.19","] ").concat(t)}let t2={mute:!1,debug:t=>{t2.mute||console.debug(t1(t))},info:t=>{t2.mute||console.info(t1(t))},warn:t=>{t2.mute||console.warn(t1(t))},error:t=>{t2.mute||console.error(t1(t))}};function t3(t){let{theme:e}=t;if(!e)return{};let i=t0(k.THEME,e);return i||(t2.warn("The theme of ".concat(e," is not registered.")),{})}function t6(t,e){if(Array.isArray(t)&&0===t.length)return null;let i=Array.isArray(t)?t[0]:t,n=Array.isArray(t)?t.slice(1):e||[];return new Proxy(i,{get:(t,e)=>"function"!=typeof t[e]||["onframe","onfinish"].includes(e)?"finished"===e?Promise.all([i.finished,...n.map(t=>t.finished)]):Reflect.get(t,e):function(){for(var i=arguments.length,r=Array(i),s=0;s<i;s++)r[s]=arguments[s];t[e](...r),n.forEach(t=>{var i;return null===(i=t[e])||void 0===i?void 0:i.call(t,...r)})},set:(t,e,i)=>(["onframe","onfinish"].includes(e)||n.forEach(t=>{t[e]=i}),Reflect.set(t,e,i))})}function t4(t){let e=t.reduce((t,e)=>(Object.entries(e).forEach(e=>{let[i,n]=e;void 0===t[i]?t[i]=[n]:t[i].push(n)}),t),{});Object.entries(e).forEach(i=>{let[n,r]=i;(r.length!==t.length||r.some(t=>(0,J.Z)(t))||r.every(t=>!["sourceNode","targetNode","childrenNode"].includes(n)&&(0,tU.Z)(t,r[0])))&&delete e[n]});let i=Object.entries(e).reduce((t,e)=>{let[i,n]=e;return n.forEach((e,n)=>{t[n]?t[n][i]=e:t[n]={[i]:e}}),t},[]);return 0!==t.length&&0===i.length&&i.push(...[{_:0},{_:0}]),i}function t8(t){switch(t){case"opacity":return 1;case"x":case"y":case"z":case"zIndex":return 0;case"visibility":return"visible";case"collapsed":return!1;case"states":return[];default:return}}function t9(t,e){let{animation:i}=t;if(!1===i||!1===e)return!1;let n={...t$};return(0,tK.Z)(i)&&Object.assign(n,i),(0,tK.Z)(e)&&Object.assign(n,e),n}var t5=i(48077);function t7(t){if(void 0!==t.id)return t.id;if(void 0!==t.source&&void 0!==t.target)return"".concat(t.source,"-").concat(t.target);throw Error(t1("The datum does not have available id."))}function et(t,e){let i={nodes:(t.nodes||[]).map(t7),edges:(t.edges||[]).map(t7),combos:(t.combos||[]).map(t7)};return e?Object.values(i).flat():i}function ee(t,e,i,n){let r=n?n.replace(/translate(3d)?\([^)]*\)/g,""):"";return 0===i?"translate(".concat(t,", ").concat(e,")").concat(r):"translate3d(".concat(t,", ").concat(e,", ").concat(i,")").concat(r)}let ei=function(t,e,i,n){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=t7(n),a="".concat(i,"s"),o=t.add[a].get(s)||t.update[a].get(s)||t.remove[a].get(s)||n;Object.entries(t).forEach(t=>{let[i,l]=t;e===i?l[a].set(s,r?(0,t5.Z)(o,n):o):l[a].delete(s)})},en=(t,e,i)=>{let n;if(!i.length)return null;let[r,s]=e,a=e=>{if(!e)return{shape:t,fromStyle:r,toStyle:s};{var i;let n=t.getShape(e);if(!n)return null;let a="get".concat((0,tY.Z)(e),"Style"),o=(null==t?void 0:null===(i=t[a])||void 0===i?void 0:i.bind(t))||(t=>t),l=(null==o?void 0:o(r))||{},h=(null==o?void 0:o(s))||{};return{shape:n,fromStyle:l,toStyle:h}}},o=i.map(t=>{let{fields:e,shape:i,states:r,...s}=t,o=a(i);if(!o)return null;let{shape:l,fromStyle:h,toStyle:c}=o,d=[{},{}];if(e.forEach(t=>{var e,i;Object.assign(d[0],{[t]:null!==(e=h[t])&&void 0!==e?e:t8(t)}),Object.assign(d[1],{[t]:null!==(i=c[t])&&void 0!==i?i:t8(t)})}),d.some(t=>Object.keys(t).some(t=>["x","y","z"].includes(t)))){let{x:t=0,y:e=0,z:i=0,transform:n=""}=l.attributes||{};d.forEach(r=>{r.transform=ee(r.x||t,r.y||e,r.z||i,n)})}let u=l.animate(t4(d),s);return void 0===i&&(n=u),u}).filter(Boolean),l=n||(null==o?void 0:o[0]);return l?t6(l,o.filter(t=>t!=t)):null},er=[{fields:["x","y"]}],es=[{fields:["sourceNode","targetNode"]}],ea=[{fields:["childrenNode","x","y"]}];function eo(t,e,i){let n=new Map(t.map(t=>[i(t),t])),r=new Map(e.map(t=>[i(t),t])),s=new Set(n.keys()),a=new Set(r.keys()),o=[],l=[],h=[],c=[];return a.forEach(t=>{s.has(t)?(0,tU.Z)(n.get(t),r.get(t))?c.push(r.get(t)):l.push(r.get(t)):o.push(r.get(t))}),s.forEach(t=>{a.has(t)||h.push(n.get(t))}),{enter:o,exit:h,keep:c,update:l}}class el{setExtensions(t){let e=function(t,e,i){let n={},r=t=>(t in n||(n[t]=0),"".concat(e,"-").concat(t,"-").concat(n[t]++));return i.map(e=>"string"==typeof e?{type:e,key:r(e)}:"function"==typeof e?e.call(t):e.key?e:{...e,key:r(e.type)})}(this.context.graph,this.category,t),{enter:i,update:n,exit:r,keep:s}=eo(this.extensions,e,t=>t.key);this.createExtensions(i),this.updateExtensions([...n,...s]),this.destroyExtensions(r),this.extensions=e}createExtension(t){let{category:e}=this,{key:i,type:n}=t,r=t0(e,n);if(!r)return t2.warn("The extension ".concat(n," of ").concat(e," is not registered."));let s=new r(this.context,t);this.extensionMap[i]=s}createExtensions(t){t.forEach(t=>this.createExtension(t))}updateExtension(t){let{key:e}=t,i=this.extensionMap[e];i&&i.update(t)}updateExtensions(t){t.forEach(t=>this.updateExtension(t))}destroyExtension(t){let e=this.extensionMap[t];e&&(e.destroy(),delete this.extensionMap[t])}destroyExtensions(t){t.forEach(t=>{let{key:e}=t;return this.destroyExtension(e)})}destroy(){Object.values(this.extensionMap).forEach(t=>t.destroy()),this.context={},this.extensions=[],this.extensionMap={}}constructor(t){this.extensions=[],this.extensionMap={},this.context=t}}class eh{update(t){this.options=Object.assign(this.options,t)}destroy(){this.context={},this.options={},this.destroyed=!0}constructor(t,e){this.events=[],this.destroyed=!1,this.context=t,this.options=e}}class ec extends eh{}var ed=i(7258),eu=i(46539);function ep(t){return t instanceof Float32Array||!!Array.isArray(t)&&(2===t.length||3===t.length)&&t.every(t=>"number"==typeof t)}function eg(t,e,i){return t>=e&&t<=i}function ef(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(Array.isArray(t)){let[e=0,i=e,n=e,r=i]=t;return[e,i,n,r]}return[t,t,t,t]}function em(t){return t.max[0]-t.min[0]}function ey(t){return t.max[1]-t.min[1]}function ev(t){return[em(t),ey(t)]}function eb(t,e){let i=ep(t)?function(t){let[e,i,n=0]=t,r=new I.mN;return r.setMinMax([e,i,n],[e,i,n]),r}(t):t.getShape("key").getBounds();return e?eE(i,e):i}function eE(t,e){let[i,n,r,s]=ef(e),[a,o,l]=t.min,[h,c,d]=t.max,u=new I.mN;return u.setMinMax([a-s,o-i,l],[h+n,c+r,d]),u}function ex(t){if(0===t.length)return new I.mN;if(1===t.length)return t[0];let e=new I.mN;e.setMinMax(t[0].min,t[0].max);for(let i=1;i<t.length;i++){let n=t[i];e.setMinMax([Math.min(e.min[0],n.min[0]),Math.min(e.min[1],n.min[1]),Math.min(e.min[2],n.min[2])],[Math.max(e.max[0],n.max[0]),Math.max(e.max[1],n.max[1]),Math.max(e.max[2],n.max[2])])}return e}function ew(t,e){return eg(t[0],e.min[0],e.max[0])&&eg(t[1],e.min[1],e.max[1])}function eS(t,e){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{min:[n,r],max:[s,a]}=e,o=(t[1]===r||t[1]===a)&&(i||eg(t[0],n,s)),l=(t[0]===n||t[0]===s)&&(i||eg(t[1],r,a));return o||l}function eT(t,e){let[i,n]=e,[r,s]=t.min,[a,o]=t.max,l=i-r,h=a-i,c=n-s,d=o-n,u=Math.min(l,h,c,d);return u===l?"left":u===h?"right":u===c?"top":u===d?"bottom":"left"}function eC(t,e){let i=(0,eu.Z)(e);if(ew(e,t)){let n=eT(t,e);switch(n){case"left":i[0]=t.min[0];break;case"right":i[0]=t.max[0];break;case"top":i[1]=t.min[1];break;case"bottom":i[1]=t.max[1]}}else{let[n,r]=e,[s,a]=t.min,[o,l]=t.max;i[0]=eg(n,s,o)?n:n<s?s:o,i[1]=eg(r,a,l)?r:r<a?a:l}return i}let eO=[0,0,0];function eM(t,e){return t.map((t,i)=>t+e[i])}function eD(t,e){return t.map((t,i)=>t-e[i])}function eA(t,e){return"number"==typeof e?t.map(t=>t*e):t.map((t,i)=>t*e[i])}function ek(t,e){return"number"==typeof e?t.map(t=>t/e):t.map((t,i)=>t/e[i])}function eP(t,e){return t.map(t=>t*e)}function eR(t,e){return Math.sqrt(t.reduce((t,i,n)=>t+(i-e[n]||0)**2,0))}function eN(t,e){return t.reduce((t,i,n)=>t+Math.abs(i-e[n]),0)}function eL(t){let e=t.reduce((t,e)=>t+e**2,0);return t.map(t=>t/Math.sqrt(e))}function eI(t,e){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=t[0]*e[1]-t[1]*e[0],r=Math.acos(eA(t,e).reduce((t,e)=>t+e,0)/(eR(t,eO)*eR(e,eO)));return i&&n<0&&(r=2*Math.PI-r),r}function e_(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return e?[-t[1],t[0]]:[t[1],-t[0]]}function eB(t){return[t[0],t[1]]}function eF(t){return 2===t.length?[t[0],t[1],0]:t}function ej(t,e){let[i,n]=t,[r,s]=e,a=eD(i,n),o=eD(r,s);return(function(t,e){let i=eF(t),n=eF(e);return[i[1]*n[2]-i[2]*n[1],i[2]*n[0]-i[0]*n[2],i[0]*n[1]-i[1]*n[0]]})(a,o).every(t=>0===t)}function ez(t,e){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(ej(t,e))return;let[n,r]=t,[s,a]=e,o=((n[0]-s[0])*(s[1]-a[1])-(n[1]-s[1])*(s[0]-a[0]))/((n[0]-r[0])*(s[1]-a[1])-(n[1]-r[1])*(s[0]-a[0])),l=a[0]-s[0]?(n[0]-s[0]+o*(r[0]-n[0]))/(a[0]-s[0]):(n[1]-s[1]+o*(r[1]-n[1]))/(a[1]-s[1]);if(i||eg(o,0,1)&&eg(l,0,1))return[n[0]+o*(r[0]-n[0]),n[1]+o*(r[1]-n[1])]}function eZ(t){if(Array.isArray(t))return eg(t[0],0,1)&&eg(t[1],0,1)?t:[.5,.5];let e=t.split("-"),i=e.includes("left")?0:e.includes("right")?1:.5,n=e.includes("top")?0:e.includes("bottom")?1:.5;return[i,n]}function eW(t){let{x:e=0,y:i=0,z:n=0}=t.style||{};return[+e,+i,+n]}function eG(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"center",i=eZ(e);return function(t,e){let[i,n]=e,{min:r,max:s}=t;return[r[0]+i*(s[0]-r[0]),r[1]+n*(s[1]-r[1])]}(t,i)}function eH(t){var e;return[t.x,t.y,null!==(e=t.z)&&void 0!==e?e:0]}function eV(t){var e;return{x:t[0],y:t[1],z:null!==(e=t[2])&&void 0!==e?e:0}}function eY(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t.map(t=>parseFloat(t.toFixed(e)))}function eU(t,e,i){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=n?eD(t,e):eD(e,t),s=eL(r),a=[s[0]*i,s[1]*i];return eM(eB(t),a)}function eK(t,e,i){let n=!(arguments.length>3)||void 0===arguments[3]||arguments[3];for(let r=0;r<i.length;r++){let s=i[r],a=i[(r+1)%i.length];n&&(s=eM(e,s),a=eM(e,a));let o=ez([e,t],[s,a]);if(o)return{point:o,line:[s,a]}}return{point:e,line:void 0}}function e$(t,e){let i=e.center,n=eD(t,e.center),r=Math.atan2(n[1],n[0]);if(isNaN(r))return i;let s=em(e)/2,a=ey(e)/2,o=i[0]+s*Math.cos(r),l=i[1]+a*Math.sin(r);return[o,l]}function eX(t,e){let[i,n]=e[0],[r,s]=e[1],[a,o]=t,l=r-i,h=s-n;if(0===l&&0===h)return[i,n];let c=((a-i)*l+(o-n)*h)/(l*l+h*h);c>1?c=1:c<0&&(c=0);let d=i+c*l,u=n+c*h;return[d,u]}function eq(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=function(t){let e=t.reduce((t,e)=>eM(t,e),[0,0]);return ek(e,t.length)}(t);return t.sort((t,n)=>{let[r,s]=t,[a,o]=n,l=Math.atan2(s-i[1],r-i[0]),h=Math.atan2(o-i[1],a-i[0]);return e?h-l:l-h})}function eJ(t,e){return[t,[t[0],e[1]],e,[e[0],t[1]]]}let eQ=t=>t.map(t=>(0,B.Z)(t)?t.toLocaleLowerCase():t);class e0{bind(t,e){0!==t.length&&this.map.set(t,e)}unbind(t,e){this.map.forEach((i,n)=>{(0,tU.Z)(n,t)&&(!e||e===i)&&this.map.delete(n)})}unbindAll(){this.map.clear()}match(t){let e=eQ(Array.from(this.recordKey)).sort(),i=eQ(t).sort();return(0,tU.Z)(e,i)}bindEvents(){let{emitter:t}=this;t.on(T.KEY_DOWN,this.onKeyDown),t.on(T.KEY_UP,this.onKeyUp),t.on(T.WHEEL,this.onWheel),t.on(T.DRAG,this.onDrag),window.addEventListener("focus",this.onFocus)}trigger(t){this.map.forEach((e,i)=>{this.match(i)&&e(t)})}triggerExtendKey(t,e){this.map.forEach((i,n)=>{n.includes(t)&&(0,tU.Z)(Array.from(this.recordKey),n.filter(e=>e!==t))&&i(e)})}destroy(){this.unbindAll(),this.emitter.off(T.KEY_DOWN,this.onKeyDown),this.emitter.off(T.KEY_UP,this.onKeyUp),this.emitter.off(T.WHEEL,this.onWheel),this.emitter.off(T.DRAG,this.onDrag),window.removeEventListener("blur",this.onFocus)}constructor(t){this.map=new Map,this.recordKey=new Set,this.onKeyDown=t=>{(null==t?void 0:t.key)&&(this.recordKey.add(t.key),this.trigger(t))},this.onKeyUp=t=>{(null==t?void 0:t.key)&&this.recordKey.delete(t.key)},this.onWheel=t=>{this.triggerExtendKey(T.WHEEL,t)},this.onDrag=t=>{this.triggerExtendKey(T.DRAG,t)},this.onFocus=()=>{this.recordKey.clear()},this.emitter=t,this.bindEvents()}}class e1 extends ec{onPointerDown(t){if(!this.validate(t)||!this.isKeydown()||this.startPoint)return;let{canvas:e,graph:i}=this.context,n={...this.options.style};this.options.style.lineWidth&&(n.lineWidth=+this.options.style.lineWidth/i.getZoom()),this.rectShape=new I.UL({id:"g6-brush-select",style:n}),e.appendChild(this.rectShape),this.startPoint=[t.canvas.x,t.canvas.y]}onPointerMove(t){var e;if(!this.startPoint)return;let{immediately:i,mode:n}=this.options;this.endPoint=e2(t),null===(e=this.rectShape)||void 0===e||e.attr({x:Math.min(this.endPoint[0],this.startPoint[0]),y:Math.min(this.endPoint[1],this.startPoint[1]),width:Math.abs(this.endPoint[0]-this.startPoint[0]),height:Math.abs(this.endPoint[1]-this.startPoint[1])}),i&&"default"===n&&this.updateElementsStates(eJ(this.startPoint,this.endPoint))}onPointerUp(t){if(this.startPoint){if(!this.endPoint){this.clearBrush();return}this.endPoint=e2(t),this.updateElementsStates(eJ(this.startPoint,this.endPoint)),this.clearBrush()}}clearStates(){this.endPoint||this.clearElementsStates()}clearElementsStates(){let{graph:t}=this.context,e=Object.values(t.getData()).reduce((t,e)=>Object.assign({},t,e.reduce((t,e)=>(t[t7(e)]=[],t),{})),{});t.setElementState(e,this.options.animation)}updateElementsStates(t){let{graph:e}=this.context,{enableElements:i,state:n,mode:r,onSelect:s}=this.options,a=this.selector(e,t,i),o={};switch(r){case"union":a.forEach(t=>{o[t]=[...e.getElementState(t),n]});break;case"diff":a.forEach(t=>{let i=e.getElementState(t);o[t]=i.includes(n)?i.filter(t=>t!==n):[...i,n]});break;case"intersect":a.forEach(t=>{let i=e.getElementState(t);o[t]=i.includes(n)?[n]:[]});break;default:a.forEach(t=>{o[t]=[n]})}(0,ed.Z)(s)&&(o=s(o)),e.setElementState(o,this.options.animation)}selector(t,e,i){if(!i||0===i.length)return[];let n=[],r=t.getData();if(i.forEach(i=>{r["".concat(i,"s")].forEach(i=>{let r=t7(i);"hidden"!==t.getElementVisibility(r)&&function(t,e,i,n){let r=t[0],s=t[1],a=!1;void 0===i&&(i=0),void 0===n&&(n=e.length);let o=n-i;for(let t=0,n=o-1;t<o;n=t++){let o=e[t+i][0],l=e[t+i][1],h=e[n+i][0],c=e[n+i][1],d=l>s!=c>s&&r<(h-o)*(s-l)/(c-l)+o;d&&(a=!a)}return a}(t.getElementPosition(r),e)&&n.push(r)})}),i.includes("edge")){let t=r.edges;null==t||t.forEach(t=>{let{source:e,target:i}=t;n.includes(e)&&n.includes(i)&&n.push(t7(t))})}return n}clearBrush(){var t;null===(t=this.rectShape)||void 0===t||t.remove(),this.rectShape=void 0,this.startPoint=void 0,this.endPoint=void 0}isKeydown(){let{trigger:t}=this.options,e=Array.isArray(t)?t:[t];return this.shortcut.match(e.filter(t=>"drag"!==t))}validate(t){if(this.destroyed)return!1;let{enable:e}=this.options;return(0,ed.Z)(e)?e(t):!!e}bindEvents(){let{graph:t}=this.context;t.on(T.POINTER_DOWN,this.onPointerDown),t.on(T.POINTER_MOVE,this.onPointerMove),t.on(T.POINTER_UP,this.onPointerUp),t.on(w.CLICK,this.clearStates)}unbindEvents(){let{graph:t}=this.context;t.off(T.POINTER_DOWN,this.onPointerDown),t.off(T.POINTER_MOVE,this.onPointerMove),t.off(T.POINTER_UP,this.onPointerUp),t.off(w.CLICK,this.clearStates)}update(t){this.unbindEvents(),this.options=(0,t5.Z)(this.options,t),this.bindEvents()}destroy(){this.unbindEvents(),super.destroy()}constructor(t,e){super(t,(0,t5.Z)({},e1.defaultOptions,e)),this.shortcut=new e0(t.graph),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.clearStates=this.clearStates.bind(this),this.bindEvents()}}e1.defaultOptions={animation:!1,enable:!0,enableElements:["node","combo","edge"],immediately:!1,mode:"default",state:"selected",trigger:["shift"],style:{width:0,height:0,lineWidth:1,fill:"#1677FF",stroke:"#1677FF",fillOpacity:.1,zIndex:2,pointerEvents:"none"}};let e2=t=>[t.canvas.x,t.canvas.y],e3=["node","edge","combo"];function e6(t,e,i,n){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;"TB"===n&&e(t,r);let s=i(t);if(s)for(let t of s)e6(t,e,i,n,r+1);"BT"===n&&e(t,r)}function e4(t,e,i,n){if("combo"===e||"node"===e)return e8(t,i,n);let r=t.getEdgeData(i);if(!r)return[];let s=e8(t,r.source,n-1),a=e8(t,r.target,n-1);return Array.from(new Set([...s,...a,i]))}function e8(t,e,i){let n=new Set,r=new Set,s=new Set;return!function(t,e,i){let n=[[t,0]];for(;n.length;){let[t,r]=n.shift();e(t,r);let s=i(t);if(s)for(let t of s)n.push([t,r+1])}}(e,(e,n)=>{n>i||(s.add(e),t.getRelatedEdgesData(e).forEach(t=>{let e=t7(t);!r.has(e)&&n<i&&(s.add(e),r.add(e))}))},e=>t.getRelatedEdgesData(e).map(t=>t.source===e?t.target:t.source).filter(t=>!n.has(t)&&(n.add(t),!0))),Array.from(s)}function e9(t){return t.states||[]}class e5 extends ec{bindEvents(){let{graph:t}=this.context;this.unbindEvents(),e3.forEach(e=>{t.on("".concat(e,":").concat(T.CLICK),this.onClickSelect)}),t.on(w.CLICK,this.onClickCanvas)}get isMultipleSelect(){let{multiple:t,trigger:e}=this.options;return t&&this.shortcut.match(e)}getNeighborIds(t){let{target:e,targetType:i}=t,{graph:n}=this.context,{degree:r}=this.options;return e4(n,i,e.id,"function"==typeof r?r(t):r).filter(t=>t!==e.id)}async updateState(t){let{state:e,unselectedState:i,neighborState:n,animation:r}=this.options;if(!e&&!n&&!i)return;let{target:s}=t,{graph:a}=this.context,o=a.getElementData(s.id),l=e9(o).includes(e)?"unselect":"select",h={},c=this.isMultipleSelect,d=[s.id],u=this.getNeighborIds(t);if(c){if(Object.assign(h,this.getDataStates()),"select"===l){let t=(t,e)=>{t.forEach(t=>{let n=new Set(a.getElementState(t));n.add(e),n.delete(i),h[t]=Array.from(n)})};t(d,e),t(u,n),i&&Object.keys(h).forEach(t=>{let r=h[t];r.includes(e)||r.includes(n)||r.includes(i)||h[t].push(i)})}else{let t=h[s.id];h[s.id]=t.filter(t=>t!==e&&t!==n),t.includes(i)||h[s.id].push(i),u.forEach(t=>{h[t]=h[t].filter(t=>t!==n),h[t].includes(e)||h[t].push(i)})}}else if("select"===l){Object.assign(h,this.getClearStates(!!i));let t=(t,e)=>{t.forEach(t=>{h[t]||(h[t]=a.getElementState(t)),h[t].push(e)})};t(d,e),t(u,n),i&&Object.keys(h).forEach(t=>{d.includes(t)||u.includes(t)||h[t].push(i)})}else Object.assign(h,this.getClearStates());await a.setElementState(h,r)}getDataStates(){let{graph:t}=this.context,{nodes:e,edges:i,combos:n}=t.getData(),r={};return[...e,...i,...n].forEach(t=>{r[t7(t)]=e9(t)}),r}getClearStates(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],{graph:e}=this.context,{state:i,unselectedState:n,neighborState:r}=this.options,s=new Set([i,n,r]),{nodes:a,edges:o,combos:l}=e.getData(),h={};return[...a,...o,...l].forEach(e=>{let i=e9(e),n=i.filter(t=>!s.has(t));t?h[t7(e)]=n:n.length!==i.length&&(h[t7(e)]=n)}),h}async clearState(){let{graph:t}=this.context;await t.setElementState(this.getClearStates(),this.options.animation)}validate(t){if(this.destroyed)return!1;let{enable:e}=this.options;return(0,ed.Z)(e)?e(t):!!e}unbindEvents(){let{graph:t}=this.context;e3.forEach(e=>{t.off("".concat(e,":").concat(T.CLICK),this.onClickSelect)}),t.off(w.CLICK,this.onClickCanvas)}destroy(){this.unbindEvents(),super.destroy()}constructor(t,e){super(t,Object.assign({},e5.defaultOptions,e)),this.onClickSelect=async t=>{var e,i;this.validate(t)&&(await this.updateState(t),null===(i=(e=this.options).onClick)||void 0===i||i.call(e,t))},this.onClickCanvas=async t=>{var e,i;this.validate(t)&&(await this.clearState(),null===(i=(e=this.options).onClick)||void 0===i||i.call(e,t))},this.shortcut=new e0(t.graph),this.bindEvents()}}function e7(t){var e;return!!(null===(e=t.style)||void 0===e?void 0:e.collapsed)}e5.defaultOptions={animation:!0,enable:!0,multiple:!1,trigger:["shift"],state:"selected",neighborState:"selected",unselectedState:void 0,degree:0};var it=i(67728),ie=i(57598),ii=i(60349);function ir(t,e){if(!t.startsWith(e))return!1;let i=t[e.length];return i>="A"&&i<="Z"}function is(t,e){let i=Object.entries(t).reduce((t,i)=>{let[n,r]=i;return"className"===n||"class"===n||ir(n,e)&&Object.assign(t,{[function(t,e){let i=!(arguments.length>2)||void 0===arguments[2]||arguments[2];if(!e||!ir(t,e))return t;let n=t.slice(e.length);return i?(0,ii.Z)(n):n}(n,e)]:r}),t},{});if("opacity"in t){let n="".concat(e).concat((0,tY.Z)("opacity")),r=t.opacity;if(n in t){let e=t[n];Object.assign(i,{opacity:r*e})}else Object.assign(i,{opacity:r})}return i}function ia(t,e){let i=e.length;return Object.keys(t).reduce((n,r)=>{if(r.startsWith(e)){let e=r.slice(i);n[e]=t[r]}return n},{})}function io(t,e){let i="string"==typeof e?[e]:e,n={};return Object.keys(t).forEach(e=>{i.find(t=>e.startsWith(t))||(n[e]=t[e])}),n}function il(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if("number"==typeof t)return[t,t,t];let[e,i=e,n=e]=t;return[e,i,n]}function ih(t,e){let{datum:i,graph:n}=e;return"function"==typeof t?t.call(n,i):Object.fromEntries(Object.entries(t).map(t=>{let[e,r]=t;return"function"==typeof r?[e,r.call(n,i)]:[e,r]}))}function ic(t,e){let i=(null==t?void 0:t.style)||{},n=(null==e?void 0:e.style)||{};return Object.assign({},t,e,{style:Object.assign({},i,n)})}let id=new WeakMap;function iu(t,e,i){id.has(t)||id.set(t,{});let n=id.get(t);if(!n[e])return n[e]=i,!0;let r=n[e];return!ip(r,i)&&(n[e]=i,!0)}let ip=function(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;if("object"!=typeof t||"object"!=typeof e)return t===e;let n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(let r of n){let n=t[r],s=e[r];if(i>1&&"object"==typeof n&&"object"==typeof s){if(!ip(n,s,i-1))return!1}else if(n!==s)return!1}return!0};var ig=i(23641),im=Object.prototype.hasOwnProperty,iy=function(t,e){if(!e||!(0,ig.Z)(t))return{};for(var i,n={},r=(0,ed.Z)(e)?e:function(t){return t[e]},s=0;s<t.length;s++){var a=t[s];i=r(a),im.call(n,i)?n[i].push(a):n[i]=[a]}return n};function iv(t){if(t)return"string"==typeof t||"function"==typeof t||Array.isArray(t)?{type:"group",field:t=>t.id,color:t,invert:!1}:t}function ib(t){let e="string"==typeof t?t0("palette",t):t;if("function"!=typeof e)return e}function iE(t,e){let i=2*t;return"string"==typeof e?i=t*Number(e.replace("%",""))/100:"number"==typeof e&&(i=e),isNaN(i)&&(i=2*t),i}function ix(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=(t.max[0]-t.min[0])*(n?i:1);return iE(r,e)}let iw=new WeakMap;function iS(t,e){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3?arguments[3]:void 0;if(void 0===e)return;let r=function(s){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,o=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a;return s.childNodes.forEach(e=>r(e,t))};if(n&&!n(s))return o();if(i||s!==t){iw.has(s)||iw.set(s,s.style.visibility);let t="hidden"===a||"hidden"===(iw.has(s)?iw.get(s):s.style.visibility)?"hidden":"visible";s.style.visibility=t,o(t)}else t.style.visibility=e,iw.delete(t),o(e)};r(t)}var iT=i(5605),iC={}.toString,iO=Object.prototype,iM=function(t){var e=t&&t.constructor,i="function"==typeof e&&e.prototype||iO;return t===i},iD=Object.prototype.hasOwnProperty,iA=function(t){if((0,J.Z)(t))return!0;if((0,iT.Z)(t))return!t.length;var e=iC.call(t).replace(/^\[object /,"").replace(/]$/,"");if("Map"===e||"Set"===e)return!t.size;if(iM(t))return!Object.keys(t).length;for(var i in t)if(iD.call(t,i))return!1;return!0};class ik extends I.b_{get parsedAttributes(){return this.attributes}upsert(t,e,i,n,r){var s,a,o,l,h,c,d,u;let p=this.shapeMap[t];if(!1===i){p&&(null==r||null===(o=r.beforeDestroy)||void 0===o||o.call(r,p),n.removeChild(p),delete this.shapeMap[t],null==r||null===(l=r.afterDestroy)||void 0===l||l.call(r,p));return}let g="string"==typeof e?t0(k.SHAPE,e):e;if(!g)throw Error(t1("Shape ".concat(e," not found")));if(!p||p.destroyed||!(p instanceof g)){p&&(null==r||null===(d=r.beforeDestroy)||void 0===d||d.call(r,p),null==p||p.destroy(),null==r||null===(u=r.afterDestroy)||void 0===u||u.call(r,p)),null==r||null===(h=r.beforeCreate)||void 0===h||h.call(r);let e=new g({className:t,style:i});return n.appendChild(e),this.shapeMap[t]=e,null==r||null===(c=r.afterCreate)||void 0===c||c.call(r,e),e}return null==r||null===(s=r.beforeUpdate)||void 0===s||s.call(r,p),rj(p,i),null==r||null===(a=r.afterUpdate)||void 0===a||a.call(r,p),p}transformPosition(t){let{x:e=0,y:i=0,z:n=0,transform:r}=t;(0!==e||0!==i||0!==n)&&(this.style.transform=ee(+e,+i,+n,r))}update(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=Object.assign({},this.attributes,t);this.attr(e),this.render(e,this),this.transformPosition(e),this.setVisibility()}bindEvents(){}getGraphicStyle(t){return function(t){let{x:e,y:i,z:n,class:r,className:s,transform:a,transformOrigin:o,context:l,zIndex:h,visibility:c,...d}=t;return d}(t)}get compositeShapes(){return[["badges","badge-"],["ports","port-"]]}animate(t,e){if(0===t.length)return null;let i=[];if(void 0!==t[0].x||void 0!==t[0].y||void 0!==t[0].z){let{x:e=0,y:i=0,z:n=0}=this.attributes;t.forEach(t=>{let{x:r=e,y:s=i,z:a=n}=t;Object.assign(t,{transform:ee(+r,+s,+a)})})}let n=super.animate(t,e);if(n&&(iP(this,n),i.push(n)),Array.isArray(t)&&t.length>0){let n=["transform","transformOrigin","x","y","z","zIndex"];if(Object.keys(t[0]).some(t=>!n.includes(t))){Object.entries(this.shapeMap).forEach(n=>{let[r,s]=n,a="get".concat((0,tY.Z)(r),"Style"),o=this[a];if((0,ed.Z)(o)){let n=t.map(t=>o.call(this,{...this.attributes,...t})),r=s.animate(t4(n),e);r&&(iP(s,r),i.push(r))}});let n=(n,r)=>{if(!iA(n)){let s="get".concat((0,tY.Z)(r),"Style"),a=this[s];if((0,ed.Z)(a)){let r=t.map(t=>a.call(this,{...this.attributes,...t}));Object.entries(r[0]).map(t=>{let[s]=t,a=r.map(t=>t[s]),o=n[s];if(o){let t=o.animate(t4(a),e);t&&(iP(o,t),i.push(t))}})}}};this.compositeShapes.forEach(t=>{let[e,i]=t,r=ia(this.shapeMap,i);n(r,e)})}}return t6(i)}getShape(t){return this.shapeMap[t]}setVisibility(){let{visibility:t}=this.attributes;iS(this,t,!0)}destroy(){this.shapeMap={},this.animateMap={},super.destroy()}constructor(t){super(t),this.shapeMap={},this.animateMap={},this.transformPosition(this.attributes),this.render(this.attributes,this),this.setVisibility(),this.bindEvents()}}function iP(t,e){null==e||e.finished.then(()=>{let i=t.activeAnimations.findIndex(t=>t===e);i>-1&&t.activeAnimations.splice(i,1)})}class iR extends ik{isTextStyle(t){return ir(t,"label")}isBackgroundStyle(t){return ir(t,"background")}getTextStyle(t){let{padding:e,...i}=this.getGraphicStyle(t);return io(i,"background")}getBackgroundStyle(t){if(!1===t.background)return!1;let e=this.getGraphicStyle(t),{wordWrap:i,wordWrapWidth:n,padding:r}=e,s=is(e,"background"),{min:[a,o],center:[l,h],halfExtents:[c,d]}=this.shapeMap.text.getGeometryBounds(),[u,p,g,f]=ef(r),m=2*c+f+p,{width:y,height:v}=s;y&&v?Object.assign(s,{x:l-Number(y)/2,y:h-Number(v)/2}):Object.assign(s,{x:a-f,y:o-u,width:i?Math.min(m,n+f+p):m,height:2*d+u+g});let{radius:b}=s;if("string"==typeof b&&b.endsWith("%")){let t=Number(b.replace("%",""))/100;s.radius=Math.min(+s.width,+s.height)*t}return s}render(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.parsedAttributes,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;this.upsert("text",I.xv,this.getTextStyle(t),e),this.upsert("background",I.UL,this.getBackgroundStyle(t),e)}getGeometryBounds(){let t=this.getShape("background")||this.getShape("text");return t.getGeometryBounds()}constructor(t){super(ic({style:iR.defaultStyleProps},t))}}iR.defaultStyleProps={padding:0,fontSize:12,fontFamily:"system-ui, sans-serif",wordWrap:!0,maxLines:1,wordWrapWidth:128,textOverflow:"...",textBaseline:"middle",backgroundOpacity:.75,backgroundZIndex:-1,backgroundLineWidth:0};class iN extends ik{getBadgeStyle(t){return this.getGraphicStyle(t)}render(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.parsedAttributes,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;this.upsert("label",iR,this.getBadgeStyle(t),e)}getGeometryBounds(){let t=this.getShape("label"),e=t.getShape("background")||t.getShape("text");return e.getGeometryBounds()}constructor(t){super(ic({style:iN.defaultStyleProps},t))}}iN.defaultStyleProps={padding:[2,4,2,4],fontSize:10,wordWrap:!1,backgroundRadius:"50%",backgroundOpacity:1};let iL={M:["x","y"],m:["dx","dy"],H:["x"],h:["dx"],V:["y"],v:["dy"],L:["x","y"],l:["dx","dy"],Z:[],z:[],C:["x1","y1","x2","y2","x","y"],c:["dx1","dy1","dx2","dy2","dx","dy"],S:["x2","y2","x","y"],s:["dx2","dy2","dx","dy"],Q:["x1","y1","x","y"],q:["dx1","dy1","dx","dy"],T:["x","y"],t:["dx","dy"],A:["rx","ry","rotation","large-arc","sweep","x","y"],a:["rx","ry","rotation","large-arc","sweep","dx","dy"]},iI=t=>{if(t.length<2)return[["M",0,0],["L",0,0]];let e=t[0],i=t[1],n=t[t.length-1],r=t[t.length-2];t.unshift(r,n),t.push(e,i);let s=[["M",n[0],n[1]]];for(let e=1;e<t.length-2;e+=1){let[i,n]=t[e-1],[r,a]=t[e],[o,l]=t[e+1],[h,c]=e!==t.length-2?t[e+2]:[o,l],d=r+(o-i)/6,u=a+(l-n)/6,p=o-(h-r)/6,g=l-(c-a)/6;s.push(["C",d,u,p,g,o,l])}return s};class i_ extends ik{getLabelStyle(t){if(!t.label||!t.d||0===t.d.length)return!1;let{maxWidth:e,offsetX:i,offsetY:n,autoRotate:r,placement:s,closeToPath:a,...o}=is(this.getGraphicStyle(t),"label"),l=this.shapeMap.key,h=null==l?void 0:l.getRenderBounds();return Object.assign(function(t,e,i,n,r,s,a){var o;let l,h;let[c,d]=eG(t,e),u={textAlign:"left"===e?"right":"right"===e?"left":"center",textBaseline:"top"===e?"bottom":"bottom"===e?"top":"middle",transform:"translate(".concat(c+i,", ").concat(d+n,")")};if("center"===e||!r)return u;let p=function(t){let e=[],i="string"==typeof t?function(t){let e=t.replace(/[\n\r]/g,"").replace(/-/g," -").replace(/(\d*\.)(\d+)(?=\.)/g,"$1$2 ").trim().split(/\s*,|\s+/),i=[],n="",r={};for(;e.length>0;){let t=e.shift();t in iL?n=t:e.unshift(t),r={type:n},iL[n].forEach(i=>{t=e.shift(),r[i]=t}),"M"===n?n="L":"m"===n&&(n="l");let[s,...a]=Object.values(r);i.push([s,...a.map(Number)])}return i}(t):t;return i.forEach(t=>{let i=t[0];if("Z"===i){e.push(e[0]);return}if("A"!==i)for(let i=1;i<t.length;i+=2)e.push([t[i],t[i+1],0]);else{let i=t.length;e.push([t[i-2],t[i-1],0])}}),e}(s);if(!p||p.length<=3)return u;let g=p.map((t,e)=>{let i=p[(e+1)%p.length];return(0,tU.Z)(t,i)?null:[t,i]}).filter(Boolean),f=(o=[c,d],l=1/0,h=[[0,0],[0,0]],g.forEach(t=>{let e=function(t,e){let i=eX(t,e);return eR(t,i)}(o,t);e<l&&(l=e,h=t)}),h),m=eX([c,d],f);if(m&&f&&(u.transform="translate(".concat(m[0]+i,", ").concat(m[1]+n,")"),a)){let t=Math.atan((f[0][1]-f[1][1])/(f[0][0]-f[1][0]));u.transform+="rotate(".concat(t/Math.PI*180,"deg)"),u.textAlign="center",("right"===e||"left"===e)&&(t>0?u.textBaseline="right"===e?"bottom":"top":u.textBaseline="right"===e?"top":"bottom")}return u}(h,s,i,n,a,t.d,r),{wordWrapWidth:ix(h,e)},o)}getKeyStyle(t){return this.getGraphicStyle(t)}render(t,e){this.upsert("key",I.y$,this.getKeyStyle(t),e),this.upsert("label",iR,this.getLabelStyle(t),e)}constructor(t){super(ic({style:i_.defaultStyleProps},t))}}i_.defaultStyleProps={label:!0,labelPlacement:"bottom",labelCloseToPath:!0,labelAutoRotate:!0,labelOffsetX:0,labelOffsetY:0};class iB extends I.Ee{handleRadius(){let{radius:t,clipPath:e,width:i=0,height:n=0}=this.attributes;if(t&&i&&n){let[r,s]=this.getBounds().min,a={x:r,y:s,radius:t,width:i,height:n};if(e)Object.assign(this.parsedStyle.clipPath.style,a);else{let t=new I.UL({style:a});this.style.clipPath=t}}else e&&(this.style.clipPath=null)}constructor(t){super(t),this.onMounted=()=>{this.handleRadius()},this.onAttrModified=()=>{this.handleRadius()},ij=this,this.isMutationObserved=!0,this.addEventListener(I.Dk.MOUNTED,this.onMounted),this.addEventListener(I.Dk.ATTR_MODIFIED,this.onAttrModified)}}let iF=new WeakMap,ij=null,iz=t=>{if(ij&&(function(t){let e=[],i=t.parentNode;for(;i;)e.push(i),i=i.parentNode;return e})(ij).includes(t)){let e=iF.get(t);e?e.includes(ij)||e.push(ij):iF.set(t,[ij])}},iZ=t=>{let e=iF.get(t);e&&e.forEach(t=>t.handleRadius())};class iW extends ik{isImage(){let{src:t}=this.attributes;return!!t}getIconStyle(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.attributes,{width:e=0,height:i=0}=t,n=this.getGraphicStyle(t);return this.isImage()?{x:-e/2,y:-i/2,...n}:{textBaseline:"middle",textAlign:"center",...n}}render(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.attributes,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;this.upsert("icon",this.isImage()?iB:I.xv,this.getIconStyle(t),e)}constructor(t){super(t)}}class iG extends ik{get context(){return this.attributes.context}get parsedAttributes(){return this.attributes}onframe(){}animate(t,e){let i=super.animate(t,e);return i&&(i.onframe=()=>this.onframe(),i.finished.then(()=>this.onframe())),i}}class iH extends iG{getSize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.attributes,{size:e}=t;return il(e)}getKeyStyle(t){let e=this.getGraphicStyle(t);return Object.assign(io(e,["label","halo","icon","badge","port"]))}getLabelStyle(t){if(!1===t.label||!t.labelText)return!1;let{placement:e,maxWidth:i,offsetX:n,offsetY:r,...s}=is(this.getGraphicStyle(t),"label"),a=this.getShape("key").getLocalBounds();return Object.assign(rF(a,e,n,r),{wordWrapWidth:ix(a,i)},s)}getHaloStyle(t){if(!1===t.halo)return!1;let{fill:e,...i}=this.getKeyStyle(t),n=is(this.getGraphicStyle(t),"halo");return{...i,stroke:e,...n}}getIconStyle(t){if(!1===t.icon||!t.iconText&&!t.iconSrc)return!1;let e=is(this.getGraphicStyle(t),"icon");return Object.assign(function(t,e){let i=il(t),n={};return e.text&&!e.fontSize&&(n={fontSize:.5*Math.min(...i)}),!e.src||e.width&&e.height||(n={width:.5*i[0],height:.5*i[1]}),n}(t.size,e),e)}getBadgesStyle(t){var e;let i=ia(this.shapeMap,"badge-"),n={};if(Object.keys(i).forEach(t=>{n[t]=!1}),!1===t.badge||!(null===(e=t.badges)||void 0===e?void 0:e.length))return n;let{badges:r=[],badgePalette:s,opacity:a=1,...o}=t,l=ib(s),h=is(this.getGraphicStyle(o),"badge");return r.forEach((t,e)=>{n[e]={backgroundFill:l?l[e%(null==l?void 0:l.length)]:void 0,opacity:a,...h,...this.getBadgeStyle(t)}}),n}getBadgeStyle(t){let e=this.getShape("key"),{placement:i="top",offsetX:n,offsetY:r,...s}=t,a=rF(e.getLocalBounds(),i,n,r,!0);return{...a,...s}}getPortsStyle(t){var e;let i=this.getPorts(),n={};if(Object.keys(i).forEach(t=>{n[t]=!1}),!1===t.port||!(null===(e=t.ports)||void 0===e?void 0:e.length))return n;let r=is(this.getGraphicStyle(t),"port"),{ports:s=[]}=t;return s.forEach((e,i)=>{let s=e.key||i,a={...r,...e};if(rR(a))n[s]=!1;else{let[i,r]=this.getPortXY(t,e);n[s]={transform:"translate(".concat(i,", ").concat(r,")"),...a}}}),n}getPortXY(t,e){let{placement:i="left"}=e,n=this.getShape("key");return rk(function(t,e){if(!t)return e.getLocalBounds();let i=t.canvas.getLayer(),n=e.cloneNode();iS(n,"hidden"),i.appendChild(n);let r=n.getLocalBounds();return i.removeChild(n),r}(this.context,n),i)}getPorts(){return ia(this.shapeMap,"port-")}getCenter(){return this.getShape("key").getBounds().center}getIntersectPoint(t){let e=this.getShape("key").getBounds();return function(t,e){let i=eG(e,"center"),n=[eG(e,"left-top"),eG(e,"right-top"),eG(e,"right-bottom"),eG(e,"left-bottom")];return eK(t,i,n,!1).point}(t,e)}drawHaloShape(t,e){let i=this.getHaloStyle(t);if(!iu(this,"halo",i))return;let n=this.getShape("key");this.upsert("halo",n.constructor,i,e)}drawIconShape(t,e){let i=this.getIconStyle(t);iu(this,"icon",i)&&(this.upsert("icon",iW,i,e),iz(this))}drawBadgeShapes(t,e){let i=this.getBadgesStyle(t);Object.keys(i).forEach(t=>{let n=i[t];iu(this,"badge-".concat(t),n)&&this.upsert("badge-".concat(t),iN,n,e)})}drawPortShapes(t,e){let i=this.getPortsStyle(t);Object.keys(i).forEach(t=>{let n=i[t],r="port-".concat(t);iu(this,r,n)&&this.upsert(r,I.Cd,n,e)})}drawLabelShape(t,e){let i=this.getLabelStyle(t);iu(this,"label",i)&&this.upsert("label",iR,i,e)}_drawKeyShape(t,e){return this.drawKeyShape(t,e)}render(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.parsedAttributes,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;this._drawKeyShape(t,e),this.getShape("key")&&(this.drawHaloShape(t,e),this.drawIconShape(t,e),this.drawBadgeShapes(t,e),this.drawLabelShape(t,e),this.drawPortShapes(t,e))}update(t){super.update(t),t&&("x"in t||"y"in t||"z"in t)&&iZ(this)}onframe(){this.drawBadgeShapes(this.parsedAttributes,this),this.drawLabelShape(this.parsedAttributes,this)}constructor(t){super(ic({style:iH.defaultStyleProps},t)),this.type="node"}}iH.defaultStyleProps={x:0,y:0,size:32,droppable:!0,draggable:!0,port:!0,ports:[],portZIndex:2,portLinkToCenter:!1,badge:!0,badges:[],badgeZIndex:3,halo:!1,haloDroppable:!1,haloLineDash:0,haloLineWidth:12,haloStrokeOpacity:.25,haloPointerEvents:"none",haloZIndex:-1,icon:!0,iconZIndex:1,label:!0,labelIsBillboard:!0,labelMaxWidth:"200%",labelPlacement:"bottom",labelWordWrap:!1,labelZIndex:0};class iV extends iH{drawKeyShape(t,e){return this.upsert("key",I.Cd,this.getKeyStyle(t),e)}getKeyStyle(t){let e=super.getKeyStyle(t);return{...e,r:Math.min(...this.getSize(t))/2}}getIconStyle(t){let e=super.getIconStyle(t),{r:i}=this.getShape("key").attributes,n=2*i*.8;return!!e&&{width:n,height:n,...e}}getIntersectPoint(t){let e=this.getShape("key").getBounds();return e$(t,e)}constructor(t){super(ic({style:iV.defaultStyleProps},t))}}iV.defaultStyleProps={size:32};class iY extends iH{get parsedAttributes(){return this.attributes}drawKeyShape(t,e){return this.upsert("key",I.mg,this.getKeyStyle(t),e)}getKeyStyle(t){let e=super.getKeyStyle(t);return{...e,points:this.getPoints(t)}}getIntersectPoint(t){var e,i;let{points:n}=this.getShape("key").attributes,r=[+((null===(e=this.attributes)||void 0===e?void 0:e.x)||0),+((null===(i=this.attributes)||void 0===i?void 0:i.y)||0)];return eK(t,r,n).point}constructor(t){super(t)}}class iU extends iV{parseOuterR(){let{size:t}=this.parsedAttributes;return Math.min(...il(t))/2}parseInnerR(){let{innerR:t}=this.parsedAttributes;return(0,B.Z)(t)?parseInt(t)/100*this.parseOuterR():t}drawDonutShape(t,e){var i;let{donuts:n}=t;if(!(null==n?void 0:n.length))return;let r=n.map(t=>(0,F.Z)(t)?{value:t}:t),s=is(this.getGraphicStyle(t),"donut"),a=ib(t.donutPalette);if(!a)return;let o=r.reduce((t,e)=>t+(null!==(i=e.value)&&void 0!==i?i:0),0),l=this.parseOuterR(),h=this.parseInnerR(),c=0;r.forEach((t,i)=>{let{value:n=0,color:d=a[i%a.length],...u}=t,p=(0===o?1/r.length:n/o)*360;this.upsert("round".concat(i),I.y$,{...s,d:iq(l,h,c,c+p),fill:d,...u},e),c+=p})}render(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;super.render(t,e),this.drawDonutShape(t,e)}constructor(t){super(ic({style:iU.defaultStyleProps},t))}}iU.defaultStyleProps={innerR:"50%",donuts:[],donutPalette:"tableau"};let iK=(t,e,i,n)=>[t+Math.sin(n)*i,e-Math.cos(n)*i],i$=(t,e,i,n)=>n<=0||i<=n?[["M",t-i,e],["A",i,i,0,1,1,t+i,e],["A",i,i,0,1,1,t-i,e],["Z"]]:[["M",t-i,e],["A",i,i,0,1,1,t+i,e],["A",i,i,0,1,1,t-i,e],["Z"],["M",t+n,e],["A",n,n,0,1,0,t-n,e],["A",n,n,0,1,0,t+n,e],["Z"]],iX=(t,e,i,n,r,s)=>{let[a,o]=[r/360*2*Math.PI,s/360*2*Math.PI],l=[iK(t,e,n,a),iK(t,e,i,a),iK(t,e,i,o),iK(t,e,n,o)],h=o-a>Math.PI?1:0;return[["M",l[0][0],l[0][1]],["L",l[1][0],l[1][1]],["A",i,i,0,h,1,l[2][0],l[2][1]],["L",l[3][0],l[3][1]],["A",n,n,0,h,0,l[0][0],l[0][1]],["Z"]]},iq=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,[r,s]=[0,0];return Math.abs(i-n)%360<1e-6?i$(r,s,t,e):iX(r,s,t,e,i,n)};class iJ extends iH{drawKeyShape(t,e){return this.upsert("key",I.Pj,this.getKeyStyle(t),e)}getKeyStyle(t){let e=super.getKeyStyle(t),[i,n]=this.getSize(t);return{...e,rx:i/2,ry:n/2}}getIconStyle(t){let e=super.getIconStyle(t),{rx:i,ry:n}=this.getShape("key").attributes,r=2*Math.min(+i,+n)*.8;return!!e&&{width:r,height:r,...e}}getIntersectPoint(t){let e=this.getShape("key").getBounds();return e$(t,e)}constructor(t){super(ic({style:iJ.defaultStyleProps},t))}}function iQ(t,e){var i=e.cx,n=void 0===i?0:i,r=e.cy,s=void 0===r?0:r,a=e.r;t.arc(n,s,a,0,2*Math.PI,!1)}function i0(t,e){var i=e.cx,n=void 0===i?0:i,r=e.cy,s=void 0===r?0:r,a=e.rx,o=e.ry;if(t.ellipse)t.ellipse(n,s,a,o,0,0,2*Math.PI,!1);else{var l=a>o?a:o,h=a>o?1:a/o,c=a>o?o/a:1;t.save(),t.scale(h,c),t.arc(n,s,l,0,2*Math.PI)}}function i1(t,e){var i,n=e.x1,r=e.y1,s=e.x2,a=e.y2,o=e.markerStart,l=e.markerEnd,h=e.markerStartOffset,c=e.markerEndOffset,d=0,u=0,p=0,g=0,f=0;o&&(0,I.RV)(o)&&h&&(d=Math.cos(f=Math.atan2(a-r,s-n))*(h||0),u=Math.sin(f)*(h||0)),l&&(0,I.RV)(l)&&c&&(p=Math.cos(f=Math.atan2(r-a,n-s))*(c||0),g=Math.sin(f)*(c||0)),t.moveTo(n+d,r+u),t.lineTo(s+p,a+g)}function i2(t,e){var i,n=e.markerStart,r=e.markerEnd,s=e.markerStartOffset,a=e.markerEndOffset,o=e.d,l=o.absolutePath,h=o.segments,c=0,d=0,u=0,p=0,g=0;if(n&&(0,I.RV)(n)&&s){var f=(0,_.CR)(n.parentNode.getStartTangent(),2),m=f[0],y=f[1];i=m[0]-y[0],c=Math.cos(g=Math.atan2(m[1]-y[1],i))*(s||0),d=Math.sin(g)*(s||0)}if(r&&(0,I.RV)(r)&&a){var v=(0,_.CR)(r.parentNode.getEndTangent(),2),m=v[0],y=v[1];i=m[0]-y[0],u=Math.cos(g=Math.atan2(m[1]-y[1],i))*(a||0),p=Math.sin(g)*(a||0)}for(var b=0;b<l.length;b++){var E=l[b],x=E[0],w=l[b+1],S=0===b&&(0!==c||0!==d),T=(b===l.length-1||w&&("M"===w[0]||"Z"===w[0]))&&0!==u&&0!==p;switch(x){case"M":S?t.moveTo(E[1]+c,E[2]+d):t.moveTo(E[1],E[2]);break;case"L":T?t.lineTo(E[1]+u,E[2]+p):t.lineTo(E[1],E[2]);break;case"Q":t.quadraticCurveTo(E[1],E[2],E[3],E[4]),T&&t.lineTo(E[3]+u,E[4]+p);break;case"C":t.bezierCurveTo(E[1],E[2],E[3],E[4],E[5],E[6]),T&&t.lineTo(E[5]+u,E[6]+p);break;case"A":var C=h[b].arcParams,O=C.cx,M=C.cy,D=C.rx,A=C.ry,k=C.startAngle,P=C.endAngle,R=C.xRotation,N=C.sweepFlag;if(t.ellipse)t.ellipse(O,M,D,A,R,k,P,!!(1-N));else{var L=D>A?D:A,B=D>A?1:D/A,F=D>A?A/D:1;t.translate(O,M),t.rotate(R),t.scale(B,F),t.arc(0,0,L,k,P,!!(1-N)),t.scale(1/B,1/F),t.rotate(-R),t.translate(-O,-M)}T&&t.lineTo(E[6]+u,E[7]+p);break;case"Z":t.closePath()}}}function i3(t,e){var i,n=e.markerStart,r=e.markerEnd,s=e.markerStartOffset,a=e.markerEndOffset,o=e.points.points,l=o.length,h=o[0][0],c=o[0][1],d=o[l-1][0],u=o[l-1][1],p=0,g=0,f=0,m=0,y=0;n&&(0,I.RV)(n)&&s&&(i=o[1][0]-o[0][0],p=Math.cos(y=Math.atan2(o[1][1]-o[0][1],i))*(s||0),g=Math.sin(y)*(s||0)),r&&(0,I.RV)(r)&&a&&(i=o[l-1][0]-o[0][0],f=Math.cos(y=Math.atan2(o[l-1][1]-o[0][1],i))*(a||0),m=Math.sin(y)*(a||0)),t.moveTo(h+(p||f),c+(g||m));for(var v=1;v<l-1;v++){var b=o[v];t.lineTo(b[0],b[1])}t.lineTo(d,u)}function i6(t,e){var i,n=e.markerStart,r=e.markerEnd,s=e.markerStartOffset,a=e.markerEndOffset,o=e.points.points,l=o.length,h=o[0][0],c=o[0][1],d=o[l-1][0],u=o[l-1][1],p=0,g=0,f=0,m=0,y=0;n&&(0,I.RV)(n)&&s&&(i=o[1][0]-o[0][0],p=Math.cos(y=Math.atan2(o[1][1]-o[0][1],i))*(s||0),g=Math.sin(y)*(s||0)),r&&(0,I.RV)(r)&&a&&(i=o[l-2][0]-o[l-1][0],f=Math.cos(y=Math.atan2(o[l-2][1]-o[l-1][1],i))*(a||0),m=Math.sin(y)*(a||0)),t.moveTo(h+p,c+g);for(var v=1;v<l-1;v++){var b=o[v];t.lineTo(b[0],b[1])}t.lineTo(d+f,u+m)}function i4(t,e){var i=e.x,n=void 0===i?0:i,r=e.y,s=void 0===r?0:r,a=e.radius,o=e.width,l=e.height;if(a&&a.some(function(t){return 0!==t})){var h=o>0?1:-1,c=l>0?1:-1,d=h+c===0,u=(0,_.CR)(a.map(function(t){return(0,q.Z)(t,0,Math.min(Math.abs(o)/2,Math.abs(l)/2))}),4),p=u[0],g=u[1],f=u[2],m=u[3];t.moveTo(h*p+n,s),t.lineTo(o-h*g+n,s),0!==g&&t.arc(o-h*g+n,c*g+s,g,-c*Math.PI/2,h>0?0:Math.PI,d),t.lineTo(o+n,l-c*f+s),0!==f&&t.arc(o-h*f+n,l-c*f+s,f,h>0?0:Math.PI,c>0?Math.PI/2:1.5*Math.PI,d),t.lineTo(h*m+n,l+s),0!==m&&t.arc(h*m+n,l-c*m+s,m,c>0?Math.PI/2:-Math.PI/2,h>0?Math.PI:0,d),t.lineTo(n,c*p+s),0!==p&&t.arc(h*p+n,c*p+s,p,h>0?Math.PI:0,c>0?1.5*Math.PI:Math.PI/2,d)}else t.rect(n,s,o,l)}iJ.defaultStyleProps={size:[45,35]};var i8=function(t){function e(){var e=t.apply(this,(0,_.ev)([],(0,_.CR)(arguments),!1))||this;return e.name="canvas-path-generator",e}return(0,_.ZT)(e,t),e.prototype.init=function(){var t,e=((t={})[I.bn.CIRCLE]=iQ,t[I.bn.ELLIPSE]=i0,t[I.bn.RECT]=i4,t[I.bn.LINE]=i1,t[I.bn.POLYLINE]=i6,t[I.bn.POLYGON]=i3,t[I.bn.PATH]=i2,t[I.bn.TEXT]=void 0,t[I.bn.GROUP]=void 0,t[I.bn.IMAGE]=void 0,t[I.bn.HTML]=void 0,t[I.bn.MESH]=void 0,t);this.context.pathGeneratorFactory=e},e.prototype.destroy=function(){delete this.context.pathGeneratorFactory},e}(I.F6),i9=i(56310),i5=i(58963),i7=Z.Ue(),nt=Z.Ue(),ne=Z.Ue(),ni=z.create(),nn=function(){function t(){var t=this;this.isHit=function(e,i,n,r){var s=t.context.pointInPathPickerFactory[e.nodeName];if(s){var a=z.invert(ni,n),o=Z.fF(nt,Z.t8(ne,i[0],i[1],0),a);if(s(e,new I.E9(o[0],o[1]),r,t.isPointInPath,t.context,t.runtime))return!0}return!1},this.isPointInPath=function(e,i){var n=t.runtime.offscreenCanvasCreator.getOrCreateContext(t.context.config.offscreenCanvas),r=t.context.pathGeneratorFactory[e.nodeName];return r&&(n.beginPath(),r(n,e.parsedStyle),n.closePath()),n.isPointInPath(i.x,i.y)}}return t.prototype.apply=function(e,i){var n,r=this,s=e.renderingService,a=e.renderingContext;this.context=e,this.runtime=i;var o=null===(n=a.root)||void 0===n?void 0:n.ownerDocument;s.hooks.pick.tapPromise(t.tag,function(t){return(0,_.mG)(r,void 0,void 0,function(){return(0,_.Jh)(this,function(e){return[2,this.pick(o,t)]})})}),s.hooks.pickSync.tap(t.tag,function(t){return r.pick(o,t)})},t.prototype.pick=function(t,e){var i,n,r=e.topmost,s=e.position,a=s.x,o=s.y,l=Z.t8(i7,a,o,0),h=t.elementsFromBBox(l[0],l[1],l[0],l[1]),c=[];try{for(var d=(0,_.XA)(h),u=d.next();!u.done;u=d.next()){var p=u.value,g=p.getWorldTransform();if(this.isHit(p,l,g,!1)){var f=(0,I.Oi)(p);if(f){var m=f.parsedStyle.clipPath;if(this.isHit(m,l,m.getWorldTransform(),!0)){if(r)return e.picked=[p],e;c.push(p)}}else{if(r)return e.picked=[p],e;c.push(p)}}}}catch(t){i={error:t}}finally{try{u&&!u.done&&(n=d.return)&&n.call(d)}finally{if(i)throw i.error}}return e.picked=c,e},t.tag="CanvasPicker",t}();function nr(t,e,i){var n=t.parsedStyle,r=n.cx,s=n.cy,a=n.r,o=n.fill,l=n.stroke,h=n.lineWidth,c=n.increasedLineWidthForHitTesting,d=n.pointerEvents,u=((void 0===h?1:h)+(void 0===c?0:c))/2,p=(0,i9.TE)(void 0===r?0:r,void 0===s?0:s,e.x,e.y),g=(0,_.CR)((0,I.L1)(void 0===d?"auto":d,o,l),2),f=g[0],m=g[1];return f&&m||i?p<=a+u:f?p<=a:!!m&&p>=a-u&&p<=a+u}function ns(t,e,i){var n,r,s,a,o,l,h=t.parsedStyle,c=h.cx,d=void 0===c?0:c,u=h.cy,p=void 0===u?0:u,g=h.rx,f=h.ry,m=h.fill,y=h.stroke,v=h.lineWidth,b=h.increasedLineWidthForHitTesting,E=h.pointerEvents,x=e.x,w=e.y,S=(0,_.CR)((0,I.L1)(void 0===E?"auto":E,m,y),2),T=S[0],C=S[1],O=((void 0===v?1:v)+(void 0===b?0:b))/2,M=(x-d)*(x-d),D=(w-p)*(w-p);return T&&C||i?1>=M/((n=g+O)*n)+D/((r=f+O)*r):T?1>=M/(g*g)+D/(f*f):!!C&&M/((s=g-O)*s)+D/((a=f-O)*a)>=1&&1>=M/((o=g+O)*o)+D/((l=f+O)*l)}function na(t,e,i,n,r,s){return r>=t&&r<=t+i&&s>=e&&s<=e+n}function no(t,e,i,n,r,s,a,o){var l=(Math.atan2(o-e,a-t)+2*Math.PI)%(2*Math.PI),h={x:t+i*Math.cos(l),y:e+i*Math.sin(l)};return(0,i9.TE)(h.x,h.y,a,o)<=s/2}function nl(t,e,i,n,r,s,a){var o=Math.min(t,i),l=Math.max(t,i),h=Math.min(e,n),c=Math.max(e,n),d=r/2;return s>=o-d&&s<=l+d&&a>=h-d&&a<=c+d&&(0,i9._x)(t,e,i,n,s,a)<=r/2}function nh(t,e,i,n,r){var s=t.length;if(s<2)return!1;for(var a=0;a<s-1;a++)if(nl(t[a][0],t[a][1],t[a+1][0],t[a+1][1],e,i,n))return!0;if(r){var o=t[0],l=t[s-1];if(nl(o[0],o[1],l[0],l[1],e,i,n))return!0}return!1}function nc(t){return 1e-6>Math.abs(t)?0:t<0?-1:1}function nd(t,e,i){var n=!1,r=t.length;if(r<=2)return!1;for(var s=0;s<r;s++){var a,o=t[s],l=t[(s+1)%r];if(((a=[e,i])[0]-o[0])*(l[1]-o[1])==(l[0]-o[0])*(a[1]-o[1])&&Math.min(o[0],l[0])<=a[0]&&a[0]<=Math.max(o[0],l[0])&&Math.min(o[1],l[1])<=a[1]&&a[1]<=Math.max(o[1],l[1]))return!0;nc(o[1]-i)>0!=nc(l[1]-i)>0&&0>nc(e-(i-o[1])*(o[0]-l[0])/(o[1]-l[1])-o[0])&&(n=!n)}return n}function nu(t,e,i){for(var n=!1,r=0;r<t.length&&!(n=nd(t[r],e,i));r++);return n}function np(t,e,i){var n=t.parsedStyle,r=n.x1,s=n.y1,a=n.x2,o=n.y2,l=n.lineWidth,h=void 0===l?1:l,c=n.increasedLineWidthForHitTesting,d=void 0===c?0:c,u=n.pointerEvents,p=void 0===u?"auto":u,g=n.fill,f=n.stroke;return(!!(0,_.CR)((0,I.L1)(p,g,f),2)[1]||!!i)&&!!h&&nl(r,s,a,o,h+d,e.x,e.y)}function ng(t,e,i,n,r,s){var a=t.parsedStyle,o=a.lineWidth,l=a.increasedLineWidthForHitTesting,h=a.stroke,c=a.fill,d=a.d,u=a.pointerEvents,p=d.segments,g=d.hasArc,f=d.polylines,m=d.polygons,y=(0,_.CR)((0,I.L1)(void 0===u?"auto":u,(null==m?void 0:m.length)&&c,h),2),v=y[0],b=y[1],E=(0,I.gz)(t),x=!1;return v||i?x=g?n(t,e):nu(m,e.x,e.y)||nu(f,e.x,e.y):(b||i)&&(x=function(t,e,i,n,r){for(var s=!1,a=e/2,o=0;o<t.length;o++){var l=t[o],h=l.currentPoint,c=l.params,d=l.prePoint,u=l.box;if(!u||na(u.x-a,u.y-a,u.width+e,u.height+e,i,n))switch(l.command){case"L":case"Z":if(s=nl(d[0],d[1],h[0],h[1],e,i,n))return!0;break;case"Q":if(s=(0,i9.Y1)(d[0],d[1],c[1],c[2],c[3],c[4],i,n)<=e/2)return!0;break;case"C":if(s=(0,i9.ph)(d[0],d[1],c[1],c[2],c[3],c[4],c[5],c[6],i,n,r)<=e/2)return!0;break;case"A":l.cubicParams||(l.cubicParams=(0,i5.W)(d[0],d[1],c[1],c[2],c[3],c[4],c[5],c[6],c[7],void 0));for(var p=l.cubicParams,g=d,f=0;f<p.length;f+=6){var m=(0,i9.ph)(g[0],g[1],p[f],p[f+1],p[f+2],p[f+3],p[f+4],p[f+5],i,n,r);if(g=[p[f+4],p[f+5]],s=m<=e/2)return!0}}}return s}(p,(void 0===o?1:o)+(void 0===l?0:l),e.x,e.y,E)),x}function nf(t,e,i){var n=t.parsedStyle,r=n.stroke,s=n.fill,a=n.lineWidth,o=n.increasedLineWidthForHitTesting,l=n.points,h=n.pointerEvents,c=(0,_.CR)((0,I.L1)(void 0===h?"auto":h,s,r),2),d=c[0],u=c[1],p=!1;return(u||i)&&(p=nh(l.points,(void 0===a?1:a)+(void 0===o?0:o),e.x,e.y,!0)),!p&&(d||i)&&(p=nd(l.points,e.x,e.y)),p}function nm(t,e,i){var n=t.parsedStyle,r=n.lineWidth,s=void 0===r?1:r,a=n.increasedLineWidthForHitTesting,o=void 0===a?0:a,l=n.points,h=n.pointerEvents,c=void 0===h?"auto":h,d=n.fill,u=n.stroke;return(!!(0,_.CR)((0,I.L1)(c,d,u),2)[1]||!!i)&&!!s&&nh(l.points,s+o,e.x,e.y,!1)}function ny(t,e,i,n,r){var s,a,o,l=t.parsedStyle,h=l.radius,c=l.fill,d=l.stroke,u=l.lineWidth,p=l.increasedLineWidthForHitTesting,g=l.x,f=void 0===g?0:g,m=l.y,y=void 0===m?0:m,v=l.width,b=l.height,E=l.pointerEvents,x=(0,_.CR)((0,I.L1)(void 0===E?"auto":E,c,d),2),w=x[0],S=x[1],T=h&&h.some(function(t){return 0!==t}),C=(void 0===u?1:u)+(void 0===p?0:p);if(T){var O,M,D,A,k,P,R,N,L=!1;return(S||i)&&(O=h.map(function(t){return(0,q.Z)(t,0,Math.min(Math.abs(v)/2,Math.abs(b)/2))}),M=e.x,D=e.y,k=(A=(0,_.CR)(O,4))[0],P=A[1],R=A[2],N=A[3],L=nl(f+k,y,f+v-P,y,C,M,D)||nl(f+v,y+P,f+v,y+b-R,C,M,D)||nl(f+v-R,y+b,f+N,y+b,C,M,D)||nl(f,y+b-N,f,y+k,C,M,D)||no(f+v-P,y+P,P,1.5*Math.PI,2*Math.PI,C,M,D)||no(f+v-R,y+b-R,R,0,.5*Math.PI,C,M,D)||no(f+N,y+b-N,N,.5*Math.PI,Math.PI,C,M,D)||no(f+k,y+k,k,Math.PI,1.5*Math.PI,C,M,D)),!L&&(w||i)&&(L=n(t,e)),L}var B=C/2;return w&&S||i?na(f-B,y-B,v+B,b+B,e.x,e.y):w?na(f,y,v,b,e.x,e.y):!!S&&(s=e.x,a=e.y,na(f-(o=C/2),y-o,v,C,s,a)||na(f+v-o,y-o,C,b,s,a)||na(f+o,y+b-o,v,C,s,a)||na(f-o,y+o,C,b,s,a))}function nv(t,e,i,n,r,s){var a=t.parsedStyle,o=a.pointerEvents,l=a.x,h=a.y,c=a.width,d=a.height;if("non-transparent-pixel"===(void 0===o?"auto":o)){var u=r.config.offscreenCanvas,p=s.offscreenCanvasCreator.getOrCreateCanvas(u),g=s.offscreenCanvasCreator.getOrCreateContext(u,{willReadFrequently:!0});return p.width=c,p.height=d,r.defaultStyleRendererFactory[I.bn.IMAGE].render(g,(0,_.pi)((0,_.pi)({},t.parsedStyle),{x:0,y:0}),t,void 0,void 0,void 0),g.getImageData(e.x-(void 0===l?0:l),e.y-(void 0===h?0:h),1,1).data.every(function(t){return 0!==t})}return!0}var nb=function(t){function e(){var e=t.apply(this,(0,_.ev)([],(0,_.CR)(arguments),!1))||this;return e.name="canvas-picker",e}return(0,_.ZT)(e,t),e.prototype.init=function(){var t,e=((t={})[I.bn.CIRCLE]=nr,t[I.bn.ELLIPSE]=ns,t[I.bn.RECT]=ny,t[I.bn.LINE]=np,t[I.bn.POLYLINE]=nm,t[I.bn.POLYGON]=nf,t[I.bn.PATH]=ng,t[I.bn.TEXT]=function(){return!0},t[I.bn.GROUP]=null,t[I.bn.IMAGE]=nv,t[I.bn.HTML]=null,t[I.bn.MESH]=null,t);this.context.pointInPathPickerFactory=e,this.addRenderingPlugin(new nn)},e.prototype.destroy=function(){delete this.context.pointInPathPickerFactory,this.removeAllRenderingPlugins()},e}(I.F6),nE=function(){function t(t){this.canvasRendererPluginOptions=t,this.removedRBushNodeAABBs=[],this.renderQueue=[],this.restoreStack=[],this.clearFullScreenLastFrame=!1,this.clearFullScreen=!1,this.vpMatrix=z.create(),this.dprMatrix=z.create(),this.tmpMat4=z.create(),this.vec3a=Z.Ue(),this.vec3b=Z.Ue(),this.vec3c=Z.Ue(),this.vec3d=Z.Ue()}return t.prototype.apply=function(e,i){var n=this;this.context=e;var r=e.config,s=e.camera,a=e.renderingService,o=e.renderingContext,l=e.rBushRoot,h=e.pathGeneratorFactory;this.rBush=l,this.pathGeneratorFactory=h;var c=e.contextService,d=o.root.ownerDocument.defaultView,u=function(t){var e=t.target.rBushNode;e.aabb&&n.removedRBushNodeAABBs.push(e.aabb)},p=function(t){var e=t.target.rBushNode;e.aabb&&n.removedRBushNodeAABBs.push(e.aabb)};a.hooks.init.tap(t.tag,function(){d.addEventListener(I.Dk.UNMOUNTED,u),d.addEventListener(I.Dk.CULLED,p);var t=c.getDPR(),e=r.width,i=r.height,s=c.getContext();n.clearRect(s,0,0,e*t,i*t,r.background)}),a.hooks.destroy.tap(t.tag,function(){d.removeEventListener(I.Dk.UNMOUNTED,u),d.removeEventListener(I.Dk.CULLED,p),n.renderQueue=[],n.removedRBushNodeAABBs=[],n.restoreStack=[]}),a.hooks.beginFrame.tap(t.tag,function(){var t,e=c.getContext(),i=c.getDPR(),s=r.width,o=r.height,l=n.canvasRendererPluginOptions,h=l.dirtyObjectNumThreshold,u=l.dirtyObjectRatioThreshold,p=a.getStats(),g=p.total,f=p.rendered;n.clearFullScreen=n.clearFullScreenLastFrame||!(null===(t=d.context.renderingPlugins[1])||void 0===t?void 0:t.isFirstTimeRenderingFinished)||a.disableDirtyRectangleRendering()||f>h&&f/g>u,e&&(e.resetTransform?e.resetTransform():e.setTransform(1,0,0,1,0,0),n.clearFullScreen&&n.clearRect(e,0,0,s*i,o*i,r.background))});var g=function(t,e){t.isVisible()&&!t.isCulled()&&n.renderDisplayObject(t,e,n.context,n.restoreStack,i),(t.sortable.sorted||t.childNodes).forEach(function(t){g(t,e)})};a.hooks.endFrame.tap(t.tag,function(){if(0===o.root.childNodes.length){n.clearFullScreenLastFrame=!0;return}n.clearFullScreenLastFrame=!1;var t=c.getContext(),e=c.getDPR();if(z.fromScaling(n.dprMatrix,[e,e,1]),z.multiply(n.vpMatrix,n.dprMatrix,s.getOrthoMatrix()),n.clearFullScreen)g(o.root,t);else{var a=n.safeMergeAABB.apply(n,(0,_.ev)([n.mergeDirtyAABBs(n.renderQueue)],(0,_.CR)(n.removedRBushNodeAABBs.map(function(t){var e=t.minX,i=t.minY,n=t.maxX,r=t.maxY,s=new I.mN;return s.setMinMax([e,i,0],[n,r,0]),s})),!1));if(n.removedRBushNodeAABBs=[],I.mN.isEmpty(a)){n.renderQueue=[];return}var l=n.convertAABB2Rect(a),h=l.x,u=l.y,p=l.width,f=l.height,m=Z.fF(n.vec3a,[h,u,0],n.vpMatrix),y=Z.fF(n.vec3b,[h+p,u,0],n.vpMatrix),v=Z.fF(n.vec3c,[h,u+f,0],n.vpMatrix),b=Z.fF(n.vec3d,[h+p,u+f,0],n.vpMatrix),E=Math.min(m[0],y[0],b[0],v[0]),x=Math.min(m[1],y[1],b[1],v[1]),w=Math.max(m[0],y[0],b[0],v[0]),S=Math.max(m[1],y[1],b[1],v[1]),T=Math.floor(E),C=Math.floor(x),O=Math.ceil(w-E),M=Math.ceil(S-x);t.save(),n.clearRect(t,T,C,O,M,r.background),t.beginPath(),t.rect(T,C,O,M),t.clip(),t.setTransform(n.vpMatrix[0],n.vpMatrix[1],n.vpMatrix[4],n.vpMatrix[5],n.vpMatrix[12],n.vpMatrix[13]),r.renderer.getConfig().enableDirtyRectangleRenderingDebug&&d.dispatchEvent(new I.Aw(I.$6.DIRTY_RECTANGLE,{dirtyRect:{x:T,y:C,width:O,height:M}})),n.searchDirtyObjects(a).sort(function(t,e){return t.sortable.renderOrder-e.sortable.renderOrder}).forEach(function(e){e&&e.isVisible()&&!e.isCulled()&&n.renderDisplayObject(e,t,n.context,n.restoreStack,i)}),t.restore(),n.renderQueue.forEach(function(t){n.saveDirtyAABB(t)}),n.renderQueue=[]}n.restoreStack.forEach(function(){t.restore()}),n.restoreStack=[]}),a.hooks.render.tap(t.tag,function(t){n.clearFullScreen||n.renderQueue.push(t)})},t.prototype.clearRect=function(t,e,i,n,r,s){t.clearRect(e,i,n,r),s&&(t.fillStyle=s,t.fillRect(e,i,n,r))},t.prototype.renderDisplayObject=function(t,e,i,n,r){var s=t.nodeName,a=n[n.length-1];a&&!(t.compareDocumentPosition(a)&I.NB.DOCUMENT_POSITION_CONTAINS)&&(e.restore(),n.pop());var o=this.context.styleRendererFactory[s],l=this.pathGeneratorFactory[s],h=t.parsedStyle.clipPath;if(h){this.applyWorldTransform(e,h);var c=this.pathGeneratorFactory[h.nodeName];c&&(e.save(),n.push(t),e.beginPath(),c(e,h.parsedStyle),e.closePath(),e.clip())}o&&(this.applyWorldTransform(e,t),e.save(),this.applyAttributesToContext(e,t)),l&&(e.beginPath(),l(e,t.parsedStyle),t.nodeName!==I.bn.LINE&&t.nodeName!==I.bn.PATH&&t.nodeName!==I.bn.POLYLINE&&e.closePath()),o&&(o.render(e,t.parsedStyle,t,i,this,r),e.restore()),t.renderable.dirty=!1},t.prototype.convertAABB2Rect=function(t){var e=t.getMin(),i=t.getMax(),n=Math.floor(e[0]),r=Math.floor(e[1]);return{x:n,y:r,width:Math.ceil(i[0])-n,height:Math.ceil(i[1])-r}},t.prototype.mergeDirtyAABBs=function(t){var e=new I.mN;return t.forEach(function(t){var i=t.getRenderBounds();e.add(i);var n=t.renderable.dirtyRenderBounds;n&&e.add(n)}),e},t.prototype.searchDirtyObjects=function(t){var e=(0,_.CR)(t.getMin(),2),i=e[0],n=e[1],r=(0,_.CR)(t.getMax(),2),s=r[0],a=r[1];return this.rBush.search({minX:i,minY:n,maxX:s,maxY:a}).map(function(t){return t.displayObject})},t.prototype.saveDirtyAABB=function(t){var e=t.renderable;e.dirtyRenderBounds||(e.dirtyRenderBounds=new I.mN);var i=t.getRenderBounds();i&&e.dirtyRenderBounds.update(i.center,i.halfExtents)},t.prototype.applyAttributesToContext=function(t,e){var i=e.parsedStyle,n=i.stroke,r=i.fill,s=i.opacity,a=i.lineDash,o=i.lineDashOffset;a&&t.setLineDash(a),(0,J.Z)(o)||(t.lineDashOffset=o),(0,J.Z)(s)||(t.globalAlpha*=s),(0,J.Z)(n)||Array.isArray(n)||n.isNone||(t.strokeStyle=e.attributes.stroke),(0,J.Z)(r)||Array.isArray(r)||r.isNone||(t.fillStyle=e.attributes.fill)},t.prototype.applyWorldTransform=function(t,e,i){i?(z.copy(this.tmpMat4,e.getLocalTransform()),z.multiply(this.tmpMat4,i,this.tmpMat4),z.multiply(this.tmpMat4,this.vpMatrix,this.tmpMat4)):(z.copy(this.tmpMat4,e.getWorldTransform()),z.multiply(this.tmpMat4,this.vpMatrix,this.tmpMat4)),t.setTransform(this.tmpMat4[0],this.tmpMat4[1],this.tmpMat4[4],this.tmpMat4[5],this.tmpMat4[12],this.tmpMat4[13])},t.prototype.safeMergeAABB=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=new I.mN;return t.forEach(function(t){i.add(t)}),i},t.tag="CanvasRenderer",t}(),nx=function(){function t(t){this.imagePool=t}return t.prototype.render=function(t,e,i,n,r,s){var a=e.fill,o=e.fillRule,l=e.opacity,h=void 0===l?1:l,c=e.fillOpacity,d=e.stroke,u=e.strokeOpacity,p=e.lineWidth,g=void 0===p?1:p,f=e.lineCap,m=e.lineJoin,y=e.shadowType,v=e.shadowColor,b=e.shadowBlur,E=e.filter,x=e.miterLimit,w=a&&!a.isNone,S=d&&!d.isNone&&g>0,T=(null==a?void 0:a.alpha)===0,C=!!(E&&E.length),O=!(0,J.Z)(v)&&b>0,M=i.nodeName,D="inner"===y,A=S&&O&&(M===I.bn.PATH||M===I.bn.LINE||M===I.bn.POLYLINE||T||D);w&&(t.globalAlpha=h*(void 0===c?1:c),A||nw(i,t,O),nC(t,i,a,o,n,r,s,this.imagePool),A||this.clearShadowAndFilter(t,C,O)),S&&(t.globalAlpha=h*(void 0===u?1:u),t.lineWidth=g,(0,J.Z)(x)||(t.miterLimit=x),(0,J.Z)(f)||(t.lineCap=f),(0,J.Z)(m)||(t.lineJoin=m),A&&(D&&(t.globalCompositeOperation="source-atop"),nw(i,t,!0),D&&(nO(t,i,d,n,r,s,this.imagePool),t.globalCompositeOperation="source-over",this.clearShadowAndFilter(t,C,!0))),nO(t,i,d,n,r,s,this.imagePool))},t.prototype.clearShadowAndFilter=function(t,e,i){if(i&&(t.shadowColor="transparent",t.shadowBlur=0),e){var n=t.filter;!(0,J.Z)(n)&&n.indexOf("drop-shadow")>-1&&(t.filter=n.replace(/drop-shadow\([^)]*\)/,"").trim()||"none")}},t}();function nw(t,e,i){var n=t.parsedStyle,r=n.filter,s=n.shadowColor,a=n.shadowBlur,o=n.shadowOffsetX,l=n.shadowOffsetY;r&&r.length&&(e.filter=t.style.filter),i&&(e.shadowColor=s.toString(),e.shadowBlur=a||0,e.shadowOffsetX=o||0,e.shadowOffsetY=l||0)}function nS(t,e,i,n,r,s,a){if("rect"===t.image.nodeName){var o,l,h=t.image.parsedStyle,c=h.width,d=h.height;l=n.contextService.getDPR();var u=n.config.offscreenCanvas;(o=s.offscreenCanvasCreator.getOrCreateCanvas(u)).width=c*l,o.height=d*l;var p=s.offscreenCanvasCreator.getOrCreateContext(u),g=[];t.image.forEach(function(t){r.renderDisplayObject(t,p,n,g,s)}),g.forEach(function(){p.restore()})}return a.getOrCreatePatternSync(t,i,o,l,e.getGeometryBounds().min,function(){e.renderable.dirty=!0,n.renderingService.dirtify()})}function nT(t,e,i,n){var r;if(t.type===I.GL.LinearGradient||t.type===I.GL.RadialGradient){var s=e.getGeometryBounds(),a=s&&2*s.halfExtents[0]||1,o=s&&2*s.halfExtents[1]||1,l=s&&s.min||[0,0];r=n.getOrCreateGradient((0,_.pi)((0,_.pi)({type:t.type},t.value),{min:l,width:a,height:o}),i)}return r}function nC(t,e,i,n,r,s,a,o,l){void 0===l&&(l=!1),Array.isArray(i)?i.forEach(function(i){t.fillStyle=nT(i,e,t,o),l||(n?t.fill(n):t.fill())}):((0,I.R)(i)&&(t.fillStyle=nS(i,e,t,r,s,a,o)),l||(n?t.fill(n):t.fill()))}function nO(t,e,i,n,r,s,a,o){void 0===o&&(o=!1),Array.isArray(i)?i.forEach(function(i){t.strokeStyle=nT(i,e,t,a),o||t.stroke()}):((0,I.R)(i)&&(t.strokeStyle=nS(i,e,t,n,r,s,a)),o||t.stroke())}var nM=function(){function t(t){this.imagePool=t}return t.prototype.render=function(t,e,i){var n,r=e.x,s=e.y,a=e.width,o=e.height,l=e.src,h=e.shadowColor,c=e.shadowBlur,d=a,u=o;if((0,B.Z)(l)?n=this.imagePool.getImageSync(l):(d||(d=l.width),u||(u=l.height),n=l),n){nw(i,t,!(0,J.Z)(h)&&c>0);try{t.drawImage(n,void 0===r?0:r,void 0===s?0:s,d,u)}catch(t){}}},t}(),nD=function(){function t(t){this.imagePool=t}return t.prototype.render=function(t,e,i,n,r,s){i.getBounds();var a=e.lineWidth,o=void 0===a?1:a,l=e.textAlign,h=void 0===l?"start":l,c=e.textBaseline,d=void 0===c?"alphabetic":c,u=e.lineJoin,p=e.miterLimit,g=void 0===p?10:p,f=e.letterSpacing,m=void 0===f?0:f,y=e.stroke,v=e.fill,b=e.fillRule,E=e.fillOpacity,x=void 0===E?1:E,w=e.strokeOpacity,S=void 0===w?1:w,T=e.opacity,C=void 0===T?1:T,O=e.metrics,M=e.x,D=e.y,A=e.dx,k=e.dy,P=e.shadowColor,R=e.shadowBlur,N=O.font,L=O.lines,I=O.height,_=O.lineHeight,B=O.lineMetrics;t.font=N,t.lineWidth=o,t.textAlign="middle"===h?"center":h;var F=d;s.enableCSSParsing||"alphabetic"!==F||(F="bottom"),t.lineJoin=void 0===u?"miter":u,(0,J.Z)(g)||(t.miterLimit=g);var j=void 0===D?0:D;"middle"===d?j+=-I/2-_/2:"bottom"===d||"alphabetic"===d||"ideographic"===d?j+=-I:("top"===d||"hanging"===d)&&(j+=-_);var z=(void 0===M?0:M)+(A||0);j+=k||0,1===L.length&&("bottom"===F?(F="middle",j-=.5*I):"top"===F&&(F="middle",j+=.5*I)),t.textBaseline=F,nw(i,t,!(0,J.Z)(P)&&R>0);for(var Z=0;Z<L.length;Z++){var W=o/2+z;j+=_,(0,J.Z)(y)||y.isNone||!o||this.drawLetterSpacing(t,i,L[Z],B[Z],h,W,j,m,v,b,x,y,S,C,!0,n,r,s),(0,J.Z)(v)||this.drawLetterSpacing(t,i,L[Z],B[Z],h,W,j,m,v,b,x,y,S,C,!1,n,r,s)}},t.prototype.drawLetterSpacing=function(t,e,i,n,r,s,a,o,l,h,c,d,u,p,g,f,m,y){if(0===o){g?this.strokeText(t,e,i,s,a,d,u,f,m,y):this.fillText(t,e,i,s,a,l,h,c,p,f,m,y);return}var v=t.textAlign;t.textAlign="left";var b=s;"center"===r||"middle"===r?b=s-n.width/2:("right"===r||"end"===r)&&(b=s-n.width);for(var E=Array.from(i),x=t.measureText(i).width,w=0,S=0;S<E.length;++S){var T=E[S];g?this.strokeText(t,e,T,b,a,d,u,f,m,y):this.fillText(t,e,T,b,a,l,h,c,p,f,m,y),b+=x-(w=t.measureText(i.substring(S+1)).width)+o,x=w}t.textAlign=v},t.prototype.fillText=function(t,e,i,n,r,s,a,o,l,h,c,d){nC(t,e,s,a,h,c,d,this.imagePool,!0);var u,p=!(0,J.Z)(o)&&1!==o;p&&(u=t.globalAlpha,t.globalAlpha=o*l),t.fillText(i,n,r),p&&(t.globalAlpha=u)},t.prototype.strokeText=function(t,e,i,n,r,s,a,o,l,h){nO(t,e,s,o,l,h,this.imagePool,!0);var c,d=!(0,J.Z)(a)&&1!==a;d&&(c=t.globalAlpha,t.globalAlpha=a),t.strokeText(i,n,r),d&&(t.globalAlpha=c)},t}();(0,_.ZT)(function(){return null!==nx&&nx.apply(this,arguments)||this},nx),(0,_.ZT)(function(){return null!==nx&&nx.apply(this,arguments)||this},nx),(0,_.ZT)(function(){return null!==nx&&nx.apply(this,arguments)||this},nx),(0,_.ZT)(function(){return null!==nx&&nx.apply(this,arguments)||this},nx),(0,_.ZT)(function(){return null!==nx&&nx.apply(this,arguments)||this},nx),(0,_.ZT)(function(){return null!==nx&&nx.apply(this,arguments)||this},nx),(0,_.ZT)(function(){return null!==nx&&nx.apply(this,arguments)||this},nx);var nA=function(t){function e(e){void 0===e&&(e={});var i=t.call(this)||this;return i.options=e,i.name="canvas-renderer",i}return(0,_.ZT)(e,t),e.prototype.init=function(){var t,e=(0,_.pi)({dirtyObjectNumThreshold:500,dirtyObjectRatioThreshold:.8},this.options),i=this.context.imagePool,n=new nx(i),r=((t={})[I.bn.CIRCLE]=n,t[I.bn.ELLIPSE]=n,t[I.bn.RECT]=n,t[I.bn.IMAGE]=new nM(i),t[I.bn.TEXT]=new nD(i),t[I.bn.LINE]=n,t[I.bn.POLYLINE]=n,t[I.bn.POLYGON]=n,t[I.bn.PATH]=n,t[I.bn.GROUP]=void 0,t[I.bn.HTML]=void 0,t[I.bn.MESH]=void 0,t);this.context.defaultStyleRendererFactory=r,this.context.styleRendererFactory=r,this.addRenderingPlugin(new nE(e))},e.prototype.destroy=function(){this.removeAllRenderingPlugins(),delete this.context.defaultStyleRendererFactory,delete this.context.styleRendererFactory},e}(I.F6),nk=function(){function t(){}return t.prototype.apply=function(e,i){var n=this,r=e.renderingService,s=e.renderingContext,a=e.config;this.context=e;var o=s.root.ownerDocument.defaultView,l=function(t){r.hooks.pointerMove.call(t)},h=function(t){r.hooks.pointerUp.call(t)},c=function(t){r.hooks.pointerDown.call(t)},d=function(t){r.hooks.pointerOver.call(t)},u=function(t){r.hooks.pointerOut.call(t)},p=function(t){r.hooks.pointerCancel.call(t)},g=function(t){r.hooks.pointerWheel.call(t)},f=function(t){r.hooks.click.call(t)},m=function(t){i.globalThis.document.addEventListener("pointermove",l,!0),t.addEventListener("pointerdown",c,!0),t.addEventListener("pointerleave",u,!0),t.addEventListener("pointerover",d,!0),i.globalThis.addEventListener("pointerup",h,!0),i.globalThis.addEventListener("pointercancel",p,!0)},y=function(t){t.addEventListener("touchstart",c,!0),t.addEventListener("touchend",h,!0),t.addEventListener("touchmove",l,!0),t.addEventListener("touchcancel",p,!0)},v=function(t){i.globalThis.document.addEventListener("mousemove",l,!0),t.addEventListener("mousedown",c,!0),t.addEventListener("mouseout",u,!0),t.addEventListener("mouseover",d,!0),i.globalThis.addEventListener("mouseup",h,!0)},b=function(t){i.globalThis.document.removeEventListener("pointermove",l,!0),t.removeEventListener("pointerdown",c,!0),t.removeEventListener("pointerleave",u,!0),t.removeEventListener("pointerover",d,!0),i.globalThis.removeEventListener("pointerup",h,!0)},E=function(t){t.removeEventListener("touchstart",c,!0),t.removeEventListener("touchend",h,!0),t.removeEventListener("touchmove",l,!0),t.removeEventListener("touchcancel",p,!0)},x=function(t){i.globalThis.document.removeEventListener("mousemove",l,!0),t.removeEventListener("mousedown",c,!0),t.removeEventListener("mouseout",u,!0),t.removeEventListener("mouseover",d,!0),i.globalThis.removeEventListener("mouseup",h,!0)};r.hooks.init.tap(t.tag,function(){var t=n.context.contextService.getDomElement();i.globalThis.navigator.msPointerEnabled?(t.style.msContentZooming="none",t.style.msTouchAction="none"):o.supportsPointerEvents&&(t.style.touchAction="none"),o.supportsPointerEvents?m(t):v(t),o.supportsTouchEvents&&y(t),a.useNativeClickEvent&&t.addEventListener("click",f,!0),t.addEventListener("wheel",g,{passive:!0,capture:!0})}),r.hooks.destroy.tap(t.tag,function(){var t=n.context.contextService.getDomElement();i.globalThis.navigator.msPointerEnabled?(t.style.msContentZooming="",t.style.msTouchAction=""):o.supportsPointerEvents&&(t.style.touchAction=""),o.supportsPointerEvents?b(t):x(t),o.supportsTouchEvents&&E(t),a.useNativeClickEvent&&t.removeEventListener("click",f,!0),t.removeEventListener("wheel",g,!0)})},t.tag="DOMInteraction",t}(),nP=function(t){function e(){var e=t.apply(this,(0,_.ev)([],(0,_.CR)(arguments),!1))||this;return e.name="dom-interaction",e}return(0,_.ZT)(e,t),e.prototype.init=function(){this.addRenderingPlugin(new nk)},e.prototype.destroy=function(){this.removeAllRenderingPlugins()},e}(I.F6),nR=function(){function t(){this.displayObjectHTMLElementMap=new WeakMap}return t.prototype.joinTransformMatrix=function(t,e){return void 0===e&&(e=[0,0,0]),"matrix(".concat([t[0],t[1],t[4],t[5],t[12]+e[0],t[13]+e[1]].join(","),")")},t.prototype.apply=function(e,i){var n=this,r=e.camera,s=e.renderingContext,a=e.renderingService;this.context=e;var o=s.root.ownerDocument.defaultView,l=o.context.eventService.nativeHTMLMap,h=function(t,e){e.style.transform=n.joinTransformMatrix(t.getWorldTransform(),t.getOrigin())},c=function(t){var e=t.target;if(e.nodeName===I.bn.HTML){n.$camera||(n.$camera=n.createCamera(r));var s=n.getOrCreateEl(e);if(n.$camera.appendChild(s),i.enableCSSParsing){var a=e.ownerDocument.documentElement.attributes;Object.keys(a).forEach(function(t){s.style[t]=a[t]})}Object.keys(e.attributes).forEach(function(t){n.updateAttribute(t,e)}),h(e,s),l.set(s,e)}},d=function(t){var e=t.target;if(e.nodeName===I.bn.HTML&&n.$camera){var i=n.getOrCreateEl(e);i&&(i.remove(),l.delete(i))}},u=function(t){var e=t.target;if(e.nodeName===I.bn.HTML){var i=t.attrName;n.updateAttribute(i,e)}},p=function(t){var e=t.target;if(e.nodeName===I.bn.HTML){var i=n.getOrCreateEl(e);h(e,i)}},g=function(){if(n.$camera){var t=n.context.config,e=t.width,i=t.height;n.$camera.parentElement.style.width="".concat(e||0,"px"),n.$camera.parentElement.style.height="".concat(i||0,"px")}};a.hooks.init.tap(t.tag,function(){o.addEventListener(I.$6.RESIZE,g),o.addEventListener(I.Dk.MOUNTED,c),o.addEventListener(I.Dk.UNMOUNTED,d),o.addEventListener(I.Dk.ATTR_MODIFIED,u),o.addEventListener(I.Dk.BOUNDS_CHANGED,p)}),a.hooks.endFrame.tap(t.tag,function(){n.$camera&&s.renderReasons.has(I.Rr.CAMERA_CHANGED)&&(n.$camera.style.transform=n.joinTransformMatrix(r.getOrthoMatrix()))}),a.hooks.destroy.tap(t.tag,function(){n.$camera&&n.$camera.remove(),o.removeEventListener(I.$6.RESIZE,g),o.removeEventListener(I.Dk.MOUNTED,c),o.removeEventListener(I.Dk.UNMOUNTED,d),o.removeEventListener(I.Dk.ATTR_MODIFIED,u),o.removeEventListener(I.Dk.BOUNDS_CHANGED,p)})},t.prototype.createCamera=function(t){var e=this.context.config,i=e.document,n=e.width,r=e.height,s=this.context.contextService.getDomElement(),a=s.parentNode;if(a){var o="g-canvas-camera",l=a.querySelector("#"+o);if(!l){var h=(i||document).createElement("div");h.style.overflow="hidden",h.style.pointerEvents="none",h.style.position="absolute",h.style.left="0px",h.style.top="0px",h.style.width="".concat(n||0,"px"),h.style.height="".concat(r||0,"px");var c=(i||document).createElement("div");l=c,c.id=o,c.style.position="absolute",c.style.left="".concat(s.offsetLeft||0,"px"),c.style.top="".concat(s.offsetTop||0,"px"),c.style.transformOrigin="left top",c.style.transform=this.joinTransformMatrix(t.getOrthoMatrix()),c.style.pointerEvents="none",c.style.width="100%",c.style.height="100%",h.appendChild(c),a.appendChild(h)}return l}return null},t.prototype.getOrCreateEl=function(t){var e=this.context.config.document,i=this.displayObjectHTMLElementMap.get(t);return i||(i=(e||document).createElement("div"),t.parsedStyle.$el=i,this.displayObjectHTMLElementMap.set(t,i),t.id&&(i.id=t.id),t.name&&i.setAttribute("name",t.name),t.className&&(i.className=t.className),i.style.position="absolute",i.style["will-change"]="transform",i.style.transform=this.joinTransformMatrix(t.getWorldTransform(),t.getOrigin())),i},t.prototype.updateAttribute=function(t,e){var i=this.getOrCreateEl(e);switch(t){case"innerHTML":var n=e.parsedStyle.innerHTML;(0,B.Z)(n)?i.innerHTML=n:(i.innerHTML="",i.appendChild(n));break;case"x":i.style.left="".concat(e.parsedStyle.x,"px");break;case"y":i.style.top="".concat(e.parsedStyle.y,"px");break;case"transformOrigin":var r=e.parsedStyle.transformOrigin;i.style["transform-origin"]="".concat(r[0].buildCSSText(null,null,"")," ").concat(r[1].buildCSSText(null,null,""));break;case"width":if(this.context.enableCSSParsing){var s=e.computedStyleMap().get("width");i.style.width=s.toString()}else{var s=e.parsedStyle.width;i.style.width=(0,F.Z)(s)?"".concat(s,"px"):s.toString()}break;case"height":if(this.context.enableCSSParsing){var a=e.computedStyleMap().get("height");i.style.height=a.toString()}else{var a=e.parsedStyle.height;i.style.height=(0,F.Z)(a)?"".concat(a,"px"):a.toString()}break;case"zIndex":var o=e.parsedStyle.zIndex;i.style["z-index"]="".concat(o);break;case"visibility":var l=e.parsedStyle.visibility;i.style.visibility=l;break;case"pointerEvents":var h=e.parsedStyle.pointerEvents;i.style.pointerEvents=void 0===h?"auto":h;break;case"opacity":var c=e.parsedStyle.opacity;i.style.opacity="".concat(c);break;case"fill":var d=e.parsedStyle.fill,u="";(0,I.qA)(d)?u=d.isNone?"transparent":e.getAttribute("fill"):Array.isArray(d)?u=e.getAttribute("fill"):(0,I.R)(d),i.style.background=u;break;case"stroke":var p=e.parsedStyle.stroke,g="";(0,I.qA)(p)?g=p.isNone?"transparent":e.getAttribute("stroke"):Array.isArray(p)?g=e.getAttribute("stroke"):(0,I.R)(p),i.style["border-color"]=g,i.style["border-style"]="solid";break;case"lineWidth":var f=e.parsedStyle.lineWidth;i.style["border-width"]="".concat(f||0,"px");break;case"lineDash":i.style["border-style"]="dashed";break;case"filter":var m=e.style.filter;i.style.filter=m;break;default:(0,J.Z)(e.style[t])||""===e.style[t]||(i.style[t]=e.style[t])}},t.tag="HTMLRendering",t}(),nN=function(t){function e(){var e=t.apply(this,(0,_.ev)([],(0,_.CR)(arguments),!1))||this;return e.name="html-renderer",e}return(0,_.ZT)(e,t),e.prototype.init=function(){this.addRenderingPlugin(new nR)},e.prototype.destroy=function(){this.removeAllRenderingPlugins()},e}(I.F6),nL=function(){function t(t){this.canvasConfig=t,this.imageCache={},this.gradientCache={},this.patternCache={}}return t.prototype.getImageSync=function(t,e){return this.imageCache[t]?e&&e(this.imageCache[t]):this.getOrCreateImage(t).then(function(t){e&&e(t)}),this.imageCache[t]},t.prototype.getOrCreateImage=function(t){var e=this;if(this.imageCache[t])return Promise.resolve(this.imageCache[t]);var i=this.canvasConfig.createImage;return new Promise(function(n,r){var s;i?s=i(t):I.jU&&(s=new window.Image),s&&(s.onload=function(){e.imageCache[t]=s,n(s)},s.onerror=function(t){r(t)},s.crossOrigin="Anonymous",s.src=t)})},t.prototype.getOrCreatePatternSync=function(t,e,i,n,r,s){var a,o=this.generatePatternKey(t);if(o&&this.patternCache[o])return this.patternCache[o];var l=t.image,h=t.repetition,c=t.transform,d=!1;(0,B.Z)(l)?a=this.getImageSync(l,s):i?(a=i,d=!0):a=l;var u=a&&e.createPattern(a,h);if(u){var p=void 0;p=c?(0,I.G0)((0,I.G$)(c),new I.s$({})):z.identity(z.create()),d&&z.scale(p,p,[1/n,1/n,1]),u.setTransform({a:p[0],b:p[1],c:p[4],d:p[5],e:p[12]+r[0],f:p[13]+r[1]})}return o&&u&&(this.patternCache[o]=u),u},t.prototype.getOrCreateGradient=function(t,e){var i=this.generateGradientKey(t),n=t.type,r=t.steps,s=t.min,a=t.width,o=t.height,l=t.angle,h=t.cx,c=t.cy,d=t.size;if(this.gradientCache[i])return this.gradientCache[i];var u=null;if(n===I.GL.LinearGradient){var p=(0,I.Rx)(s,a,o,l),g=p.x1,f=p.y1,m=p.x2,y=p.y2;u=e.createLinearGradient(g,f,m,y)}else if(n===I.GL.RadialGradient){var v=(0,I.o6)(s,a,o,h,c,d),b=v.x,E=v.y,x=v.r;u=e.createRadialGradient(b,E,0,b,E,x)}return u&&(r.forEach(function(t){var e=t.offset,i=t.color;e.unit===I.Cm.kPercentage&&(null==u||u.addColorStop(e.value/100,i.toString()))}),this.gradientCache[i]=u),this.gradientCache[i]},t.prototype.generateGradientKey=function(t){var e=t.type,i=t.min,n=t.width,r=t.height,s=t.steps,a=t.angle,o=t.cx,l=t.cy,h=t.size;return"gradient-".concat(e,"-").concat((null==a?void 0:a.toString())||0,"-").concat((null==o?void 0:o.toString())||0,"-").concat((null==l?void 0:l.toString())||0,"-").concat((null==h?void 0:h.toString())||0,"-").concat(i[0],"-").concat(i[1],"-").concat(n,"-").concat(r,"-").concat(s.map(function(t){var e=t.offset,i=t.color;return"".concat(e).concat(i)}).join("-"))},t.prototype.generatePatternKey=function(t){var e=t.image,i=t.repetition;return(0,B.Z)(e)?"pattern-".concat(e,"-").concat(i):"rect"===e.nodeName?"pattern-".concat(e.entity,"-").concat(i):void 0},t}(),nI=function(){function t(){}return t.prototype.apply=function(e){var i=e.renderingService,n=e.renderingContext,r=e.imagePool,s=n.root.ownerDocument.defaultView,a=function(t,e,i){var n=t.parsedStyle,r=n.width,s=n.height;r&&!s?t.setAttribute("height",i/e*r):!r&&s&&t.setAttribute("width",e/i*s)},o=function(t){var e=t.target,n=e.nodeName,s=e.attributes;if(n===I.bn.IMAGE){var o=s.src,l=s.keepAspectRatio;(0,B.Z)(o)&&r.getImageSync(o,function(t){var n=t.width,r=t.height;l&&a(e,n,r),e.renderable.dirty=!0,i.dirtify()})}},l=function(t){var e=t.target,n=t.attrName,s=t.newValue;e.nodeName===I.bn.IMAGE&&"src"===n&&(0,B.Z)(s)&&r.getOrCreateImage(s).then(function(t){var n=t.width,r=t.height;e.attributes.keepAspectRatio&&a(e,n,r),e.renderable.dirty=!0,i.dirtify()})};i.hooks.init.tap(t.tag,function(){s.addEventListener(I.Dk.MOUNTED,o),s.addEventListener(I.Dk.ATTR_MODIFIED,l)}),i.hooks.destroy.tap(t.tag,function(){s.removeEventListener(I.Dk.MOUNTED,o),s.removeEventListener(I.Dk.ATTR_MODIFIED,l)})},t.tag="LoadImage",t}(),n_=function(t){function e(){var e=t.apply(this,(0,_.ev)([],(0,_.CR)(arguments),!1))||this;return e.name="image-loader",e}return(0,_.ZT)(e,t),e.prototype.init=function(){this.context.imagePool=new nL(this.context.config),this.addRenderingPlugin(new nI)},e.prototype.destroy=function(){this.removeAllRenderingPlugins()},e}(I.F6),nB=function(){function t(t){this.renderingContext=t.renderingContext,this.canvasConfig=t.config}return t.prototype.init=function(){var t=this.canvasConfig,e=t.container,i=t.canvas;if(i)this.$canvas=i,e&&i.parentElement!==e&&e.appendChild(i),this.$container=i.parentElement,this.canvasConfig.container=this.$container;else if(e&&(this.$container=(0,B.Z)(e)?document.getElementById(e):e,this.$container)){var n=document.createElement("canvas");this.$container.appendChild(n),this.$container.style.position||(this.$container.style.position="relative"),this.$canvas=n}this.context=this.$canvas.getContext("2d"),this.resize(this.canvasConfig.width,this.canvasConfig.height)},t.prototype.getContext=function(){return this.context},t.prototype.getDomElement=function(){return this.$canvas},t.prototype.getDPR=function(){return this.dpr},t.prototype.getBoundingClientRect=function(){if(this.$canvas.getBoundingClientRect)return this.$canvas.getBoundingClientRect()},t.prototype.destroy=function(){this.$container&&this.$canvas&&this.$canvas.parentNode&&this.$container.removeChild(this.$canvas)},t.prototype.resize=function(t,e){var i=this.canvasConfig.devicePixelRatio||I.jU&&window.devicePixelRatio||1;i=i>=1?Math.ceil(i):1,this.dpr=i,this.$canvas&&(this.$canvas.width=this.dpr*t,this.$canvas.height=this.dpr*e,(0,I.$p)(this.$canvas,t,e)),this.renderingContext.renderReasons.add(I.Rr.CAMERA_CHANGED)},t.prototype.applyCursorStyle=function(t){this.$container&&this.$container.style&&(this.$container.style.cursor=t)},t.prototype.toDataURL=function(t){return void 0===t&&(t={}),(0,_.mG)(this,void 0,void 0,function(){var e,i;return(0,_.Jh)(this,function(n){return e=t.type,i=t.encoderOptions,[2,this.context.canvas.toDataURL(e,i)]})})},t}(),nF=function(t){function e(){var e=t.apply(this,(0,_.ev)([],(0,_.CR)(arguments),!1))||this;return e.name="canvas-context-register",e}return(0,_.ZT)(e,t),e.prototype.init=function(){this.context.ContextService=nB},e.prototype.destroy=function(){delete this.context.ContextService},e}(I.F6),nj=function(t){function e(e){var i=t.call(this,e)||this;return i.registerPlugin(new nF),i.registerPlugin(new n_),i.registerPlugin(new i8),i.registerPlugin(new nA),i.registerPlugin(new nP),i.registerPlugin(new nb),i.registerPlugin(new nN),i}return(0,_.ZT)(e,t),e}(I.I8),nz=i(63252),nZ=i(28036);class nW extends iH{get eventService(){return this.context.canvas.context.eventService}get events(){return[T.CLICK,T.POINTER_DOWN,T.POINTER_MOVE,T.POINTER_UP,T.POINTER_OVER,T.POINTER_LEAVE]}getDomElement(){return this.getShape("key").getDomElement()}getKeyStyle(t){let{dx:e=0,dy:i=0,...n}=(0,nz.Z)(t,["dx","dy","innerHTML","pointerEvents","cursor"]),[r,s]=this.getSize(t);return{x:e,y:i,...n,width:r,height:s}}drawKeyShape(t,e){let i=this.getKeyStyle(t),{x:n,y:r,width:s=0,height:a=0}=i,o=this.upsert("key-container",I.UL,{x:n,y:r,width:s,height:a,opacity:0},e);return this.upsert("key",I.k9,i,o)}connectedCallback(){let t=this.context.canvas.getRenderer("main");if(!(t instanceof nj))return;let e=this.getDomElement();this.events.forEach(t=>{e.addEventListener(t,this.forwardEvents)})}attributeChangedCallback(t,e,i){"zIndex"===t&&e!==i&&(this.getDomElement().style.zIndex=i)}destroy(){let t=this.getDomElement();this.events.forEach(e=>{t.removeEventListener(e,this.forwardEvents)}),super.destroy()}normalizeToPointerEvent(t,e){let i=[];if(e.isTouchEvent(t))for(let e=0;e<t.changedTouches.length;e++){let n=t.changedTouches[e];(0,nZ.Z)(n.button)&&(n.button=0),(0,nZ.Z)(n.buttons)&&(n.buttons=1),(0,nZ.Z)(n.isPrimary)&&(n.isPrimary=1===t.touches.length&&"touchstart"===t.type),(0,nZ.Z)(n.width)&&(n.width=n.radiusX||1),(0,nZ.Z)(n.height)&&(n.height=n.radiusY||1),(0,nZ.Z)(n.tiltX)&&(n.tiltX=0),(0,nZ.Z)(n.tiltY)&&(n.tiltY=0),(0,nZ.Z)(n.pointerType)&&(n.pointerType="touch"),(0,nZ.Z)(n.pointerId)&&(n.pointerId=n.identifier||0),(0,nZ.Z)(n.pressure)&&(n.pressure=n.force||.5),(0,nZ.Z)(n.twist)&&(n.twist=0),(0,nZ.Z)(n.tangentialPressure)&&(n.tangentialPressure=0),n.isNormalized=!0,n.type=t.type,i.push(n)}else e.isMouseEvent(t)&&((0,nZ.Z)(t.isPrimary)&&(t.isPrimary=!0),(0,nZ.Z)(t.width)&&(t.width=1),(0,nZ.Z)(t.height)&&(t.height=1),(0,nZ.Z)(t.tiltX)&&(t.tiltX=0),(0,nZ.Z)(t.tiltY)&&(t.tiltY=0),(0,nZ.Z)(t.pointerType)&&(t.pointerType="mouse"),(0,nZ.Z)(t.pointerId)&&(t.pointerId=1),(0,nZ.Z)(t.pressure)&&(t.pressure=.5),(0,nZ.Z)(t.twist)&&(t.twist=0),(0,nZ.Z)(t.tangentialPressure)&&(t.tangentialPressure=0),t.isNormalized=!0),i.push(t);return i}transferMouseData(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=performance.now(),t.type=e.type,t.altKey=e.altKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.ctrlKey=e.ctrlKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.screen.x=e.screenX,t.screen.y=e.screenY,t.relatedTarget=null}bootstrapEvent(t,e,i,n){t.view=i,t.originalEvent=null,t.nativeEvent=n,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e);let{x:r,y:s}=this.getViewportXY(e);t.viewport.x=r,t.viewport.y=s;let[a,o]=this.context.canvas.getCanvasByViewport([r,s]);return t.canvas.x=a,t.canvas.y=o,t.global.copyFrom(t.canvas),t.offset.copyFrom(t.canvas),t.isTrusted=n.isTrusted,"pointerleave"===t.type&&(t.type="pointerout"),t}getViewportXY(t){let e,i;let{offsetX:n,offsetY:r,clientX:s,clientY:a}=t;if(!this.context.canvas.context.config.supportsCSSTransform||(0,J.Z)(n)||(0,J.Z)(r)){let t=this.eventService.client2Viewport({x:s,y:a});e=t.x,i=t.y}else e=n,i=r;return{x:e,y:i}}onframe(){super.onframe();let{opacity:t}=this.attributes;this.getDomElement().style.opacity="".concat(t)}constructor(t){super({...t,style:Object.assign({},nW.defaultStyleProps,t.style)}),this.rootPointerEvent=new I.nR(null),this.forwardEvents=t=>{let e=this.context.canvas,i=e.context.renderingContext.root.ownerDocument.defaultView,n=this.normalizeToPointerEvent(t,i);n.forEach(n=>{let r=this.bootstrapEvent(this.rootPointerEvent,n,i,t);e.context.eventService.mapEvent(r)})}}}nW.defaultStyleProps={size:[160,80],halo:!1,icon:!1,label:!1,pointerEvents:"auto"};class nG extends iH{getKeyStyle(t){let[e,i]=this.getSize(t),{fillOpacity:n,opacity:r=n,...s}=super.getKeyStyle(t);return{opacity:r,...s,width:e,height:i,x:-e/2,y:-i/2}}getHaloStyle(t){if(!1===t.halo)return!1;let{fill:e,stroke:i,...n}=this.getShape("key").attributes,r=is(this.getGraphicStyle(t),"halo"),s=Number(r.lineWidth),[a,o]=eM(this.getSize(t),[s,s]);return{...r,width:a,height:o,fill:"transparent",x:-a/2,y:-o/2}}getIconStyle(t){let e=super.getIconStyle(t),[i,n]=this.getSize(t);return!!e&&{width:.8*i,height:.8*n,...e}}drawKeyShape(t,e){let i=this.upsert("key",iB,this.getKeyStyle(t),e);return iz(this),i}drawHaloShape(t,e){this.upsert("halo",I.UL,this.getHaloStyle(t),e)}update(t){super.update(t),t&&("x"in t||"y"in t||"z"in t)&&iZ(this)}constructor(t){super(ic({style:nG.defaultStyleProps},t))}}nG.defaultStyleProps={size:32};class nH extends iY{getPoints(t){let{direction:e}=t,[i,n]=this.getSize(t);return function(t,e,i){let n=e/2,r=t/2,s={up:[[-r,n],[r,n],[0,-n]],left:[[-r,0],[r,n],[r,-n]],right:[[-r,n],[-r,-n],[r,0]],down:[[-r,-n],[r,-n],[0,n]]};return s[i]||s.up}(i,n,e)}getPortXY(t,e){let{direction:i}=t,{placement:n="top"}=e,r=this.getShape("key").getLocalBounds(),[s,a]=this.getSize(t),o=function(t,e,i){let n=e/2,r=t/2,s={};return"down"===i?(s.bottom=s.default=[0,n],s.right=[r,-n],s.left=[-r,-n]):"left"===i?(s.top=[r,-n],s.bottom=[r,n],s.left=s.default=[-r,0]):"right"===i?(s.top=[-r,-n],s.bottom=[-r,n],s.right=s.default=[r,0]):(s.left=[-r,n],s.top=s.default=[0,-n],s.right=[r,n]),s}(s,a,i);return rk(r,n,o,!1)}getIconStyle(t){let{icon:e,iconText:i,iconSrc:n,direction:r}=t;if(!1===e||iA(i||n))return!1;let s=is(this.getGraphicStyle(t),"icon"),a=this.getShape("key").getLocalBounds(),[o,l]=function(t,e){let{center:i}=t,[n,r]=ev(t),s="up"===e||"down"===e?i[0]:"right"===e?i[0]-n/6:i[0]+n/6,a="left"===e||"right"===e?i[1]:"down"===e?i[1]-r/6:i[1]+r/6;return[s,a]}(a,r),h=2*function(t,e){let[i,n]=ev(t);return[i,n]="up"===e||"down"===e?[i,n]:[n,i],(n**2-(Math.sqrt((i/2)**2+n**2)-i/2)**2)/(2*n)}(a,r)*.8;return{x:o,y:l,width:h,height:h,...s}}constructor(t){super(ic({style:nH.defaultStyleProps},t))}}nH.defaultStyleProps={size:40,direction:"up"};class nV extends iH{getKeySize(t){let{collapsed:e,childrenNode:i=[]}=t;return 0===i.length?this.getEmptyKeySize(t):e?this.getCollapsedKeySize(t):this.getExpandedKeySize(t)}getEmptyKeySize(t){let{padding:e,collapsedSize:i}=t,[n,r,s,a]=ef(e);return eM(il(i),[a+r,n+s,0])}getCollapsedKeySize(t){return il(t.collapsedSize)}getExpandedKeySize(t){let e=this.getContentBBox(t);return[em(e),ey(e),0]}getContentBBox(t){let{context:e,childrenNode:i=[],padding:n}=t,r=i.map(t=>e.element.getElement(t)).filter(Boolean);if(0===r.length){let e=new I.mN,{x:i=0,y:n=0,size:r}=t,[s,a]=il(r);return e.setMinMax([i-s/2,n-a/2,0],[i+s/2,n+a/2,0]),e}let s=ex(r.map(t=>t.getBounds()));return n?eE(s,n):s}drawCollapsedMarkerShape(t,e){let i=this.getCollapsedMarkerStyle(t);iu(this,"collapsedMarker",i)&&(this.upsert("collapsed-marker",iW,i,e),iz(this))}getCollapsedMarkerStyle(t){if(!t.collapsed||!t.collapsedMarker)return!1;let{type:e,...i}=is(this.getGraphicStyle(t),"collapsedMarker"),n=this.getShape("key"),[r,s]=eG(n.getLocalBounds(),"center"),a={...i,x:r,y:s};if(e){let i=this.getCollapsedMarkerText(e,t);Object.assign(a,{text:i})}return a}getCollapsedMarkerText(t,e){let{context:i,childrenData:n=[]}=e,{model:r}=i;return"descendant-count"===t?r.getDescendantsData(this.id).length.toString():"child-count"===t?n.length.toString():"node-count"===t?r.getDescendantsData(this.id).filter(t=>"node"===r.getElementType(t7(t))).length.toString():(0,ed.Z)(t)?t(n):""}getComboZIndex(t){let e=this.context.model.getAncestorsData(this.id,tq)||[];return e.length}getComboPosition(t){let{x:e=0,y:i=0,collapsed:n,context:r,childrenData:s=[]}=t;if(0===s.length)return[+e,+i,0];if(n){let{model:t}=r,n=t.getDescendantsData(this.id).filter(e=>!t.isCombo(t7(e)));if(n.length>0){let t=n.reduce((t,e)=>eM(t,eW(e)),[0,0,0]);return ek(t,n.length)}return[+e,+i,0]}return this.getContentBBox(t).center}getComboStyle(t){let{zIndex:e=this.getComboZIndex(t)}=t,[i,n]=this.getComboPosition(t);return{x:i,y:n,transform:"translate(".concat(i,", ").concat(n,")"),zIndex:e}}updateComboPosition(t){let e=this.getComboStyle(t);Object.assign(this.style,e);let{x:i,y:n}=e;this.context.model.syncComboDatum({id:this.id,style:{x:i,y:n}}),iZ(this)}render(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;super.render(t,e),this.drawCollapsedMarkerShape(t,e)}update(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super.update(t),this.updateComboPosition(this.parsedAttributes)}onframe(){super.onframe(),this.attributes.collapsed||this.updateComboPosition(this.parsedAttributes),this.drawKeyShape(this.parsedAttributes,this)}animate(t,e){let i=super.animate(this.attributes.collapsed?t:t.map(t=>{let{x:e,y:i,z:n,transform:r,...s}=t;return s}),e);return i?new Proxy(i,{set:(t,e,i)=>("currentTime"===e&&Promise.resolve().then(()=>this.onframe()),Reflect.set(t,e,i))}):i}constructor(t){super(ic({style:nV.defaultStyleProps},t)),this.type="combo",this.updateComboPosition(this.parsedAttributes)}}nV.defaultStyleProps={childrenNode:[],droppable:!0,draggable:!0,collapsed:!1,collapsedSize:32,collapsedMarker:!0,collapsedMarkerZIndex:1,collapsedMarkerFontSize:12,collapsedMarkerTextAlign:"center",collapsedMarkerTextBaseline:"middle",collapsedMarkerType:"child-count"};var nY=i(36683);let nU={padding:10};function nK(t,e,i,n,r,s){let{padding:a}=Object.assign(nU,s),o=eb(i,a),l=eb(n,a),h=[t,...r,e],c=null,d=[];for(let t=0,e=h.length;t<e-1;t++){var u,p;let i=t+1,n=h[t],r=h[i],s=(u=n,p=r,u[1]===p[1]||u[0]===p[0]),g=null;0===t?i===e-1?o.intersects(l)?g=n1(n,r,o,l):s||(g=function(t,e,i,n){let r=nQ(t,e,i),s=eF(r.points[0]);if(ew(s,n)){r=nQ(e,t,n);let a=eF(r.points[0]);if(ew(a,i)){let o=eU(t,s,nJ(i,nq(t,s))/2),l=eU(e,a,nJ(n,nq(e,a))/2),h=[(o[0]+l[0])/2,(o[1]+l[1])/2],c=nQ(t,h,i),d=n0(h,e,n,c.direction);r.points=[c.points[0],d.points[0]],r.direction=d.direction}}return r}(n,r,o,l)):ew(r,o)?g=n1(n,r,o,eb(r,a),c):s||(g=nQ(n,r,o)):i===e-1?ew(n,l)?g=n1(n,r,eb(n,a),l,c):s||(g=n0(n,r,l,c)):s||(g=function(t,e,i){let n=[t[0],e[1]],r=[e[0],t[1]],s=nq(t,n),a=nq(t,r),o=i?n$[i]:null,l=s===i||s!==o&&a!==i?n:r;return{points:[l],direction:nq(l,e)}}(n,r,c)),g?(d.push(...g.points),c=g.direction):c=nq(n,r),i<e-1&&d.push(r)}return d}let n$={N:"S",S:"N",W:"E",E:"W"},nX={N:-Math.PI/2,S:Math.PI/2,E:0,W:Math.PI};function nq(t,e){let[i,n]=t,[r,s]=e;return i===r?n>s?"N":"S":n===s?i>r?"W":"E":null}function nJ(t,e){return"N"===e||"S"===e?ey(t):em(t)}function nQ(t,e,i){let n=n2(t,e,i);return{points:[n],direction:nq(n,e)}}function n0(t,e,i,n){let r=[[e[0],t[1]],[t[0],e[1]]],s=r.filter(t=>!ew(t,i)&&!eS(t,i,!0)),a=s.filter(e=>nq(e,t)!==n);if(a.length>0){let i=a.find(e=>nq(t,e)===n)||a[0];return{points:[i],direction:nq(i,e)}}{var o;let a=(void 0===(o=s)&&(o=[]),(0,nY.Z)(r,function(t){var e;return e=o,!((0,iT.Z)(e)&&e.indexOf(t)>-1)}))[0],l=eU(e,a,nJ(i,n)/2),h=n2(l,t,i);return{points:[h,l],direction:nq(l,e)}}}function n1(t,e,i,n,r){let s;let a=ex([i,n]),o=eR(e,a.center)>eR(t,a.center),[l,h]=o?[e,t]:[t,e],c=ey(a)+em(a);if(r){let t=[l[0]+c*Math.cos(nX[r]),l[1]+c*Math.sin(nX[r])];s=eU(eC(a,t),t,.01)}else s=eU(eC(a,l),l,-.01);let d=n2(s,h,a),u=[eY(s,2),eY(d,2)];if((0,tU.Z)(eY(s),eY(d))){let t=eI(eD(s,l),[1,0,0])+Math.PI/2;d=[h[0]+c*Math.cos(t),h[1]+c*Math.sin(t),0],d=eY(eU(eC(a,d),h,-.01),2);let e=n2(s,d,a);u=[s,e,d]}return{points:o?u.reverse():u,direction:o?nq(s,e):nq(d,e)}}function n2(t,e,i){let n=[t[0],e[1]];return ew(n,i)&&(n=[e[0],t[1]]),n}function n3(t,e,i,n,r){let s="number"==typeof e?e:.5;"start"===e&&(s=0),"end"===e&&(s=.99);let a=eH(t.getPoint(s)),o=eH(t.getPoint(s+.01)),l="start"===e?"left":"end"===e?"right":"center";if(a[1]===o[1]||!i){let[e,i]=n6(t,s,n,r);return{transform:"translate(".concat(e,", ").concat(i,")"),textAlign:l}}let h=Math.atan2(o[1]-a[1],o[0]-a[0]),c=o[0]<a[0];c&&(l="center"===l?l:"left"===l?"right":"left",n*=-1,h+=Math.PI);let[d,u]=n6(t,s,n,r,h),p="translate(".concat(d,", ").concat(u,") rotate(").concat(h/Math.PI*180,"deg)");return{textAlign:l,transform:p}}function n6(t,e,i,n,r){let[s,a]=eH(t.getPoint(e)),o=i,l=n;return r&&(o=i*Math.cos(r)-n*Math.sin(r),l=i*Math.sin(r)+n*Math.cos(r)),[s+o,a+l]}function n4(t,e,i,n){if((0,tU.Z)(t,e))return t;let r=eD(e,t),s=[t[0]+i*r[0],t[1]+i*r[1]],a=eL(e_(r,!1));return s[0]+=n*a[0],s[1]+=n*a[1],s}function n8(t,e,i){return[["M",t[0],t[1]],["C",i[0][0],i[0][1],i[1][0],i[1][1],e[0],e[1]]]}function n9(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=t[0],r=t[t.length-1],s=t.slice(1,t.length-1),a=[["M",n[0],n[1]]];return s.forEach((t,i)=>{let o=s[i-1]||n,l=s[i+1]||r;if(!ej([o,t],[t,l])&&e){let[i,n]=function(t,e,i,n){let r=eN(t,e),s=eN(i,e),a=Math.min(n,Math.min(r,s)/2),o=[e[0]-a/r*(e[0]-t[0]),e[1]-a/r*(e[1]-t[1])],l=[e[0]-a/s*(e[0]-i[0]),e[1]-a/s*(e[1]-i[1])];return[o,l]}(o,t,l,e);a.push(["L",i[0],i[1]],["Q",t[0],t[1],n[0],n[1]],["L",n[0],n[1]])}else a.push(["L",t[0],t[1]])}),a.push(["L",r[0],r[1]]),i&&a.push(["Z"]),a}let n5=t=>{let e=Math.PI/2,i=ey(t)/2,n=em(t)/2,r=Math.atan2(i,n)/2,s=Math.atan2(n,i)/2;return{top:[-e-s,-e+s],"top-right":[-e+s,-r],"right-top":[-e+s,-r],right:[-r,r],"bottom-right":[r,e-s],"right-bottom":[r,e-s],bottom:[e-s,e+s],"bottom-left":[e+s,Math.PI-r],"left-bottom":[e+s,Math.PI-r],left:[Math.PI-r,Math.PI+r],"top-left":[Math.PI+r,-e-s],"left-top":[Math.PI+r,-e-s]}};function n7(t,e,i,n,r){let s=eb(t),a=t.getCenter(),o=n&&rN(n),l=r&&rN(r);if(!o||!l){let n=n5(s),r=n[e][0],h=n[e][1],[c,d]=ev(s),u=Math.max(c,d),p=eM(a,[u*Math.cos(r),u*Math.sin(r),0]),g=eM(a,[u*Math.cos(h),u*Math.sin(h),0]);o=rB(t,p),l=rB(t,g),i||([o,l]=[l,o])}return[o,l]}function rt(t,e){let i=new Set,n=new Set,r=new Set;return t.forEach(s=>{let a=e(s);a.forEach(e=>{i.add(e),t.includes(e.source)&&t.includes(e.target)?n.add(e):r.add(e)})}),{edges:Array.from(i),internal:Array.from(n),external:Array.from(r)}}function re(t,e){let i=[],n=t;for(;n;){i.push(n);let t=e(t7(n));if(t)n=t;else break}if(i.some(t=>{var e;return null===(e=t.style)||void 0===e?void 0:e.collapsed})){let t=i.reverse().findIndex(e7);return i[t]||i.at(-1)}return t}let ri=(t,e)=>{let i=Math.max(t,e)/2;return[["M",-t/2,0],["A",i,i,0,1,0,2*i-t/2,0],["A",i,i,0,1,0,-t/2,0],["Z"]]},rn=(t,e)=>[["M",-t/2,0],["L",t/2,-e/2],["L",t/2,e/2],["Z"]],rr=(t,e)=>[["M",-t/2,0],["L",0,-e/2],["L",t/2,0],["L",0,e/2],["Z"]],rs=(t,e)=>[["M",-t/2,0],["L",t/2,-e/2],["L",4*t/5-t/2,0],["L",t/2,e/2],["Z"]],ra=(t,e)=>[["M",-t/2,-e/2],["L",t/2,-e/2],["L",t/2,e/2],["L",-t/2,e/2],["Z"]],ro=(t,e)=>{let i=t/2,n=t/7,r=t-n;return[["M",-i,0],["L",0,-e/2],["L",0,e/2],["Z"],["M",r-i,-e/2],["L",r+n-i,-e/2],["L",r+n-i,e/2],["L",r-i,e/2],["Z"]]},rl=(t,e)=>[["M",t/2,-e/2],["L",-t/2,0],["L",t/2,0],["L",-t/2,0],["L",t/2,e/2]];class rh extends iG{get sourceNode(){let{context:t,sourceNode:e}=this.parsedAttributes;return t.element.getElement(e)}get targetNode(){let{context:t,targetNode:e}=this.parsedAttributes;return t.element.getElement(e)}getKeyStyle(t){let{loop:e,...i}=this.getGraphicStyle(t),{sourceNode:n,targetNode:r}=this,s=e&&n&&r&&n===r?this.getLoopPath(t):this.getKeyPath(t);return{d:s,...io(i,["halo","label","startArrow","endArrow"])}}getLoopPath(t){let{sourcePort:e,targetPort:i}=t,n=this.sourceNode,r=eb(n),s=Math.max(em(r),ey(r)),{placement:a,clockwise:o,dist:l=s}=is(this.getGraphicStyle(t),"loop");return function(t,e,i,n,r,s){let a=t.getPorts()[r||s],o=t.getPorts()[s||r],[l,h]=n7(t,e,i,a,o),c=function(t,e,i,n){let r=t.getCenter();if((0,tU.Z)(e,i)){let t=eD(e,r),s=[n*Math.sign(t[0])||n/2,n*Math.sign(t[1])||-n/2,0];return[eM(e,s),eM(i,eA(s,[1,-1,1]))]}return[eU(r,e,eR(r,e)+n),eU(r,i,eR(r,i)+n)]}(t,l,h,n);return a&&(l=r_(a,c[0])),o&&(h=r_(o,c[c.length-1])),n8(l,h,c)}(n,a,o,l,e,i)}getEndpoints(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],{sourcePort:n,targetPort:r}=t,{sourceNode:s,targetNode:a}=this,[o,l]=function(t,e,i,n){let r=rL(t,e,i,n),s=rL(e,t,n,i);return[r,s]}(s,a,n,r);if(!e){let t=o?rN(o):s.getCenter(),e=l?rN(l):a.getCenter();return[t,e]}let h="function"==typeof i?i():i,c=rI(o||s,h[0]||l||a),d=rI(l||a,h[h.length-1]||o||s);return[c,d]}getHaloStyle(t){if(!1===t.halo)return!1;let e=this.getKeyStyle(t),i=is(this.getGraphicStyle(t),"halo");return{...e,...i}}getLabelStyle(t){if(!1===t.label||!t.labelText)return!1;let e=is(this.getGraphicStyle(t),"label"),{placement:i,offsetX:n,offsetY:r,autoRotate:s,maxWidth:a,...o}=e,l=n3(this.shapeMap.key,i,s,n,r),h=this.shapeMap.key.getLocalBounds(),c=function(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=eR(t[0],t[1])*i;return iE(n,e)}([h.min,h.max],a);return Object.assign({wordWrapWidth:c},l,o)}getBadgeStyle(t){if(!1===t.badge||!t.badgeText)return!1;let{offsetX:e,offsetY:i,placement:n,...r}=is(t,"badge");return Object.assign(r,function(t,e,i,n,r){var s,a;let o=(null===(s=t.badge)||void 0===s?void 0:s.getGeometryBounds().halfExtents[0])*2||0,l=(null===(a=t.label)||void 0===a?void 0:a.getGeometryBounds().halfExtents[0])*2||0;return n3(t.key,i,!0,(l?(l/2+o/2)*("suffix"===e?1:-1):0)+n,r)}(this.shapeMap,n,t.labelPlacement,e,i))}drawArrow(t,e){let i="start"===e,n=t["start"===e?"startArrow":"endArrow"],r=this.shapeMap.key;if(n){let n=this.getArrowStyle(t,i);if(!iu(this,"arrow-".concat(e),n))return;let[s,a,o]=i?["markerStart","markerStartOffset","startArrowOffset"]:["markerEnd","markerEndOffset","endArrowOffset"],l=r.parsedStyle[s];if(l)l.attr(n);else{let t=n.src?I.Ee:I.y$,e=new t({style:n});r.style[s]=e}r.style[a]=t[o]||n.width/2+ +n.lineWidth}else{var s;let t=i?"markerStart":"markerEnd";null===(s=r.style[t])||void 0===s||s.destroy(),r.style[t]=null}}getArrowStyle(t,e){var i;let n=this.getShape("key").attributes,{size:r,type:s,...a}=is(this.getGraphicStyle(t),e?"startArrow":"endArrow"),[o,l]=il((i=n.lineWidth,r||(i<4?10:4===i?12:2.5*i))),h=(0,ed.Z)(s)?s:L[s]||rn,c=h(o,l);return Object.assign((0,nz.Z)(n,["stroke","strokeOpacity","fillOpacity"]),{width:o,height:l},{...c&&{d:c,fill:"simple"===s?"":n.stroke}},a)}drawLabelShape(t,e){let i=this.getLabelStyle(t);iu(this,"label",i)&&this.upsert("label",iR,i,e)}drawHaloShape(t,e){let i=this.getHaloStyle(t);iu(this,"halo",i)&&this.upsert("halo",I.y$,i,e)}drawBadgeShape(t,e){let i=this.getBadgeStyle(t);iu(this,"badge",i)&&this.upsert("badge",iN,i,e)}drawSourceArrow(t){this.drawArrow(t,"start")}drawTargetArrow(t){this.drawArrow(t,"end")}drawKeyShape(t,e){let i=this.getKeyStyle(t);if(iu(this,"key",i))return this.upsert("key",I.y$,i,e)}render(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.parsedAttributes,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;this.drawKeyShape(t,e),this.getShape("key")&&(this.drawSourceArrow(t),this.drawTargetArrow(t),this.drawLabelShape(t,e),this.drawHaloShape(t,e),this.drawBadgeShape(t,e))}onframe(){this.drawKeyShape(this.parsedAttributes,this),this.drawSourceArrow(this.parsedAttributes),this.drawTargetArrow(this.parsedAttributes),this.drawHaloShape(this.parsedAttributes,this),this.drawLabelShape(this.parsedAttributes,this),this.drawBadgeShape(this.parsedAttributes,this)}animate(t,e){let i=super.animate(t,e);return i?new Proxy(i,{set:(t,e,i)=>("currentTime"===e&&Promise.resolve().then(()=>this.onframe()),Reflect.set(t,e,i))}):i}constructor(t){super(ic({style:rh.defaultStyleProps},t)),this.type="edge"}}rh.defaultStyleProps={badge:!0,badgeOffsetX:0,badgeOffsetY:0,badgePlacement:"suffix",isBillboard:!0,label:!0,labelAutoRotate:!0,labelIsBillboard:!0,labelMaxWidth:"80%",labelOffsetX:4,labelOffsetY:0,labelPlacement:"center",labelTextBaseline:"middle",labelWordWrap:!1,halo:!1,haloDroppable:!1,haloLineDash:0,haloLineWidth:12,haloPointerEvents:"none",haloStrokeOpacity:.25,haloZIndex:-1,loop:!0,startArrow:!1,startArrowLineDash:0,startArrowLineJoin:"round",startArrowLineWidth:1,startArrowTransformOrigin:"center",startArrowType:"vee",endArrow:!1,endArrowLineDash:0,endArrowLineJoin:"round",endArrowLineWidth:1,endArrowTransformOrigin:"center",endArrowType:"vee",loopPlacement:"top",loopClockwise:!0};class rc extends rh{getKeyPath(t){let[e,i]=this.getEndpoints(t),{controlPoints:n,curvePosition:r,curveOffset:s}=t,a=this.getControlPoints(e,i,(0,F.Z)(r)?[r,1-r]:r,(0,F.Z)(s)?[s,-s]:s,n);return n8(e,i,a)}getControlPoints(t,e,i,n,r){return(null==r?void 0:r.length)===2?r:[n4(t,e,i[0],n[0]),n4(t,e,i[1],n[1])]}constructor(t){super(ic({style:rc.defaultStyleProps},t))}}rc.defaultStyleProps={curvePosition:.5,curveOffset:20};class rd extends rc{getControlPoints(t,e,i,n){let r=e[0]-t[0];return[[t[0]+r*i[0]+n[0],t[1]],[e[0]-r*i[1]+n[1],e[1]]]}constructor(t){super(ic({style:rd.defaultStyleProps},t))}}rd.defaultStyleProps={curvePosition:[.5,.5],curveOffset:[0,0]};class ru extends rc{getControlPoints(t,e,i,n){let r=e[1]-t[1];return[[t[0],t[1]+r*i[0]+n[0]],[e[0],e[1]-r*i[1]+n[1]]]}constructor(t){super(ic({style:ru.defaultStyleProps},t))}}ru.defaultStyleProps={curvePosition:[.5,.5],curveOffset:[0,0]};class rp extends rh{getKeyPath(t){let[e,i]=this.getEndpoints(t);return[["M",e[0],e[1]],["L",i[0],i[1]]]}constructor(t){super(ic({style:rp.defaultStyleProps},t))}}rp.defaultStyleProps={};let rg={enableObstacleAvoidance:!1,offset:10,maxAllowedDirectionChange:Math.PI/2,maximumLoops:3e3,gridSize:5,startDirections:["top","right","bottom","left"],endDirections:["top","right","bottom","left"],directionMap:{right:{stepX:1,stepY:0},left:{stepX:-1,stepY:0},bottom:{stepX:0,stepY:1},top:{stepX:0,stepY:-1}},penalties:{0:0,90:0},distFunc:eN},rf=t=>"".concat(Math.round(t[0]),"|||").concat(Math.round(t[1]));function rm(t,e){let i=t=>Math.round(t/e);return(0,F.Z)(t)?i(t):t.map(i)}function ry(t,e){let i=e[0]-t[0],n=e[1]-t[1];return i||n?Math.atan2(n,i):0}function rv(t,e,i,n){let r=ry(t,e),s=i[rf(t)],a=ry(s||n,t);return function(t,e){let i=Math.abs(t-e);return i>Math.PI?2*Math.PI-i:i}(a,r)}let rb=(t,e)=>{let{offset:i,gridSize:n}=e,r={};return t.forEach(t=>{if(!t||t.destroyed||!t.isVisible())return;let e=eE(t.getRenderBounds(),i);for(let t=rm(e.min[0],n);t<=rm(e.max[0],n);t+=1)for(let i=rm(e.min[1],n);i<=rm(e.max[1],n);i+=1)r["".concat(t,"|||").concat(i)]=!0}),r};function rE(t,e,i){return Math.min(...e.map(e=>i(t,e)))}let rx=(t,e,i,n)=>{if(!e)return[t];let{directionMap:r,offset:s}=n,a=eE(e.getRenderBounds(),s),o=Object.keys(r).reduce((e,n)=>{if(i.includes(n)){let i=r[n],[s,o]=ev(a),l=[t[0]+i.stepX*s,t[1]+i.stepY*o],h=function(t){let{min:[e,i],max:[n,r]}=t,s=[e,r],a=[n,r],o=[n,i],l=[e,i];return[[s,a],[a,o],[o,l],[l,s]]}(a);for(let i=0;i<h.length;i++){let n=ez([t,l],h[i]);n&&eS(n,a)&&e.push(n)}}return e},[]);return ew(t,a)||o.push(t),o.map(t=>rm(t,n.gridSize))},rw=(t,e,i,n,r,s,a)=>{let o=[],l=[s[0]===n[0]?n[0]:t[0]*a,s[1]===n[1]?n[1]:t[1]*a];o.unshift(l);let h=t,c=e[rf(h)];for(;c;){let t=c,n=h,r=rv(t,n,e,i);r&&(l=[t[0]===n[0]?l[0]:t[0]*a,t[1]===n[1]?l[1]:t[1]*a],o.unshift(l)),c=e[rf(t)],h=t}let d=r.map(t=>[t[0]*a,t[1]*a]),u=function(t,e,i){let n=t[0],r=i(t[0],e);for(let s=0;s<t.length;s++){let a=t[s],o=i(a,e);o<r&&(n=a,r=o)}return n}(d,l,eN);return o.unshift(u),o};class rS{_innerAdd(t,e){let i=0,n=e-1;for(;n-i>1;){let e=Math.floor((i+n)/2);if(this.arr[e].value>t.value)n=e;else if(this.arr[e].value<t.value)i=e;else{this.arr.splice(e,0,t),this.map[t.id]=!0;return}}this.arr.splice(n,0,t),this.map[t.id]=!0}add(t){delete this.map[t.id];let e=this.arr.length;if(!e||this.arr[e-1].value<t.value){this.arr.push(t),this.map[t.id]=!0;return}this._innerAdd(t,e)}remove(t){this.map[t]&&delete this.map[t]}_clearAndGetMinId(){let t;for(let e=this.arr.length-1;e>=0;e--)this.map[this.arr[e].id]?t=this.arr[e].id:this.arr.splice(e,1);return t}_findFirstId(){for(;this.arr.length;){let t=this.arr.shift();if(this.map[t.id])return t.id}}minId(t){return t?this._clearAndGetMinId():this._findFirstId()}constructor(){this.arr=[],this.map={},this.arr=[],this.map={}}}class rT extends rh{getControlPoints(t){let{router:e}=t,{sourceNode:i,targetNode:n}=this,[r,s]=this.getEndpoints(t,!1),a=[];if(e){if("shortest-path"===e.type){let o=this.context.element.getNodes();(a=function(t,e,i,n){let r;let s=eB(t.getCenter()),a=eB(e.getCenter()),o=Object.assign(rg,n),{gridSize:l}=o,h=o.enableObstacleAvoidance?i:[t,e],c=rb(h,o),d=rm(s,l),u=rm(a,l),p=rx(s,t,o.startDirections,o),g=rx(a,e,o.endDirections,o);p.forEach(t=>delete c[rf(t)]),g.forEach(t=>delete c[rf(t)]);let f={},m={},y={},v={},b={},E=new rS;for(let t=0;t<p.length;t++){let e=p[t],i=rf(e);f[i]=e,v[i]=0,b[i]=rE(e,g,o.distFunc),E.add({id:i,value:b[i]})}let x=g.map(t=>rf(t)),w=o.maximumLoops,S=1/0;for(let[t,e]of Object.entries(f))b[t]<=S&&(S=b[t],r=e);for(;Object.keys(f).length>0&&w>0;){let t=E.minId(!1);if(t)r=f[t];else break;let e=rf(r);if(x.includes(e))return rw(r,y,d,a,p,u,l);for(let t of(delete f[e],E.remove(e),m[e]=!0,Object.values(o.directionMap))){let i=eM(r,[t.stepX,t.stepY]),n=rf(i);if(m[n])continue;let s=rv(r,i,y,d);if(s>o.maxAllowedDirectionChange||c[n])continue;f[n]||(f[n]=i);let a=o.penalties[s],h=o.distFunc(r,i)+(isNaN(a)?l:a),u=v[e]+h,p=v[n];p&&u>=p||(y[n]=r,v[n]=u,b[n]=u+rE(i,g,o.distFunc),E.add({id:n,value:b[n]}))}w-=1}return[]}(i,n,o,e)).length||(a=nK(r,s,i,n,t.controlPoints,{padding:e.offset}))}else"orth"===e.type&&(a=nK(r,s,i,n,t.controlPoints,e))}else a=t.controlPoints;return a}getPoints(t){let e=this.getControlPoints(t),[i,n]=this.getEndpoints(t,!0,e);return[i,...e,n]}getKeyPath(t){let e=this.getPoints(t);return n9(e,t.radius)}getLoopPath(t){let{sourcePort:e,targetPort:i,radius:n}=t,r=this.sourceNode,s=eb(r),a=Math.max(em(s),ey(s))/4,{placement:o,clockwise:l,dist:h=a}=is(this.getGraphicStyle(t),"loop");return function(t,e,i,n,r,s,a){let o=rP(t),l=o[s||a],h=o[a||s],[c,d]=n7(t,i,n,l,h),u=function(t,e,i,n){let r=[],s=eb(t);if((0,tU.Z)(e,i)){let t=eT(s,e);switch(t){case"left":r.push([e[0]-n,e[1]]),r.push([e[0]-n,e[1]+n]),r.push([e[0],e[1]+n]);break;case"right":r.push([e[0]+n,e[1]]),r.push([e[0]+n,e[1]+n]),r.push([e[0],e[1]+n]);break;case"top":r.push([e[0],e[1]-n]),r.push([e[0]+n,e[1]-n]),r.push([e[0]+n,e[1]]);break;case"bottom":r.push([e[0],e[1]+n]),r.push([e[0]+n,e[1]+n]),r.push([e[0]+n,e[1]])}}else{let t=eT(s,e),a=eT(s,i);if(t===a){let s,a;switch(t){case"left":s=Math.min(e[0],i[0])-n,r.push([s,e[1]]),r.push([s,i[1]]);break;case"right":s=Math.max(e[0],i[0])+n,r.push([s,e[1]]),r.push([s,i[1]]);break;case"top":a=Math.min(e[1],i[1])-n,r.push([e[0],a]),r.push([i[0],a]);break;case"bottom":a=Math.max(e[1],i[1])+n,r.push([e[0],a]),r.push([i[0],a])}}else{let o=(t,e)=>({left:[e[0]-n,e[1]],right:[e[0]+n,e[1]],top:[e[0],e[1]-n],bottom:[e[0],e[1]+n]})[t],l=o(t,e),h=o(a,i),c=n2(l,h,s);r.push(l,c,h)}}return r}(t,c,d,r);return l&&(c=r_(l,u[0])),h&&(d=r_(h,u[u.length-1])),n9([c,...u,d],e)}(r,n,o,l,h,e,i)}constructor(t){super(ic({style:rT.defaultStyleProps},t))}}rT.defaultStyleProps={radius:0,controlPoints:[],router:!1};class rC extends rh{getKeyPath(t){let{curvePosition:e,curveOffset:i}=t,[n,r]=this.getEndpoints(t),s=t.controlPoint||n4(n,r,e,i);return[["M",n[0],n[1]],["Q",s[0],s[1],r[0],r[1]]]}constructor(t){super(ic({style:rC.defaultStyleProps},t))}}function rO(t){return t instanceof iH&&"node"===t.type}function rM(t){return t instanceof rh}function rD(t){return t instanceof nV}rC.defaultStyleProps={curvePosition:.5,curveOffset:30};let rA={top:[.5,0],right:[1,.5],bottom:[.5,1],left:[0,.5],default:[.5,.5]};function rk(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:rA,n=!(arguments.length>3)||void 0===arguments[3]||arguments[3],r=[.5,.5],s=(0,B.Z)(e)?(0,it.Z)(i,e.toLocaleLowerCase(),r):e;if(!n&&(0,B.Z)(e))return s;let[a,o]=s||r;return[t.min[0]+em(t)*a,t.min[1]+ey(t)*o]}function rP(t){if(!t)return{};let e=t.getPorts(),i=t.attributes.ports||[];return i.forEach((i,n)=>{let{key:r,placement:s}=i;if(rR(i)){var a;e[a=r||n]||(e[a]=eG(t.getShape("key").getBounds(),s))}}),e}function rR(t){let{r:e}=t;return!e||0===Number(e)}function rN(t){return ep(t)?t:t.getPosition()}function rL(t,e,i,n){let r,s;let a=rP(t);if(i)return a[i];let o=Object.values(a);if(0===o.length)return;let l=o.map(t=>rN(t)),h=function(t,e){let i=rP(t);if(e)return[rN(i[e])];let n=Object.values(i);return n.length>0?n.map(t=>rN(t)):[t.getCenter()]}(e,n),[c]=(r=1/0,s=[l[0],h[0]],l.forEach(t=>{h.forEach(e=>{let i=eR(t,e);i<r&&(r=i,s=[t,e])})}),s);return o.find(t=>rN(t)===c)}function rI(t,e){return rD(t)||rO(t)?rB(t,e):r_(t,e)}function r_(t,e){if(!t||!e)return[0,0,0];if(ep(t))return t;if(t.attributes.linkToCenter)return t.getPosition();let i=ep(e)?e:rO(e)?e.getCenter():e.getPosition();return e$(i,t.getBounds())}function rB(t,e){if(!t||!e)return[0,0,0];let i=ep(e)?e:rO(e)?e.getCenter():e.getPosition();return t.getIntersectPoint(i)||t.getCenter()}function rF(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"bottom",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=e.split("-"),[a,o]=eG(t,e),l=s.includes("left")?"right":s.includes("right")?"left":"center",h=s.includes("top")?"bottom":s.includes("bottom")?"top":"middle";return r&&(h="top"===h?"bottom":"bottom"===h?"top":h),{transform:"translate(".concat(a+i,", ").concat(o+n,")"),textBaseline:h,textAlign:l}}function rj(t,e){"update"in t?t.update(e):t.attr(e)}function rz(t){return(0,it.Z)(t,"__to_be_destroyed__",!1)}class rZ extends ec{update(t){this.unbindEvents(),super.update(t),this.bindEvents()}bindEvents(){let{graph:t}=this.context,{trigger:e}=this.options;t.on("node:".concat(e),this.onCollapseExpand),t.on("combo:".concat(e),this.onCollapseExpand)}unbindEvents(){let{graph:t}=this.context,{trigger:e}=this.options;t.off("node:".concat(e),this.onCollapseExpand),t.off("combo:".concat(e),this.onCollapseExpand)}validate(t){if(this.destroyed)return!1;let{enable:e}=this.options;return(0,ed.Z)(e)?e(t):!!e}destroy(){this.unbindEvents(),super.destroy()}constructor(t,e){super(t,Object.assign({},rZ.defaultOptions,e)),this.onCollapseExpand=async t=>{if(!this.validate(t))return;let{target:e}=t;if(!(rO(e)||rM(e)||rD(e)))return;let i=e.id,{model:n,graph:r}=this.context,s=n.getElementDataById(i);if(!s)return!1;let{onCollapse:a,onExpand:o,animation:l}=this.options;e7(s)?(await r.expandElement(i,l),null==o||o(i)):(await r.collapseElement(i,l),null==a||a(i))},this.bindEvents()}}rZ.defaultOptions={enable:!0,animation:!0,trigger:T.DBLCLICK};var rW={};let rG="g6-create-edge-assist-node-id";class rH extends ec{update(t){super.update(t),this.bindEvents()}bindEvents(){let{graph:t}=this.context,{trigger:e}=this.options;this.unbindEvents(),"click"===e?(t.on(A.CLICK,this.handleCreateEdge),t.on(S.CLICK,this.handleCreateEdge),t.on(w.CLICK,this.cancelEdge),t.on(O.CLICK,this.cancelEdge)):(t.on(A.DRAG_START,this.handleCreateEdge),t.on(S.DRAG_START,this.handleCreateEdge),t.on(T.POINTER_UP,this.drop)),t.on(T.POINTER_MOVE,this.updateAssistEdge)}getSelectedNodeIDs(t){return Array.from(new Set(this.context.graph.getElementDataByState("node",this.options.state).map(t=>t.id).concat(t)))}validate(t){if(this.destroyed)return!1;let{enable:e}=this.options;return(0,ed.Z)(e)?e(t):!!e}unbindEvents(){let{graph:t}=this.context;t.off(A.CLICK,this.handleCreateEdge),t.off(S.CLICK,this.handleCreateEdge),t.off(w.CLICK,this.cancelEdge),t.off(O.CLICK,this.cancelEdge),t.off(A.DRAG_START,this.handleCreateEdge),t.off(S.DRAG_START,this.handleCreateEdge),t.off(T.POINTER_UP,this.drop),t.off(T.POINTER_MOVE,this.updateAssistEdge)}destroy(){this.unbindEvents(),super.destroy()}constructor(t,e){super(t,Object.assign({},rH.defaultOptions,e)),this.drop=async t=>{let{targetType:e}=t;["combo","node"].includes(e)&&this.source?await this.handleCreateEdge(t):await this.cancelEdge()},this.handleCreateEdge=async t=>{var e;if(!this.validate(t))return;let{graph:i,canvas:n,batch:r,element:s}=this.context,{style:a}=this.options;if(this.source){this.createEdge(t),await this.cancelEdge();return}r.startBatch(),n.setCursor("crosshair"),this.source=this.getSelectedNodeIDs([t.target.id])[0],i.addNodeData([{id:rG,style:{visibility:"hidden",ports:[{key:"port-1",placement:[.5,.5]}]}}]),i.addEdgeData([{id:"g6-create-edge-assist-edge-id",source:this.source,target:rG,style:{pointerEvents:"none",...a}}]),await (null===(e=s.draw({animation:!1}))||void 0===e?void 0:e.finished)},this.updateAssistEdge=async t=>{var e;if(!this.source)return;let{model:i,element:n}=this.context;i.translateNodeTo(rG,[t.canvas.x,t.canvas.y]),await (null===(e=n.draw({animation:!1,silence:!0}))||void 0===e?void 0:e.finished)},this.createEdge=t=>{var e,i,n;let{graph:r}=this.context,{style:s,onFinish:a,onCreate:o}=this.options,l=null===(e=t.target)||void 0===e?void 0:e.id;if(void 0===l||void 0===this.source)return;let h=null===(i=this.getSelectedNodeIDs([t.target.id]))||void 0===i?void 0:i[0],c="".concat(this.source,"-").concat(h,"-").concat((rW[n=n||"g"]?rW[n]+=1:rW[n]=1,n+rW[n])),d=o({id:c,source:this.source,target:h,style:s});r.addEdgeData([d]),a(d)},this.cancelEdge=async()=>{var t;if(!this.source)return;let{graph:e,element:i,batch:n}=this.context;e.removeNodeData([rG]),this.source=void 0,await (null===(t=i.draw({animation:!1}))||void 0===t?void 0:t.finished),n.endBatch()},this.bindEvents()}}rH.defaultOptions={animation:!0,enable:!0,style:{},trigger:"drag",onCreate:t=>t,onFinish:()=>{}};var rV=i(35758);class rY extends ec{update(t){this.unbindEvents(),super.update(t),this.bindEvents()}bindEvents(){let{trigger:t}=this.options;if((0,tK.Z)(t)){let{up:e=[],down:i=[],left:n=[],right:r=[]}=t;this.shortcut.bind(e,t=>this.onTranslate([0,1],t)),this.shortcut.bind(i,t=>this.onTranslate([0,-1],t)),this.shortcut.bind(n,t=>this.onTranslate([1,0],t)),this.shortcut.bind(r,t=>this.onTranslate([-1,0],t))}else{let{graph:t}=this.context;t.on(T.DRAG_START,this.onDragStart),t.on(T.DRAG,this.onDrag),t.on(T.DRAG_END,this.onDragEnd)}}async onTranslate(t,e){if(!this.validate(e))return;let{sensitivity:i}=this.options;await this.translate(eA(t,-1*i),this.options.animation),this.invokeOnFinish()}async translate(t,e){let[i,n]=t,{direction:r}=this.options;"x"===r?n=0:"y"===r&&(i=0),await this.context.graph.translateBy([i,n],e)}validate(t){if(this.destroyed)return!1;let{enable:e}=this.options;return"function"==typeof e?e(t):!!e}unbindEvents(){this.shortcut.unbindAll();let{graph:t}=this.context;t.off(T.DRAG_START,this.onDragStart),t.off(T.DRAG,this.onDrag),t.off(T.DRAG_END,this.onDragEnd)}destroy(){this.shortcut.destroy(),this.unbindEvents(),this.context.canvas.setCursor(this.defaultCursor),super.destroy()}constructor(t,e){super(t,Object.assign({},rY.defaultOptions,e)),this.isDragging=!1,this.onDragStart=t=>{this.validate(t)&&(this.isDragging=!0,this.context.canvas.setCursor("grabbing"))},this.onDrag=t=>{if(!this.isDragging)return;let{x:e,y:i}=t.movement;(e|i)!=0&&this.translate([e,i],!1)},this.onDragEnd=()=>{var t,e;this.isDragging=!1,this.context.canvas.setCursor(this.defaultCursor),null===(e=(t=this.options).onFinish)||void 0===e||e.call(t)},this.invokeOnFinish=(0,rV.Z)(()=>{var t,e;null===(e=(t=this.options).onFinish)||void 0===e||e.call(t)},300),this.shortcut=new e0(t.graph),this.bindEvents(),this.defaultCursor=this.context.canvas.getConfig().cursor||"default"}}rY.defaultOptions={enable:t=>!("targetType"in t)||"canvas"===t.targetType,sensitivity:10,direction:"both"};class rU extends ec{update(t){this.unbindEvents(),super.update(t),this.bindEvents()}bindEvents(){let{graph:t,canvas:e}=this.context,i=e.getLayer().getContextService().$canvas;i&&(i.addEventListener("blur",this.onDragEnd),i.addEventListener("contextmenu",this.onDragEnd)),this.enableElements.forEach(e=>{t.on("".concat(e,":").concat(T.DRAG_START),this.onDragStart),t.on("".concat(e,":").concat(T.DRAG),this.onDrag),t.on("".concat(e,":").concat(T.DRAG_END),this.onDragEnd),t.on("".concat(e,":").concat(T.POINTER_ENTER),this.setCursor),t.on("".concat(e,":").concat(T.POINTER_LEAVE),this.setCursor)}),["link"].includes(this.options.dropEffect)&&(t.on(S.DROP,this.onDrop),t.on(w.DROP,this.onDrop))}getSelectedNodeIDs(t){return Array.from(new Set(this.context.graph.getElementDataByState("node",this.options.state).map(t=>t.id).concat(t)))}getDelta(t){let e=this.context.graph.getZoom();return ek([t.dx,t.dy],e)}onDragStart(t){var e;if(this.enable=this.validate(t),!this.enable)return;let{batch:i,canvas:n}=this.context;n.setCursor((null===(e=this.options.cursor)||void 0===e?void 0:e.grabbing)||"grabbing"),this.isDragging=!0,i.startBatch(),this.target=this.getSelectedNodeIDs([t.target.id]),this.hideEdge(),this.context.graph.frontElement(this.target),this.options.shadow&&this.createShadow(this.target)}onDrag(t){if(!this.enable)return;let e=this.getDelta(t);this.options.shadow?this.moveShadow(e):this.moveElement(this.target,e)}onDragEnd(){var t,e,i;if(this.enable=!1,this.options.shadow){if(!this.shadow)return;this.shadow.style.visibility="hidden";let{x:t=0,y:e=0}=this.shadow.attributes,[i,n]=eD([+t,+e],this.shadowOrigin);this.moveElement(this.target,[i,n])}this.showEdges(),null===(e=(t=this.options).onFinish)||void 0===e||e.call(t,this.target);let{batch:n,canvas:r}=this.context;n.endBatch(),r.setCursor((null===(i=this.options.cursor)||void 0===i?void 0:i.grab)||"grab"),this.isDragging=!1,this.target=[]}validate(t){if(this.destroyed)return!1;let{enable:e}=this.options;return(0,ed.Z)(e)?e(t):!!e}async moveElement(t,e){let{graph:i,model:n}=this.context,{dropEffect:r}=this.options;"move"===r&&t.forEach(t=>n.refreshComboData(t)),i.translateElementBy(Object.fromEntries(t.map(t=>[t,e])),!1)}moveShadow(t){if(!this.shadow)return;let{x:e=0,y:i=0}=this.shadow.attributes,[n,r]=t;this.shadow.attr({x:+e+n,y:+i+r})}createShadow(t){let e=is(this.options,"shadow"),i=ex(t.map(t=>this.context.element.getElement(t).getBounds())),[n,r]=i.min;this.shadowOrigin=[n,r];let[s,a]=ev(i),o={width:s,height:a,x:n,y:r};this.shadow?this.shadow.attr({...e,...o,visibility:"visible"}):(this.shadow=new I.UL({style:{$layer:"transient",...e,...o,pointerEvents:"none"}}),this.context.canvas.appendChild(this.shadow))}showEdges(){this.options.shadow||0===this.hiddenEdges.length||(this.context.graph.showElement(this.hiddenEdges),this.hiddenEdges=[])}hideEdge(){let{hideEdge:t,shadow:e}=this.options;if("none"===t||e)return;let{graph:i}=this.context;"all"===t?this.hiddenEdges=i.getEdgeData().map(t7):this.hiddenEdges=Array.from(new Set(this.target.map(e=>i.getRelatedEdgesData(e,t).map(t7)).flat())),i.hideElement(this.hiddenEdges)}unbindEvents(){let{graph:t,canvas:e}=this.context,i=e.getLayer().getContextService().$canvas;i&&(i.removeEventListener("blur",this.onDragEnd),i.removeEventListener("contextmenu",this.onDragEnd)),this.enableElements.forEach(e=>{t.off("".concat(e,":").concat(T.DRAG_START),this.onDragStart),t.off("".concat(e,":").concat(T.DRAG),this.onDrag),t.off("".concat(e,":").concat(T.DRAG_END),this.onDragEnd),t.off("".concat(e,":").concat(T.POINTER_ENTER),this.setCursor),t.off("".concat(e,":").concat(T.POINTER_LEAVE),this.setCursor)}),t.off("combo:".concat(T.DROP),this.onDrop),t.off("canvas:".concat(T.DROP),this.onDrop)}destroy(){var t;this.unbindEvents(),null===(t=this.shadow)||void 0===t||t.destroy(),super.destroy()}constructor(t,e){super(t,Object.assign({},rU.defaultOptions,e)),this.enable=!1,this.enableElements=["node","combo"],this.target=[],this.shadowOrigin=[0,0],this.hiddenEdges=[],this.isDragging=!1,this.onDrop=async t=>{var e;if("link"!==this.options.dropEffect)return;let{model:i,element:n}=this.context,r=t.target.id;this.target.forEach(t=>{let e=i.getParentData(t,tq);e&&t7(e)===r&&i.refreshComboData(r),i.setParent(t,r,tq)}),await (null===(e=null==n?void 0:n.draw({animation:!0}))||void 0===e?void 0:e.finished)},this.setCursor=t=>{if(this.isDragging)return;let{type:e}=t,{canvas:i}=this.context,{cursor:n}=this.options;e===T.POINTER_ENTER?i.setCursor((null==n?void 0:n.grab)||"grab"):i.setCursor((null==n?void 0:n.default)||"default")},this.onDragStart=this.onDragStart.bind(this),this.onDrag=this.onDrag.bind(this),this.onDragEnd=this.onDragEnd.bind(this),this.onDrop=this.onDrop.bind(this),this.bindEvents()}}rU.defaultOptions={animation:!0,enable:t=>["node","combo"].includes(t.targetType),dropEffect:"move",state:"selected",hideEdge:"none",shadow:!1,shadowZIndex:100,shadowFill:"#F3F9FF",shadowFillOpacity:.5,shadowStroke:"#1890FF",shadowStrokeOpacity:.9,shadowLineDash:[5,5],cursor:{default:"default",grab:"grab",grabbing:"grabbing"}};var rK=i(5646);class r${constructor(t,e){this.context=t,this.options=e||{}}}function rX(t){let{nodes:e,edges:i}=t,n={nodes:[],edges:[],combos:[]};return e.forEach(t=>{let e=t.data._isCombo?n.combos:n.nodes,{x:i,y:r,z:s=0}=t.data;null==e||e.push({id:t.id,style:{x:i,y:r,z:s}})}),i.forEach(t=>{let{id:e,source:i,target:r,data:{points:s=[],controlPoints:a=s.slice(1,s.length-1)}}=t;n.edges.push({id:e,source:i,target:r,style:{...(null==a?void 0:a.length)?{controlPoints:a.map(eH)}:{}}})}),n}function rq(t,e){for(var i=arguments.length,n=Array(i>2?i-2:0),r=2;r<i;r++)n[r-2]=arguments[r];if(e in t)return t[e](...n);if("instance"in t){let i=t.instance;if(e in i)return i[e](...n)}return null}function rJ(t,e){if(e in t)return t[e];if("instance"in t){let i=t.instance;if(e in i)return i[e]}return null}let rQ="cachedStyle",r0=t=>"__".concat(t,"__");function r1(t,e){let i=Array.isArray(e)?e:[e];(0,it.Z)(t,rQ)||(0,ie.Z)(t,rQ,{}),i.forEach(e=>{(0,ie.Z)((0,it.Z)(t,rQ),r0(e),t.attributes[e])})}function r2(t,e){return(0,it.Z)(t,[rQ,r0(e)])}function r3(t,e){return r0(e) in((0,it.Z)(t,rQ)||{})}class r6 extends ec{bindEvents(){let{graph:t}=this.context;t.on(M.AFTER_TRANSFORM,this.fixElementSize),t.on(M.BEFORE_DRAW,this.resetTransform)}unbindEvents(){let{graph:t}=this.context;t.off(M.AFTER_TRANSFORM,this.fixElementSize),t.off(M.BEFORE_DRAW,this.resetTransform)}validate(t){if(this.destroyed)return!1;let{enable:e}=this.options;return(0,ed.Z)(e)?e(t):!!e}destroy(){this.unbindEvents(),super.destroy()}constructor(t,e){super(t,Object.assign({},r6.defaultOptions,e)),this.elementCache=new Map,this.isZoomEvent=t=>"scale"in t.data,this.fixElementSize=async t=>{if(!this.isZoomEvent(t)||!this.validate(t))return;let{graph:e,element:i}=this.context,{state:n}=this.options,r=n?[...e.getElementDataByState("node",n),...e.getElementDataByState("edge",n),...e.getElementDataByState("combo",n)]:Object.values(e.getData()).flat();if(!r.length)return;let s=t.data.scale||e.getZoom();r.forEach(t=>{let n=t7(t),r=null==i?void 0:i.getElement(n),a=e.getElementType(n),o=this.options[a];if(!o){this.elementCache.set(n,r),"edge"===a&&(r.style.transformOrigin="center"),r.setLocalScale(1/s);return}let l=function(t){let e=[],i=t=>{(null==t?void 0:t.children.length)&&t.children.forEach(t=>{e.push(t),i(t)})};return i(t),e}(r),h=Array.isArray(o)?o:[o];h.forEach(t=>{let{shape:e,fields:i}=t,n=e(l);i.forEach(t=>{r3(n,t)||r1(n,t);let e=r2(n,t);(0,F.Z)(e)&&(n.style[t]=e/s)})})})},this.resetTransform=async()=>{this.elementCache&&(this.elementCache.forEach(t=>t.setLocalScale(1)),this.elementCache.clear())},this.bindEvents()}}r6.defaultOptions={enable:t=>t.data.scale<1,state:"selected",edge:[{shape:t=>t.find(t=>"key"===t.className),fields:["lineWidth"]},{shape:t=>t.find(t=>{var e;return(null===(e=t.parentElement)||void 0===e?void 0:e.className)==="label"&&"text"===t.className}),fields:["fontSize","lineHeight"]}]};class r4 extends ec{bindEvents(){let{graph:t}=this.context;this.unbindEvents(),e3.forEach(e=>{t.on("".concat(e,":").concat(T.CLICK),this.focus)})}validate(t){if(this.destroyed)return!1;let{enable:e}=this.options;return(0,ed.Z)(e)?e(t):!!e}unbindEvents(){let{graph:t}=this.context;e3.forEach(e=>{t.off("".concat(e,":").concat(T.CLICK),this.focus)})}destroy(){this.unbindEvents(),super.destroy()}constructor(t,e){super(t,Object.assign({},r4.defaultOptions,e)),this.focus=async t=>{if(!this.validate(t))return;let{graph:e}=this.context;await e.focusElement(t.target.id,this.options.animation)},this.bindEvents()}}r4.defaultOptions={animation:{easing:"ease-in",duration:500},enable:!0};class r8 extends ec{bindEvents(){let{graph:t}=this.context;this.unbindEvents(),e3.forEach(e=>{t.on("".concat(e,":").concat(T.POINTER_OVER),this.hoverElement),t.on("".concat(e,":").concat(T.POINTER_OUT),this.hoverElement)});let e=this.context.canvas.document;e.addEventListener("".concat(T.DRAG_START),this.toggleFrozen),e.addEventListener("".concat(T.DRAG_END),this.toggleFrozen)}validate(t){if(this.destroyed||this.isFrozen||this.context.graph.isCollapsingExpanding)return!1;let{enable:e}=this.options;return(0,ed.Z)(e)?e(t):!!e}unbindEvents(){let{graph:t}=this.context;e3.forEach(e=>{t.off("".concat(e,":").concat(T.POINTER_OVER),this.hoverElement),t.off("".concat(e,":").concat(T.POINTER_OUT),this.hoverElement)});let e=this.context.canvas.document;e.removeEventListener("".concat(T.DRAG_START),this.toggleFrozen),e.removeEventListener("".concat(T.DRAG_END),this.toggleFrozen)}destroy(){this.unbindEvents(),super.destroy()}constructor(t,e){super(t,Object.assign({},r8.defaultOptions,e)),this.isFrozen=!1,this.toggleFrozen=t=>{this.isFrozen="dragstart"===t.type},this.hoverElement=t=>{if(!this.validate(t))return;let e=t.type===T.POINTER_OVER;this.updateElementsState(t,e);let{onHover:i,onHoverEnd:n}=this.options;e?null==i||i(t):null==n||n(t)},this.updateElementsState=(t,e)=>{if(!this.options.state&&!this.options.inactiveState)return;let{graph:i}=this.context,{state:n,degree:r,animation:s,inactiveState:a}=this.options,{targetType:o,target:l}=t,h=r?e4(i,o,l.id,r):[l.id],c={};if(n&&Object.assign(c,this.getElementsState(h,n,e)),a){let t=et(i.getData(),!0).filter(t=>!h.includes(t));Object.assign(c,this.getElementsState(t,a,e))}i.setElementState(c,s)},this.getElementsState=(t,e,i)=>{let{graph:n}=this.context,r={};return t.forEach(t=>{let s=n.getElementState(t),a=i?[...s,e]:s.filter(t=>t!==e);r[t]=a}),r},this.bindEvents()}}r8.defaultOptions={animation:!1,enable:!0,degree:0,state:"active",inactiveState:void 0};class r9 extends ec{bindEvents(){let{graph:t}=this.context;t.on(M.BEFORE_TRANSFORM,this.hideShapes),t.on(M.AFTER_TRANSFORM,this.showShapes)}unbindEvents(){let{graph:t}=this.context;t.off(M.BEFORE_TRANSFORM,this.hideShapes),t.off(M.AFTER_TRANSFORM,this.showShapes)}validate(t){if(this.destroyed)return!1;let{enable:e}=this.options;return(0,ed.Z)(e)?e(t):!!e}destroy(){this.unbindEvents(),super.destroy()}constructor(t,e){super(t,Object.assign({},r9.defaultOptions,e)),this.isVisible=!0,this.setElementsVisibility=(t,e,i)=>{t.forEach(t=>{iS(t,e,!1,t=>!t.className||!(null==i?void 0:i.includes(t.className)))})},this.hideShapes=t=>{if(!this.validate(t)||!this.isVisible)return;let{element:e}=this.context,{shapes:i={}}=this.options;this.setElementsVisibility(e.getNodes(),"hidden",i.node),this.setElementsVisibility(e.getEdges(),"hidden",i.edge),this.setElementsVisibility(e.getCombos(),"hidden",i.combo),this.isVisible=!1},this.showShapes=(0,rV.Z)(t=>{if(!this.validate(t)||this.isVisible)return;let{element:e}=this.context;this.setElementsVisibility(e.getNodes(),"visible"),this.setElementsVisibility(e.getEdges(),"visible"),this.setElementsVisibility(e.getCombos(),"visible"),this.isVisible=!0},this.options.debounce),this.bindEvents()}}r9.defaultOptions={enable:!0,debounce:200,shapes:{node:["key"]}};class r5 extends ec{update(t){super.update(t),this.bindEvents()}bindEvents(){var t,e;let{trigger:i}=this.options;if(this.shortcut.unbindAll(),(0,tK.Z)(i)){null===(t=this.graphDom)||void 0===t||t.removeEventListener(T.WHEEL,this.onWheel);let{up:e=[],down:n=[],left:r=[],right:s=[]}=i;this.shortcut.bind(e,t=>this.scroll([0,-10],t)),this.shortcut.bind(n,t=>this.scroll([0,10],t)),this.shortcut.bind(r,t=>this.scroll([-10,0],t)),this.shortcut.bind(s,t=>this.scroll([10,0],t))}else null===(e=this.graphDom)||void 0===e||e.addEventListener(T.WHEEL,this.onWheel,{passive:!1})}get graphDom(){return this.context.graph.getCanvas().getContextService().getDomElement()}formatDisplacement(t){let[e,i]=t,{direction:n,sensitivity:r}=this.options;return e*=r,i*=r,"x"===n?i=0:"y"===n&&(e=0),[e,i]}async scroll(t,e){if(!this.validate(e))return;let{onFinish:i}=this.options,n=this.context.graph,r=this.formatDisplacement(t);await n.translateBy(r,!1),null==i||i()}validate(t){if(this.destroyed)return!1;let{enable:e}=this.options;return(0,ed.Z)(e)?e(t):!!e}destroy(){var t;this.shortcut.destroy(),null===(t=this.graphDom)||void 0===t||t.removeEventListener(T.WHEEL,this.onWheel),super.destroy()}constructor(t,e){super(t,Object.assign({},r5.defaultOptions,e)),this.onWheel=async t=>{this.options.preventDefault&&t.preventDefault();let e=t.deltaX,i=t.deltaY;await this.scroll([-e,-i],t)},this.shortcut=new e0(t.graph),this.bindEvents()}}r5.defaultOptions={enable:!0,sensitivity:1,preventDefault:!0};class r7 extends ec{update(t){super.update(t),this.bindEvents()}bindEvents(){let{trigger:t}=this.options;if(this.shortcut.unbindAll(),Array.isArray(t)){var e;null===(e=this.context.canvas.getContainer())||void 0===e||e.addEventListener(T.WHEEL,this.preventDefault),this.shortcut.bind([...t,T.WHEEL],t=>{let{deltaX:e,deltaY:i}=t;this.zoom(-(null!=i?i:e),t,!1)})}if("object"==typeof t){let{zoomIn:e=[],zoomOut:i=[],reset:n=[]}=t;this.shortcut.bind(e,t=>this.zoom(10,t,this.options.animation)),this.shortcut.bind(i,t=>this.zoom(-10,t,this.options.animation)),this.shortcut.bind(n,this.onReset)}}validate(t){if(this.destroyed)return!1;let{enable:e}=this.options;return(0,ed.Z)(e)?e(t):!!e}destroy(){var t;this.shortcut.destroy(),null===(t=this.context.canvas.getContainer())||void 0===t||t.removeEventListener(T.WHEEL,this.preventDefault),super.destroy()}constructor(t,e){super(t,Object.assign({},r7.defaultOptions,e)),this.zoom=async(t,e,i)=>{let n;if(!this.validate(e))return;let{graph:r}=this.context;"viewport"in e&&(n=eH(e.viewport));let{sensitivity:s,onFinish:a}=this.options,o=1+(0,q.Z)(t,-50,50)*s/100,l=r.getZoom();await r.zoomTo(l*o,i,n),null==a||a()},this.onReset=async()=>{await this.context.graph.zoomTo(1,this.options.animation)},this.preventDefault=t=>{this.options.preventDefault&&t.preventDefault()},this.shortcut=new e0(t.graph),this.bindEvents()}}r7.defaultOptions={animation:{duration:200},enable:!0,sensitivity:1,trigger:[],preventDefault:!0};var st=i(51405),se=i(89287),si=i(29977),sn=i(38386),sr=i(88129),ss=i(47620),sa=i(19074),so=i(30750),sl=i(62333),sh=i(28763),sc=i(34822),sd=i(87374),su=i(23605),sp=i(53129),sg=i(38754);let sf=t=>t?parseInt(t):0;function sm(t){let e=640,i=480,[n,r]=function(t){let e=getComputedStyle(t),i=t.clientWidth||sf(e.width),n=t.clientHeight||sf(e.height),r=sf(e.paddingLeft)+sf(e.paddingRight),s=sf(e.paddingTop)+sf(e.paddingBottom);return[i-r,n-s]}(t);return e=n||e,i=r||i,[Math.max((0,F.Z)(e)?e:1,1),Math.max((0,F.Z)(i)?i:1,1)]}function sy(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=arguments.length>2?arguments[2]:void 0,n=document.createElement("div");return n.setAttribute("class","g6-".concat(t)),Object.assign(n.style,{position:"absolute",display:"block"}),e&&Object.assign(n.style,{inset:"0px",height:"100%",width:"100%",overflow:"hidden",pointerEvents:"none"}),i&&Object.assign(n.style,i),n}function sv(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"div",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:document.body,s=document.getElementById(t);s&&s.remove();let a=document.createElement(e);return a.innerHTML=n,a.id=t,Object.assign(a.style,i),r.appendChild(a),a}class sb extends eh{}class sE extends sb{async update(t){super.update(t),Object.assign(this.$element.style,(0,sg.Z)(this.options,["key","type"]))}destroy(){super.destroy(),this.$element.remove()}constructor(t,e){super(t,Object.assign({},sE.defaultOptions,e)),this.$element=sy("background");let i=this.context.canvas.getContainer();i.prepend(this.$element),this.update(e)}}function sx(t,e,i,n,r,s){let a=i-t,o=n-e,l=r-t,h=s-e,c=l*a+h*o,d=0;d=c<=0?0:(c=(l=a-l)*a+(h=o-h)*o)<=0?0:c*c/(a*a+o*o);let u=l*l+h*h-d;return u<0?0:u}function sw(t,e,i,n){return(t-i)*(t-i)+(e-n)*(e-n)}function sS(t){let e=Math.min(t.x1,t.x2),i=Math.max(t.x1,t.x2),n=Math.min(t.y1,t.y2),r=Math.max(t.y1,t.y2);return{x:e,y:n,x2:i,y2:r,width:i-e,height:r-n}}sE.defaultOptions={transition:"background 0.5s",backgroundSize:"cover"};class sT{constructor(t,e,i,n){this.x1=t,this.y1=e,this.x2=i,this.y2=n}equals(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2}draw(t){t.moveTo(this.x1,this.y1),t.lineTo(this.x2,this.y2)}toString(){return`Line(from=(${this.x1},${this.y1}),to=(${this.x2},${this.y2}))`}static from(t){return new sT(t.x1,t.y1,t.x2,t.y2)}cuts(t,e){if(this.y1===this.y2||e<this.y1&&e<=this.y2||e>this.y1&&e>=this.y2||t>this.x1&&t>=this.x2)return!1;if(t<this.x1&&t<=this.x2)return!0;let i=this.x1+(e-this.y1)*(this.x2-this.x1)/(this.y2-this.y1);return t<=i}distSquare(t,e){return sx(this.x1,this.y1,this.x2,this.y2,t,e)}ptClose(t,e,i){if(this.x1<this.x2){if(t<this.x1-i||t>this.x2+i)return!1}else if(t<this.x2-i||t>this.x1+i)return!1;if(this.y1<this.y2){if(e<this.y1-i||e>this.y2+i)return!1}else if(e<this.y2-i||e>this.y1+i)return!1;return!0}}(f=P||(P={}))[f.POINT=1]="POINT",f[f.PARALLEL=2]="PARALLEL",f[f.COINCIDENT=3]="COINCIDENT",f[f.NONE=4]="NONE";class sC{constructor(t,e=0,i=0){this.state=t,this.x=e,this.y=i}}function sO(t,e){let i=(e.x2-e.x1)*(t.y1-e.y1)-(e.y2-e.y1)*(t.x1-e.x1),n=(t.x2-t.x1)*(t.y1-e.y1)-(t.y2-t.y1)*(t.x1-e.x1),r=(e.y2-e.y1)*(t.x2-t.x1)-(e.x2-e.x1)*(t.y2-t.y1);if(r){let e=i/r,s=n/r;return 0<=e&&e<=1&&0<=s&&s<=1?new sC(P.POINT,t.x1+e*(t.x2-t.x1),t.y1+e*(t.y2-t.y1)):new sC(P.NONE)}return new sC(0===i||0===n?P.COINCIDENT:P.PARALLEL)}function sM(t,e){let i=(e.x2-e.x1)*(t.y1-e.y1)-(e.y2-e.y1)*(t.x1-e.x1),n=(t.x2-t.x1)*(t.y1-e.y1)-(t.y2-t.y1)*(t.x1-e.x1),r=(e.y2-e.y1)*(t.x2-t.x1)-(e.x2-e.x1)*(t.y2-t.y1);if(r){let t=i/r,e=n/r;if(0<=t&&t<=1&&0<=e&&e<=1)return t}return Number.POSITIVE_INFINITY}function sD(t,e,i){let n=new Set;return t.width<=0?(n.add(R.LEFT),n.add(R.RIGHT)):e<t.x?n.add(R.LEFT):e>t.x+t.width&&n.add(R.RIGHT),t.height<=0?(n.add(R.TOP),n.add(R.BOTTOM)):i<t.y?n.add(R.TOP):i>t.y+t.height&&n.add(R.BOTTOM),n}function sA(t,e){let i=e.x1,n=e.y1,r=e.x2,s=e.y2,a=Array.from(sD(t,r,s));if(0===a.length)return!0;let o=sD(t,i,n);for(;0!==o.size;){for(let t of a)if(o.has(t))return!1;if(o.has(R.RIGHT)||o.has(R.LEFT)){let e=t.x;o.has(R.RIGHT)&&(e+=t.width),n+=(e-i)*(s-n)/(r-i),i=e}else{let e=t.y;o.has(R.BOTTOM)&&(e+=t.height),i+=(e-n)*(r-i)/(s-n),n=e}o=sD(t,i,n)}return!0}(m=R||(R={}))[m.LEFT=0]="LEFT",m[m.TOP=1]="TOP",m[m.RIGHT=2]="RIGHT",m[m.BOTTOM=3]="BOTTOM";class sk{constructor(t,e,i,n){this.x=t,this.y=e,this.width=i,this.height=n}get x2(){return this.x+this.width}get y2(){return this.y+this.height}get cx(){return this.x+this.width/2}get cy(){return this.y+this.height/2}get radius(){return Math.max(this.width,this.height)/2}static from(t){return new sk(t.x,t.y,t.width,t.height)}equals(t){return this.x===t.x&&this.y===t.y&&this.width===t.width&&this.height===t.height}clone(){return new sk(this.x,this.y,this.width,this.height)}add(t){let e=Math.min(this.x,t.x),i=Math.min(this.y,t.y),n=Math.max(this.x2,t.x+t.width),r=Math.max(this.y2,t.y+t.height);this.x=e,this.y=i,this.width=n-e,this.height=r-i}addPoint(t){let e=Math.min(this.x,t.x),i=Math.min(this.y,t.y),n=Math.max(this.x2,t.x),r=Math.max(this.y2,t.y);this.x=e,this.y=i,this.width=n-e,this.height=r-i}toString(){return`Rectangle[x=${this.x}, y=${this.y}, w=${this.width}, h=${this.height}]`}draw(t){t.rect(this.x,this.y,this.width,this.height)}containsPt(t,e){return t>=this.x&&t<=this.x2&&e>=this.y&&e<=this.y2}get area(){return this.width*this.height}intersects(t){return!(this.area<=0)&&!(t.width<=0)&&!(t.height<=0)&&t.x+t.width>this.x&&t.y+t.height>this.y&&t.x<this.x2&&t.y<this.y2}distSquare(t,e){if(this.containsPt(t,e))return 0;let i=sD(this,t,e);return i.has(R.TOP)?i.has(R.LEFT)?sw(t,e,this.x,this.y):i.has(R.RIGHT)?sw(t,e,this.x2,this.y):(this.y-e)*(this.y-e):i.has(R.BOTTOM)?i.has(R.LEFT)?sw(t,e,this.x,this.y2):i.has(R.RIGHT)?sw(t,e,this.x2,this.y2):(e-this.y2)*(e-this.y2):i.has(R.LEFT)?(this.x-t)*(this.x-t):i.has(R.RIGHT)?(t-this.x2)*(t-this.x2):0}}class sP{constructor(t,e,i){this.cx=t,this.cy=e,this.radius=i}get x(){return this.cx-this.radius}get x2(){return this.cx+this.radius}get width(){return 2*this.radius}get y(){return this.cy-this.radius}get y2(){return this.cy+this.radius}get height(){return 2*this.radius}static from(t){return new sP(t.cx,t.cy,t.radius)}containsPt(t,e){return sw(this.cx,this.cy,t,e)<this.radius*this.radius}distSquare(t,e){let i=sw(this.cx,this.cy,t,e);if(i<this.radius*this.radius)return 0;let n=Math.sqrt(i)-this.radius;return n*n}draw(t){t.ellipse(this.cx,this.cy,this.radius,this.radius,0,0,2*Math.PI)}}class sR{constructor(t,e=0,i=0,n=0,r=0,s=10,a=10,o=new Float32Array(Math.max(0,s*a)).fill(0)){this.pixelGroup=t,this.i=e,this.j=i,this.pixelX=n,this.pixelY=r,this.width=s,this.height=a,this.area=o}createSub(t,e){return new sR(this.pixelGroup,t.x,t.y,e.x,e.y,t.width,t.height)}static fromPixelRegion(t,e){return new sR(e,0,0,t.x,t.y,Math.ceil(t.width/e),Math.ceil(t.height/e))}copy(t,e){return new sR(this.pixelGroup,this.scaleX(e.x),this.scaleY(e.y),e.x,e.y,t.width,t.height,t.area)}boundX(t){return t<this.i?this.i:t>=this.width?this.width-1:t}boundY(t){return t<this.j?this.j:t>=this.height?this.height-1:t}scaleX(t){return this.boundX(Math.floor((t-this.pixelX)/this.pixelGroup))}scaleY(t){return this.boundY(Math.floor((t-this.pixelY)/this.pixelGroup))}scale(t){let e=this.scaleX(t.x),i=this.scaleY(t.y),n=this.boundX(Math.ceil((t.x+t.width-this.pixelX)/this.pixelGroup)),r=this.boundY(Math.ceil((t.y+t.height-this.pixelY)/this.pixelGroup)),s=n-e,a=r-i;return new sk(e,i,s,a)}invertScaleX(t){return Math.round(t*this.pixelGroup+this.pixelX)}invertScaleY(t){return Math.round(t*this.pixelGroup+this.pixelY)}addPadding(t,e){let i=Math.ceil(e/this.pixelGroup),n=this.boundX(t.x-i),r=this.boundY(t.y-i),s=this.boundX(t.x2+i),a=this.boundY(t.y2+i),o=s-n,l=a-r;return new sk(n,r,o,l)}get(t,e){return t<0||e<0||t>=this.width||e>=this.height?Number.NaN:this.area[t+e*this.width]}inc(t,e,i){t<0||e<0||t>=this.width||e>=this.height||(this.area[t+e*this.width]+=i)}set(t,e,i){t<0||e<0||t>=this.width||e>=this.height||(this.area[t+e*this.width]=i)}incArea(t,e){if(t.width<=0||t.height<=0||0===e)return;let i=this.width,n=t.width,r=Math.max(0,t.i),s=Math.max(0,t.j),a=Math.min(t.i+t.width,i),o=Math.min(t.j+t.height,this.height);if(!(o<=0)&&!(a<=0)&&!(r>=i)&&!(o>=this.height))for(let l=s;l<o;l++){let s=(l-t.j)*n,o=l*i;for(let i=r;i<a;i++){let n=t.area[i-t.i+s];0!==n&&(this.area[i+o]+=e*n)}}}fill(t){this.area.fill(t)}fillArea(t,e){let i=t.x+t.y*this.width;for(let n=0;n<t.height;n++){let r=i+n*this.width;this.area.fill(e,r,r+t.width)}}fillHorizontalLine(t,e,i,n){let r=t+e*this.width;this.area.fill(n,r,r+i)}fillVerticalLine(t,e,i,n){let r=t+e*this.width;for(let t=0;t<i;t++)this.area[r+t*this.width]=n}clear(){this.area.fill(0)}toString(){let t="";for(let e=0;e<this.height;e++){let i=e*this.width;for(let e=0;e<this.width;e++){let n=this.area[i+e];t+=n.toFixed(1).padStart(6)+" "}t+="\n"}return t}draw(t,e=!0){if(this.width<=0||this.height<=0)return;t.save(),e&&t.translate(this.pixelX,this.pixelY);let i=this.area.reduce((t,e)=>Math.min(t,e),Number.POSITIVE_INFINITY),n=this.area.reduce((t,e)=>Math.max(t,e),Number.NEGATIVE_INFINITY),r=t=>(t-i)/(n-i);t.scale(this.pixelGroup,this.pixelGroup);for(let e=0;e<this.width;e++)for(let i=0;i<this.height;i++){let n=this.area[e+i*this.width];t.fillStyle=`rgba(0, 0, 0, ${r(n)})`,t.fillRect(e,i,1,1)}t.restore()}drawThreshold(t,e,i=!0){if(!(this.width<=0)&&!(this.height<=0)){t.save(),i&&t.translate(this.pixelX,this.pixelY),t.scale(this.pixelGroup,this.pixelGroup);for(let i=0;i<this.width;i++)for(let n=0;n<this.height;n++){let r=this.area[i+n*this.width];t.fillStyle=r>e?"black":"white",t.fillRect(i,n,1,1)}t.restore()}}}function sN(t,e){let i=t=>({x:t.x-e,y:t.y-e,width:t.width+2*e,height:t.height+2*e});return Array.isArray(t)?t.map(i):i(t)}function sL(t,e,i){return sI(Object.assign(sS(t),{distSquare:(e,i)=>sx(t.x1,t.y1,t.x2,t.y2,e,i)}),e,i)}function sI(t,e,i){let n=sN(t,i),r=e.scale(n),s=e.createSub(r,n);return function(t,e,i,n){let r=i*i;for(let s=0;s<t.height;s++)for(let a=0;a<t.width;a++){let o=e.invertScaleX(t.i+a),l=e.invertScaleY(t.j+s),h=n(o,l);if(0===h){t.set(a,s,r);continue}if(h<r){let e=i-Math.sqrt(h);t.set(a,s,e*e)}}}(s,e,i,(e,i)=>t.distSquare(e,i)),s}function s_(t,e){return e.some(e=>e.containsPt(t.x,t.y))}function sB(t,e){return e.some(e=>{var i,n,r,s;return i=e.x1,n=e.y1,1e-6>sw(i,n,t.x,t.y)||(r=e.x2,s=e.y2,1e-6>sw(r,s,t.x,t.y))})}function sF(t,e){let i=Number.POSITIVE_INFINITY,n=null;for(let r of t){if(!sA(r,e))continue;let t=function(t,e){let i=Number.POSITIVE_INFINITY,n=0;function r(t,r,s,a){let o=sM(e,new sT(t,r,s,a));(o=Math.abs(o-.5))>=0&&o<=1&&(n++,o<i&&(i=o))}return(r(t.x,t.y,t.x2,t.y),r(t.x,t.y,t.x,t.y2),n>1)?i:(r(t.x,t.y2,t.x2,t.y2),n>1)?i:(r(t.x2,t.y,t.x2,t.y2),0===n)?-1:i}(r,e);t>=0&&t<i&&(n=r,i=t)}return n}function sj(t,e,i,n){let r=i.top,s=i.left,a=i.bottom,o=i.right;if(n){if(s.state===P.POINT){if(r.state===P.POINT)return{x:t.x-e,y:t.y-e};if(a.state===P.POINT)return{x:t.x-e,y:t.y2+e};let i=t.width*t.height,n=t.width*((s.y-t.y+(o.y-t.y))*.5);return n<.5*i?s.y>o.y?{x:t.x-e,y:t.y-e}:{x:t.x2+e,y:t.y-e}:s.y<o.y?{x:t.x-e,y:t.y2+e}:{x:t.x2+e,y:t.y2+e}}if(o.state===P.POINT){if(r.state===P.POINT)return{x:t.x2+e,y:t.y-e};if(a.state===P.POINT)return{x:t.x2+e,y:t.y2+e}}let i=t.height*t.width,n=t.height*((r.x-t.x+(o.x-t.x))*.5);return n<.5*i?r.x>a.x?{x:t.x-e,y:t.y-e}:{x:t.x-e,y:t.y2+e}:r.x<a.x?{x:t.x2+e,y:t.y-e}:{x:t.x2+e,y:t.y2+e}}if(s.state===P.POINT){if(r.state===P.POINT)return{x:t.x2+e,y:t.y2+e};if(a.state===P.POINT)return{x:t.x2+e,y:t.y-e};let i=t.height*t.width,n=t.width*((s.y-t.y+(o.y-t.y))*.5);return n<.5*i?s.y>o.y?{x:t.x2+e,y:t.y2+e}:{x:t.x-e,y:t.y2+e}:s.y<o.y?{x:t.x2+e,y:t.y-e}:{x:t.x-e,y:t.y-e}}if(o.state===P.POINT){if(r.state===P.POINT)return{x:t.x-e,y:t.y2+e};if(a.state===P.POINT)return{x:t.x-e,y:t.y-e}}let l=t.height*t.width,h=t.height*((r.x-t.x+(o.x-t.x))*.5);return h<.5*l?r.x>a.x?{x:t.x2+e,y:t.y2+e}:{x:t.x2+e,y:t.y-e}:r.x<a.x?{x:t.x-e,y:t.y2+e}:{x:t.x-e,y:t.y-e}}class sz{constructor(t=[],e=!0){this.points=t,this.closed=e}get(t){let e=this.points.length;return t<0?this.closed?this.get(t+e):this.points[0]:t>=e?this.closed?this.get(t-e):this.points[e-1]:this.points[t]}get length(){return this.points.length}toString(t=1/0){let e=this.points;if(0===e.length)return"";let i="function"==typeof t?t:function(t){if(!Number.isFinite(t))return t=>t;if(0===t)return Math.round;let e=Math.pow(10,t);return t=>Math.round(t*e)/e}(t),n="M";for(let t of e)n+=`${i(t.x)},${i(t.y)} L`;return n=n.slice(0,-1),this.closed&&(n+=" Z"),n}draw(t){let e=this.points;if(0!==e.length){for(let i of(t.beginPath(),t.moveTo(e[0].x,e[0].y),e))t.lineTo(i.x,i.y);this.closed&&t.closePath()}}sample(t){return(function(t=8){return e=>{let i=t,n=e.length;if(i>1)for(n=Math.floor(e.length/i);n<3&&i>1;)i-=1,n=Math.floor(e.length/i);let r=[];for(let t=0,s=0;s<n;s++,t+=i)r.push(e.get(t));return new sz(r)}})(t)(this)}simplify(t){return(function(t=0){return e=>{if(t<0||e.length<3)return e;let i=[],n=0,r=t*t;for(;n<e.length;){let t=n+1;for(;function(t,e,i,n){let r=t.closed?i<t.length:i<t.length-1;if(!r)return!1;let s=t.get(e),a=t.get(i+1);for(let r=e+1;r<=i;r++){let e=t.get(r),i=sx(s.x,s.y,a.x,a.y,e.x,e.y);if(i>n)return!1}return!0}(e,n,t,r);)t++;i.push(e.get(n)),n=t}return new sz(i)}})(t)(this)}bSplines(t){return(function(t=6){function e(t,e,i){let n=0,r=0;for(let s=-2;s<=1;s++){let a=t.get(e+s),o=function(t,e){switch(t){case -2:return(((-e+3)*e-3)*e+1)/6;case -1:return((3*e-6)*e*e+4)/6;case 0:return(((-3*e+3)*e+3)*e+1)/6;case 1:return e*e*e/6;default:throw Error("unknown error")}}(s,i);n+=o*a.x,r+=o*a.y}return{x:n,y:r}}return i=>{if(i.length<3)return i;let n=[],r=i.closed,s=i.length+3-1+(r?0:2);n.push(e(i,2-(r?0:2),0));for(let a=2-(r?0:2);a<s;a++)for(let r=1;r<=t;r++)n.push(e(i,a,r/t));return new sz(n)}})(t)(this)}apply(t){return t(this)}containsElements(t){let e=function(t){if(0===t.length)return null;let e=t[0],i=new sk(e.x,e.y,0,0);for(let e of t)i.addPoint(e);return i}(this.points);return!!e&&t.every(t=>e.containsPt(t.cx,t.cy)&&this.withinArea(t.cx,t.cy))}withinArea(t,e){if(0===this.length)return!1;let i=0,n=this.points[0],r=new sT(n.x,n.y,n.x,n.y);for(let n=1;n<this.points.length;n++){let s=this.points[n];r.x1=r.x2,r.y1=r.y2,r.x2=s.x,r.y2=s.y,r.cuts(t,e)&&i++}return r.x1=r.x2,r.y1=r.y2,r.x2=n.x,r.y2=n.y,r.cuts(t,e)&&i++,i%2==1}}class sZ{constructor(t=0){this.count=0,this.arr=[],this.set=new Set,this.arr.length=t}add(t){this.set.add(`${t.x}x${t.y}`),this.arr[this.count++]=t}contains(t){return this.set.has(`${t.x}x${t.y}`)}isFirst(t){if(0===this.count)return!1;let e=this.arr[0];return null!=e&&e.x===t.x&&e.y===t.y}path(){return new sz(this.arr.slice(0,this.count))}clear(){this.set.clear(),this.count=0}get(t){return this.arr[t]}get length(){return this.count}}let sW={maxRoutingIterations:100,maxMarchingIterations:20,pixelGroup:4,edgeR0:10,edgeR1:20,nodeR0:15,nodeR1:50,morphBuffer:10,threshold:1,memberInfluenceFactor:1,edgeInfluenceFactor:1,nonMemberInfluenceFactor:-.8,virtualEdges:!0};function sG(t){return null!=t&&"number"==typeof t.radius}function sH(t,e){return sG(t)===sG(e)&&(sG(t)?t.cx===e.cx&&t.cy===e.cy&&t.radius===e.radius:t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height)}(y=N||(N={}))[y.MEMBERS=0]="MEMBERS",y[y.NON_MEMBERS=1]="NON_MEMBERS",y[y.EDGES=2]="EDGES";class sV{constructor(t={}){this.dirty=new Set,this.members=[],this.nonMembers=[],this.virtualEdges=[],this.edges=[],this.activeRegion=new sk(0,0,0,0),this.potentialArea=new sR(1,0,0,0,0,0,0),this.o=Object.assign({},sW,t)}pushMember(...t){if(0!==t.length)for(let e of(this.dirty.add(N.MEMBERS),t))this.members.push({raw:e,obj:sG(e)?sP.from(e):sk.from(e),area:null})}removeMember(t){let e=this.members.findIndex(e=>sH(e.raw,t));return!(e<0)&&(this.members.splice(e,1),this.dirty.add(N.MEMBERS),!0)}removeNonMember(t){let e=this.nonMembers.findIndex(e=>sH(e.raw,t));return!(e<0)&&(this.nonMembers.splice(e,1),this.dirty.add(N.NON_MEMBERS),!0)}removeEdge(t){let e=this.edges.findIndex(e=>e.obj.equals(t));return!(e<0)&&(this.edges.splice(e,1),this.dirty.add(N.NON_MEMBERS),!0)}pushNonMember(...t){if(0!==t.length)for(let e of(this.dirty.add(N.NON_MEMBERS),t))this.nonMembers.push({raw:e,obj:sG(e)?sP.from(e):sk.from(e),area:null})}pushEdge(...t){if(0!==t.length)for(let e of(this.dirty.add(N.EDGES),t))this.edges.push({raw:e,obj:sT.from(e),area:null})}update(){let t=this.dirty.has(N.MEMBERS),e=this.dirty.has(N.NON_MEMBERS),i=this.dirty.has(N.EDGES);this.dirty.clear();let n=this.members.map(t=>t.obj);if(this.o.virtualEdges&&(t||e)){let t=this.nonMembers.map(t=>t.obj),e=function(t,e,i,n){if(0===t.length)return[];let r=function(t){if(t.length<2)return t;let e=0,i=0;return t.forEach(t=>{e+=t.cx,i+=t.cy}),e/=t.length,i/=t.length,t.map(t=>{let n=e-t.cx,r=i-t.cy;return[t,n*n+r*r]}).sort((t,e)=>t[1]-e[1]).map(t=>t[0])}(t);return r.map((t,s)=>{let a=r.slice(0,s);return function(t,e,i,n,r){let s;let a={x:e.cx,y:e.cy},o=(s=Number.POSITIVE_INFINITY,i.reduce((e,i)=>{let n=sw(a.x,a.y,i.cx,i.cy);if(n>s)return e;let r=new sT(a.x,a.y,i.cx,i.cy),o=t.reduce((t,e)=>sA(e,r)&&function(t,e){function i(t,i,n,r){let s=sM(e,new sT(t,i,n,r));return(s=Math.abs(s-.5))>=0&&s<=1?1:0}let n=i(t.x,t.y,t.x2,t.y);return!!((n+=i(t.x,t.y,t.x,t.y2))>1||(n+=i(t.x,t.y2,t.x2,t.y2))>1)||(n+=i(t.x2,t.y,t.x2,t.y2))>0}(e,r)?t+1:t,0);return n*(o+1)*(o+1)<s&&(e=i,s=n*(o+1)*(o+1)),e},null));if(null==o)return[];let l=new sT(a.x,a.y,o.cx,o.cy),h=function(t,e,i,n){let r=[],s=[];s.push(t);let a=!0;for(let t=0;t<i&&a;t++)for(a=!1;!a&&s.length>0;){let t=s.pop(),i=sF(e,t),o=i?function(t,e){let i=0,n=sO(t,new sT(e.x,e.y,e.x2,e.y));i+=n.state===P.POINT?1:0;let r=sO(t,new sT(e.x,e.y,e.x,e.y2));i+=r.state===P.POINT?1:0;let s=sO(t,new sT(e.x,e.y2,e.x2,e.y2));i+=s.state===P.POINT?1:0;let a=sO(t,new sT(e.x2,e.y,e.x2,e.y2));return{top:n,left:r,bottom:s,right:a,count:i+=a.state===P.POINT?1:0}}(t,i):null;if(!i||!o||2!==o.count){a||r.push(t);continue}let l=n,h=sj(i,l,o,!0),c=sB(h,s)||sB(h,r),d=s_(h,e);for(;!c&&d&&l>=1;)l/=1.5,c=sB(h=sj(i,l,o,!0),s)||sB(h,r),d=s_(h,e);if(!h||c||d||(s.push(new sT(t.x1,t.y1,h.x,h.y)),s.push(new sT(h.x,h.y,t.x2,t.y2)),a=!0),a)continue;let u=sB(h=sj(i,l=n,o,!1),s)||sB(h,r);for(d=s_(h,e);!u&&d&&l>=1;)l/=1.5,u=sB(h=sj(i,l,o,!1),s)||sB(h,r),d=s_(h,e);h&&!u&&(s.push(new sT(t.x1,t.y1,h.x,h.y)),s.push(new sT(h.x,h.y,t.x2,t.y2)),a=!0),a||r.push(t)}for(;s.length>0;)r.push(s.pop());return r}(l,t,n,r);return function(t,e){let i=[];for(;t.length>0;){let n=t.pop();if(0===t.length){i.push(n);break}let r=t.pop(),s=new sT(n.x1,n.y1,r.x2,r.y2),a=sF(e,s);a?(i.push(n),t.push(r)):t.push(s)}return i}(h,t)}(e,t,a,i,n)}).flat()}(n,t,this.o.maxRoutingIterations,this.o.morphBuffer),r=new Map(this.virtualEdges.map(t=>[t.obj.toString(),t.area]));this.virtualEdges=e.map(t=>{var e;return{raw:t,obj:t,area:null!==(e=r.get(t.toString()))&&void 0!==e?e:null}}),i=!0}let r=!1;if(t||i){let t=this.virtualEdges.concat(this.edges).map(t=>t.obj),e=function(t,e){if(0===t.length)return new sk(0,0,0,0);let i=sk.from(t[0]);for(let e of t)i.add(e);for(let t of e)i.add(sS(t));return i}(n,t),i=Math.max(this.o.edgeR1,this.o.nodeR1)+this.o.morphBuffer,s=sk.from(sN(e,i));s.equals(this.activeRegion)||(r=!0,this.activeRegion=s)}if(r){let t=Math.ceil(this.activeRegion.width/this.o.pixelGroup),e=Math.ceil(this.activeRegion.height/this.o.pixelGroup);this.activeRegion.x!==this.potentialArea.pixelX||this.activeRegion.y!==this.potentialArea.pixelY?(this.potentialArea=sR.fromPixelRegion(this.activeRegion,this.o.pixelGroup),this.members.forEach(t=>t.area=null),this.nonMembers.forEach(t=>t.area=null),this.edges.forEach(t=>t.area=null),this.virtualEdges.forEach(t=>t.area=null)):(t!==this.potentialArea.width||e!==this.potentialArea.height)&&(this.potentialArea=sR.fromPixelRegion(this.activeRegion,this.o.pixelGroup))}let s=new Map,a=t=>{if(t.area){let e=`${t.obj.width}x${t.obj.height}x${t.obj instanceof sk?"R":"C"}`;s.set(e,t.area)}},o=t=>{if(t.area)return;let e=`${t.obj.width}x${t.obj.height}x${t.obj instanceof sk?"R":"C"}`;if(s.has(e)){let i=s.get(e);t.area=this.potentialArea.copy(i,{x:t.obj.x-this.o.nodeR1,y:t.obj.y-this.o.nodeR1});return}let i=t.obj instanceof sk?function(t,e,i){let n=e.scale(t),r=e.addPadding(n,i),s=e.createSub(r,{x:t.x-i,y:t.y-i}),a=n.x-r.x,o=n.y-r.y,l=r.x2-n.x2,h=r.y2-n.y2,c=r.width-a-l,d=r.height-o-h,u=i*i;s.fillArea({x:a,y:o,width:c+1,height:d+1},u);let p=[0],g=Math.max(o,a,l,h);{let r=e.invertScaleX(n.x+n.width/2);for(let s=1;s<g;s++){let a=e.invertScaleY(n.y-s),o=t.distSquare(r,a);if(o<u){let t=i-Math.sqrt(o);p.push(t*t)}else break}}let f=[],m=Math.max(a,l),y=Math.max(o,l);for(let r=1;r<m;r++){let s=e.invertScaleX(n.x-r),a=[];for(let r=1;r<y;r++){let o=e.invertScaleY(n.y-r),l=t.distSquare(s,o);if(l<u){let t=i-Math.sqrt(l);a.push(t*t)}else a.push(0)}f.push(a)}for(let t=1;t<Math.min(o,p.length);t++){let e=p[t];s.fillHorizontalLine(a,o-t,c+1,e)}for(let t=1;t<Math.min(h,p.length);t++){let e=p[t];s.fillHorizontalLine(a,o+d+t,c+1,e)}for(let t=1;t<Math.min(a,p.length);t++){let e=p[t];s.fillVerticalLine(a-t,o,d+1,e)}for(let t=1;t<Math.min(h,p.length);t++){let e=p[t];s.fillVerticalLine(a+c+t,o,d+1,e)}for(let t=1;t<a;t++){let e=f[t-1],i=a-t;for(let t=1;t<o;t++)s.set(i,o-t,e[t-1]);for(let t=1;t<h;t++)s.set(i,o+d+t,e[t-1])}for(let t=1;t<l;t++){let e=f[t-1],i=a+c+t;for(let t=1;t<o;t++)s.set(i,o-t,e[t-1]);for(let t=1;t<h;t++)s.set(i,o+d+t,e[t-1])}return s}(t.obj,this.potentialArea,this.o.nodeR1):sI(t.obj,this.potentialArea,this.o.nodeR1);t.area=i,s.set(e,i)};this.members.forEach(a),this.nonMembers.forEach(a),this.members.forEach(o),this.nonMembers.forEach(t=>{this.activeRegion.intersects(t.obj)?o(t):t.area=null}),this.edges.forEach(t=>{t.area||(t.area=sL(t.obj,this.potentialArea,this.o.edgeR1))}),this.virtualEdges.forEach(t=>{t.area||(t.area=sL(t.obj,this.potentialArea,this.o.edgeR1))})}drawMembers(t){for(let e of this.members)e.obj.draw(t)}drawNonMembers(t){for(let e of this.nonMembers)e.obj.draw(t)}drawEdges(t){for(let e of this.edges)e.obj.draw(t)}drawPotentialArea(t,e=!0){this.potentialArea.draw(t,e)}compute(){if(0===this.members.length)return new sz([]);this.dirty.size>0&&this.update();let{o:t,potentialArea:e}=this,i=this.members.map(t=>t.area),n=this.virtualEdges.concat(this.edges).map(t=>t.area),r=this.nonMembers.filter(t=>null!=t.area).map(t=>t.area),s=this.members.map(t=>t.obj);return function(t,e,i,n,r,s={}){let a=Object.assign({},sW,s),o=a.threshold,l=a.memberInfluenceFactor,h=a.edgeInfluenceFactor,c=a.nonMemberInfluenceFactor,d=(a.nodeR0-a.nodeR1)*(a.nodeR0-a.nodeR1),u=(a.edgeR0-a.edgeR1)*(a.edgeR0-a.edgeR1);for(let s=0;s<a.maxMarchingIterations;s++){if(t.clear(),0!==l){let i=l/d;for(let n of e)t.incArea(n,i)}if(0!==h){let e=h/u;for(let n of i)t.incArea(n,e)}if(0!==c){let e=c/d;for(let i of n)t.incArea(i,e)}let p=function(t,e){let i=(Math.floor(t.width)+Math.floor(t.height))*2,n=new sZ(i);function r(i,n,r,s){let a=t.get(i,n);return Number.isNaN(a)?Number.NaN:a>e?r+s:r}function s(t,e){let i=0;return(i=r(t,e,0,1),i=r(t+1,e,i,2),i=r(t,e+1,i,4),Number.isNaN(i=r(t+1,e+1,i,8)))?-1:i}let a=1;for(let i=0;i<t.width;i++)for(let r=0;r<t.height;r++){if(t.get(i,r)<=e)continue;let o=s(i,r);if(!(o<0)&&15!==o&&function(e,i){let r=e,o=i,l=t.invertScaleX(r),h=t.invertScaleY(o);for(let e=0;e<t.width*t.height;e++){let e={x:l,y:h};if(n.contains(e)){if(n.isFirst(e))break}else n.add(e);let i=s(r,o);switch(i){case -1:return!0;case 0:case 3:case 2:case 7:a=2;break;case 12:case 14:case 4:a=3;break;case 6:a=0===a?3:2;break;case 1:case 13:case 5:a=0;break;case 9:a=2===a?0:1;break;case 10:case 8:case 11:a=1;break;default:return console.warn("Marching squares invalid state: "+i),!0}switch(a){case 0:o--,h-=t.pixelGroup;break;case 1:o++,h+=t.pixelGroup;break;case 3:r--,l-=t.pixelGroup;break;case 2:r++,l+=t.pixelGroup;break;default:return console.warn("Marching squares invalid state: "+i),!0}}return!0}(i,r))return n.path()}return null}(t,o);if(p&&r(p))return p;if(o*=.95,s<=.5*a.maxMarchingIterations)l*=1.2,h*=1.2;else if(0!==c&&n.length>0)c*=.8;else break}return new sz([])}(e,i,n,r,t=>t.containsElements(s),t)}}class sY extends sb{bindEvents(){this.context.graph.on(M.AFTER_RENDER,this.drawBubbleSets),this.context.graph.on(M.AFTER_ELEMENT_UPDATE,this.updateBubbleSetsPath)}init(){this.bubbleSets=new sV(this.options),this.members=new Map,this.avoidMembers=new Map}parseOptions(){let{type:t,key:e,members:i,avoidMembers:n,...r}=this.options,s=Object.keys(r).reduce((t,e)=>(e in sW?t.bubbleSetOptions[e]=r[e]:t.style[e]=r[e],t),{style:{},bubbleSetOptions:{}});return{type:t,key:e,members:i,avoidMembers:n,...s}}addMember(t){let e=Array.isArray(t)?t:[t];e.some(t=>this.options.avoidMembers.includes(t))&&(this.options.avoidMembers=this.options.avoidMembers.filter(t=>!e.includes(t))),this.options.members=[...new Set([...this.options.members,...e])],this.drawBubbleSets()}removeMember(t){let e=Array.isArray(t)?t:[t];this.options.members=this.options.members.filter(t=>!e.includes(t)),this.drawBubbleSets()}updateMember(t){this.options.members=(0,ed.Z)(t)?t(this.options.members):t,this.drawBubbleSets()}getMember(){return this.options.members}addAvoidMember(t){let e=Array.isArray(t)?t:[t];e.some(t=>this.options.members.includes(t))&&(this.options.members=this.options.members.filter(t=>!e.includes(t))),this.options.avoidMembers=[...new Set([...this.options.avoidMembers,...e])],this.drawBubbleSets()}removeAvoidMember(t){let e=Array.isArray(t)?t:[t];this.options.avoidMembers.some(t=>e.includes(t))&&(this.options.avoidMembers=this.options.avoidMembers.filter(t=>!e.includes(t)),this.drawBubbleSets())}updateAvoidMember(t){this.options.avoidMembers=Array.isArray(t)?t:[t],this.drawBubbleSets()}getAvoidMember(){return this.options.avoidMembers}destroy(){this.context.graph.off(M.AFTER_RENDER,this.drawBubbleSets),this.context.graph.off(M.AFTER_ELEMENT_UPDATE,this.updateBubbleSetsPath),this.shape.destroy(),super.destroy()}constructor(t,e){super(t,(0,t5.Z)({},sY.defaultOptions,e)),this.members=new Map,this.avoidMembers=new Map,this.bubbleSetOptions={},this.drawBubbleSets=()=>{let{style:t,bubbleSetOptions:e}=this.parseOptions();(0,tU.Z)(this.bubbleSetOptions,e)||this.init(),this.bubbleSetOptions={...e};let i={...t,d:this.getPath()};this.shape?this.shape.update(i):(this.shape=new i_({style:i}),this.context.canvas.appendChild(this.shape))},this.updateBubbleSetsPath=t=>{if(!this.shape)return;let e=t7(t.data);[...this.options.members,...this.options.avoidMembers].includes(e)&&this.shape.update({...this.parseOptions().style,d:this.getPath(e)})},this.getPath=t=>{let{graph:e}=this.context,i=this.options.members,n=[...this.members.keys()],r=this.options.avoidMembers,s=[...this.avoidMembers.keys()];if(!t&&(0,tU.Z)(i,n)&&(0,tU.Z)(r,s))return this.path;let{enter:a=[],exit:o=[]}=eo(n,i,t=>t),{enter:l=[],exit:h=[]}=eo(s,r,t=>t);t&&(o.push(t),a.push(t));let c=(t,i,n)=>{t.forEach(t=>{let r=n?this.members:this.avoidMembers;if(i){let i;"edge"===e.getElementType(t)?([i]=sK(e,t),this.bubbleSets.pushEdge(i)):([i]=sU(e,t),this.bubbleSets[n?"pushMember":"pushNonMember"](i)),r.set(t,i)}else{let i=r.get(t);i&&("edge"===e.getElementType(t)?this.bubbleSets.removeEdge(i):this.bubbleSets[n?"removeMember":"removeNonMember"](i),r.delete(t))}})};c(o,!1,!0),c(a,!0,!0),c(h,!1,!1),c(l,!0,!1);let d=this.bubbleSets.compute(),u=d.sample(8).simplify(0).bSplines().simplify(0);return this.path=iI(u.points.map(eH)),this.path},this.bindEvents(),this.bubbleSets=new sV(this.options)}}sY.defaultOptions={members:[],avoidMembers:[],fill:"lightblue",fillOpacity:.2,stroke:"blue",strokeOpacity:.2,...sW};let sU=(t,e)=>{let i=Array.isArray(e)?e:[e];return i.map(e=>{let i=t.getElementRenderBounds(e);return new sk(i.min[0],i.min[1],em(i),ey(i))})},sK=(t,e)=>{let i=Array.isArray(e)?e:[e];return i.map(e=>{let i=t.getEdgeData(e),n=t.getElementPosition(i.source),r=t.getElementPosition(i.target);return sT.from({x1:n[0],y1:n[1],x2:r[0],y2:r[1]})})};class s$ extends sb{initElement(){this.$element=sy("contextmenu",!1,{zIndex:"99"});let{className:t}=this.options;t&&this.$element.classList.add(t);let e=this.context.canvas.getContainer();e.appendChild(this.$element),sv("g6-contextmenu-css","style",{},"\n  .g6-contextmenu {\n    font-size: 12px;\n    background-color: rgba(255, 255, 255, 0.96);\n    border-radius: 4px;\n    overflow: hidden;\n    box-shadow: rgba(0, 0, 0, 0.12) 0px 6px 12px 0px;\n    transition: visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1) 0s, left 0.4s cubic-bezier(0.23, 1, 0.32, 1) 0s, top 0.4s cubic-bezier(0.23, 1, 0.32, 1) 0s;\n  }\n\n  .g6-contextmenu-ul {\n    max-width: 256px;\n    min-width: 96px;\n    list-style: none;\n    padding: 0;\n    margin: 0;\n  }\n\n  .g6-contextmenu-li {\n    padding: 8px 12px;\n    cursor: pointer;\n    user-select: none;\n  }\n\n  .g6-contextmenu-li:hover {\n    background-color: #f5f5f5;\n    cursor: pointer;\n  }\n",document.head)}async show(t){let{enable:e,offset:i}=this.options;if("function"==typeof e&&!e(t)||!e){this.hide();return}let n=await this.getDOMContent(t);n instanceof HTMLElement?(this.$element.innerHTML="",this.$element.appendChild(n)):this.$element.innerHTML=n;let r=this.context.graph.getCanvas().getContainer().getBoundingClientRect();this.$element.style.left="".concat(t.client.x-r.left+i[0],"px"),this.$element.style.top="".concat(t.client.y-r.top+i[1],"px"),this.$element.style.display="block",this.targetElement=t.target}hide(){this.$element.style.display="none",this.targetElement=null}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}destroy(){this.unbindEvents(),super.destroy(),this.$element.remove()}async getDOMContent(t){let{getContent:e,getItems:i}=this.options;if(i){var n;return n=await i(t),'\n    <ul class="g6-contextmenu-ul">\n      '.concat(n.map(t=>'<li  class="g6-contextmenu-li" value="'.concat(t.value,'">').concat(t.name,"</li>")).join(""),"\n    </ul>\n  ")}return await e(t)}bindEvents(){let{graph:t}=this.context,{trigger:e}=this.options;t.on("canvas:".concat(e),this.onTriggerEvent),t.on("node:".concat(e),this.onTriggerEvent),t.on("edge:".concat(e),this.onTriggerEvent),t.on("combo:".concat(e),this.onTriggerEvent),document.addEventListener("click",this.onMenuItemClick)}unbindEvents(){let{graph:t}=this.context,{trigger:e}=this.options;t.off("canvas:".concat(e),this.onTriggerEvent),t.off("node:".concat(e),this.onTriggerEvent),t.off("edge:".concat(e),this.onTriggerEvent),t.off("combo:".concat(e),this.onTriggerEvent),document.removeEventListener("click",this.onMenuItemClick)}constructor(t,e){super(t,Object.assign({},s$.defaultOptions,e)),this.targetElement=null,this.onTriggerEvent=t=>{var e;null===(e=t.preventDefault)||void 0===e||e.call(t),this.show(t)},this.onMenuItemClick=t=>{let{onClick:e,trigger:i}=this.options;if(t.target instanceof HTMLElement&&t.target.className.includes("g6-contextmenu-li")){let i=t.target.getAttribute("value");null==e||e(i,t.target,this.targetElement),this.hide()}"click"!==i&&this.hide()},this.initElement(),this.update(e)}}s$.defaultOptions={trigger:"contextmenu",offset:[4,4],loadingContent:'<div class="g6-contextmenu-loading">Loading...</div>',getContent:()=>"It is a empty context menu.",enable:()=>!0};let sX={fill:"#fff",fillOpacity:1,lineWidth:1,stroke:"#000",strokeOpacity:.8};class sq extends sb{get canvas(){return this.context.canvas.getLayer("transient")}get isLensOn(){return this.lens&&!this.lens.destroyed}getElementStyle(t,e){let i="node"===t?this.options.nodeStyle:this.options.edgeStyle;return"function"==typeof i?i(e):i}get graphDom(){return this.context.graph.getCanvas().getContextService().getDomElement()}bindEvents(){let{graph:t}=this.context,{trigger:e,scaleRBy:i}=this.options,n=t.getCanvas().getLayer();if(["click","drag"].includes(e)&&n.addEventListener(T.CLICK,this.onEdgeFilter),"pointermove"===e?n.addEventListener(T.POINTER_MOVE,this.onEdgeFilter):"drag"===e&&(n.addEventListener(T.DRAG_START,this.onDragStart),n.addEventListener(T.DRAG,this.onDrag),n.addEventListener(T.DRAG_END,this.onDragEnd)),"wheel"===i){var r;null===(r=this.graphDom)||void 0===r||r.addEventListener(T.WHEEL,this.scaleRByWheel,{passive:!1})}}unbindEvents(){let{graph:t}=this.context,{trigger:e,scaleRBy:i}=this.options,n=t.getCanvas().getLayer();if(["click","drag"].includes(e)&&n.removeEventListener(T.CLICK,this.onEdgeFilter),"pointermove"===e?n.removeEventListener(T.POINTER_MOVE,this.onEdgeFilter):"drag"===e&&(n.removeEventListener(T.DRAG_START,this.onDragStart),n.removeEventListener(T.DRAG,this.onDrag),n.removeEventListener(T.DRAG_END,this.onDragEnd)),"wheel"===i){var r;null===(r=this.graphDom)||void 0===r||r.removeEventListener(T.WHEEL,this.scaleRByWheel)}}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}destroy(){this.unbindEvents(),this.isLensOn&&this.lens.destroy(),this.shapes.forEach((t,e)=>{t.destroy(),this.shapes.delete(e)}),super.destroy()}constructor(t,e){super(t,Object.assign({},sq.defaultOptions,e)),this.shapes=new Map,this.r=this.options.r,this.onEdgeFilter=t=>{if("drag"===this.options.trigger&&this.isLensOn)return;let e=eH(t.canvas);this.renderLens(e),this.renderFocusElements()},this.renderLens=t=>{let e=Object.assign({},sX,this.options.style);this.isLensOn||(this.lens=new iV({style:e}),this.canvas.appendChild(this.lens)),Object.assign(e,eV(t),{size:2*this.r}),this.lens.update(e)},this.getFilterData=()=>{let{filter:t}=this.options,{model:e}=this.context,i=e.getData();if(!t)return i;let{nodes:n,edges:r,combos:s}=i;return{nodes:n.filter(e=>t(t7(e),"node")),edges:r.filter(e=>t(t7(e),"edge")),combos:s.filter(e=>t(t7(e),"combo"))}},this.getFocusElements=t=>{let{nodes:e,edges:i}=this.getFilterData(),n=e.filter(e=>eR(eW(e),t)<this.r),r=n.map(t=>t7(t)),s=i.filter(t=>{let{source:e,target:i}=t,n=r.includes(e),s=r.includes(i);switch(this.options.nodeType){case"both":return n&&s;case"either":return n!==s;case"source":return n&&!s;case"target":return!n&&s;default:return!1}});return{nodes:n,edges:s}},this.renderFocusElements=()=>{let{element:t,graph:e}=this.context;if(!this.isLensOn)return;let i=this.lens.getCenter(),{nodes:n,edges:r}=this.getFocusElements(i),s=new Set,a=i=>{let n=t7(i);s.add(n);let r=t.getElement(n);if(!r)return;let a=this.shapes.get(n)||r.cloneNode();a.setPosition(r.getPosition()),a.id=r.id,this.shapes.has(n)?Object.entries(r.attributes).forEach(t=>{let[e,i]=t;a.style[e]!==i&&(a.style[e]=i)}):(this.canvas.appendChild(a),this.shapes.set(n,a));let o=e.getElementType(n),l=this.getElementStyle(o,i);a.update(l)};n.forEach(a),r.forEach(a),this.shapes.forEach((t,e)=>{s.has(e)||(t.destroy(),this.shapes.delete(e))})},this.scaleRByWheel=t=>{var e;this.options.preventDefault&&t.preventDefault();let{clientX:i,clientY:n,deltaX:r,deltaY:s}=t,{graph:a,canvas:o}=this.context,l=a.getCanvasByClient([i,n]),h=null===(e=this.lens)||void 0===e?void 0:e.getCenter();if(!this.isLensOn||eR(l,h)>this.r)return;let{maxR:c,minR:d}=this.options,u=Math.min(...o.getSize())/2;this.r=Math.max(d||0,Math.min(c||u,this.r*(r+s>0?1/.95:.95))),this.renderLens(h),this.renderFocusElements()},this.isLensDragging=!1,this.onDragStart=t=>{var e;let i=eH(t.canvas),n=null===(e=this.lens)||void 0===e?void 0:e.getCenter();!this.isLensOn||eR(i,n)>this.r||(this.isLensDragging=!0)},this.onDrag=t=>{if(!this.isLensDragging)return;let e=eH(t.canvas);this.renderLens(e),this.renderFocusElements()},this.onDragEnd=()=>{this.isLensDragging=!1},this.bindEvents()}}sq.defaultOptions={trigger:"pointermove",r:60,nodeType:"both",filter:()=>!0,style:{lineWidth:2},nodeStyle:{label:!1},edgeStyle:{label:!0},scaleRBy:"wheel",preventDefault:!0};let sJ={fill:"#ccc",fillOpacity:.1,lineWidth:2,stroke:"#000",strokeOpacity:.8,labelFontSize:12};class sQ extends sb{get canvas(){return this.context.canvas.getLayer("transient")}get isLensOn(){return this.lens&&!this.lens.destroyed}get graphDom(){return this.context.graph.getCanvas().getContextService().getDomElement()}bindEvents(){let{graph:t}=this.context,{trigger:e,scaleRBy:i,scaleDBy:n}=this.options,r=t.getCanvas().getLayer();if(["click","drag"].includes(e)&&r.addEventListener(T.CLICK,this.onCreateFisheye),"pointermove"===e&&r.addEventListener(T.POINTER_MOVE,this.onCreateFisheye),"drag"===e||"drag"===i||"drag"===n){r.addEventListener(T.DRAG_START,this.onDragStart),r.addEventListener(T.DRAG_END,this.onDragEnd);let t="drag"===e?this.onDrag:"drag"===i?this.scaleRByDrag:this.scaleDByDrag;r.addEventListener(T.DRAG,t)}if("wheel"===i||"wheel"===n){var s;let t="wheel"===i?this.scaleRByWheel:this.scaleDByWheel;null===(s=this.graphDom)||void 0===s||s.addEventListener(T.WHEEL,t,{passive:!1})}}unbindEvents(){let{graph:t}=this.context,{trigger:e,scaleRBy:i,scaleDBy:n}=this.options,r=t.getCanvas().getLayer();if(["click","drag"].includes(e)&&r.removeEventListener(T.CLICK,this.onCreateFisheye),"pointermove"===e&&r.removeEventListener(T.POINTER_MOVE,this.onCreateFisheye),"drag"===e||"drag"===i||"drag"===n){r.removeEventListener(T.DRAG_START,this.onDragStart),r.removeEventListener(T.DRAG_END,this.onDragEnd);let t="drag"===e?this.onDrag:"drag"===i?this.scaleRByDrag:this.scaleDByDrag;r.removeEventListener(T.DRAG,t)}if("wheel"===i||"wheel"===n){var s;let t="wheel"===i?this.scaleRByWheel:this.scaleDByWheel;null===(s=this.graphDom)||void 0===s||s.removeEventListener(T.WHEEL,t)}}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}destroy(){if(this.unbindEvents(),this.isLensOn){var t;null===(t=this.lens)||void 0===t||t.destroy()}this.prevMagnifiedStyleMap.clear(),this.prevOriginStyleMap.clear(),super.destroy()}constructor(t,e){super(t,Object.assign({},sQ.defaultOptions,e)),this.r=this.options.r,this.d=this.options.d,this.onCreateFisheye=t=>{if("drag"===this.options.trigger&&this.isLensOn)return;let e=eH(t.canvas);this.onMagnify(e)},this.onMagnify=t=>{t.some(isNaN)||(this.renderLens(t),this.renderFocusElements())},this.renderLens=t=>{let e=Object.assign({},sJ,this.options.style);this.isLensOn||(this.lens=new iV({style:e}),this.canvas.appendChild(this.lens)),Object.assign(e,eV(t),{size:2*this.r,label:this.options.showDPercent,labelText:this.getDPercent()}),this.lens.update(e)},this.getDPercent=()=>{let{minD:t,maxD:e}=this.options,i=Math.round((this.d-t)/(e-t)*100);return"".concat(i,"%")},this.prevMagnifiedStyleMap=new Map,this.prevOriginStyleMap=new Map,this.renderFocusElements=()=>{if(!this.isLensOn)return;let{graph:t}=this.context,e=this.lens.getCenter(),i=(this.d+1)*this.r,n=new Map,r=new Map,s=t.getNodeData();s.forEach(s=>{let a=eW(s),o=eR(a,e);if(o>this.r)return;let l=i*o/(this.d*o+this.r),[h,c]=a,[d,u]=e,p=t7(s),g=this.getNodeStyle(s),f=(0,nz.Z)(t.getElementRenderStyle(p),Object.keys(g));n.set(p,{...eV([d+l*((h-d)/o),u+l*((c-u)/o)]),...g}),r.set(p,{...eV(a),...f})}),this.updateStyle(n,r)},this.getNodeStyle=t=>{let{nodeStyle:e}=this.options;return"function"==typeof e?e(t):e},this.updateStyle=(t,e)=>{let{graph:i,element:n}=this.context,{enter:r,exit:s,keep:a}=eo(Array.from(this.prevMagnifiedStyleMap.keys()),Array.from(t.keys()),t=>t),o=new Set,l=(t,e)=>{let r=n.getElement(t);r.update(e),i.getRelatedEdgesData(t).forEach(t=>{o.add(t7(t))})};[...r,...a].forEach(e=>{l(e,t.get(e))}),s.forEach(t=>{l(t,this.prevOriginStyleMap.get(t)),this.prevOriginStyleMap.delete(t)}),o.forEach(t=>{let e=n.getElement(t);null==e||e.update({})}),this.prevMagnifiedStyleMap=t,e.forEach((t,e)=>{this.prevOriginStyleMap.has(e)||this.prevOriginStyleMap.set(e,t)})},this.isWheelValid=t=>{if(this.options.preventDefault&&t.preventDefault(),!this.isLensOn)return!1;let{clientX:e,clientY:i}=t,n=this.context.graph.getCanvasByClient([e,i]),r=this.lens.getCenter();return!(eR(n,r)>this.r)},this.scaleR=t=>{let{maxR:e,minR:i}=this.options,n=Math.min(...this.context.canvas.getSize())/2;this.r=Math.max(i||0,Math.min(e||n,this.r*(t?1/.95:.95)))},this.scaleD=t=>{let{maxD:e,minD:i}=this.options,n=t?this.d+.1:this.d-.1;this.d=Math.max(i,Math.min(e,n))},this.scaleRByWheel=t=>{if(!this.isWheelValid(t))return;let{deltaX:e,deltaY:i}=t;this.scaleR(e+i>0);let n=this.lens.getCenter();this.onMagnify(n)},this.scaleDByWheel=t=>{if(!this.isWheelValid(t))return;let{deltaX:e,deltaY:i}=t;this.scaleD(e+i>0);let n=this.lens.getCenter();this.onMagnify(n)},this.isDragValid=t=>{if(this.options.preventDefault&&t.preventDefault(),!this.isLensOn)return!1;let e=eH(t.canvas),i=this.lens.getCenter();return!(eR(e,i)>this.r)},this.isLensDragging=!1,this.onDragStart=t=>{this.isDragValid(t)&&(this.isLensDragging=!0)},this.onDrag=t=>{if(!this.isLensDragging)return;let e=eH(t.canvas);this.onMagnify(e)},this.onDragEnd=()=>{this.isLensDragging=!1},this.scaleRByDrag=t=>{if(!this.isLensDragging)return;let{dx:e,dy:i}=t;this.scaleR(e-i>0);let n=this.lens.getCenter();this.onMagnify(n)},this.scaleDByDrag=t=>{if(!this.isLensDragging)return;let{dx:e,dy:i}=t;this.scaleD(e-i>0);let n=this.lens.getCenter();this.onMagnify(n)},this.bindEvents()}}sQ.defaultOptions={trigger:"pointermove",r:120,d:1.5,maxD:5,minD:0,showDPercent:!0,style:{},nodeStyle:{label:!0},preventDefault:!0};class s0 extends sb{bindEvents(){this.unbindEvents(),this.shortcut.unbindAll();let{request:t=[],exit:e=[]}=this.options.trigger;this.shortcut.bind(t,this.request),this.shortcut.bind(e,this.exit),["webkitfullscreenchange","mozfullscreenchange","fullscreenchange","MSFullscreenChange"].forEach(t=>{document.addEventListener(t,this.onFullscreenChange,!1)})}unbindEvents(){this.shortcut.unbindAll(),["webkitfullscreenchange","mozfullscreenchange","fullscreenchange","MSFullscreenChange"].forEach(t=>{document.removeEventListener(t,this.onFullscreenChange,!1)})}setGraphSize(){let t,e,i=!(arguments.length>0)||void 0===arguments[0]||arguments[0];i?(t=window.screen.width,e=window.screen.height,this.graphSize=this.context.graph.getSize()):[t,e]=this.graphSize,this.context.graph.setSize(t,e),this.context.graph.render()}request(){!document.fullscreenElement&&(document.fullscreenEnabled||Reflect.get(document,"webkitFullscreenEnabled")||Reflect.get(document,"mozFullscreenEnabled")||Reflect.get(document,"msFullscreenEnabled"))&&this.$el.requestFullscreen().catch(t=>{t2.warn("Error attempting to enable full-screen: ".concat(t.message," (").concat(t.name,")"))})}exit(){document.fullscreenElement&&document.exitFullscreen()}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}destroy(){this.exit(),this.style.remove(),super.destroy()}constructor(t,e){super(t,Object.assign({},s0.defaultOptions,e)),this.$el=this.context.canvas.getContainer(),this.graphSize=[0,0],this.onFullscreenChange=()=>{var t,e,i,n;let r=!!document.fullscreenElement;this.options.autoFit&&this.setGraphSize(r),r?null===(e=(t=this.options).onEnter)||void 0===e||e.call(t):null===(n=(i=this.options).onExit)||void 0===n||n.call(i)},this.shortcut=new e0(t.graph),this.bindEvents(),this.style=document.createElement("style"),document.head.appendChild(this.style),this.style.innerHTML="\n      :not(:root):fullscreen::backdrop {\n        background: transparent;\n      }\n    "}}s0.defaultOptions={trigger:{},autoFit:!0};class s1 extends sb{update(t){super.update(t),this.updateStyle()}bindEvents(){let{graph:t}=this.context;t.on(M.AFTER_TRANSFORM,this.onTransform)}updateStyle(){let{size:t,stroke:e,lineWidth:i,border:n,borderLineWidth:r,borderStroke:s,borderStyle:a}=this.options;Object.assign(this.$element.style,{border:n?"".concat(r,"px ").concat(a," ").concat(s):"none",backgroundImage:"linear-gradient(".concat(e," ").concat(i,"px, transparent ").concat(i,"px), linear-gradient(90deg, ").concat(e," ").concat(i,"px, transparent ").concat(i,"px)"),backgroundSize:"".concat(t,"px ").concat(t,"px")})}updateOffset(t){var e,i;this.offset=(e=eM(this.offset,t),i=this.options.size,e.map(t=>t%i)),this.$element.style.backgroundPosition="".concat(this.offset[0],"px ").concat(this.offset[1],"px")}destroy(){this.context.graph.off(M.AFTER_TRANSFORM,this.onTransform),this.$element.remove(),super.destroy()}constructor(t,e){super(t,Object.assign({},s1.defaultOptions,e)),this.$element=sy("grid-line"),this.offset=[0,0],this.onTransform=t=>{if(!this.options.follow)return;let{data:{translate:e}}=t;e&&this.updateOffset(e)};let i=this.context.canvas.getContainer();!function(t,e){let i=t.firstChild;i?t.insertBefore(e,i):t.appendChild(e)}(i,this.$element),this.updateStyle(),this.bindEvents()}}s1.defaultOptions={border:!0,borderLineWidth:1,borderStroke:"#eee",borderStyle:"solid",lineWidth:1,size:20,stroke:"#eee"};var s2=i(13697);function s3(t){let e={Added:new Map,Updated:new Map,Removed:new Map};return t.forEach(t=>{let{type:i,value:n}=t,r=t7(n);if("NodeAdded"===i||"EdgeAdded"===i||"ComboAdded"===i)e.Added.set(r,t);else if("NodeUpdated"===i||"EdgeUpdated"===i||"ComboUpdated"===i){if(e.Added.has(r))e.Added.set(r,{type:i.replace("Updated","Added"),value:n});else if(e.Updated.has(r)){let{original:t}=e.Updated.get(r);e.Updated.set(r,{type:i,value:n,original:t})}else e.Removed.has(r)||e.Updated.set(r,t)}else("NodeRemoved"===i||"EdgeRemoved"===i||"ComboRemoved"===i)&&(e.Added.has(r)?e.Added.delete(r):(e.Updated.has(r)&&e.Updated.delete(r),e.Removed.set(r,t)))}),[...Array.from(e.Added.values()),...Array.from(e.Updated.values()),...Array.from(e.Removed.values())]}function s6(t){let{NodeAdded:e=[],NodeUpdated:i=[],NodeRemoved:n=[],EdgeAdded:r=[],EdgeUpdated:s=[],EdgeRemoved:a=[],ComboAdded:o=[],ComboUpdated:l=[],ComboRemoved:h=[]}=iy(t,t=>t.type);return{add:{nodes:e,edges:r,combos:o},update:{nodes:i,edges:s,combos:l},remove:{nodes:n,edges:a,combos:h}}}class s4 extends sb{canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}undo(){let t=this.undoStack.pop();if(t){var e,i,n,r;this.executeCommand(t);let s=null===(i=(e=this.options).beforeAddCommand)||void 0===i?void 0:i.call(e,t,!1);if(!1===s)return;this.redoStack.push(t),null===(r=(n=this.options).afterAddCommand)||void 0===r||r.call(n,t,!1),this.notify(D.UNDO,t)}return this}redo(){let t=this.redoStack.pop();return t&&(this.executeCommand(t,!1),this.undoStackPush(t),this.notify(D.REDO,t)),this}undoAndCancel(){let t=this.undoStack.pop();return t&&(this.executeCommand(t,!1),this.redoStack=[],this.notify(D.CANCEL,t)),this}undoStackPush(t){var e,i,n,r;let{stackSize:s}=this.options;0!==s&&this.undoStack.length>=s&&this.undoStack.shift();let a=null===(i=(e=this.options).beforeAddCommand)||void 0===i?void 0:i.call(e,t,!0);!1!==a&&(this.undoStack.push(t),null===(r=(n=this.options).afterAddCommand)||void 0===r||r.call(n,t,!0))}clear(){this.undoStack=[],this.redoStack=[],this.batchChanges=null,this.batchAnimation=!1,this.notify(D.CLEAR,null)}notify(t,e){this.emitter.emit(t,{cmd:e}),this.emitter.emit(D.CHANGE,{cmd:e})}on(t,e){this.emitter.on(t,e)}destroy(){let{graph:t}=this.context;t.off(M.AFTER_DRAW,this.addCommand),t.off(M.BATCH_START,this.initBatchCommand),t.off(M.BATCH_END,this.addCommand),this.emitter.off(),super.destroy(),this.undoStack=[],this.redoStack=[]}constructor(t,e){var i;super(t,Object.assign({},s4.defaultOptions,e)),i=this,this.batchChanges=null,this.batchAnimation=!1,this.undoStack=[],this.redoStack=[],this.freezed=!1,this.executeCommand=function(t){var e,n,r;let s=!(arguments.length>1)||void 0===arguments[1]||arguments[1];i.freezed=!0,null===(n=(e=i.options).executeCommand)||void 0===n||n.call(e,t);let a=s?t.original:t.current;i.context.graph.addData(a.add),i.context.graph.updateData(a.update),i.context.graph.removeData(et(a.remove,!1)),null===(r=i.context.element)||void 0===r||r.draw({silence:!0,animation:t.animation}),i.freezed=!1},this.addCommand=t=>{if(!this.freezed){if(t.type===M.AFTER_DRAW){var e;let{dataChanges:i=[],animation:n=!0}=t.data;if(null===(e=this.context.batch)||void 0===e?void 0:e.isBatching){if(!this.batchChanges)return;this.batchChanges.push(i),this.batchAnimation&&(this.batchAnimation=n);return}this.batchChanges=[i],this.batchAnimation=n}this.undoStackPush(function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0,n={animation:e,current:{add:{},update:{},remove:{}},original:{add:{},update:{},remove:{}}},{add:r,update:s,remove:a}=s6(s3(t));return["nodes","edges","combos"].forEach(t=>{s[t]&&s[t].forEach(e=>{var r,s;let a={...e.value},o={...e.original};if(i){let t=i.graph.getElementType(t7(e.original)),n="edge"===t?"stroke":"fill",r=i.element.getElementComputedStyle(t,e.original);o={...e.original,style:{[n]:r[n],...e.original.style}}}(function t(e,i){for(let n in e)(0,tK.Z)(e[n])&&!Array.isArray(e[n])&&null!==e[n]?(i[n]||(i[n]={}),t(e[n],i[n])):void 0===i[n]&&(i[n]=t8(n))})(a,o),(r=n.current.update)[t]||(r[t]=[]),n.current.update[t].push(a),(s=n.original.update)[t]||(s[t]=[]),n.original.update[t].push(o)}),r[t]&&r[t].forEach(e=>{var i,r;let s={...e.value};(i=n.current.add)[t]||(i[t]=[]),n.current.add[t].push(s),(r=n.original.remove)[t]||(r[t]=[]),n.original.remove[t].push(s)}),a[t]&&a[t].forEach(e=>{var i,r;let s={...e.value};(i=n.current.remove)[t]||(i[t]=[]),n.current.remove[t].push(s),(r=n.original.add)[t]||(r[t]=[]),n.original.add[t].push(s)})}),n}(this.batchChanges.flat(),this.batchAnimation,this.context)),this.notify(D.ADD,this.undoStack[this.undoStack.length-1])}},this.initBatchCommand=t=>{let{initiate:e}=t.data;if(this.batchAnimation=!1,e)this.batchChanges=[];else{let t=this.undoStack.pop();t||(this.batchChanges=null)}},this.emitter=new s2.Z;let{graph:n}=this.context;n.on(M.AFTER_DRAW,this.addCommand),n.on(M.BATCH_START,this.initBatchCommand),n.on(M.BATCH_END,this.addCommand)}}s4.defaultOptions={stackSize:0};var s8=i(47032),s9=i.n(s8);let s5=(t,e,i)=>{if("sharp"===i)return[["M",t[0]-e,t[1]-e],["L",t[0]+e,t[1]-e],["L",t[0]+e,t[1]+e],["L",t[0]-e,t[1]+e],["Z"]];let n=[e,e,0,0,0];return[["M",t[0],t[1]-e],["A",...n,t[0],t[1]+e],["A",...n,t[0],t[1]-e]]},s7=(t,e,i)=>{let n=[e,e,0,0,0],r="sharp"===i?eM(t[0],eP(eL(eD(t[0],t[1])),e)):t[0],s="sharp"===i?eM(t[1],eP(eL(eD(t[1],t[0])),e)):t[1],a=eP(eL(e_(eD(r,s),!1)),e),o=eP(a,-1),l=eM(r,a),h=eM(s,a),c=eM(s,o),d=eM(r,o);return"sharp"===i?[["M",l[0],l[1]],["L",h[0],h[1]],["L",c[0],c[1]],["L",d[0],d[1]],["Z"]]:[["M",l[0],l[1]],["L",h[0],h[1]],["A",...n,c[0],c[1]],["L",d[0],d[1]],["A",...n,l[0],l[1]]]},at=(t,e)=>{let i=eq(t).map((i,n)=>{let r=(n-2+t.length)%t.length,s=(n-1+t.length)%t.length,a=(n+1)%t.length,o=t[r],l=t[s],h=t[a],c=eD(o,l),d=eD(l,i),u=eD(i,h),p=(t,e)=>eI(t,e,!0)<Math.PI,g=p(c,d),f=p(d,u),m=t=>eP(eL(e_(t,!1)),e),y=m(d);return[{p:eB(g?eM(l,m(c)):eM(l,y)),concave:g&&l},{p:eB(f?eM(i,m(u)):eM(i,y)),concave:f&&i}]}),n=[e,e,0,0,0],r=i.findIndex((t,e)=>!i[(e-1+i.length)%i.length][0].concave&&!i[(e-1+i.length)%i.length][1].concave&&!t[0].concave&&!t[0].concave&&!t[1].concave),s=i.slice(r).concat(i.slice(0,r)),a=[];return s.flatMap((t,e)=>{let r=[],o=s[i.length-1];return 0===e&&r.push(["M",...o[1].p]),t[0].concave?a.push(t[0].p,t[1].p):r.push(["A",...n,...t[0].p]),t[1].concave?a.unshift(t[1].p):r.push(["L",...t[1].p]),3===a.length&&(r.pop(),r.push(["C",...a.flat()]),a=[]),r})},ae=(t,e)=>{let i=eq(t).map((e,i)=>{let n=t[(i+1)%t.length];return{p:e,v:eL(eD(n,e))}});return i.forEach((n,r)=>{let s=r>0?r-1:t.length-1,a=i[s].v,o=eL(eM(a,eP(n.v,eI(a,n.v,!0)<Math.PI?1:-1)));n.p=eM(n.p,eP(o,e))}),iI(i.map(t=>t.p))},ai=(t,e)=>{let i=t.map((i,n)=>{let r=t[0===n?t.length-1:n-1],s=eF(eP(eL(e_(eD(r,i),!1)),e));return[eM(r,s),eM(i,s)]}),n=i.flat(),r=n.map((t,e)=>{if(e%2==0)return null;let i=[n[(e-1)%n.length],n[e%n.length]],r=[n[(e+1)%n.length],n[(e+2)%n.length]];return ez(i,r,!0)}).filter(Boolean);return r.map((t,e)=>[0===e?"M":"L",t[0],t[1]]).concat([["Z"]])};class an extends sb{bindEvents(){this.context.graph.on(M.AFTER_RENDER,this.drawHull),this.context.graph.on(M.AFTER_ELEMENT_UPDATE,this.updateHullPath)}getHullStyle(t){let{members:e,padding:i,corner:n,...r}=this.options;return{...r,d:this.getHullPath(t)}}getPadding(){let{graph:t}=this.context,e=this.hullMemberIds.reduce((e,i)=>{let{halfExtents:n}=t.getElementRenderBounds(i),r=Math.max(n[0],n[1]);return Math.max(e,r)},0);return e+this.options.padding}addMember(t){let e=Array.isArray(t)?t:[t];this.options.members=[...new Set([...this.options.members,...e])],this.shape.update({d:this.getHullPath()})}removeMember(t){let e=Array.isArray(t)?t:[t];this.options.members=this.options.members.filter(t=>!e.includes(t)),e.some(t=>this.hullMemberIds.includes(t))&&this.shape.update({d:this.getHullPath()})}updateMember(t){this.options.members=(0,ed.Z)(t)?t(this.options.members):t,this.shape.update(this.getHullStyle(!0))}getMember(){return this.options.members}destroy(){this.context.graph.off(M.AFTER_DRAW,this.drawHull),this.shape.destroy(),this.hullMemberIds=[],super.destroy()}constructor(t,e){var i;super(t,Object.assign({},an.defaultOptions,e)),i=this,this.hullMemberIds=[],this.drawHull=()=>{if(this.shape){let t=!(0,tU.Z)(this.optionsCache,this.options);this.shape.update(this.getHullStyle(t))}else this.shape=new i_({style:this.getHullStyle()}),this.context.canvas.appendChild(this.shape);this.optionsCache={...this.options}},this.updateHullPath=t=>{this.shape&&this.options.members.includes(t7(t.data))&&this.shape.update({d:this.getHullPath(!0)})},this.getHullPath=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],{graph:e}=i.context,n=i.getMember();if(0===n.length)return"";let r=n.map(t=>e.getNodeData(t)),s=s9()(r.map(eW),i.options.concavity).slice(1).reverse(),a=s.flatMap(t=>r.filter(e=>(0,tU.Z)(eW(e),t)).map(t7));return(0,tU.Z)(a,i.hullMemberIds)&&!t||(i.hullMemberIds=a,i.path=function(t,e,i){if(1===t.length)return s5(t[0],e,i);if(2===t.length)return s7(t,e,i);switch(i){case"smooth":return ae(t,e);case"sharp":return ai(t,e);default:return at(t,e)}}(s,i.getPadding(),i.options.corner)),i.path},this.bindEvents()}}an.defaultOptions={members:[],padding:10,corner:"rounded",concavity:1/0,fill:"lightblue",fillOpacity:.2,labelOpacity:1,stroke:"blue",strokeOpacity:.2};var ar=i(94672),as=i(63059);class aa extends sb{update(t){super.update(t),this.clear(),this.createElement()}clear(){var t;null===(t=this.element)||void 0===t||t.destroy(),this.element=null,this.draw=!1}updateElement(){if(!this.element)return;let t=this.element.getChildByIndex(0);t.update({itemMarkerOpacity:t=>{let{id:e}=t;return!this.selectedItems.length||this.selectedItems.includes(e)?1:.5},itemLabelOpacity:t=>{let{id:e}=t;return!this.selectedItems.length||this.selectedItems.includes(e)?1:.5}})}destroy(){this.clear(),this.context.graph.off(M.AFTER_DRAW,this.createElement),super.destroy()}constructor(t,e){super(t,Object.assign({},aa.defaultOptions,e)),this.typePrefix="__data__",this.element=null,this.draw=!1,this.fieldMap={node:new Map,edge:new Map,combo:new Map},this.selectedItems=[],this.bindEvents=()=>{let{graph:t}=this.context;t.on(M.AFTER_DRAW,this.createElement)},this.changeState=(t,e)=>{let{graph:i}=this.context,{typePrefix:n}=this,r=(0,it.Z)(t,[n,"id"]),s=(0,it.Z)(t,[n,"style","labelText"]),[a]=r.split("__"),o=this.fieldMap[a].get(s)||[];i.setElementState(Object.fromEntries(null==o?void 0:o.map(t=>[t,e])))},this.click=t=>{if("hover"===this.options.trigger)return;let e=(0,it.Z)(t,[this.typePrefix,"id"]);this.selectedItems.includes(e)?(this.selectedItems=this.selectedItems.filter(t=>t!==e),this.changeState(t,[])):(this.selectedItems.push(e),this.changeState(t,"selected"))},this.mouseleave=t=>{"click"!==this.options.trigger&&(this.selectedItems=[],this.changeState(t,[]))},this.mouseenter=t=>{if("click"===this.options.trigger)return;let e=(0,it.Z)(t,[this.typePrefix,"id"]);this.selectedItems.includes(e)?this.selectedItems=this.selectedItems.filter(t=>t!==e):(this.selectedItems.push(e),this.changeState(t,"active"))},this.setFieldMap=(t,e,i)=>{if(!t)return;let n=this.fieldMap[i];if(n){if(n.has(t)){let i=n.get(t);i&&(i.push(e),n.set(t,i))}else n.set(t,[e])}},this.getEvents=()=>({mouseenter:this.mouseenter,mouseleave:this.mouseleave,click:this.click}),this.getMarkerData=(t,e)=>{if(!t)return[];let{model:i,element:n,graph:r}=this.context,{nodes:s,edges:a,combos:o}=i.getData(),l={},h=e=>(0,ed.Z)(t)?t(e):t,c={node:"circle",edge:"line",combo:"rect"},d={circle:"circle",ellipse:"circle",image:"bowtie",rect:"square",star:"cross",triangle:"triangle",diamond:"diamond",cubic:"dot",line:"hyphen",polyline:"hyphen",quadratic:"hv","cubic-horizontal":"hyphen","cubic-vertical":"line"},u=(t,e)=>{let i=null==n?void 0:n.getElementComputedStyle(t,e);return i},p=(t,e)=>{t.forEach(t=>{let{id:i}=t,r=(0,it.Z)(t,["data",h(t)]),s=(null==n?void 0:n.getElementType(e,t))||"circle",a=u(e,t),o=("edge"===e?null==a?void 0:a.stroke:null==a?void 0:a.fill)||"#1783ff";i&&r&&r.replace(/\s+/g,"")&&(this.setFieldMap(r,i,e),l[r]||(l[r]={id:"".concat(e,"__").concat(i),label:r,marker:d[s]||c[e],elementType:e,lineWidth:1,stroke:o,fill:o}))})};switch(e){case"node":p(s,"node");break;case"edge":p(a,"edge");break;case"combo":p(o,"combo");break;default:return[]}return Object.values(l)},this.layout=t=>{let{flexDirection:e,alignItems:i,justifyContent:n}={flexDirection:"row",alignItems:"flex-end",justifyContent:"center"},r={top:["row","flex-start","center"],bottom:["row","flex-end","center"],left:["column","flex-start","center"],right:["column","flex-end","center"]};return t in r&&([e,i,n]=r[t]),{display:"flex",flexDirection:e,justifyContent:n,alignItems:i}},this.createElement=()=>{if(this.draw){this.updateElement();return}let{canvas:t}=this.context,[e,i]=t.getSize(),{width:n=e,height:r=i,nodeField:s,edgeField:a,comboField:o,trigger:l,position:h,...c}=this.options,d=this.getMarkerData(s,"node"),u=this.getMarkerData(a,"edge"),p=this.getMarkerData(o,"combo"),g=[...d,...p,...u],f=this.layout(h),m=new ar.A({style:{width:n,height:r,...f}}),y=Object.assign({width:n,height:r,data:g,itemMarkerLineWidth:t=>{let{lineWidth:e}=t;return e},itemMarker:t=>{let{marker:e}=t;return e},itemMarkerStroke:t=>{let{stroke:e}=t;return e},itemMarkerFill:t=>{let{fill:e}=t;return e},gridCol:d.length},c,this.getEvents()),v=new as.W({className:"legend",style:y});m.appendChild(v),t.appendChild(m),this.element=m,this.draw=!0},this.bindEvents()}}aa.defaultOptions={position:"bottom",trigger:"hover",orientation:"horizontal",layout:"flex",itemSpacing:4,rowPadding:10,colPadding:10,itemMarkerSize:16,itemLabelFontSize:16};var ao=i(16677);class al extends sb{bindEvents(){let{graph:t}=this.context;t.on(M.AFTER_DRAW,this.onDraw),t.on(M.AFTER_RENDER,this.onRender),t.on(M.AFTER_TRANSFORM,this.onTransform)}unbindEvents(){let{graph:t}=this.context;t.off(M.AFTER_DRAW,this.onDraw),t.off(M.AFTER_RENDER,this.onRender),t.off(M.AFTER_TRANSFORM,this.onTransform)}renderMinimap(){let t=this.getElements(),e=this.initCanvas();this.setShapes(e,t)}getElements(){let{filter:t}=this.options,{model:e}=this.context,i=e.getData();if(!t)return i;let{nodes:n,edges:r,combos:s}=i;return{nodes:n.filter(e=>t(t7(e),"node")),edges:r.filter(e=>t(t7(e),"edge")),combos:s.filter(e=>t(t7(e),"combo"))}}setShapes(t,e){let{nodes:i,edges:n,combos:r}=e,{shape:s}=this.options,{element:a}=this.context;if("key"===s){let e=new Set,s=i=>{let n=t7(i);e.add(n);let r=a.getElement(n);if(!r)return;let s=r.getShape("key"),o=this.shapes.get(n)||s.cloneNode();o.setPosition(s.getPosition()),r.style.zIndex&&(o.style.zIndex=r.style.zIndex),o.id=r.id,this.shapes.has(n)?Object.entries(s.attributes).forEach(t=>{let[e,i]=t;o.style[e]!==i&&(o.style[e]=i)}):(t.appendChild(o),this.shapes.set(n,o))};n.forEach(s),r.forEach(s),i.forEach(s),this.shapes.forEach((i,n)=>{e.has(n)||(t.removeChild(i),this.shapes.delete(n))});return}let o=(t,e)=>{let i=a.getElement(t),n=i.getPosition();return e.setPosition(n),e};t.removeChildren(),n.forEach(e=>t.appendChild(s(t7(e),"edge"))),r.forEach(e=>{t.appendChild(o(t7(e),s(t7(e),"combo")))}),i.forEach(e=>{t.appendChild(o(t7(e),s(t7(e),"node")))})}calculatePosition(){let{position:t,size:[e,i]}=this.options,{canvas:n}=this.context,[r,s]=n.getSize(),[a,o]=eZ(t);return[a*(r-e),o*(s-i)]}createContainer(){let{container:t,className:e,size:[i,n],containerStyle:r}=this.options;if(t)return"string"==typeof t?document.querySelector(t):t;let s=document.createElement("div");s.classList.add("g6-minimap"),e&&s.classList.add(e);let[a,o]=this.calculatePosition();return Object.assign(s.style,{position:"absolute",left:a+"px",top:o+"px",width:i+"px",height:n+"px",...r}),this.context.canvas.getContainer().appendChild(s)}initCanvas(){let{renderer:t,size:[e,i]}=this.options;if(this.canvas)this.canvas.resize(e,i),t&&this.canvas.setRenderer(t);else{let n=document.createElement("div"),r=this.createContainer();this.container=r,r.appendChild(n),this.canvas=new I.Xz({width:e,height:i,container:n,renderer:t||new nj})}return this.setCamera(),this.canvas}createLandmark(t,e,i){let n="".concat(t.join(","),"-").concat(e.join(","),"-").concat(i);if(this.landmarkMap.has(n))return this.landmarkMap.get(n);let r=this.canvas.getCamera(),s=r.createLandmark(n,{position:t,focalPoint:e,zoom:i});return this.landmarkMap.set(n,s),s}setCamera(){var t;let{canvas:e}=this.context,i=null===(t=this.canvas)||void 0===t?void 0:t.getCamera();if(!i)return;let{size:[n,r],padding:s}=this.options,[a,o,l,h]=ef(s),{min:c,max:d,center:u}=e.getBounds("elements"),p=d[0]-c[0],g=d[1]-c[1],f=this.createLandmark(u,u,Math.min((n-h-o)/p,(r-a-l)/g));i.gotoLandmark(f,0)}get maskBBox(){let{canvas:t}=this.context,e=t.getSize(),i=t.getCanvasByViewport([0,0]),n=t.getCanvasByViewport(e),r=this.canvas.canvas2Viewport(eV(i)),s=this.canvas.canvas2Viewport(eV(n)),a=s.x-r.x,o=s.y-r.y;return[r.x,r.y,a,o]}calculateMaskBBox(){let{size:[t,e]}=this.options,[i,n,r,s]=this.maskBBox;return i<0&&(r=ah(r+i,t),i=0),n<0&&(s=ah(s+n,e),n=0),i+r>t&&(r=ac(t-i,0)),n+s>e&&(s=ac(e-n,0)),[ah(i,t),ah(n,e),ac(r,0),ac(s,0)]}renderMask(){let{maskStyle:t}=this.options;this.mask||(this.mask=document.createElement("div"),this.mask.addEventListener("pointerdown",this.onMaskDragStart)),this.container.appendChild(this.mask),Object.assign(this.mask.style,{...t,cursor:"move",position:"absolute",pointerEvents:"auto"}),this.updateMask()}updateMask(){if(!this.mask)return;let[t,e,i,n]=this.calculateMaskBBox();Object.assign(this.mask.style,{top:e+"px",left:t+"px",width:i+"px",height:n+"px"})}destroy(){var t;this.unbindEvents(),this.canvas.destroy(),null===(t=this.mask)||void 0===t||t.remove(),super.destroy()}constructor(t,e){super(t,Object.assign({},al.defaultOptions,e)),this.onDraw=t=>{var e;null!=t&&null!==(e=t.data)&&void 0!==e&&e.render||this.onRender()},this.onRender=(0,ao.Z)(()=>{this.renderMinimap(),this.renderMask()},32,{leading:!0}),this.shapes=new Map,this.landmarkMap=new Map,this.mask=null,this.isMaskDragging=!1,this.onMaskDragStart=t=>{this.mask&&(this.isMaskDragging=!0,this.mask.setPointerCapture(t.pointerId),this.mask.addEventListener("pointermove",this.onMaskDrag),this.mask.addEventListener("pointerup",this.onMaskDragEnd),this.mask.addEventListener("pointercancel",this.onMaskDragEnd))},this.onMaskDrag=t=>{if(!this.mask||!this.isMaskDragging)return;let{size:[e,i]}=this.options,{movementX:n,movementY:r}=t,{left:s,top:a,width:o,height:l}=this.mask.style,[,,h,c]=this.maskBBox,d=parseInt(s)+n,u=parseInt(a)+r,p=parseInt(o),g=parseInt(l);d<0&&(d=0),u<0&&(u=0),d+p>e&&(d=ac(e-p,0)),u+g>i&&(u=ac(i-g,0)),p<h&&(n>0?(d=ac(d-n,0),p=ah(p+n,e)):n<0&&(p=ah(p-n,e))),g<c&&(r>0?(u=ac(u-r,0),g=ah(g+r,i)):r<0&&(g=ah(g-r,i))),Object.assign(this.mask.style,{left:d+"px",top:u+"px",width:p+"px",height:g+"px"});let f=parseInt(s)-d,m=parseInt(a)-u;if(0===f&&0===m)return;let y=this.context.canvas.getCamera().getZoom(),v=this.canvas.getCamera().getZoom(),b=y/v;this.context.graph.translateBy([f*b,m*b],!1)},this.onMaskDragEnd=t=>{this.mask&&(this.isMaskDragging=!1,this.mask.releasePointerCapture(t.pointerId),this.mask.removeEventListener("pointermove",this.onMaskDrag),this.mask.removeEventListener("pointerup",this.onMaskDragEnd),this.mask.removeEventListener("pointercancel",this.onMaskDragEnd))},this.onTransform=(0,ao.Z)(()=>{this.isMaskDragging||(this.updateMask(),this.setCamera())},32,{leading:!0}),this.bindEvents()}}al.defaultOptions={size:[240,160],shape:"key",padding:10,position:"right-bottom",maskStyle:{border:"1px solid #ddd",background:"rgba(0, 0, 0, 0.1)"},containerStyle:{border:"1px solid #ddd",background:"#fff"}};let ah=(t,e)=>Math.min(t,e),ac=(t,e)=>Math.max(t,e),ad={x1:0,y1:0,x2:0,y2:0,visibility:"hidden"};class au extends sb{getNodes(){var t;let{filter:e}=this.options,i=(null===(t=this.context.element)||void 0===t?void 0:t.getNodes())||[],n=i.filter(t=>{var e;return"hidden"!==(0,it.Z)(t,["style","visibility"])&&(null===(e=this.context.viewport)||void 0===e?void 0:e.isInViewport(t.getRenderBounds()))});return e?n.filter(t=>e(t)):n}hideSnapline(){this.horizontalLine.style.visibility="hidden",this.verticalLine.style.visibility="hidden"}getLineWidth(t){let{lineWidth:e}=this.options["".concat(t,"LineStyle")];return+(e||ad.lineWidth||1)/this.context.graph.getZoom()}updateSnapline(t){let{verticalX:e,verticalMinY:i,verticalMaxY:n,horizontalY:r,horizontalMinX:s,horizontalMaxX:a}=t,[o,l]=this.context.canvas.getSize(),{offset:h}=this.options;null!==r?Object.assign(this.horizontalLine.style,{x1:h===1/0?0:s-h,y1:r,x2:h===1/0?o:a+h,y2:r,visibility:"visible",lineWidth:this.getLineWidth("horizontal")}):this.horizontalLine.style.visibility="hidden",null!==e?Object.assign(this.verticalLine.style,{x1:e,y1:h===1/0?0:i-h,x2:e,y2:h===1/0?l:n+h,visibility:"visible",lineWidth:this.getLineWidth("vertical")}):this.verticalLine.style.visibility="hidden"}getDelta(t){let e=this.context.graph.getZoom();return ek([t.dx,t.dy],e)}async bindEvents(){let{graph:t}=this.context;t.on(A.DRAG_START,this.onDragStart),t.on(A.DRAG,this.onDrag),t.on(A.DRAG_END,this.onDragEnd)}unbindEvents(){let{graph:t}=this.context;t.off(A.DRAG_START,this.onDragStart),t.off(A.DRAG,this.onDrag),t.off(A.DRAG_END,this.onDragEnd)}destroyElements(){var t,e;null===(t=this.horizontalLine)||void 0===t||t.destroy(),null===(e=this.verticalLine)||void 0===e||e.destroy()}destroy(){this.destroyElements(),this.unbindEvents(),super.destroy()}constructor(t,e){super(t,Object.assign({},au.defaultOptions,e)),this.initSnapline=()=>{let t=this.context.canvas.getLayer("transient");this.horizontalLine||(this.horizontalLine=t.appendChild(new I.x1({style:{...ad,...this.options.horizontalLineStyle}}))),this.verticalLine||(this.verticalLine=t.appendChild(new I.x1({style:{...ad,...this.options.verticalLineStyle}})))},this.isHorizontalSticking=!1,this.isVerticalSticking=!1,this.enableStick=!0,this.autoSnapToLine=async(t,e,i)=>{let{verticalX:n,horizontalY:r}=i,{tolerance:s}=this.options,{min:[a,o],max:[l,h],center:[c,d]}=e,u=0,p=0;null!==n&&(ap(l,n)<s&&(u=n-l),ap(a,n)<s&&(u=n-a),ap(c,n)<s&&(u=n-c),0!==u&&(this.isVerticalSticking=!0)),null!==r&&(ap(h,r)<s&&(p=r-h),ap(o,r)<s&&(p=r-o),ap(d,r)<s&&(p=r-d),0!==p&&(this.isHorizontalSticking=!0)),(0!==u||0!==p)&&await this.context.graph.translateElementBy({[t]:[u,p]},!1)},this.enableSnap=t=>{let{target:e}=t;if(this.isHorizontalSticking||this.isVerticalSticking){let[i,n]=this.getDelta(t);if(this.isHorizontalSticking&&this.isVerticalSticking&&.5>=Math.abs(i)&&.5>=Math.abs(n))return this.context.graph.translateElementBy({[e.id]:[-i,-n]},!1),!1;if(this.isHorizontalSticking&&.5>=Math.abs(n))return this.context.graph.translateElementBy({[e.id]:[0,-n]},!1),!1;if(this.isVerticalSticking&&.5>=Math.abs(i))return this.context.graph.translateElementBy({[e.id]:[-i,0]},!1),!1;this.isHorizontalSticking=!1,this.isVerticalSticking=!1,this.enableStick=!1,setTimeout(()=>{this.enableStick=!0},200)}return this.enableStick},this.calcSnaplineMetadata=(t,e)=>{let{tolerance:i,shape:n}=this.options,{min:[r,s],max:[a,o],center:[l,h]}=e,c=null,d=null,u=null,p=null,g=null,f=null;return this.getNodes().some(e=>{if((0,tU.Z)(t.id,e.id))return!1;let m=ag(e,n).getRenderBounds(),{min:[y,v],max:[b,E],center:[x,w]}=m;return null===c&&(ap(x,l)<i?c=x:ap(y,r)<i?c=y:ap(y,a)<i?c=y:ap(b,a)<i?c=b:ap(b,r)<i&&(c=b),null!==c&&(d=Math.min(v,s),u=Math.max(E,o))),null===p&&(ap(w,h)<i?p=w:ap(v,s)<i?p=v:ap(v,o)<i?p=v:ap(E,o)<i?p=E:ap(E,s)<i&&(p=E),null!==p&&(g=Math.min(y,r),f=Math.max(b,a))),null!==c&&null!==p}),{verticalX:c,verticalMinY:d,verticalMaxY:u,horizontalY:p,horizontalMinX:g,horizontalMaxX:f}},this.onDragStart=()=>{this.initSnapline()},this.onDrag=async t=>{let{target:e}=t;if(this.options.autoSnap){let e=this.enableSnap(t);if(!e)return}let i=ag(e,this.options.shape).getRenderBounds(),n=this.calcSnaplineMetadata(e,i);this.hideSnapline(),(null!==n.verticalX||null!==n.horizontalY)&&this.updateSnapline(n),this.options.autoSnap&&await this.autoSnapToLine(e.id,i,n)},this.onDragEnd=()=>{this.hideSnapline()},this.bindEvents()}}au.defaultOptions={tolerance:5,offset:20,autoSnap:!0,shape:"key",verticalLineStyle:{stroke:"#1783FF"},horizontalLineStyle:{stroke:"#1783FF"},filter:()=>!0};let ap=(t,e)=>Math.abs(t-e),ag=(t,e)=>"function"==typeof e?e(t):t.getShape(e);var af=i(33587),am=i(37776),ay=i(74747),av=i(51502),ab=i(70621),aE=i(63502);function ax(t,e){var i={YYYY:t.getFullYear(),MM:t.getMonth()+1,DD:t.getDate(),HH:t.getHours(),mm:t.getMinutes(),ss:t.getSeconds()},n=e;return Object.keys(i).forEach(function(t){var e=i[t];n=n.replace(t,"YYYY"===t?"".concat(e):"".concat(e).padStart(2,"0"))}),n}var aw=i(95533),aS=i(9189),aT=i(57345),aC=i(35328),aO=i(56832),aM=i(85952),aD=i(78500),aA=function(t){function e(i){var n=t.call(this,(0,av.n)({},e.defaultOptions,i))||this;return n.hoverColor="#f5f5f5",n.selectedColor="#e6f7ff",n.background=n.appendChild(new ay.UL({})),n.label=n.background.appendChild(new ay.ZA({})),n}return(0,af.ZT)(e,t),Object.defineProperty(e.prototype,"padding",{get:function(){return(0,aT.j)(this.style.padding)},enumerable:!1,configurable:!0}),e.prototype.renderLabel=function(){var t=this.style,e=t.label,i=t.value,n=(0,aE.zs)(this.attributes,"label");(0,aC.Ys)(this.label).maybeAppend(".label",function(){return(0,aM.S)(e)}).attr("className","label").styles(n),this.label.attr("__data__",i)},e.prototype.renderBackground=function(){var t=this.label.getBBox(),e=(0,af.CR)(this.padding,4),i=e[0],n=e[1],r=e[2],s=e[3],a=t.width,o=t.height,l=o+i+r,h=(0,aE.zs)(this.attributes,"background"),c=this.style,d=c.width,u=c.height,p=c.selected;this.background.attr((0,af.pi)((0,af.pi)({},h),{width:Math.max(a+s+n,void 0===d?0:d),height:Math.max(l,void 0===u?0:u),fill:p?this.selectedColor:"#fff"})),this.label.attr({transform:"translate(".concat(s,", ").concat((l-o)/2,")")})},e.prototype.render=function(){this.renderLabel(),this.renderBackground()},e.prototype.bindEvents=function(){var t=this;this.addEventListener("pointerenter",function(){t.style.selected||t.background.attr("fill",t.hoverColor)}),this.addEventListener("pointerleave",function(){t.style.selected||t.background.attr("fill",t.style.backgroundFill)});var e=this;this.addEventListener("click",function(){var i=t.style,n=i.label,r=i.value,s=i.onClick;null==s||s(r,{label:n,value:r},e)})},e.defaultOptions={style:{value:"",label:"",cursor:"pointer"}},e}(am.w),ak=function(t){function e(i){var n,r,s=t.call(this,(0,av.n)({},e.defaultOptions,i))||this;s.currentValue=null===(n=e.defaultOptions.style)||void 0===n?void 0:n.defaultValue,s.isPointerInSelect=!1,s.select=s.appendChild(new ay.UL({className:"select",style:{cursor:"pointer",width:0,height:0}})),s.dropdown=s.appendChild(new ay.UL({className:"dropdown"}));var a=s.style.defaultValue;return a&&(null===(r=s.style.options)||void 0===r?void 0:r.some(function(t){return t.value===a}))&&(s.currentValue=a),s}return(0,af.ZT)(e,t),e.prototype.setValue=function(t){this.currentValue=t,this.render()},e.prototype.getValue=function(){return this.currentValue},Object.defineProperty(e.prototype,"dropdownPadding",{get:function(){return(0,aT.j)(this.style.dropdownPadding)},enumerable:!1,configurable:!0}),e.prototype.renderSelect=function(){var t,e=this,i=this.style,n=i.x,r=i.y,s=i.width,a=i.height,o=i.bordered,l=i.showDropdownIcon,h=(0,aE.zs)(this.attributes,"select"),c=(0,aE.zs)(this.attributes,"placeholder");this.select.attr((0,af.pi)((0,af.pi)({x:n,y:r,width:s,height:a},h),{fill:"#fff",strokeWidth:o?1:0}));var d=this.dropdownPadding;l&&(0,aC.Ys)(this.select).maybeAppend(".dropdown-icon","path").style("d","M-5,-3.5 L0,3.5 L5,-3.5").style("transform","translate(".concat(n+s-10-d[1]-d[3],", ").concat(r+a/2,")")).style("lineWidth",1).style("stroke",this.select.style.stroke);var u=null===(t=this.style.options)||void 0===t?void 0:t.find(function(t){return t.value===e.currentValue}),p=(0,af.pi)({x:n+d[3]},c);(0,aC.Ys)(this.select).selectAll(".placeholder").data(u?[]:[1]).join(function(t){return t.append("text").attr("className","placeholder").styles(p).style("y",function(){return r+(a-this.getBBox().height)/2})},function(t){return t.styles(p)},function(t){return t.remove()});var g=(0,aE.zs)(this.attributes,"optionLabel"),f=(0,af.pi)({x:n+d[3]},g);(0,aC.Ys)(this.select).selectAll(".value").data(u?[u]:[]).join(function(t){return t.append(function(t){return(0,aM.S)(t.label)}).attr("className","value").styles(f).style("y",function(){return r+(a-this.getBBox().height)/2})},function(t){return t.styles(f)},function(t){return t.remove()})},e.prototype.renderDropdown=function(){var t,e,i=this,n=this.style,r=n.x,s=n.y,a=n.width,o=n.height,l=n.options,h=n.onSelect,c=n.open,d=(0,aE.zs)(this.attributes,"dropdown"),u=(0,aE.zs)(this.attributes,"option"),p=this.dropdownPadding;(0,aC.Ys)(this.dropdown).maybeAppend(".dropdown-container","g").attr("className","dropdown-container").selectAll(".dropdown-item").data(l,function(t){return t.value}).join(function(t){return t.append(function(t){return new aA({className:"dropdown-item",style:(0,af.pi)((0,af.pi)((0,af.pi)({},t),u),{width:a-p[1]-p[3],selected:t.value===i.currentValue,onClick:function(t,e,n){i.setValue(t),null==h||h(t,e,n),i.dispatchEvent(new ay.Aw("change",{detail:{value:t,option:e,item:n}})),(0,aD.Cp)(i.dropdown)}})})}).each(function(t,e){var i,n=(null===(i=this.parentNode)||void 0===i?void 0:i.children).reduce(function(t,i,n){return n<e&&(t+=i.getBBox().height),t},0);this.attr("transform","translate(".concat(p[3],", ").concat(p[0]+n,")"))})},function(t){return t.update(function(t){return{selected:t.value===i.currentValue}})},function(t){return t.remove()});var g=null===(e=null===(t=this.dropdown.getElementsByClassName("dropdown-container"))||void 0===t?void 0:t[0])||void 0===e?void 0:e.getBBox(),f=d.spacing;this.dropdown.attr((0,af.pi)({transform:"translate(".concat(r,", ").concat(s+o+f,")"),width:g.width+p[1]+p[3],height:g.height+p[0]+p[2]},d)),c||(0,aD.Cp)(this.dropdown)},e.prototype.render=function(){this.renderSelect(),this.renderDropdown()},e.prototype.bindEvents=function(){var t=this;this.addEventListener("click",function(t){t.stopPropagation()}),this.select.addEventListener("click",function(){"visible"===t.dropdown.style.visibility?(0,aD.Cp)(t.dropdown):(0,aD.$Z)(t.dropdown)}),this.addEventListener("pointerenter",function(){t.isPointerInSelect=!0}),this.addEventListener("pointerleave",function(){t.isPointerInSelect=!1}),null==document||document.addEventListener("click",function(){t.isPointerInSelect||(0,aD.Cp)(t.dropdown)})},e.defaultOptions={style:{x:0,y:0,width:140,height:32,options:[],bordered:!0,defaultValue:"",selectRadius:8,selectStroke:"#d9d9d9",showDropdownIcon:!0,placeholderText:"",placeholderFontSize:12,placeholderTextBaseline:"top",placeholderFill:"#c2c2c2",dropdownFill:"#fff",dropdownStroke:"#d9d9d9",dropdownRadius:8,dropdownShadowBlur:4,dropdownShadowColor:"rgba(0, 0, 0, 0.08)",dropdownPadding:8,dropdownSpacing:10,optionPadding:[8,12],optionFontSize:12,optionTextBaseline:"top",optionBackgroundFill:"#fff",optionBackgroundRadius:4,optionLabelFontSize:12,optionLabelTextBaseline:"top"}},e}(am.w),aP=function(t){function e(i){var n=t.call(this,(0,av.n)({},{style:{backgroundOpacity:e.backgroundOpacities.default}},e.defaultOptions,i))||this;return n.showBackground=!0,n.background=n.appendChild(new ay.UL({})),n.icon=n.appendChild(new ay.ZA({})),n}return(0,af.ZT)(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return"BaseIcon"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lineWidth",{get:function(){return Math.log10(this.attributes.size)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"padding",{get:function(){return(0,aT.j)(this.attributes.size/5)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"iconSize",{get:function(){var t=this.attributes.size,e=(0,af.CR)(this.padding,4),i=e[0],n=e[1],r=e[2];return Math.max(t-Math.max(e[3]+n,i+r),2*this.lineWidth+1)},enumerable:!1,configurable:!0}),e.prototype.renderBackground=function(){var t=this.attributes,e=t.x,i=t.y,n=t.size,r=n/2,s=(0,aE.zs)(this.attributes,"background");this.background.attr((0,af.pi)({x:e-r,y:i-r,width:n,height:n},s))},e.prototype.showIndicator=function(){if(this.label){var t=this.attributes.size,e=this.background.getBBox(),i=e.x,n=e.y;this.indicator.update({x:i+t/2,y:n-5,labelText:this.label,visibility:"visible"})}},e.prototype.hideIndicator=function(){this.indicator.update({visibility:"hidden"})},e.prototype.connectedCallback=function(){t.prototype.connectedCallback.call(this);var e,i=this.attributes.size,n=this.background.getBBox(),r=n.x,s=n.y,a=null===(e=this.ownerDocument)||void 0===e?void 0:e.defaultView;a&&(this.indicator=a.appendChild(new aO.z({style:{x:r+i/2,y:s-i/2,visibility:"hidden",position:"top",radius:3,zIndex:100}})))},e.prototype.disconnectedCallback=function(){this.indicator.destroy()},e.prototype.render=function(){this.renderIcon(),this.showBackground&&this.renderBackground()},e.prototype.bindEvents=function(){var t=this,i=this.attributes.onClick;if(this.addEventListener("click",function(){null==i||i(t)}),this.showBackground){var n=function(){return t.background.attr({opacity:e.backgroundOpacities.default})};this.addEventListener("pointerenter",function(){t.background.attr({opacity:e.backgroundOpacities.hover}),t.showIndicator()}),this.addEventListener("pointerleave",function(){n(),t.hideIndicator()}),this.addEventListener("pointerdown",function(){t.background.attr({opacity:e.backgroundOpacities.active})}),this.addEventListener("pointerup",function(){n()})}},e.tag="IconBase",e.defaultOptions={style:{x:0,y:0,size:10,color:"#565758",backgroundRadius:4,backgroundFill:"#e2e2e2"}},e.backgroundOpacities={default:0,hover:.8,active:1},e}(am.w),aR=function(t,e){return void 0===e&&(e="#565758"),new ay.y$({style:{fill:e,d:"M ".concat(t,",").concat(t," L -").concat(t,",0 L ").concat(t,",-").concat(t," Z"),transformOrigin:"center"}})},aN=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,af.ZT)(e,t),e.prototype.arcPath=function(t,e,i){var n=(0,af.CR)([i,i],2),r=n[0],s=n[1],a=function(n){return[t+i*Math.cos(n),e+i*Math.sin(n)]},o=(0,af.CR)(a(-5/4*Math.PI),2),l=o[0],h=o[1],c=(0,af.CR)(a(1/4*Math.PI),2),d=c[0],u=c[1];return"M".concat(l,",").concat(h,",A").concat(r,",").concat(s,",0,1,1,").concat(d,",").concat(u)},Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,i=t.y,n=t.color,r=this.iconSize,s=this.lineWidth,a=s+.5;(0,aC.Ys)(this.icon).maybeAppend(".reset","path").styles({stroke:n,lineWidth:s,d:this.arcPath(e,i,r/2-s),markerStart:aR(a,n)})},e}(aP),aL=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,af.ZT)(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,i=t.y,n=t.color,r=this.iconSize,s=r/2,a=r/2/1.7320508075688772;(0,aC.Ys)(this.icon).maybeAppend(".backward","polygon").styles({points:[[e,i],[e,i-a],[e-s,i],[e,i+a],[e,i],[e+s,i-a],[e+s,i+a],[e,i]],fill:n})},e}(aP),aI=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,af.ZT)(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,i=t.y,n=t.color,r=this.iconSize,s=r/2,a=r/2/1.7320508075688772;(0,aC.Ys)(this.icon).maybeAppend(".forward","polygon").styles({points:[[e,i],[e,i-a],[e+s,i],[e,i+a],[e,i],[e-s,i-a],[e-s,i+a],[e,i]],fill:n})},e}(aP),a_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,af.ZT)(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,i=t.y,n=t.color,r=this.iconSize,s=r/3*1.3856406460551018;(0,aC.Ys)(this.icon).maybeAppend(".play","polygon").styles({points:[[e+s,i],[e-s/2,i-r/2*.8],[e-s/2,i+r/2*.8],[e+s,i]],fill:n})},e}(aP),aB=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,af.ZT)(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,i=t.y,n=t.color,r=this.iconSize,s=r/3;(0,aC.Ys)(this.icon).maybeAppend(".pause","polygon").styles({points:[[e-s,i-r/2],[e-s,i+r/2],[e-s/2,i+r/2],[e-s/2,i-r/2],[e-s,i-r/2],[e+s/2,i-r/2],[e+s/2,i+r/2],[e+s,i+r/2],[e+s,i-r/2]],fill:n})},e}(aP),aF=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,af.ZT)(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,i=t.y,n=t.color,r=this.iconSize,s=this.lineWidth;(0,aC.Ys)(this.icon).maybeAppend(".left-line","line").styles({x1:e-r/2,y1:i-r/2,x2:e-r/2,y2:i+r/2,stroke:n,lineWidth:s}),(0,aC.Ys)(this.icon).maybeAppend(".right-line","line").styles({x1:e+r/2,y1:i-r/2,x2:e+r/2,y2:i+r/2,stroke:n,lineWidth:s}),(0,aC.Ys)(this.icon).maybeAppend(".left-arrow","line").styles({x1:e,y1:i,x2:e-r/2+2*s,y2:i,stroke:n,lineWidth:s,markerEnd:aR(2*s,n)}),(0,aC.Ys)(this.icon).maybeAppend(".right-arrow","line").styles({x1:e,y1:i,x2:e+r/2-2*s,y2:i,stroke:n,lineWidth:s,markerEnd:aR(2*s,n)})},e}(aP),aj=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,af.ZT)(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,i=t.y,n=t.color,r=this.iconSize,s=this.lineWidth;(0,aC.Ys)(this.icon).maybeAppend(".line","line").styles({x1:e,y1:i-r/2,x2:e,y2:i+r/2,stroke:n,lineWidth:s}),(0,aC.Ys)(this.icon).maybeAppend(".left-arrow","line").styles({x1:e-r/2-2*s,y1:i,x2:e-2*s,y2:i,stroke:n,lineWidth:s,markerEnd:aR(2*s,n)}),(0,aC.Ys)(this.icon).maybeAppend(".right-arrow","line").styles({x1:e+r/2+2*s,y1:i,x2:e+2*s,y2:i,stroke:n,lineWidth:s,markerEnd:aR(2*s,n)})},e}(aP),az=function(t){return[[-t/2,-t/2],[-t/2,t/2],[t/2,t/2]]},aZ=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,af.ZT)(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,i=t.y,n=t.color,r=this.iconSize,s=this.lineWidth,a=(r-2*s-s)/4,o=(r-2*s-s)/2,l=(0,af.CR)([e-r/2+s,i+r/2-2*s],2),h=l[0],c=l[1];(0,aC.Ys)(this.icon).maybeAppend(".coordinate","polyline").styles({points:az(r).map(function(t){var n=(0,af.CR)(t,2);return[n[0]+e,n[1]+i]}),stroke:n,lineWidth:s}),(0,aC.Ys)(this.icon).maybeAppend(".line","polyline").styles({points:[[h,c],[h+a,c-o],[h+2*a,c],[h+4*a,c-2*o]],stroke:n,lineWidth:s})},e}(aP),aW=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,af.ZT)(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return[1,4,2,4,3]},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.data,e=this.attributes,i=e.x,n=e.y,r=e.color,s=this.iconSize,a=this.lineWidth,o=(s-a)/t.length,l=(s-2*a)/4,h=(0,af.CR)([i-s/2+2*a,n+s/2-a],2),c=h[0],d=h[1];(0,aC.Ys)(this.icon).maybeAppend(".coordinate","polyline").styles({points:az(s).map(function(t){var e=(0,af.CR)(t,2);return[e[0]+i,e[1]+n]}),stroke:r,lineWidth:a}),(0,aC.Ys)(this.icon).maybeAppend(".bars","g").selectAll(".column").data(this.data.map(function(t,e){return{value:t,index:e}})).join(function(t){return t.append("line").attr("className","column").style("x1",function(t){return c+o*t.index}).style("y1",d).style("x2",function(t){return c+o*t.index}).style("y2",function(t){return d-l*t.value}).styles({y1:d,stroke:r,lineWidth:a})})},e}(aP),aG=function(t){function e(e){var i=t.call(this,(0,av.n)({},{style:{color:"#d8d9d9"}},e))||this;return i.showBackground=!1,i}return(0,af.ZT)(e,t),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,i=t.y,n=t.color,r=this.iconSize,s=this.lineWidth;(0,aC.Ys)(this.icon).maybeAppend(".split","line").styles({x1:e,y1:i-r/2,x2:e,y2:i+r/2,stroke:n,lineWidth:s})},e}(aP),aH=function(t){function e(){var e=t.apply(this,(0,af.ev)([],(0,af.CR)(arguments),!1))||this;return e.showBackground=!1,e}return(0,af.ZT)(e,t),Object.defineProperty(e.prototype,"padding",{get:function(){return(0,aT.j)(0)},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.iconSize,e=this.attributes,i=e.x,n=e.y,r=e.speed,s=(0,sg.Z)(this.attributes,["x","y","transform","transformOrigin","width","height","size","color","speed"]),a=(0,q.Z)(t,20,1/0),o=(0,af.pi)((0,af.pi)({},s),{x:i-a/2,y:n-10,width:a,height:20,defaultValue:void 0===r?1:r,bordered:!1,showDropdownIcon:!1,selectRadius:2,dropdownPadding:this.padding,dropdownRadius:2,dropdownSpacing:t/5,placeholderFontSize:t/2,optionPadding:0,optionLabelFontSize:t/2,optionBackgroundRadius:1,options:[{label:"1x",value:1},{label:"1.5x",value:1.5},{label:"2x",value:2}]});(0,aC.Ys)(this.icon).maybeAppend(".speed",function(){return new ak({style:o})}).attr("className","speed").each(function(){this.update(o)})},e.tag="SpeedSelect",e}(aP),aV=function(t){function e(e){var i=t.call(this,e)||this;return i.icon=i.appendChild(new ay.ZA({})),i.currentType=i.attributes.type,i}return(0,af.ZT)(e,t),e.prototype.getType=function(){return this.currentType},e.prototype.render=function(){var t=this,e=this.attributes,i=(e.onChange,(0,af._T)(e,["onChange"]));(0,aC.Ys)(this.icon).selectAll(".icon").data([this.currentType]).join(function(e){return e.append(function(e){var i,n=null===(i=t.toggles.find(function(t){return(0,af.CR)(t,1)[0]===e}))||void 0===i?void 0:i[1];if(!n)throw Error("Invalid type: ".concat(e));return new n({})}).attr("className","icon").styles(i,!1).update({})},function(t){return t.styles({restStyles:i}).update({})},function(t){return t.remove()})},e.prototype.bindEvents=function(){var t=this,e=this.attributes.onChange;this.addEventListener("click",function(i){i.preventDefault(),i.stopPropagation();var n=(t.toggles.findIndex(function(e){return(0,af.CR)(e,1)[0]===t.currentType})+1)%t.toggles.length,r=t.toggles[n][0];null==e||e(t.currentType),t.currentType=r,t.render()})},e.tag="ToggleIcon",e}(am.w),aY=function(t){function e(e){var i=t.call(this,(0,av.n)({},{style:{type:"play"}},e))||this;return i.toggles=[["play",a_],["pause",aB]],i}return(0,af.ZT)(e,t),e}(aV),aU=function(t){function e(e){var i=t.call(this,(0,av.n)({},{style:{type:"range"}},e))||this;return i.toggles=[["range",aF],["value",aj]],i}return(0,af.ZT)(e,t),e}(aV),aK=function(t){function e(e){var i=t.call(this,(0,av.n)({},{style:{type:"column"}},e))||this;return i.toggles=[["line",aZ],["column",aW]],i}return(0,af.ZT)(e,t),e}(aV),a$={reset:aN,speed:aH,backward:aL,playPause:aY,forward:aI,selectionType:aU,chartType:aK,split:aG},aX=function(t){function e(i){var n=t.call(this,(0,av.n)({},e.defaultOptions,i))||this;return n.background=n.appendChild(new ay.UL({})),n.functions=n.appendChild(new ay.ZA({})),n}return(0,af.ZT)(e,t),Object.defineProperty(e.prototype,"padding",{get:function(){return(0,aT.j)(this.attributes.padding)},enumerable:!1,configurable:!0}),e.prototype.renderBackground=function(){var t=this.style,e=t.x,i=t.y,n=t.width,r=t.height,s=(0,aE.zs)(this.attributes,"background");this.background.attr((0,af.pi)({x:e,y:i,width:n,height:r},s))},e.prototype.renderFunctions=function(){var t,e=this,i=this.attributes,n=i.functions,r=i.iconSize,s=i.iconSpacing,a=i.x,o=i.y,l=i.width,h=i.height,c=i.align,d=(0,af.CR)(this.padding,4),u=d[1],p=d[3],g=n.reduce(function(t,e){return t.length&&e.length?t.concat.apply(t,(0,af.ev)(["split"],(0,af.CR)(e),!1)):t.concat.apply(t,(0,af.ev)([],(0,af.CR)(e),!1))},[]),f=g.length*(r+s)-s,m={left:p+r/2,center:(l-f)/2+r/2,right:l-f-p-u+r/2}[c]||0;null===(t=this.speedSelect)||void 0===t||t.destroy(),this.functions.removeChildren(),g.forEach(function(t,i){var n,l=a$[t],c={x:a+i*(r+s)+m,y:o+h/2,size:r};if(l===aH?(c.speed=e.attributes.speed,c.onSelect=function(i){return e.handleFunctionChange(t,{value:i})}):[aY,aU,aK].includes(l)?(c.onChange=function(i){return e.handleFunctionChange(t,{value:i})},l===aY&&(c.type="play"===e.attributes.state?"pause":"play"),l===aU&&(c.type="range"===e.attributes.selectionType?"value":"range"),l===aK&&(c.type="line"===e.attributes.chartType?"column":"line")):c.onClick=function(){return e.handleFunctionChange(t,{value:t})},l===aH){var d=null===(n=e.ownerDocument)||void 0===n?void 0:n.defaultView;d&&(e.speedSelect=new l({style:(0,af.pi)((0,af.pi)({},c),{zIndex:100})}),d.appendChild(e.speedSelect))}else e.functions.appendChild(new l({style:c}))})},e.prototype.disconnectedCallback=function(){var e;t.prototype.disconnectedCallback.call(this),null===(e=this.speedSelect)||void 0===e||e.destroy()},e.prototype.render=function(){this.renderBackground(),this.renderFunctions()},e.prototype.handleFunctionChange=function(t,e){var i=this.attributes.onChange;null==i||i(t,e)},e.defaultOptions={style:{x:0,y:0,width:300,height:40,padding:0,align:"center",iconSize:25,iconSpacing:0,speed:1,state:"pause",chartType:"line",selectionType:"range",backgroundFill:"#fbfdff",backgroundStroke:"#ebedf0",functions:[["reset","speed"],["backward","playPause","forward"],["selectionType","chartType"]]}},e}(am.w),aq=function(t){function e(i){var n=t.call(this,(0,av.n)({},e.defaultOptions,i))||this;return n.bindEvents(),n}return(0,af.ZT)(e,t),e.prototype.bindEvents=function(){var t=this;this.addEventListener("mouseenter",function(){t.attr("lineWidth",Math.ceil(+(t.style.r||0)/2))}),this.addEventListener("mouseleave",function(){t.attr("lineWidth",0)})},e.defaultOptions={style:{r:5,fill:"#3f7cf7",lineWidth:0,stroke:"#3f7cf7",strokeOpacity:.5,cursor:"pointer"}},e}(ay.Cd),aJ=function(t){function e(i){return t.call(this,(0,av.n)({},e.defaultOptions,i))||this}return(0,af.ZT)(e,t),e.prototype.renderBackground=function(){var t=this.attributes,e=t.x,i=t.y,n=t.width,r=t.height,s=(0,aE.zs)(this.attributes,"background");(0,aC.Ys)(this).maybeAppend("background","rect").attr("className","background").styles((0,af.pi)({x:e-n/2,y:i-r/2,width:n,height:r},s))},e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,i=t.y,n=t.iconSize,r=(0,aE.zs)(this.attributes,"icon"),s=n/2;(0,aC.Ys)(this).maybeAppend("icon-left-line","line").attr("className","icon-left-line").styles((0,af.pi)({x1:e-1,y1:i-s,x2:e-1,y2:i+s},r)),(0,aC.Ys)(this).maybeAppend("icon-right-line","line").attr("className","icon-right-line").styles((0,af.pi)({x1:e+1,y1:i-s,x2:e+1,y2:i+s},r))},e.prototype.renderBorder=function(){var t=this.attributes,e=t.x,i=t.y,n=t.width,r=t.height,s=t.type,a=(0,aE.zs)(this.attributes,"border"),o="start"===s?+n/2:-n/2;(0,aC.Ys)(this).maybeAppend("border","line").attr("className","border").styles((0,af.pi)({x1:o+e,y1:i-r/2,x2:o+e,y2:i+r/2},a))},e.prototype.render=function(){this.renderBackground(),this.renderIcon(),this.renderBorder()},e.defaultOptions={style:{x:0,y:0,width:10,height:50,iconSize:10,type:"start",backgroundFill:"#fff",backgroundFillOpacity:.5,iconStroke:"#9a9a9a",iconLineWidth:1,borderStroke:"#e8e8e8",borderLineWidth:1}},e}(am.w);function aQ(t){var e=String(Math.floor(t/3600)).padStart(2,"0"),i=String(Math.floor(t%3600/60)).padStart(2,"0"),n=String(Math.floor(t%60)).padStart(2,"0");return t<3600?"".concat(i,":").concat(n):"".concat(e,":").concat(i,":").concat(n)}var a0=function(t){function e(i){var n=t.call(this,(0,av.n)({},e.defaultOptions,i))||this;n.axis=n.appendChild(new aw.R({style:{type:"linear",startPos:[0,0],endPos:[0,0],data:[],showArrow:!1,animate:!1}})),n.timeline=n.appendChild(new aS.i({style:{onChange:function(t){n.handleSliderChange(t)}}})),n.controller=n.appendChild(new aX({})),n.states={},n.handleSliderChange=function(t){var e,i=Array.isArray(e=n.states.values)?(0,af.ev)([],(0,af.CR)(e),!1):e;n.setBySliderValues(t),n.dispatchOnChange(i)};var r=n.attributes,s=r.selectionType,a=r.chartType,o=r.speed,l=r.state,h=r.playMode,c=r.values;return n.states={chartType:a,playMode:h,selectionType:s,speed:o,state:l},n.setByTimebarValues(c),n}return(0,af.ZT)(e,t),Object.defineProperty(e.prototype,"data",{get:function(){return this.attributes.data.sort(function(t,e){return t.time<e.time?-1:t.time>e.time?1:0})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"space",{get:function(){var t,e=this.attributes,i=e.x,n=e.y,r=e.width,s=e.height,a=e.type,o=e.controllerHeight,l=(0,q.Z)(+s-o,0,+s),h=new ab.b(i,n+ +s-o,+r,o),c=0;"chart"===a?(c=35,t=new ab.b(i,n+l-c,+r,c)):t=new ab.b;var d="time"===a?10:l;return{axisBBox:t,controllerBBox:h,timelineBBox:new ab.b(i,n+("time"===a?l:l-d),+r,d-c)}},enumerable:!1,configurable:!0}),e.prototype.setBySliderValues=function(t){var e,i,n=this.data,r=(0,af.CR)(Array.isArray(t)?t:[0,t],2),s=r[0],a=r[1],o=n.length,l=n[Math.floor(s*o)],h=n[Math.ceil(a*o)-(Array.isArray(t)?0:1)];this.states.values=[null!==(e=null==l?void 0:l.time)&&void 0!==e?e:n[0].time,null!==(i=null==h?void 0:h.time)&&void 0!==i?i:1/0]},e.prototype.setByTimebarValues=function(t){var e,i,n,r=this.data,s=(0,af.CR)(Array.isArray(t)?t:[void 0,t],2),a=s[0],o=s[1],l=r.find(function(t){return t.time===a}),h=r.find(function(t){return t.time===o});this.states.values=[null!==(e=null==l?void 0:l.time)&&void 0!==e?e:null===(i=r[0])||void 0===i?void 0:i.time,null!==(n=null==h?void 0:h.time)&&void 0!==n?n:1/0]},e.prototype.setByIndex=function(t){var e,i,n,r,s=this.data,a=(0,af.CR)(t,2),o=a[0],l=a[1];this.states.values=[null!==(i=null===(e=s[o])||void 0===e?void 0:e.time)&&void 0!==i?i:s[0].time,null!==(r=null===(n=this.data[l])||void 0===n?void 0:n.time)&&void 0!==r?r:1/0]},Object.defineProperty(e.prototype,"sliderValues",{get:function(){var t,e=this.states,i=e.values,n=e.selectionType,r=(0,af.CR)(Array.isArray(i)?i:[void 0,i],2),s=r[0],a=r[1],o=this.data,l=o.length,h="value"===n;return[(t=o.findIndex(function(t){return t.time===s}),h?0:t>-1?t/l:0),function(){if(a===1/0)return 1;var t=o.findIndex(function(t){return t.time===a});return t>-1?t/l:h?.5:1}()]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"values",{get:function(){var t=this.states,e=t.values,i=t.selectionType,n=(0,af.CR)(Array.isArray(e)?e:[this.data[0].time,e],2),r=n[0],s=n[1];return"value"===i?s:[r,s]},enumerable:!1,configurable:!0}),e.prototype.getDatumByRatio=function(t){var e=this.data,i=e.length;return e[Math.floor(t*(i-1))]},Object.defineProperty(e.prototype,"chartHandleIconShape",{get:function(){var t=this.states.selectionType,e=this.space.timelineBBox.height;return"range"===t?function(t){return new aJ({style:{type:t,height:e,iconSize:e/6}})}:function(){return new ay.x1({style:{x1:0,y1:-e/2,x2:0,y2:e/2,lineWidth:2,stroke:"#c8c8c8"}})}},enumerable:!1,configurable:!0}),e.prototype.getChartStyle=function(t){var e=this,i=t.x,n=t.y,r=t.width,s=t.height,a=this.states,o=a.selectionType,l=a.chartType,h=this.data,c=this.attributes,d=c.type,u=c.labelFormatter,p=(0,aE.zs)(this.attributes,"chart"),g=(p.type,(0,af._T)(p,["type"])),f="range"===o;if("time"===d)return(0,af.pi)({handleIconShape:function(){return new aq({})},selectionFill:"#2e7ff8",selectionFillOpacity:1,showLabelOnInteraction:!0,handleLabelDy:f?-15:0,autoFitLabel:f,handleSpacing:f?-15:0,trackFill:"#edeeef",trackLength:r,trackOpacity:.5,trackRadius:s/2,trackSize:s/2,type:o,values:this.sliderValues,formatter:function(t){if(u)return u(t);var i=e.getDatumByRatio(t).time;return"number"==typeof i?aQ(i):ax(i,"YYYY-MM-DD HH:mm:ss")},transform:"translate(".concat(i,", ").concat(n,")"),zIndex:1},g);var m=h.map(function(t){return t.value});return(0,af.pi)({handleIconOffset:"range"===o?5:0,handleIconShape:this.chartHandleIconShape,selectionFill:"#fff",selectionFillOpacity:.5,selectionType:"invert",sparklineSpacing:.1,sparklineColumnLineWidth:0,sparklineColor:"#d4e5fd",sparklineAreaOpacity:1,sparklineAreaLineWidth:0,sparklineData:m,sparklineType:l,sparklineScale:.8,trackLength:r,trackSize:s,type:o,values:this.sliderValues,transform:"translate(".concat(i,", ").concat(n,")"),zIndex:1},g)},e.prototype.renderChart=function(t){void 0===t&&(t=this.space.timelineBBox),this.timeline.update(this.getChartStyle(t))},e.prototype.updateSelection=function(){this.timeline.setValues(this.sliderValues,!0),this.handleSliderChange(this.sliderValues)},e.prototype.getAxisStyle=function(t){var e=this.data,i=this.attributes,n=i.interval,r=i.labelFormatter,s=(0,aE.zs)(this.attributes,"axis"),a=t.x,o=t.y,l=t.width,h=(0,af.ev)((0,af.ev)([],(0,af.CR)(e),!1),[{time:0}],!1).map(function(t,e,i){var n=t.time;return{label:"".concat(n),value:e/(i.length-1),time:n}});return(0,af.pi)({startPos:[a,o],endPos:[a+l,o],data:h,labelFilter:function(t,e){return e<h.length-1},labelFormatter:function(t){var e=t.time;return r?r(e):"number"==typeof e?aQ(e):function(t,e){var i=new Date(t);switch(e){case"half-hour":case"hour":case"four-hour":if([0,6,12,18].includes(i.getHours())&&0===i.getMinutes())return ax(i,"HH:mm\nYYYY-MM-DD");return ax(i,"HH:mm");case"half-day":if(12>i.getHours())return"AM\n".concat(ax(i,"YYYY-MM-DD"));return"PM";case"day":if([1,10,20].includes(i.getDate()))return ax(i,"DD\nYYYY-MM");return ax(i,"DD");case"week":if(7>=i.getDate())return ax(i,"DD\nYYYY-MM");return ax(i,"DD");case"month":if([0,6].includes(i.getMonth()))return ax(i,"MM\nYYYY");return ax(i,"MM");case"season":if([0].includes(i.getMonth()))return ax(i,"MM\nYYYY");return ax(i,"MM");case"year":return ax(i,"YYYY");default:return ax(i,"YYYY-MM-DD HH:mm")}}(e,n)}},s)},e.prototype.renderAxis=function(t){void 0===t&&(t=this.space.axisBBox),"chart"===this.attributes.type&&this.axis.update(this.getAxisStyle(t))},e.prototype.renderController=function(t){void 0===t&&(t=this.space.controllerBBox);var e=this.attributes.type,i=this.states,n=i.state,r=i.speed,s=i.selectionType,a=i.chartType,o=(0,aE.zs)(this.attributes,"controller"),l=this,h=(0,af.pi)((0,af.pi)((0,af.pi)({},t),{iconSize:20,speed:r,state:n,selectionType:s,chartType:a,onChange:function(t,e){var i=e.value;switch(t){case"reset":l.internalReset();break;case"speed":l.handleSpeedChange(i);break;case"backward":l.internalBackward();break;case"playPause":"play"===i?l.internalPlay():l.internalPause();break;case"forward":l.internalForward();break;case"selectionType":l.handleSelectionTypeChange(i);break;case"chartType":l.handleChartTypeChange(i)}}}),o);"time"===e&&(h.functions=[["reset","speed"],["backward","playPause","forward"],["selectionType"]]),this.controller.update(h)},e.prototype.dispatchOnChange=function(t){var e=this.data,i=this.attributes.onChange,n=this.states,r=n.values,s=n.selectionType,a=(0,af.CR)(r,2),o=a[0],l=a[1],h=l===1/0?e.at(-1).time:l,c="range"===s?[o,h]:h;(!t||(Array.isArray(t)?!Array.isArray(c)||t[0]!==c[0]||t[1]!==c[1]&&t[1]!==1/0&&c[1]!==1/0:Array.isArray(c)||t!==c))&&null!=i&&i("range"===s?[o,h]:h)},e.prototype.internalReset=function(t){var e,i,n=this.states.selectionType;this.internalPause(),this.setBySliderValues("range"===n?[0,1]:[0,0]),this.renderController(),this.updateSelection(),t||(null===(i=null===(e=this.attributes)||void 0===e?void 0:e.onReset)||void 0===i||i.call(e),this.dispatchOnChange())},e.prototype.reset=function(){this.internalReset()},e.prototype.moveSelection=function(t,e){var i,n,r,s,a,o,l=this.data,h=l.length,c=this.states,d=c.values,u=c.selectionType,p=c.playMode,g=(0,af.CR)(d,2),f=g[0],m=g[1],y=l.findIndex(function(t){return t.time===f}),v=l.findIndex(function(t){return t.time===m});-1===v&&(v=h);var b="backward"===t?-1:1;"range"===u?"acc"===p?(o=[y,v+b],-1===b&&y===v&&(o=[y,h])):o=[y+b,v+b]:o=[y,v+b];var E=(i=o,r=(n=(0,af.CR)(i.sort(function(t,e){return t-e}),2))[0],s=n[1],a=function(t){return(0,q.Z)(t,0,h)},s>h?"value"===u?[0,0]:"acc"===p?[a(r),a(r)]:[0,a(s-r)]:r<0?"acc"===p?[0,a(s)]:[a(r+h-s),h]:[a(r),a(s)]);return this.setByIndex(E),this.updateSelection(),E},e.prototype.internalBackward=function(t){var e,i,n=this.moveSelection("backward",t);return t||(null===(i=null===(e=this.attributes)||void 0===e?void 0:e.onBackward)||void 0===i||i.call(e),this.dispatchOnChange()),n},e.prototype.backward=function(){this.internalBackward()},e.prototype.internalPlay=function(t){var e,i,n=this,r=this.data,s=this.attributes.loop,a=this.states.speed,o=void 0===a?1:a;this.playInterval=window.setInterval(function(){n.internalForward()[1]!==r.length||s||(n.internalPause(),n.renderController())},1e3/o),this.states.state="play",t||null===(i=null===(e=this.attributes)||void 0===e?void 0:e.onPlay)||void 0===i||i.call(e)},e.prototype.play=function(){this.internalPlay()},e.prototype.internalPause=function(t){var e,i;clearInterval(this.playInterval),this.states.state="pause",t||null===(i=null===(e=this.attributes)||void 0===e?void 0:e.onPause)||void 0===i||i.call(e)},e.prototype.pause=function(){this.internalPause()},e.prototype.internalForward=function(t){var e,i,n=this.moveSelection("forward",t);return t||(null===(i=null===(e=this.attributes)||void 0===e?void 0:e.onForward)||void 0===i||i.call(e),this.dispatchOnChange()),n},e.prototype.forward=function(){this.internalForward()},e.prototype.handleSpeedChange=function(t){var e,i;this.states.speed=t,"play"===this.states.state&&(this.internalPause(!0),this.internalPlay(!0)),null===(i=null===(e=this.attributes)||void 0===e?void 0:e.onSpeedChange)||void 0===i||i.call(e,t)},e.prototype.handleSelectionTypeChange=function(t){var e,i;this.states.selectionType=t,this.renderChart(),null===(i=null===(e=this.attributes)||void 0===e?void 0:e.onSelectionTypeChange)||void 0===i||i.call(e,t)},e.prototype.handleChartTypeChange=function(t){var e,i;this.states.chartType=t,this.renderChart(),null===(i=null===(e=this.attributes)||void 0===e?void 0:e.onChartTypeChange)||void 0===i||i.call(e,t)},e.prototype.render=function(){var t=this.space,e=t.axisBBox,i=t.controllerBBox,n=t.timelineBBox;this.renderController(i),this.renderAxis(e),this.renderChart(n),"play"===this.states.state&&this.internalPlay()},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.internalPause(!0)},e.defaultOptions={style:{x:0,y:0,axisLabelFill:"#6e6e6e",axisLabelTextAlign:"left",axisLabelTextBaseline:"top",axisLabelTransform:"translate(5, -12)",axisLineLineWidth:1,axisLineStroke:"#cacdd1",axisTickLength:15,axisTickLineWidth:1,axisTickStroke:"#cacdd1",chartShowLabel:!1,chartType:"line",controllerAlign:"center",controllerHeight:40,data:[],interval:"day",loop:!1,playMode:"acc",selectionType:"range",type:"time"}},e}(am.w),a1=i(3392);let a2=["timestamp","time","date","datetime"];class a3 extends sb{get padding(){return ef(this.options.padding)}play(){var t;null===(t=this.timebar)||void 0===t||t.play()}pause(){var t;null===(t=this.timebar)||void 0===t||t.pause()}forward(){var t;null===(t=this.timebar)||void 0===t||t.forward()}backward(){var t;null===(t=this.timebar)||void 0===t||t.backward()}reset(){var t;null===(t=this.timebar)||void 0===t||t.reset()}update(t){super.update(t),this.backup(),Object.keys(t).forEach(t=>{"position"===t?this.upsertWrapper():this.upsertTimebar()})}backup(){this.originalData=a6(this.context.graph.getData())}upsertTimebar(){let{canvas:t}=this.context,{onChange:e,timebarType:i,data:n,x:r,y:s,width:a,height:o,mode:l,...h}=this.options,c=t.getSize(),[d]=this.padding;this.upsertCanvas().ready.then(()=>{let t={x:c[0]/2-a/2,y:d,onChange:t=>{let i=((0,ig.Z)(t)?t:[t,t]).map(t=>(0,a1.Z)(t,"Date")?t.getTime():t);"modify"===this.options.mode?this.filterElements(i):this.hiddenElements(i),null==e||e(i)},...h,data:n.map(t=>(0,F.Z)(t)?{time:t,value:0}:t),width:a,height:o,type:i};if(this.timebar)this.timebar.update(t);else{var r;this.timebar=new a0({style:t}),null===(r=this.canvas)||void 0===r||r.appendChild(this.timebar)}})}upsertWrapper(){var t;if(!this.wrapper){let t=document.createElement("div");t.style.position="absolute",this.wrapper=t}let{x:e,y:i,className:n,position:r}=this.options;return n&&(this.wrapper.className=n),(0,F.Z)(e)||(0,F.Z)(i)?Object.assign(this.wrapper.style,{left:"".concat(null!=e?e:0,"px"),top:"".concat(null!=i?i:0,"px")}):Object.assign(this.wrapper.style,{["top"===r?"bottom":"top"]:"unset",["top"===r?"top":"bottom"]:"0px"}),null===(t=this.context.canvas.getContainer())||void 0===t||t.appendChild(this.wrapper),this.wrapper}upsertCanvas(){var t,e;let i=this.upsertWrapper();if(this.canvas)return this.canvas;let{height:n}=this.options,[r]=this.context.canvas.getSize(),[s,,a]=this.padding;return this.canvas=new I.Xz({container:i,width:r,height:n+s+a,renderer:(null===(e=(t=this.context.options).renderer)||void 0===e?void 0:e.call(t,"main"))||new nj,supportsMutipleCanvasesInOneContainer:!0}),this.canvas}async filterElements(t){var e;if(!this.originalData)return;let{elementTypes:i,getTime:n}=this.options,{graph:r,element:s}=this.context,a=a6(this.originalData);i.forEach(e=>{let i="".concat(e,"s");a[i]=(this.originalData[i]||[]).filter(e=>{let i=n(e);return!!a4(i,t)})});let o=[...a.nodes,...a.combos].map(t=>t7(t));a.edges=a.edges.filter(t=>{let e=t.source,i=t.target;return o.includes(e)&&o.includes(i)}),r.setData(a),await (null===(e=s.draw({animation:!1,silence:!0}))||void 0===e?void 0:e.finished)}hiddenElements(t){let{graph:e}=this.context,{elementTypes:i,getTime:n}=this.options,r=[],s=[];i.forEach(e=>{var i;let a=(null===(i=this.originalData)||void 0===i?void 0:i["".concat(e,"s")])||[];a.forEach(e=>{let i=t7(e),a=n(e);a4(a,t)?s.push(i):r.push(i)})}),e.hideElement(r,!1),e.showElement(s,!1)}destroy(){var t,e,i;let{graph:n}=this.context;this.originalData&&n.setData({...this.originalData}),null===(t=this.timebar)||void 0===t||t.destroy(),null===(e=this.canvas)||void 0===e||e.destroy(),null===(i=this.wrapper)||void 0===i||i.remove(),this.originalData=void 0,this.wrapper=void 0,this.timebar=void 0,this.canvas=void 0,super.destroy()}constructor(t,e){super(t,Object.assign({},a3.defaultOptions,e)),this.backup(),this.upsertTimebar()}}a3.defaultOptions={position:"bottom",enable:!0,timebarType:"time",className:"g6-timebar",width:450,height:60,zIndex:3,elementTypes:["node"],padding:10,mode:"modify",getTime:t=>a8(t,a2,void 0),loop:!1};let a6=t=>{let{nodes:e=[],edges:i=[],combos:n=[]}=t;return{nodes:[...e],edges:[...i],combos:[...n]}},a4=(t,e)=>{if((0,F.Z)(e))return t===e;let[i,n]=e;return t>=i&&t<=n},a8=(t,e,i)=>{for(let i=0;i<e.length;i++){var n;let r=e[i],s=null===(n=t.data)||void 0===n?void 0:n[r];if(s)return s}return i};class a9 extends sb{async update(t){super.update(t);let{className:e,position:i,style:n}=this.options;this.$element.className="g6-toolbar ".concat(e||""),Object.assign(this.$element.style,n,function(t){let e={top:"unset",right:"unset",bottom:"unset",left:"unset"},i=t.split("-");return i.forEach(t=>{e[t]="8px"}),e.flexDirection=t.startsWith("top")||t.startsWith("bottom")?"row":"column",e}(i)),this.$element.innerHTML=await this.getDOMContent()}destroy(){this.$element.removeEventListener("click",this.onToolbarItemClick),this.$element.remove(),super.destroy()}async getDOMContent(){let t=await this.options.getItems();return t.map(t=>'\n          <div class="g6-toolbar-item" value="'.concat(t.value,'">\n            <svg aria-hidden="true" focusable="false">\n              <use xlink:href="#').concat(t.id,'"></use>\n            </svg>\n          </div>')).join("")}constructor(t,e){super(t,Object.assign({},a9.defaultOptions,e)),this.$element=sy("toolbar",!1),this.onToolbarItemClick=t=>{let{onClick:e}=this.options;if(t.target instanceof Element&&t.target.className.includes("g6-toolbar-item")){let i=t.target.getAttribute("value");null==e||e(i,t.target)}};let i=this.context.canvas.getContainer();this.$element.style.display="flex",i.appendChild(this.$element),sv("g6-toolbar-css","style",{},"\n  .g6-toolbar {\n    position: absolute;\n    z-index: 100;\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    justify-content: center;\n    border-radius: 4px;\n    box-shadow: 0px 0px 8px rgba(0, 0, 0, 0.1);\n    opacity: 0.65;\n  }\n  .g6-toolbar .g6-toolbar-item {\n    display: inline-block;\n    width: 16px;\n    height: 16px;\n    padding: 4px;\n    cursor: pointer;\n    box-sizing: content-box;\n  }\n\n  .g6-toolbar .g6-toolbar-item:hover {\n    background-color: #f0f0f0;\n  }\n\n  .g6-toolbar .g6-toolbar-item svg {\n    display: inline-block;\n    width: 100%;\n    height: 100%;\n    pointer-events: none;\n  }\n",document.head),sv("g6-toolbar-svgicon","div",{display:"none"},'\n  <svg>\n    <symbol id="zoom-in" viewBox="64 64 896 896">\n      <path d="M637 443H519V309c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v134H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h118v134c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V519h118c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z"></path>\n    </symbol>\n    <symbol id="zoom-out" viewBox="64 64 896 896">\n      <path d="M637 443H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h312c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z"></path>\n    </symbol>\n    <symbol id="edit" viewBox="64 64 896 896">\n      <path d="M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9zm67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z"></path>\n    </symbol>\n    <symbol id="delete" viewBox="64 64 896 896">\n      <path d="M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"></path>\n    </symbol>\n    <symbol id="redo" viewBox="64 64 896 896">\n      <path d="M758.2 839.1C851.8 765.9 912 651.9 912 523.9 912 303 733.5 124.3 512.6 124 291.4 123.7 112 302.8 112 523.9c0 125.2 57.5 236.9 147.6 310.2 3.5 2.8 8.6 2.2 11.4-1.3l39.4-50.5c2.7-3.4 2.1-8.3-1.2-11.1-8.1-6.6-15.9-13.7-23.4-21.2a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-9.3 9.3-19.1 18-29.3 26L668.2 724a8 8 0 00-14.1 3l-39.6 162.2c-1.2 5 2.6 9.9 7.7 9.9l167 .8c6.7 0 10.5-7.7 6.3-12.9l-37.3-47.9z"></path>\n    </symbol>\n    <symbol id="undo" viewBox="64 64 896 896">\n      <path d="M511.4 124C290.5 124.3 112 303 112 523.9c0 128 60.2 242 153.8 315.2l-37.5 48c-4.1 5.3-.3 13 6.3 12.9l167-.8c5.2 0 9-4.9 7.7-9.9L369.8 727a8 8 0 00-14.1-3L315 776.1c-10.2-8-20-16.7-29.3-26a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-7.5 7.5-15.3 14.5-23.4 21.2a7.93 7.93 0 00-1.2 11.1l39.4 50.5c2.8 3.5 7.9 4.1 11.4 1.3C854.5 760.8 912 649.1 912 523.9c0-221.1-179.4-400.2-400.6-399.9z"></path>\n    </symbol>\n    <symbol id="export" viewBox="64 64 896 896">\n      <path d="M880 912H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32h360c4.4 0 8 3.6 8 8v56c0 4.4-3.6 8-8 8H184v656h656V520c0-4.4 3.6-8 8-8h56c4.4 0 8 3.6 8 8v360c0 17.7-14.3 32-32 32zM770.87 199.13l-52.2-52.2a8.01 8.01 0 014.7-13.6l179.4-21c5.1-.6 9.5 3.7 8.9 8.9l-21 179.4c-.8 6.6-8.9 9.4-13.6 4.7l-52.4-52.4-256.2 256.2a8.03 8.03 0 01-11.3 0l-42.4-42.4a8.03 8.03 0 010-11.3l256.1-256.3z"></path>\n    </symbol>\n    <symbol id="auto-fit" viewBox="64 64 896 896">\n      <path d="M952 474H829.8C812.5 327.6 696.4 211.5 550 194.2V72c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v122.2C327.6 211.5 211.5 327.6 194.2 474H72c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h122.2C211.5 696.4 327.6 812.5 474 829.8V952c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V829.8C696.4 812.5 812.5 696.4 829.8 550H952c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zM512 756c-134.8 0-244-109.2-244-244s109.2-244 244-244 244 109.2 244 244-109.2 244-244 244z"></path>\n      <path d="M512 392c-32.1 0-62.1 12.4-84.8 35.2-22.7 22.7-35.2 52.7-35.2 84.8s12.5 62.1 35.2 84.8C449.9 619.4 480 632 512 632s62.1-12.5 84.8-35.2C619.4 574.1 632 544 632 512s-12.5-62.1-35.2-84.8A118.57 118.57 0 00512 392z"></path>\n    </symbol>\n    <symbol id="reset" viewBox="64 64 896 896">\n      <path d="M909.1 209.3l-56.4 44.1C775.8 155.1 656.2 92 521.9 92 290 92 102.3 279.5 102 511.5 101.7 743.7 289.8 932 521.9 932c181.3 0 335.8-115 394.6-276.1 1.5-4.2-.7-8.9-4.9-10.3l-56.7-19.5a8 8 0 00-10.1 4.8c-1.8 5-3.8 10-5.9 14.9-17.3 41-42.1 77.8-73.7 109.4A344.77 344.77 0 01655.9 829c-42.3 17.9-87.4 27-133.8 27-46.5 0-91.5-9.1-133.8-27A341.5 341.5 0 01279 755.2a342.16 342.16 0 01-73.7-109.4c-17.9-42.4-27-87.4-27-133.9s9.1-91.5 27-133.9c17.3-41 42.1-77.8 73.7-109.4 31.6-31.6 68.4-56.4 109.3-73.8 42.3-17.9 87.4-27 133.8-27 46.5 0 91.5 9.1 133.8 27a341.5 341.5 0 01109.3 73.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.6 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c-.1-6.6-7.8-10.3-13-6.2z"></path>\n    </symbol>\n    <symbol id="exit-fullscreen" viewBox="0 0 1024 1024">\n      <path d="M418.13333333 361.43786666c0 0.2048-0.13653333 0.4096-0.13653334 0.68266667C417.99679999 362.32533333 418.13333333 362.53013333 418.13333333 362.73493333 418.13333333 371.54133333 414.44693333 379.392 408.78079999 385.39946666 408.43946666 385.7408 408.30293333 386.21866666 408.02986666 386.49173333c-1.09226667 1.09226667-2.59413333 1.77493333-3.82293333 2.73066667C398.40426666 393.65973333 391.64586666 396.8 383.93173333 396.8 383.72693333 396.8 383.59039999 396.73173333 383.38559999 396.73173333S382.97599999 396.8 382.77119999 396.8L112.29866666 396.8C92.50133333 396.8 76.79999999 381.50826666 76.79999999 362.66666666 76.66346666 343.89333333 92.63786666 328.53333333 112.16213333 328.53333333l189.44 0L87.44959999 114.51733333C73.59146666 100.59093333 73.25013333 78.5408 86.63039999 65.29706666c13.17546667-13.44853333 35.36213333-12.97066667 49.152 0.88746667l214.08426667 214.08426667L349.86666666 90.89706666C349.79839999 71.23626666 365.22666666 55.46666666 383.99999999 55.46666666 402.77333333 55.33013333 418.13333333 71.30453333 418.13333333 90.8288L418.13333333 361.43786666zM928.90453333 328.53333333l-189.44 0 214.15253333-214.08426667c13.85813333-13.9264 14.19946667-35.90826667 0.88746667-49.22026666-13.17546667-13.44853333-35.36213333-12.97066667-49.152 0.88746666l-214.08426667 214.08426667L691.26826666 90.89706666C691.26826666 71.23626666 675.83999999 55.46666666 657.06666666 55.46666666 638.29333333 55.33013333 622.93333333 71.30453333 622.93333333 90.8288l0 270.60906666c0 0.2048 0.13653333 0.4096 0.13653333 0.68266667C623.06986666 362.32533333 622.93333333 362.53013333 622.93333333 362.73493333 622.93333333 371.54133333 626.61973333 379.392 632.28586666 385.39946666c0.34133333 0.34133333 0.47786667 0.8192 0.8192 1.09226667 1.09226667 1.09226667 2.59413333 1.77493333 3.8912 2.73066667C642.66239999 393.65973333 649.42079999 396.8 657.13493333 396.8c0.2048 0 0.34133333-0.06826667 0.54613333-0.06826667S658.09066666 396.8 658.29546666 396.8l270.5408 0C948.56533333 396.8 964.26666666 381.50826666 964.26666666 362.66666666 964.40319999 343.89333333 948.42879999 328.53333333 928.90453333 328.53333333zM418.13333333 635.73333333c0-8.8064-3.6864-16.5888-9.35253334-22.66453333C408.43946666 612.72746666 408.30293333 612.2496 408.02986666 611.90826666 406.86933333 610.88426666 405.43573333 610.2016 404.20693333 609.24586666 398.47253333 604.80853333 391.64586666 601.6 383.93173333 601.6 383.72693333 601.6 383.59039999 601.73653333 383.38559999 601.73653333S382.97599999 601.6 382.77119999 601.6L112.29866666 601.6C92.50133333 601.6 76.79999999 616.96 76.79999999 635.73333333 76.66346666 654.50666666 92.63786666 669.86666666 112.16213333 669.86666666l189.44 0-214.15253334 214.15253334c-13.85813333 13.85813333-14.19946667 35.84-0.88746666 49.22026666 13.17546667 13.44853333 35.36213333 12.9024 49.152-0.95573333l214.08426666-214.08426667 0 189.37173334c0 19.59253333 15.42826667 35.49866667 34.2016 35.36213333C402.77333333 943.2064 418.13333333 927.232 418.13333333 907.5712L418.13333333 637.09866666c0-0.27306667-0.13653333-0.47786667-0.13653334-0.68266666C417.99679999 636.14293333 418.13333333 635.93813333 418.13333333 635.73333333zM739.46453333 669.86666666l189.44 0c19.456 0 35.49866667-15.36 35.36213333-34.13333333C964.26666666 616.96 948.56533333 601.6 928.76799999 601.6L658.29546666 601.6C658.09066666 601.6 657.88586666 601.73653333 657.68106666 601.73653333S657.33973333 601.6 657.13493333 601.6C649.42079999 601.6 642.59413333 604.80853333 636.85973333 609.24586666 635.63093333 610.2016 634.19733333 610.88426666 633.03679999 611.90826666 632.76373333 612.2496 632.62719999 612.72746666 632.28586666 613.0688 626.61973333 619.14453333 622.93333333 626.92693333 622.93333333 635.73333333c0 0.2048 0.13653333 0.4096 0.13653333 0.68266667C623.06986666 636.6208 622.93333333 636.8256 622.93333333 637.09866666l0 270.5408C622.93333333 927.232 638.29333333 943.2064 657.06666666 942.93333333c18.77333333 0.13653333 34.2016-15.70133333 34.2016-35.36213333l0-189.37173334 214.08426667 214.08426667c13.78986667 13.85813333 35.90826667 14.40426667 49.152 0.95573333 13.312-13.312 12.97066667-35.36213333-0.88746667-49.22026666L739.46453333 669.86666666z"  ></path></symbol>\n    <symbol id="request-fullscreen" viewBox="0 0 1024 1024">\n      <path d="M69.818182 87.598545v273.128728a34.909091 34.909091 0 0 0 69.818182 0V163.653818l221.928727 222.021818a33.512727 33.512727 0 0 0 47.383273-47.383272L186.926545 116.363636h197.073455a34.909091 34.909091 0 0 0 0-69.818181H110.871273C85.364364 46.545455 69.818182 59.671273 69.818182 87.598545zM938.542545 46.545455H665.413818a34.909091 34.909091 0 0 0 0 69.818181h197.073455L640.465455 338.292364a33.512727 33.512727 0 0 0 47.383272 47.383272l221.928728-222.021818v197.073455a34.909091 34.909091 0 0 0 69.818181 0V87.598545c0-27.927273-15.453091-41.053091-40.96-41.05309z m-827.671272 907.636363h273.128727a34.909091 34.909091 0 0 0 0-69.818182H186.926545l222.021819-221.928727a33.512727 33.512727 0 0 0-47.383273-47.383273L139.636364 837.073455V640a34.909091 34.909091 0 0 0-69.818182 0v273.128727c0 27.927273 15.546182 41.053091 41.053091 41.053091z m868.724363-41.053091V640a34.909091 34.909091 0 0 0-69.818181 0v197.073455L687.941818 615.051636a33.512727 33.512727 0 0 0-47.383273 47.383273L862.487273 884.363636H665.413818a34.909091 34.909091 0 0 0 0 69.818182h273.128727c25.6 0 41.053091-13.125818 41.053091-41.053091z"  ></path></symbol>\n  </svg>\n'),this.$element.addEventListener("click",this.onToolbarItemClick),this.update(e)}}a9.defaultOptions={position:"top-left"};var a5=i(67159);class a7 extends sb{getEvents(){return"click"===this.options.trigger?{"node:click":this.onClick,"edge:click":this.onClick,"combo:click":this.onClick,"canvas:click":this.onPointerLeave,contextmenu:this.onPointerLeave,drag:this.onPointerLeave}:{"node:pointerenter":this.onPointerEnter,"node:pointermove":this.onPointerMove,"canvas:pointermove":this.onCanvasMove,"edge:pointerenter":this.onPointerEnter,"edge:pointermove":this.onPointerMove,"combo:pointerenter":this.onPointerEnter,"combo:pointermove":this.onPointerMove,contextmenu:this.onPointerLeave,"node:drag":this.onPointerLeave}}update(t){if(this.unbindEvents(),super.update(t),this.tooltipElement){var e;null===(e=this.container)||void 0===e||e.removeChild(this.tooltipElement.HTMLTooltipElement)}this.tooltipElement=this.initTooltip(),this.bindEvents()}render(){let{canvas:t}=this.context,e=t.getContainer();e&&(this.container=e,this.tooltipElement=this.initTooltip())}unbindEvents(){let{graph:t}=this.context,e=this.getEvents();Object.keys(e).forEach(i=>{t.off(i,e[i])})}bindEvents(){let{graph:t}=this.context,e=this.getEvents();Object.keys(e).forEach(i=>{t.on(i,e[i])})}get tooltipStyleProps(){let{canvas:t}=this.context,{center:e}=t.getBounds(),i=t.getContainer(),{top:n,left:r}=i.getBoundingClientRect(),{style:s,position:a,enterable:o,container:l={x:-r,y:-n},title:h,offset:c}=this.options,[d,u]=e,[p,g]=t.getSize();return{x:d,y:u,container:l,title:h,bounding:{x:0,y:0,width:p,height:g},position:a,enterable:o,offset:c,style:s}}destroy(){if(this.unbindEvents(),this.tooltipElement){var t;null===(t=this.container)||void 0===t||t.removeChild(this.tooltipElement.HTMLTooltipElement)}super.destroy()}constructor(t,e){super(t,Object.assign({},a7.defaultOptions,e)),this.currentTarget=null,this.tooltipElement=null,this.container=null,this.isEnable=t=>{let{enable:e}=this.options;return"function"==typeof e?e(t):e},this.onClick=t=>{let{target:{id:e}}=t;this.currentTarget===e?(this.currentTarget=null,this.hide(t)):(this.currentTarget=e,this.show(t))},this.onPointerMove=t=>{let{target:e}=t;this.currentTarget&&e.id!==this.currentTarget&&this.show(t)},this.onPointerLeave=t=>{this.hide(t),this.currentTarget=null},this.onCanvasMove=t=>{this.hide(t),this.currentTarget=null},this.onPointerEnter=t=>{this.show(t)},this.showById=t=>{this.show({target:{id:t}})},this.getElementData=(t,e)=>{let{model:i}=this.context;switch(e){case"node":return i.getNodeData([t]);case"edge":return i.getEdgeData([t]);case"combo":return i.getComboData([t]);default:return[]}},this.show=t=>{let e,i;let{client:n,target:{id:r}}=t;if(rz(t.target)||!this.tooltipElement||!this.isEnable(t))return;let s=this.context.graph.getElementType(r),{getContent:a,title:o}=this.options;this.currentTarget=r;let l=this.getElementData(r,s);if(n)e=n.x,i=n.y;else{let t=(0,it.Z)(l,"0.style",{x:0,y:0});e=t.x,i=t.y}let h={};if(a)h.content=a(t,l);else{let t=this.context.graph.getElementRenderStyle(r),e="node"===s?t.fill:t.stroke;h={title:o||s,data:l.map(t=>({name:"ID",value:t.id||"".concat(t.source," -> ").concat(t.target),color:e}))}}this.tooltipElement.update({...this.tooltipStyleProps,x:e,y:i,style:{".tooltip":{visibility:"visible"}},...h})},this.hide=t=>{if(!t){var e;null===(e=this.tooltipElement)||void 0===e||e.hide();return}if(!this.tooltipElement||!this.isEnable(t))return;let{client:{x:i,y:n}}=t;this.tooltipElement.hide(i,n)},this.initTooltip=()=>{var t;let e=new a5.u({className:"tooltip",style:this.tooltipStyleProps});return null===(t=this.container)||void 0===t||t.appendChild(e.HTMLTooltipElement),e},this.render(),this.bindEvents()}}function ot(t,e){n||(n=document.createElement("canvas")),n.width=t,n.height=e;let i=n.getContext("2d");return i.clearRect(0,0,t,e),n}async function oe(t,e,i,n){let r=ot(t,e),s=r.getContext("2d"),{rotate:a,opacity:o,textFill:l,textFontSize:h,textFontFamily:c,textFontVariant:d,textFontWeight:u,textAlign:p,textBaseline:g}=n;return s.textAlign=p,s.textBaseline=g,s.translate(t/2,e/2),s.font="".concat(h,"px ").concat(c," ").concat(d," ").concat(u),a&&s.rotate(a),o&&(s.globalAlpha=o),l&&(s.fillStyle=l,s.fillText("".concat(i),0,0)),r.toDataURL()}async function oi(t,e,i,n){let r=ot(t,e),s=r.getContext("2d"),{rotate:a,opacity:o}=n;a&&s.rotate(a),o&&(s.globalAlpha=o);let l=new Image;return l.crossOrigin="anonymous",l.src=i,new Promise(i=>{l.onload=function(){let n=t>l.width?(t-l.width)/2:0,a=e>l.height?(e-l.height)/2:0;s.drawImage(l,0,0,l.width,l.height,n,a,t-2*n,e-2*a),i(r.toDataURL())}})}a7.defaultOptions={trigger:"hover",position:"top-right",enterable:!1,enable:!0,offset:[10,10],style:{".tooltip":{visibility:"hidden"}}};class on extends sb{async update(t){super.update(t);let{width:e,height:i,text:n,imageURL:r,...s}=this.options;Object.keys(s).forEach(e=>{e.startsWith("background")&&(this.$element.style[e]=t[e])});let a=r?await oi(e,i,r,s):await oe(e,i,n,s);this.$element.style.backgroundImage="url(".concat(a,")")}destroy(){super.destroy(),this.$element.remove()}constructor(t,e){super(t,Object.assign({},on.defaultOptions,e)),this.$element=sy("watermark");let i=this.context.canvas.getContainer();i.appendChild(this.$element),this.update(e)}}on.defaultOptions={width:200,height:100,opacity:.2,rotate:Math.PI/12,text:"",textFill:"#000",textFontSize:16,textAlign:"center",textBaseline:"middle",backgroundRepeat:"repeat"};let or=["#7E92B5","#F4664A","#FFBE3A"],os={type:"group",color:["#1783FF","#00C9C9","#F08F56","#D580FF","#7863FF","#DB9D0D","#60C42D","#FF80CA","#2491B3","#17C76F"]},oa={type:"group",color:["#99ADD1","#1783FF","#00C9C9","#F08F56","#D580FF","#7863FF","#DB9D0D","#60C42D","#FF80CA","#2491B3","#17C76F"]};function oo(t){let{bgColor:e,textColor:i,nodeColor:n,nodeColorDisabled:r,nodeStroke:s,nodeHaloStrokeOpacityActive:a=.15,nodeHaloStrokeOpacitySelected:o=.25,nodeOpacityDisabled:l=.06,nodeIconOpacityInactive:h=.85,nodeOpacityInactive:c=.25,nodeBadgePalette:d=or,nodePaletteOptions:u=os,edgeColor:p,edgeColorDisabled:g,edgePaletteOptions:f=oa,comboColor:m,comboColorDisabled:y,comboStroke:v,comboStrokeDisabled:b,edgeColorInactive:E}=t;return{background:e,node:{palette:u,style:{donutOpacity:1,badgeBackgroundOpacity:1,badgeFill:"#fff",badgeFontSize:8,badgePadding:[0,4],badgePalette:d,fill:n,fillOpacity:1,halo:!1,iconFill:"#fff",iconOpacity:1,labelBackground:!1,labelBackgroundFill:e,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelFill:i,labelFillOpacity:.85,labelLineHeight:16,labelPadding:[0,2],labelFontSize:12,labelFontWeight:400,labelOpacity:1,labelOffsetY:2,lineWidth:0,portFill:n,portLineWidth:1,portStroke:s,portStrokeOpacity:.65,size:32,stroke:s,strokeOpacity:1,zIndex:2},state:{selected:{halo:!0,haloLineWidth:24,haloStrokeOpacity:o,labelFontSize:12,labelFontWeight:"bold",lineWidth:4,stroke:s},active:{halo:!0,haloLineWidth:12,haloStrokeOpacity:a},highlight:{labelFontWeight:"bold",lineWidth:4,stroke:s,strokeOpacity:.85},inactive:{badgeBackgroundOpacity:c,donutOpacity:c,fillOpacity:c,iconOpacity:h,labelFill:i,labelFillOpacity:c,strokeOpacity:c},disabled:{badgeBackgroundOpacity:.25,donutOpacity:l,fill:r,fillOpacity:l,iconFill:r,iconOpacity:.25,labelFill:i,labelFillOpacity:.25,strokeOpacity:l}},animation:{enter:"fade",exit:"fade",show:"fade",hide:"fade",expand:"node-expand",collapse:"node-collapse",update:[{fields:["x","y","fill","stroke"]}],translate:[{fields:["x","y"]}]}},edge:{palette:f,style:{badgeBackgroundFill:p,badgeFill:"#fff",badgeFontSize:8,badgeOffsetX:10,fillOpacity:1,halo:!1,haloLineWidth:12,haloStrokeOpacity:1,increasedLineWidthForHitTesting:2,labelBackground:!1,labelBackgroundFill:e,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelBackgroundPadding:[4,4,4,4],labelFill:i,labelFontSize:12,labelFontWeight:400,labelOpacity:1,labelPlacement:"center",labelTextBaseline:"middle",lineWidth:1,stroke:p,strokeOpacity:1,zIndex:1},state:{selected:{halo:!0,haloStrokeOpacity:.25,labelFontSize:14,labelFontWeight:"bold",lineWidth:3},active:{halo:!0,haloStrokeOpacity:.15},highlight:{labelFontWeight:"bold",lineWidth:3},inactive:{stroke:E,fillOpacity:.08,labelOpacity:.25,strokeOpacity:.08,badgeBackgroundOpacity:.25},disabled:{stroke:g,fillOpacity:.45,strokeOpacity:.45,labelOpacity:.25,badgeBackgroundOpacity:.45}},animation:{enter:"fade",exit:"fade",expand:"path-in",collapse:"path-out",show:"fade",hide:"fade",update:[{fields:["sourceNode","targetNode"]},{fields:["stroke"],shape:"key"}],translate:[{fields:["sourceNode","targetNode"]}]}},combo:{style:{collapsedMarkerFill:e,collapsedMarkerFontSize:12,collapsedMarkerFillOpacity:1,collapsedSize:32,collapsedFillOpacity:1,fill:m,halo:!1,haloLineWidth:12,haloStroke:v,haloStrokeOpacity:.25,labelBackground:!1,labelBackgroundFill:e,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelBackgroundPadding:[2,4,2,4],labelFill:i,labelFontSize:12,labelFontWeight:400,labelOpacity:1,lineDash:0,lineWidth:1,fillOpacity:.04,strokeOpacity:1,padding:10,stroke:v},state:{selected:{halo:!0,labelFontSize:14,labelFontWeight:700,lineWidth:4},active:{halo:!0},highlight:{labelFontWeight:700,lineWidth:4},inactive:{fillOpacity:.65,labelOpacity:.25,strokeOpacity:.65},disabled:{fill:y,fillOpacity:.25,labelOpacity:.25,stroke:b,strokeOpacity:.25}},animation:{enter:"fade",exit:"fade",show:"fade",hide:"fade",expand:"combo-expand",collapse:"combo-collapse",update:[{fields:["x","y"]},{fields:["fill","stroke","lineWidth"],shape:"key"}],translate:[{fields:["x","y"]}]}}}}let ol=oo({bgColor:"#000000",comboColor:"#fdfdfd",comboColorDisabled:"#d0e4ff",comboStroke:"#99add1",comboStrokeDisabled:"#969696",edgeColor:"#637088",edgeColorDisabled:"#637088",edgeColorInactive:"#D0E4FF",edgePaletteOptions:{type:"group",color:["#637088","#0F55A6","#008383","#9C5D38","#8B53A6","#4E40A6","#8F6608","#3E801D","#A65383","#175E75","#0F8248"]},nodeColor:"#1783ff",nodeColorDisabled:"#D0E4FF",nodeHaloStrokeOpacityActive:.25,nodeHaloStrokeOpacitySelected:.45,nodeIconOpacityInactive:.45,nodeOpacityDisabled:.25,nodeOpacityInactive:.45,nodeStroke:"#d0e4ff",textColor:"#ffffff"}),oh=oo({bgColor:"#ffffff",comboColor:"#99ADD1",comboColorDisabled:"#f0f0f0",comboStroke:"#99add1",comboStrokeDisabled:"#d9d9d9",edgeColor:"#99add1",edgeColorDisabled:"#d9d9d9",edgeColorInactive:"#1B324F",nodeColor:"#1783ff",nodeColorDisabled:"#1B324F",nodeHaloStrokeOpacityActive:.15,nodeHaloStrokeOpacitySelected:.25,nodeIconOpacityInactive:.85,nodeOpacityDisabled:.06,nodeOpacityInactive:.25,nodeStroke:"#000000",textColor:"#000000"});class oc extends eh{beforeDraw(t,e){return t}}function od(t,e,i,n,r){let s=t7(n),a="".concat(i,"s"),o=r?n:t.add[a].get(s)||t.update[a].get(s)||t.remove[a].get(s)||n;Object.entries(t).forEach(t=>{let[i,n]=t;e===i?n[a].set(s,o):n[a].delete(s)})}let ou=(t,e,i,n)=>{let r="".concat(i,"s"),s=t7(n);t.add[r].has(s)||t.update[r].has(s)||t[e][r].set(t7(n),n)};class op{constructor(t){this.type=t}}class og extends op{constructor(t,e){super(t),this.data=e}}class of extends op{constructor(t,e,i,n){super(t),this.animationType=e,this.animation=i,this.data=n}}class om extends op{constructor(t,e,i){super(t),this.elementType=e,this.data=i}}class oy extends op{constructor(t,e){super(t),this.data=e}}function ov(t,e){t.emit(e.type,e)}class ob{getTasks(){let t=[...this.tasks];return this.tasks=[],t}add(t,e){this.tasks.push([t,e])}animate(t,e,i){var n,r,s;null==e||null===(n=e.before)||void 0===n||n.call(e);let a=this.getTasks().map(e=>{var n,r,s;let[a,o]=e,{element:l,elementType:h,stage:c}=a,d=function(t,e,i,n){var r,s;let{animation:a}=t,o=null==t?void 0:null===(r=t[e])||void 0===r?void 0:r.animation;if(!1===o)return[];let l=null==o?void 0:o[i];if(!1===l||!1===a||!1===n)return[];let h=null===(s=t3(t)[e])||void 0===s?void 0:s.animation,c=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return(function(t){if("string"==typeof t){let e=t0(k.ANIMATION,t);return e||(t2.warn("The animation of ".concat(t," is not registered.")),[])}return t})(t).map(t=>({...tX,...(0,tK.Z)(a)&&a,...t,...(0,tK.Z)(n)&&n}))};if(l)return c(l);if(!h)return[];let d=h[i];return!1===d?[]:c(d)}(this.context.options,h,c,t);null==o||null===(n=o.before)||void 0===n||n.call(o);let u=en(l,this.inferStyle(a,i),d);return u?(null==o||null===(s=o.beforeAnimate)||void 0===s||s.call(o,u),u.finished.then(()=>{var t,e;null==o||null===(t=o.afterAnimate)||void 0===t||t.call(o,u),null==o||null===(e=o.after)||void 0===e||e.call(o),this.animations.delete(u)})):null==o||null===(r=o.after)||void 0===r||r.call(o),u}).filter(Boolean);a.forEach(t=>this.animations.add(t));let o=t6(a);return o?(null==e||null===(s=e.beforeAnimate)||void 0===s||s.call(e,o),o.finished.then(()=>{var t,i;null==e||null===(t=e.afterAnimate)||void 0===t||t.call(e,o),null==e||null===(i=e.after)||void 0===i||i.call(e),this.release()})):null==e||null===(r=e.after)||void 0===r||r.call(e),o}inferStyle(t,e){var i;let{element:n,elementType:r,stage:s,originalStyle:a,modifiedStyle:o}=t,l={...a},h={...o},c=()=>null!==(i=r2(n,"opacity"))&&void 0!==i?i:t8("opacity");if("enter"===s)Object.assign(l,{opacity:0});else if("exit"===s)Object.assign(h,{opacity:0});else if("show"===s)Object.assign(l,{opacity:0}),Object.assign(h,{opacity:c()});else if("hide"===s)Object.assign(l,{opacity:c()}),Object.assign(h,{opacity:0});else if("collapse"===s){let{collapse:t}=e||{},{target:i,descendants:s,position:a}=t;if("node"===r){if(s.includes(n.id)){let[t,e,i]=a;Object.assign(h,{x:t,y:e,z:i})}}else if("combo"===r){if(n.id===i||s.includes(n.id)){let[t,e]=a;Object.assign(h,{x:t,y:e,childrenNode:l.childrenNode})}}else"edge"===r&&Object.assign(h,{sourceNode:l.sourceNode,targetNode:l.targetNode})}else if("expand"===s){let{expand:t}=e||{},{target:i,descendants:s,position:a}=t;if("node"===r){if(n.id===i||s.includes(n.id)){let[t,e,i]=a;Object.assign(l,{x:t,y:e,z:i})}}else if("combo"===r){if(n.id===i||s.includes(n.id)){let[t,e,i]=a;Object.assign(l,{x:t,y:e,z:i,childrenNode:h.childrenNode})}}else"edge"===r&&Object.assign(l,{sourceNode:h.sourceNode,targetNode:h.targetNode})}return[l,h]}stop(){this.animations.forEach(t=>t.cancel())}clear(){this.tasks=[]}release(){var t,e;let{canvas:i}=this.context,n=null===(t=i.document)||void 0===t?void 0:null===(e=t.timeline)||void 0===e?void 0:e.animationsWithPromises;n&&(i.document.timeline.animationsWithPromises=n.filter(t=>"finished"!==t.playState))}destroy(){this.stop(),this.animations.clear(),this.tasks=[]}constructor(t){this.tasks=[],this.animations=new Set,this.context=t}}class oE{emit(t){let{graph:e}=this.context;e.emit(t.type,t)}startBatch(){let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];this.batchCount++,1===this.batchCount&&this.emit(new og(M.BATCH_START,{initiate:t}))}endBatch(){this.batchCount--,0===this.batchCount&&this.emit(new og(M.BATCH_END))}get isBatching(){return this.batchCount>0}destroy(){this.context=null}constructor(t){this.batchCount=0,this.context=t}}class ox extends el{setBehaviors(t){this.setExtensions(t)}forwardEvents(){let t=this.context.canvas.getContainer();t&&[C.KEY_DOWN,C.KEY_UP].forEach(e=>{t.addEventListener(e,this.forwardContainerEvents)});let e=this.context.canvas.document;e&&[T.CLICK,T.DBLCLICK,T.POINTER_OVER,T.POINTER_LEAVE,T.POINTER_ENTER,T.POINTER_MOVE,T.POINTER_OUT,T.POINTER_DOWN,T.POINTER_UP,T.CONTEXT_MENU,T.DRAG_START,T.DRAG,T.DRAG_END,T.DRAG_ENTER,T.DRAG_OVER,T.DRAG_LEAVE,T.DROP,T.WHEEL].forEach(t=>{e.addEventListener(t,this.forwardCanvasEvents)})}destroy(){let t=this.context.canvas.getContainer();t&&[C.KEY_DOWN,C.KEY_UP].forEach(e=>{t.removeEventListener(e,this.forwardContainerEvents)}),this.context.canvas.document.removeAllEventListeners(),super.destroy()}constructor(t){super(t),this.currentTarget=null,this.currentTargetType=null,this.category="behavior",this.forwardCanvasEvents=t=>{let{target:e}=t,i=function(t){if(!t)return null;if(t instanceof I.BB)return{type:"canvas",element:t};let e=t;for(;e;){if(rO(e))return{type:"node",element:e};if(rM(e))return{type:"edge",element:e};if(rD(e))return{type:"combo",element:e};e=e.parentElement}return null}(e);if(!i)return;let{graph:n,canvas:r}=this.context,{type:s,element:a}=i;if("destroyed"in a&&(rz(a)||a.destroyed))return;let{type:o,detail:l,button:h}=t,c={...t,target:a,targetType:s,originalTarget:e};o===T.POINTER_MOVE&&(this.currentTarget!==a&&(this.currentTarget&&n.emit("".concat(this.currentTargetType,":").concat(T.POINTER_LEAVE),{...c,type:T.POINTER_LEAVE,target:this.currentTarget}),a&&(Object.assign(c,{type:T.POINTER_ENTER}),n.emit("".concat(s,":").concat(T.POINTER_ENTER),c))),this.currentTarget=a,this.currentTargetType=s),o===T.CLICK&&2===h||(n.emit("".concat(s,":").concat(o),c),n.emit(o,c)),o===T.CLICK&&2===l&&(Object.assign(c,{type:T.DBLCLICK}),n.emit("".concat(s,":").concat(T.DBLCLICK),c),n.emit(T.DBLCLICK,c)),o===T.POINTER_DOWN&&2===h&&(Object.assign(c,{type:T.CONTEXT_MENU,preventDefault:()=>{var t;null===(t=r.getContainer())||void 0===t||t.addEventListener(T.CONTEXT_MENU,t=>t.preventDefault(),{once:!0})}}),n.emit("".concat(s,":").concat(T.CONTEXT_MENU),c),n.emit(T.CONTEXT_MENU,c))},this.forwardContainerEvents=t=>{this.context.graph.emit(t.type,t)},this.forwardEvents(),this.setBehaviors(this.context.options.behaviors||[])}}var ow=i(60788),oS=function(){function t(t){this.dragndropPluginOptions=t}return t.prototype.apply=function(e){var i=this,n=e.renderingService,r=e.renderingContext.root.ownerDocument,s=r.defaultView,a=function(t){var e=t.target,n=e===r,a=n&&i.dragndropPluginOptions.isDocumentDraggable?r:e.closest&&e.closest("[draggable=true]");if(a){var o=!1,l=t.timeStamp,h=[t.clientX,t.clientY],c=null,d=[t.clientX,t.clientY],u=function(t){return(0,_.mG)(i,void 0,void 0,function(){var i,s,u,p,g,f;return(0,_.Jh)(this,function(m){switch(m.label){case 0:if(!o){if(i=t.timeStamp-l,s=(0,ow.y)([t.clientX,t.clientY],h),i<=this.dragndropPluginOptions.dragstartTimeThreshold||s<=this.dragndropPluginOptions.dragstartDistanceThreshold)return[2];t.type="dragstart",a.dispatchEvent(t),o=!0}if(t.type="drag",t.dx=t.clientX-d[0],t.dy=t.clientY-d[1],a.dispatchEvent(t),d=[t.clientX,t.clientY],n)return[3,2];return u="pointer"===this.dragndropPluginOptions.overlap?[t.canvasX,t.canvasY]:e.getBounds().center,[4,r.elementsFromPoint(u[0],u[1])];case 1:c!==(f=(null==(g=(p=m.sent())[p.indexOf(e)+1])?void 0:g.closest("[droppable=true]"))||(this.dragndropPluginOptions.isDocumentDroppable?r:null))&&(c&&(t.type="dragleave",t.target=c,c.dispatchEvent(t)),f&&(t.type="dragenter",t.target=f,f.dispatchEvent(t)),(c=f)&&(t.type="dragover",t.target=c,c.dispatchEvent(t))),m.label=2;case 2:return[2]}})})};s.addEventListener("pointermove",u);var p=function(t){if(o){t.detail={preventClick:!0};var e=t.clone();c&&(e.type="drop",e.target=c,c.dispatchEvent(e)),e.type="dragend",a.dispatchEvent(e),o=!1}s.removeEventListener("pointermove",u)};e.addEventListener("pointerup",p,{once:!0}),e.addEventListener("pointerupoutside",p,{once:!0})}};n.hooks.init.tap(t.tag,function(){s.addEventListener("pointerdown",a)}),n.hooks.destroy.tap(t.tag,function(){s.removeEventListener("pointerdown",a)})},t.tag="Dragndrop",t}(),oT=function(t){function e(e){void 0===e&&(e={});var i=t.call(this)||this;return i.options=e,i.name="dragndrop",i}return(0,_.ZT)(e,t),e.prototype.init=function(){this.addRenderingPlugin(new oS((0,_.pi)({overlap:"pointer",isDocumentDraggable:!1,isDocumentDroppable:!1,dragstartDistanceThreshold:0,dragstartTimeThreshold:0},this.options)))},e.prototype.destroy=function(){this.removeAllRenderingPlugins()},e.prototype.setOptions=function(t){Object.assign(this.plugins[0].dragndropPluginOptions,t)},e}(I.F6),oC=i(45653);let oO=["background","main","label","transient"];class oM{getConfig(){return this.config}getLayer(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"main";return this.extends.layers[t]}getLayers(){return this.extends.layers}getRenderer(t){return this.extends.renderers[t]}getCamera(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"main";return this.getLayer(t).getCamera()}getRoot(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"main";return this.getLayer(t).getRoot()}getContextService(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"main";return this.getLayer(t).getContextService()}setCursor(t){this.config.cursor=t,this.getLayer().setCursor(t)}get document(){return this.getLayer().document}get context(){return this.getLayer().context}get ready(){return Promise.all(Object.entries(this.getLayers()).map(t=>{let[,e]=t;return e.ready}))}resize(t,e){Object.assign(this.extends.config,{width:t,height:e}),Object.values(this.getLayers()).forEach(i=>{let n=i.getCamera(),r=n.getPosition(),s=n.getFocalPoint();i.resize(t,e),n.setPosition(r),n.setFocalPoint(s)})}getBounds(t){return ex(Object.values(this.getLayers()).map(e=>{let i=t?e.getRoot().childNodes.find(e=>e.classList.includes(t)):e.getRoot();return i}).filter(t=>(null==t?void 0:t.childNodes.length)>0).map(t=>t.getBounds()))}getContainer(){let t=this.extends.config.container;return"string"==typeof t?document.getElementById(t):t}getSize(){return[this.extends.config.width||0,this.extends.config.height||0]}appendChild(t,e){var i;let n=(null===(i=t.style)||void 0===i?void 0:i.$layer)||"main";return this.getLayer(n).appendChild(t,e)}setRenderer(t){if(t===this.extends.renderer)return;let e=oD(t);this.extends.renderers=e,Object.entries(e).forEach(t=>{let[e,i]=t;return this.getLayer(e).setRenderer(i)}),oA(this.getLayers())}getCanvasByViewport(t){return eH(this.getLayer().viewport2Canvas(eV(t)))}getViewportByCanvas(t){return eH(this.getLayer().canvas2Viewport(eV(t)))}getViewportByClient(t){return eH(this.getLayer().client2Viewport(eV(t)))}getClientByViewport(t){return eH(this.getLayer().viewport2Client(eV(t)))}getClientByCanvas(t){return this.getClientByViewport(this.getViewportByCanvas(t))}getCanvasByClient(t){let e=this.getLayer(),i=e.client2Viewport(eV(t));return eH(e.viewport2Canvas(i))}async toDataURL(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=window.devicePixelRatio||1,{mode:i="viewport",...n}=t,[r,s,a,o]=[0,0,0,0];if("viewport"===i)[a,o]=this.getSize();else if("overall"===i){let t=this.getBounds(),e=ev(t);[r,s]=t.min,[a,o]=e}let l=(0,oC.L)('<div id="virtual-image"></div>'),h=new I.Xz({width:a,height:o,renderer:new nj,devicePixelRatio:e,container:l,background:this.extends.config.background});await h.ready,h.appendChild(this.getLayer("background").getRoot().cloneNode(!0)),h.appendChild(this.getRoot().cloneNode(!0));let c=this.getLayer("label").getRoot().cloneNode(!0),d=h.viewport2Canvas({x:0,y:0}),u=this.getCanvasByViewport([0,0]);c.translate([u[0]-d.x,u[1]-d.y]),c.scale(1/this.getCamera().getZoom()),h.appendChild(c),h.appendChild(this.getLayer("transient").getRoot().cloneNode(!0));let p=this.getCamera(),g=h.getCamera();if("viewport"===i)g.setZoom(p.getZoom()),g.setPosition(p.getPosition()),g.setFocalPoint(p.getFocalPoint());else if("overall"===i){let[t,e,i]=g.getPosition(),[n,a,o]=g.getFocalPoint();g.setPosition([t+r,e+s,i]),g.setFocalPoint([n+r,a+s,o])}let f=h.getContextService();return new Promise(t=>{h.addEventListener(I.$6.RERENDER,async()=>{await new Promise(t=>setTimeout(t,300));let e=await f.toDataURL(n);t(e)})})}destroy(){Object.values(this.getLayers()).forEach(t=>{let e=t.getCamera();e.cancelLandmarkAnimation(),t.destroy()})}constructor(t){this.config=t;let{renderer:e,background:i,cursor:n,...r}=t,s=oD(e),a=Object.fromEntries(oO.map(t=>{let e=new I.Xz({...r,supportsMutipleCanvasesInOneContainer:!0,renderer:s[t],background:"background"===t?i:void 0});return[t,e]}));oA(a),this.extends={config:t,renderer:e,renderers:s,layers:a}}}function oD(t){return Object.fromEntries(oO.map(e=>{let i=(null==t?void 0:t(e))||new nj;return"main"===e?i.registerPlugin(new oT({isDocumentDraggable:!0,isDocumentDroppable:!0,dragstartDistanceThreshold:10,dragstartTimeThreshold:100})):i.unregisterPlugin(i.getPlugin("dom-interaction")),[e,i]}))}function oA(t){Object.entries(t).forEach(t=>{let[e,i]=t,n=i.getContextService().getDomElement();n.style.position="absolute",n.style.outline="none",n.tabIndex=1,"main"!==e&&(n.style.pointerEvents="none")})}function ok(t,e){let{data:i,style:n,...r}=t,{data:s,style:a,...o}=e,l={...r,...o};return(i||s)&&Object.assign(l,{data:{...i,...s}}),(n||a)&&Object.assign(l,{style:{...n,...a}}),l}function oP(t){let{data:e,style:i,...n}=t;return e&&(n.data={...e}),i&&(n.style={...i}),n}function oR(t){let{id:e=t7(t),style:i,data:n,...r}=t,s={...t,style:{...i},data:{...n}};return"source"in t&&"target"in t?{id:e,data:s,...r}:{id:e,data:s}}function oN(t){return t.data}class oL{pushChange(t){if(this.isTraceless)return;let{type:e}=t;if(e===E.NodeUpdated||e===E.EdgeUpdated||e===E.ComboUpdated){let{value:i,original:n}=t;this.changes.push({value:oP(i),original:oP(n),type:e})}else this.changes.push({value:oP(t.value),type:e})}getChanges(){return this.changes}clearChanges(){this.changes=[]}batch(t){this.batchCount++,this.model.batch(t),this.batchCount--}silence(t){this.isTraceless=!0,t(),this.isTraceless=!1}isCombo(t){return this.comboIds.has(t)||this.latestRemovedComboIds.has(t)}getData(){return{nodes:this.getNodeData(),edges:this.getEdgeData(),combos:this.getComboData()}}getNodeData(t){return this.model.getAllNodes().reduce((e,i)=>{let n=oN(i);return this.isCombo(t7(n))||(void 0===t?e.push(n):t.includes(t7(n))&&e.push(n)),e},[])}getEdgeDatum(t){return oN(this.model.getEdge(t))}getEdgeData(t){return this.model.getAllEdges().reduce((e,i)=>{let n=oN(i);return void 0===t?e.push(n):t.includes(t7(n))&&e.push(n),e},[])}getComboData(t){return this.model.getAllNodes().reduce((e,i)=>{let n=oN(i);return this.isCombo(t7(n))&&(void 0===t?e.push(n):t.includes(t7(n))&&e.push(n)),e},[])}getAncestorsData(t,e){let{model:i}=this;return i.hasNode(t)&&i.hasTreeStructure(e)?i.getAncestors(t,e).map(oN):[]}getDescendantsData(t){let e=this.getElementDataById(t),i=[];return e6(e,t=>{t!==e&&i.push(t)},t=>this.getChildrenData(t7(t)),"TB"),i}getParentData(t,e){let{model:i}=this;if(!e){t2.warn("The hierarchy structure key is not specified");return}if(!i.hasNode(t)||!i.hasTreeStructure(e))return;let n=i.getParent(t,e);return n?oN(n):void 0}getChildrenData(t){let e="node"===this.getElementType(t)?tJ:tq,{model:i}=this;return i.hasNode(t)&&i.hasTreeStructure(e)?i.getChildren(t,e).map(oN):[]}getElementsDataByType(t){return"node"===t?this.getNodeData():"edge"===t?this.getEdgeData():"combo"===t?this.getComboData():[]}getElementDataById(t){let e=this.getElementType(t);return"edge"===e?this.getEdgeDatum(t):this.getNodeLikeDatum(t)}getNodeLikeDatum(t){let e=this.model.getNode(t);return oN(e)}getNodeLikeData(t){return this.model.getAllNodes().reduce((e,i)=>{let n=oN(i);return t?t.includes(t7(n))&&e.push(n):e.push(n),e},[])}getElementDataByState(t,e){let i=this.getElementsDataByType(t);return i.filter(t=>{var i;return null===(i=t.states)||void 0===i?void 0:i.includes(e)})}getElementState(t){var e;return(null===(e=this.getElementDataById(t))||void 0===e?void 0:e.states)||[]}hasNode(t){return this.model.hasNode(t)&&!this.isCombo(t)}hasEdge(t){return this.model.hasEdge(t)}hasCombo(t){return this.model.hasNode(t)&&this.isCombo(t)}getRelatedEdgesData(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"both";return this.model.getRelatedEdges(t,e).map(oN)}getNeighborNodesData(t){return this.model.getNeighbors(t).map(oN)}setData(t){let{nodes:e=[],edges:i=[],combos:n=[]}=t,{nodes:r,edges:s,combos:a}=this.getData(),o=eo(r,e,t=>t7(t)),l=eo(s,i,t=>t7(t)),h=eo(a,n,t=>t7(t));this.batch(()=>{this.addData({nodes:o.enter,edges:l.enter,combos:h.enter}),this.updateData({nodes:o.update,edges:l.update,combos:h.update}),this.removeData({nodes:o.exit.map(t7),edges:l.exit.map(t7),combos:h.exit.map(t7)})})}addData(t){let{nodes:e,edges:i,combos:n}=t;this.batch(()=>{this.addComboData(n),this.addNodeData(e),this.addEdgeData(i)})}addNodeData(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.length&&(this.model.addNodes(t.map(t=>(this.pushChange({value:t,type:E.NodeAdded}),oR(t)))),this.updateNodeLikeHierarchy(t))}addEdgeData(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.length&&this.model.addEdges(t.map(t=>(this.pushChange({value:t,type:E.EdgeAdded}),oR(t))))}addComboData(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!t.length)return;let{model:e}=this;e.hasTreeStructure(tq)||e.attachTreeStructure(tq),e.addNodes(t.map(t=>(this.comboIds.add(t7(t)),this.pushChange({value:t,type:E.ComboAdded}),oR(t)))),this.updateNodeLikeHierarchy(t)}addChildrenData(t,e){let i=this.getNodeLikeDatum(t),n=e.map(t7);this.addNodeData(e),this.updateNodeData([{id:t,children:[...i.children||[],...n]}]),this.addEdgeData(n.map(e=>({source:t,target:e})))}updateNodeLikeHierarchy(t){if(!this.enableUpdateNodeLikeHierarchy)return;let{model:e}=this;t.forEach(t=>{let i=t7(t);e.attachTreeStructure(tq),this.setParent(i,t.combo,tq);let n=t.children;if(void 0!==n){e.attachTreeStructure(tJ);let t=n.filter(t=>e.hasNode(t));t.forEach(t=>this.setParent(t,i,tJ)),t.length!==n.length&&this.updateNodeData([{id:i,children:t}])}})}preventUpdateNodeLikeHierarchy(t){this.enableUpdateNodeLikeHierarchy=!1,t(),this.enableUpdateNodeLikeHierarchy=!0}updateData(t){let{nodes:e,edges:i,combos:n}=t;this.batch(()=>{this.updateNodeData(e),this.updateComboData(n),this.updateEdgeData(i)})}updateNodeData(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!t.length)return;let{model:e}=this;this.batch(()=>{let i=[];t.forEach(t=>{let n=t7(t),r=oN(e.getNode(n));if((0,tU.Z)(r,t))return;let s=ok(r,t);this.pushChange({value:s,original:r,type:E.NodeUpdated}),e.mergeNodeData(n,s),i.push(s)}),this.updateNodeLikeHierarchy(i)})}refreshData(){let{nodes:t,edges:e,combos:i}=this.getData();t.forEach(t=>{this.pushChange({value:t,original:t,type:E.NodeUpdated})}),e.forEach(t=>{this.pushChange({value:t,original:t,type:E.EdgeUpdated})}),i.forEach(t=>{this.pushChange({value:t,original:t,type:E.ComboUpdated})})}syncNodeDatum(t){let{model:e}=this,i=t7(t),n=oN(e.getNode(i)),r=ok(n,t);e.mergeNodeData(i,r)}updateEdgeData(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!t.length)return;let{model:e}=this;this.batch(()=>{t.forEach(t=>{let i=t7(t),n=oN(e.getEdge(i));if((0,tU.Z)(n,t))return;t.source&&n.source!==t.source&&e.updateEdgeSource(i,t.source),t.target&&n.target!==t.target&&e.updateEdgeTarget(i,t.target);let r=ok(n,t);this.pushChange({value:r,original:n,type:E.EdgeUpdated}),e.mergeEdgeData(i,r)})})}updateComboData(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!t.length)return;let{model:e}=this;e.batch(()=>{let i=[];t.forEach(t=>{let n=t7(t),r=oN(e.getNode(n));if((0,tU.Z)(r,t))return;let s=ok(r,t);this.pushChange({value:s,original:r,type:E.ComboUpdated}),e.mergeNodeData(n,s),i.push(s)}),this.updateNodeLikeHierarchy(i)})}setParent(t,e,i){let n=!(arguments.length>3)||void 0===arguments[3]||arguments[3];if(t===e)return;let r=this.getNodeLikeDatum(t).combo;if(r!==e&&i===tq){let i={id:t,combo:e};this.isCombo(t)?this.syncComboDatum(i):this.syncNodeDatum(i)}this.model.setParent(t,e,i),n&&i===tq&&(function(t,e){void 0===e&&(e=new Map);var i=[];if(Array.isArray(t))for(var n=0,r=t.length;n<r;n++){var s=t[n];e.has(s)||(i.push(s),e.set(s,!0))}return i})([r,e]).forEach(t=>{void 0!==t&&this.refreshComboData(t)})}refreshComboData(t){let e=this.getComboData([t])[0],i=this.getAncestorsData(t,tq);e&&this.pushChange({value:e,original:e,type:E.ComboUpdated}),i.forEach(t=>{this.pushChange({value:t,original:t,type:E.ComboUpdated})})}syncComboDatum(t){let{model:e}=this,i=t7(t);if(!e.hasNode(i))return;let n=oN(e.getNode(i)),r=ok(n,t);e.mergeNodeData(i,r)}getElementPosition(t){let e=this.getElementDataById(t);return eW(e)}translateNodeLikeBy(t,e){this.isCombo(t)?this.translateComboBy(t,e):this.translateNodeBy(t,e)}translateNodeLikeTo(t,e){this.isCombo(t)?this.translateComboTo(t,e):this.translateNodeTo(t,e)}translateNodeBy(t,e){let i=this.getElementPosition(t),n=eM(i,[...e,0].slice(0,3));this.translateNodeTo(t,n)}translateNodeTo(t,e){let[i=0,n=0,r=0]=e;this.preventUpdateNodeLikeHierarchy(()=>{this.updateNodeData([{id:t,style:{x:i,y:n,z:r}}])})}translateComboBy(t,e){let[i=0,n=0,r=0]=e;if([i,n,r].some(isNaN)||[i,n,r].every(t=>0===t))return;let s=this.getComboData([t])[0];s&&e6(s,t=>{let e=t7(t),[s,a,o]=eW(t),l=ok(t,{style:{x:s+i,y:a+n,z:o+r}});this.pushChange({value:l,original:t,type:this.isCombo(e)?E.ComboUpdated:E.NodeUpdated}),this.model.mergeNodeData(e,l)},t=>this.getChildrenData(t7(t)),"BT")}translateComboTo(t,e){var i;if(e.some(isNaN))return;let[n=0,r=0,s=0]=e,a=null===(i=this.getComboData([t]))||void 0===i?void 0:i[0];if(!a)return;let[o,l,h]=eW(a),c=n-o,d=r-l,u=s-h;e6(a,t=>{let e=t7(t),[i,n,r]=eW(t),s=ok(t,{style:{x:i+c,y:n+d,z:r+u}});this.pushChange({value:s,original:t,type:this.isCombo(e)?E.ComboUpdated:E.NodeUpdated}),this.model.mergeNodeData(e,s)},t=>this.getChildrenData(t7(t)),"BT")}removeData(t){let{nodes:e,edges:i,combos:n}=t;this.batch(()=>{this.removeEdgeData(i),this.removeNodeData(e),this.removeComboData(n),this.latestRemovedComboIds=new Set(n)})}removeNodeData(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.length&&this.batch(()=>{t.forEach(t=>{this.removeEdgeData(this.getRelatedEdgesData(t).map(t7)),this.pushChange({value:this.getNodeData([t])[0],type:E.NodeRemoved}),this.removeNodeLikeHierarchy(t)}),this.model.removeNodes(t)})}removeEdgeData(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.length&&(t.forEach(t=>this.pushChange({value:this.getEdgeData([t])[0],type:E.EdgeRemoved})),this.model.removeEdges(t))}removeComboData(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.length&&this.batch(()=>{t.forEach(t=>{this.pushChange({value:this.getComboData([t])[0],type:E.ComboRemoved}),this.removeNodeLikeHierarchy(t),this.comboIds.delete(t)}),this.model.removeNodes(t)})}removeNodeLikeHierarchy(t){if(this.model.hasTreeStructure(tq)){let e=this.getNodeLikeDatum(t).combo;this.setParent(t,void 0,tq,!1),this.model.getChildren(t,tq).forEach(t=>{let i=oN(t),n=t7(i);this.setParent(t7(i),e,tq,!1);let r=ok(i,{id:t7(i),combo:e});this.pushChange({value:r,original:i,type:this.isCombo(n)?E.ComboUpdated:E.NodeUpdated}),this.model.mergeNodeData(t7(i),r)}),(0,nZ.Z)(e)||this.refreshComboData(e)}}getElementType(t){if(this.model.hasNode(t))return this.isCombo(t)?"combo":"node";if(this.model.hasEdge(t))return"edge";throw Error(t1("Unknown element type of id: ".concat(t)))}destroy(){let{model:t}=this,e=t.getAllNodes(),i=t.getAllEdges();t.removeEdges(i.map(t=>t.id)),t.removeNodes(e.map(t=>t.id)),this.context={}}constructor(){this.latestRemovedComboIds=new Set,this.comboIds=new Set,this.changes=[],this.batchCount=0,this.isTraceless=!1,this.enableUpdateNodeLikeHierarchy=!0,this.model=new rK.k}}class oI{init(){if(!this.container){let{canvas:t}=this.context;this.container=t.appendChild(new I.ZA({className:"elements"}))}}emit(t,e){e.silence||ov(this.context.graph,t)}forEachElementData(t){e3.forEach(e=>{let i=this.context.model.getElementsDataByType(e);t(e,i)})}getElementType(t,e){var i;let{options:n,graph:r}=this.context,s=(null===(i=n[t])||void 0===i?void 0:i.type)||e.type;return s?"string"==typeof s?s:s.call(r,e):"edge"===t?"line":"circle"}getTheme(t){return t3(this.context.options)[t]||{}}getThemeStyle(t){return this.getTheme(t).style||{}}getThemeStateStyle(t,e){let{state:i={}}=this.getTheme(t);return Object.assign({},...e.map(t=>i[t]||{}))}computePaletteStyle(){let{options:t}=this.context;this.paletteStyle={},this.forEachElementData((e,i)=>{var n,r;let s=Object.assign({},iv(null===(n=this.getTheme(e))||void 0===n?void 0:n.palette),iv(null===(r=t[e])||void 0===r?void 0:r.palette));(null==s?void 0:s.field)&&Object.assign(this.paletteStyle,function(t,e){if(!e)return{};let{type:i,color:n,field:r,invert:s}=e,a=t=>{let e="string"==typeof n?t0("palette",n):n;if("function"==typeof e){let i={};return t.forEach(t=>{let[n,r]=t;i[n]=e(s?1-r:r)}),i}if(Array.isArray(e)){let i=s?[...e].reverse():e,n={};return t.forEach(t=>{let[r,s]=t;n[r]=i[s%e.length]}),n}return{}},o=(t,e)=>{var i;return"string"==typeof t?null===(i=e.data)||void 0===i?void 0:i[t]:null==t?void 0:t(e)};if("group"===i){let e=iy(t,t=>{if(!r)return"default";let e=o(r,t);return e?String(e):"default"}),i=Object.keys(e),n=a(i.map((t,e)=>[t,e])),s={};return Object.entries(e).forEach(t=>{let[e,i]=t;i.forEach(t=>{s[t7(t)]=n[e]})}),s}if("value"===i){let[e,i]=t.reduce((t,e)=>{let[i,n]=t,s=o(r,e);if("number"!=typeof s)throw Error(t1("Palette field ".concat(r," is not a number")));return[Math.min(i,s),Math.max(n,s)]},[1/0,-1/0]),n=i-e;return a(t.map(t=>[t.id,(o(r,t)-e)/n]))}}(i,s))})}getPaletteStyle(t,e){let i=this.paletteStyle[e];return i?"edge"===t?{stroke:i}:{fill:i}:{}}computeElementDefaultStyle(t,e){var i;let{options:n}=this.context,r=(null===(i=n[t])||void 0===i?void 0:i.style)||{};this.defaultStyle[t7(e.datum)]=ih(r,e)}computeElementsDefaultStyle(t){let{graph:e}=this.context;this.forEachElementData((i,n)=>{let r=n.length;for(let s=0;s<r;s++){let r=n[s];(void 0===t||t.includes(t7(r)))&&this.computeElementDefaultStyle(i,{datum:r,graph:e})}})}getDefaultStyle(t){return this.defaultStyle[t]||{}}getElementState(t){try{let{model:e}=this.context;return e.getElementState(t)}catch(t){return[]}}getElementStateStyle(t,e,i){var n,r;let{options:s}=this.context,a=(null===(n=s[t])||void 0===n?void 0:null===(r=n.state)||void 0===r?void 0:r[e])||{};return ih(a,i)}computeElementStatesStyle(t,e,i){this.stateStyle[t7(i.datum)]=Object.assign({},...e.map(e=>this.getElementStateStyle(t,e,i)))}computeElementsStatesStyle(t){let{graph:e}=this.context;this.forEachElementData((i,n)=>{let r=n.length;for(let s=0;s<r;s++){let r=n[s];if(void 0===t||t.includes(t7(r))){let t=this.getElementState(t7(r));this.computeElementStatesStyle(i,t,{datum:r,graph:e})}}})}getStateStyle(t){return this.stateStyle[t]||{}}computeStyle(t,e){t&&["translate","zIndex"].includes(t)||(this.computePaletteStyle(),this.computeElementsDefaultStyle(e),this.computeElementsStatesStyle(e))}getElement(t){return this.elementMap[t]}getElementZIndex(t){var e;let i=this.getElement(t);return i&&null!==(e=i.style.zIndex)&&void 0!==e?e:0}getNodes(){return this.context.model.getNodeData().map(t=>{let{id:e}=t;return this.elementMap[e]})}getEdges(){return this.context.model.getEdgeData().map(t=>this.elementMap[t7(t)])}getCombos(){return this.context.model.getComboData().map(t=>{let{id:e}=t;return this.elementMap[e]})}getElementComputedStyle(t,e){let i=t7(e),n=this.getThemeStyle(t),r=this.getPaletteStyle(t,i),s=e.style||{},a=this.getDefaultStyle(i),o=this.getThemeStateStyle(t,this.getElementState(i)),l=this.getStateStyle(i),h=Object.assign({},n,r,s,a,o,l);if("combo"===t){let t=this.context.model.getChildrenData(i),e=!!h.collapsed,n=e?[]:t.map(t7).filter(t=>this.getElement(t));Object.assign(h,{childrenNode:n,childrenData:t})}return h}draw(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{animation:!0};this.init();let e=this.computeChangesAndDrawData(t);if(!e)return null;let{dataChanges:i,drawData:n}=e;this.markDestroyElement(n),this.computeStyle(t.stage);let{add:r,update:s,remove:a}=n;this.destroyElements(a,t),this.createElements(r,t),this.updateElements(s,t);let{animation:o,silence:l}=t,{type:h="draw"}=t,c="render"===h;return this.context.animation.animate(o,l?{}:{before:()=>this.emit(new og(M.BEFORE_DRAW,{dataChanges:i,animation:o,render:c}),t),beforeAnimate:e=>this.emit(new of(M.BEFORE_ANIMATE,x.DRAW,e,n),t),afterAnimate:e=>this.emit(new of(M.AFTER_ANIMATE,x.DRAW,e,n),t),after:()=>this.emit(new og(M.AFTER_DRAW,{dataChanges:i,animation:o,render:c}),t)})}computeChangesAndDrawData(t){let{model:e}=this.context,i=e.getChanges(),n=s3(i);if(0===n.length)return null;let{NodeAdded:r=[],NodeUpdated:s=[],NodeRemoved:a=[],EdgeAdded:o=[],EdgeUpdated:l=[],EdgeRemoved:h=[],ComboAdded:c=[],ComboUpdated:d=[],ComboRemoved:u=[]}=iy(n,t=>t.type),p=t=>new Map(t.map(t=>{let e=t.value;return[t7(e),e]})),g={add:{nodes:p(r),edges:p(o),combos:p(c)},update:{nodes:p(s),edges:p(l),combos:p(d)},remove:{nodes:p(a),edges:p(h),combos:p(u)}},f=this.transformData(g,t);return e.clearChanges(),{dataChanges:i,drawData:f}}transformData(t,e){let i=this.context.transform.getTransformInstance();return Object.values(i).reduce((t,i)=>i.beforeDraw(t,e),t)}createElement(t,e,i){var n,r;let s=t7(e),a=this.getElement(s);if(a)return;let o=this.getElementType(t,e),l=this.getElementComputedStyle(t,e),h=t0(t,o);if(!h)return t2.warn("The element ".concat(o," of ").concat(t," is not registered."));if(this.emit(new om(M.BEFORE_ELEMENT_CREATE,t,e),i),"expand"===i.stage){let t=this.getElementZIndex(i.target);(!l.zIndex||l.zIndex<t)&&(l.zIndex=t+(null!==(r=l.zIndex)&&void 0!==r?r:0))}let c=this.container.appendChild(new h({id:s,style:{context:this.context,...l}}));this.shapeTypeMap[s]=o,this.elementMap[s]=c;let{stage:d="enter"}=i;null===(n=this.context.animation)||void 0===n||n.add({element:c,elementType:t,stage:d,originalStyle:{...c.attributes},modifiedStyle:{...c.attributes,...l}},{after:()=>{var n;this.emit(new om(M.AFTER_ELEMENT_CREATE,t,e),i),null===(n=c.onCreate)||void 0===n||n.call(c)}})}createElements(t,e){let{nodes:i,edges:n,combos:r}=t;[["node",i],["combo",r],["edge",n]].forEach(t=>{let[i,n]=t;n.forEach(t=>this.createElement(i,t,e))})}updateElement(t,e,i){var n;let r=t7(e),s=this.getElement(r);if(!s)return()=>null;this.emit(new om(M.BEFORE_ELEMENT_UPDATE,t,e),i);let a=this.getElementType(t,e),o=this.getElementComputedStyle(t,e);this.shapeTypeMap[r]!==a&&(s.destroy(),delete this.shapeTypeMap[r],delete this.elementMap[r],this.createElement(t,e,{animation:!1,silence:!0}));let{stage:l="update"}=i,h="visibility"!==l?l:"hidden"===o.visibility?"hide":"show";"hide"===h&&delete o.visibility,null===(n=this.context.animation)||void 0===n||n.add({element:s,elementType:t,stage:h,originalStyle:{...s.attributes},modifiedStyle:{...s.attributes,...o}},{before:()=>{let t=this.elementMap[r];"collapse"!==l&&rj(t,o),"visibility"===l&&(r3(t,"opacity")||r1(t,"opacity"),this.visibilityCache.set(t,"show"===h?"visible":"hidden"),"show"===h&&iS(t,"visible"))},after:()=>{var n;let s=this.elementMap[r];"collapse"===l&&rj(s,o),"hide"===h&&iS(s,this.visibilityCache.get(s)),this.emit(new om(M.AFTER_ELEMENT_UPDATE,t,e),i),null===(n=s.onUpdate)||void 0===n||n.call(s)}})}updateElements(t,e){let{nodes:i,edges:n,combos:r}=t;[["node",i],["combo",r],["edge",n]].forEach(t=>{let[i,n]=t;n.forEach(t=>this.updateElement(i,t,e))})}markDestroyElement(t){Object.values(t.remove).forEach(t=>{t.forEach(t=>{let e=t7(t),i=this.getElement(e);i&&(0,ie.Z)(i,"__to_be_destroyed__",!0)})})}destroyElement(t,e,i){var n;let{stage:r="exit"}=i,s=t7(e),a=this.elementMap[s];if(!a)return()=>null;this.emit(new om(M.BEFORE_ELEMENT_DESTROY,t,e),i),null===(n=this.context.animation)||void 0===n||n.add({element:a,elementType:t,stage:r,originalStyle:{...a.attributes},modifiedStyle:{...a.attributes}},{after:()=>{var n;this.clearElement(s),a.destroy(),null===(n=a.onDestroy)||void 0===n||n.call(a),this.emit(new om(M.AFTER_ELEMENT_DESTROY,t,e),i)}})}destroyElements(t,e){let{nodes:i,edges:n,combos:r}=t;[["combo",r],["edge",n],["node",i]].forEach(t=>{let[i,n]=t;n.forEach(t=>this.destroyElement(i,t,e))})}clearElement(t){delete this.paletteStyle[t],delete this.defaultStyle[t],delete this.stateStyle[t],delete this.elementMap[t],delete this.shapeTypeMap[t]}async collapseNode(t,e){var i;let{model:n,layout:r}=this.context,s=this.computeChangesAndDrawData({stage:"collapse",animation:e});if(!s)return;this.markDestroyElement(s.drawData);let a=await r.simulate();n.updateData(a);let o=this.computeChangesAndDrawData({stage:"collapse",animation:e});if(!o)return;let{drawData:l}=o,{add:h,remove:c,update:d}=l;this.markDestroyElement(l);let u={animation:e,stage:"collapse",data:l};this.destroyElements(c,u),this.createElements(h,u),this.updateElements(d,u),await (null===(i=this.context.animation.animate(e,{beforeAnimate:t=>this.emit(new of(M.BEFORE_ANIMATE,x.COLLAPSE,t,l),u),afterAnimate:t=>this.emit(new of(M.AFTER_ANIMATE,x.COLLAPSE,t,l),u)},{collapse:{target:t,descendants:Array.from(c.nodes).map(t=>{let[,e]=t;return t7(e)}),position:eW(d.nodes.get(t))}}))||void 0===i?void 0:i.finished)}async expandNode(t,e){var i;let{model:n,layout:r}=this.context;if(!n.getAncestorsData(t,tq).every(t=>e7(t)))return;let s=eW(n.getNodeData([t])[0]),a=this.computeChangesAndDrawData({stage:"expand",animation:e});if(!a)return;let{drawData:{add:o}}=a;this.createElements(o,{animation:!1,stage:"expand",target:t}),this.context.animation.clear();let l=await r.simulate();n.updateData(l),this.computeStyle("expand");let h=this.computeChangesAndDrawData({stage:"collapse",animation:e});if(!h)return;let{drawData:c}=h,{update:d}=c,u={animation:e,stage:"expand",data:c};o.edges.forEach(t=>{let e=t7(t);d.edges.has(e)||d.edges.set(e,t)}),this.updateElements(d,u),await (null===(i=this.context.animation.animate(e,{beforeAnimate:t=>this.emit(new of(M.BEFORE_ANIMATE,x.EXPAND,t,c),u),afterAnimate:t=>this.emit(new of(M.AFTER_ANIMATE,x.EXPAND,t,c),u)},{expand:{target:t,descendants:Array.from(o.nodes).map(t=>{let[,e]=t;return t7(e)}),position:s}}))||void 0===i?void 0:i.finished)}async collapseCombo(t,e){var i;let{model:n,element:r}=this.context;if(n.getAncestorsData(t,tq).some(t=>e7(t)))return;let s=r.getElement(t),a=s.getComboPosition({...s.attributes,collapsed:!0}),o=this.computeChangesAndDrawData({stage:"collapse",animation:e});if(!o)return;let{dataChanges:l,drawData:h}=o;this.markDestroyElement(h);let{update:c,remove:d}=h,u={animation:e,stage:"collapse",data:h};this.destroyElements(d,u),this.updateElements(c,u);let p=t=>Array.from(t).map(t=>{let[,e]=t;return t7(e)});await (null===(i=this.context.animation.animate(e,{before:()=>this.emit(new og(M.BEFORE_DRAW,{dataChanges:l,animation:e}),u),beforeAnimate:t=>this.emit(new of(M.BEFORE_ANIMATE,x.COLLAPSE,t,h),u),afterAnimate:t=>this.emit(new of(M.AFTER_ANIMATE,x.COLLAPSE,t,h),u),after:()=>this.emit(new og(M.AFTER_DRAW,{dataChanges:l,animation:e}),u)},{collapse:{target:t,descendants:[...p(d.nodes),...p(d.combos)],position:a}}))||void 0===i?void 0:i.finished)}async expandCombo(t,e){var i;let{model:n}=this.context,r=eW(n.getComboData([t])[0]);this.computeStyle("expand");let s=this.computeChangesAndDrawData({stage:"expand",animation:e});if(!s)return;let{dataChanges:a,drawData:o}=s,{add:l,update:h}=o,c={animation:e,stage:"expand",data:o,target:t};this.createElements(l,c),this.updateElements(h,c);let d=t=>Array.from(t).map(t=>{let[,e]=t;return t7(e)});await (null===(i=this.context.animation.animate(e,{before:()=>this.emit(new og(M.BEFORE_DRAW,{dataChanges:a,animation:e}),c),beforeAnimate:t=>this.emit(new of(M.BEFORE_ANIMATE,x.EXPAND,t,o),c),afterAnimate:t=>this.emit(new of(M.AFTER_ANIMATE,x.EXPAND,t,o),c),after:()=>this.emit(new og(M.AFTER_DRAW,{dataChanges:a,animation:e}),c)},{expand:{target:t,descendants:[...d(l.nodes),...d(l.combos)],position:r}}))||void 0===i?void 0:i.finished)}getFrontZIndex(t){let{model:e}=this.context,i=e.getElementType(t),n=e.getElementDataById(t),r=e.getData();if(Object.assign(r,{["".concat(i,"s")]:r["".concat(i,"s")].filter(e=>t7(e)!==t)}),"combo"===i&&!e7(n)){let i=e.getAncestorsData(t,tq).map(t7);r.nodes=r.nodes.filter(t=>!i.includes(t7(t))),r.combos=r.combos.filter(t=>!i.includes(t7(t))),r.edges=r.edges.filter(t=>{let{source:e,target:n}=t;return i.includes(e)&&i.includes(n)})}return Math.max(0,...Object.values(r).flat().map(t=>{let e=t7(t);return this.getElementZIndex(e)}))+1}destroy(){this.container.destroy(),this.elementMap={},this.shapeTypeMap={},this.defaultStyle={},this.stateStyle={},this.paletteStyle={},this.context={}}constructor(t){this.elementMap={},this.shapeTypeMap={},this.paletteStyle={},this.defaultStyle={},this.stateStyle={},this.visibilityCache=new WeakMap,this.context=t}}var o_=i(19512);class oB extends s2.Z{constructor(t,e,i){super(),this.graph=t,this.layout=e,this.options=i,this.spawnWorker()}spawnWorker(){this.proxy=o_.Ud(new Worker(i.tu(new URL(i.p+i.u(8467),i.b)),{type:void 0})),this.running&&(this.running=!1,this.execute())}execute(){var t;return(0,_.mG)(this,void 0,void 0,function*(){if(this.running)return this;this.running=!0;let e=this.layout.options,{onTick:i}=e,n=(0,_._T)(e,["onTick"]),r={};Object.keys(n).forEach(t=>{(0,ed.Z)(n[t])||(r[t]=n[t])});let s={layout:{id:this.layout.id,options:r,iterations:null===(t=this.options)||void 0===t?void 0:t.iterations},nodes:this.graph.getAllNodes(),edges:this.graph.getAllEdges()},a=new Float32Array([0]),[o]=yield this.proxy.calculateLayout(s,[a]);return o})}stop(){return this.running=!1,this.proxy.stopLayout(),this}kill(){this.proxy[o_.Yy]()}isRunning(){return this.running}}var oF=i(28608);class oj{get presetOptions(){return{animation:!!t9(this.context.options,!0)}}get options(){let{options:t}=this.context;return t.layout}getLayoutInstance(){return this.instances}async layout(){if(!this.options)return;let t=Array.isArray(this.options)?this.options:[this.options],{graph:e}=this.context;for(let i of(ov(e,new og(M.BEFORE_LAYOUT)),t)){let n=t.indexOf(i),r=this.getLayoutData(i),s={...this.presetOptions,...i};ov(e,new og(M.BEFORE_STAGE_LAYOUT,{options:s,index:n}));let a=await this.stepLayout(r,s,n);ov(e,new og(M.AFTER_STAGE_LAYOUT,{options:s,index:n})),i.animation||this.updateElementPosition(a,!1)}ov(e,new og(M.AFTER_LAYOUT))}async simulate(){if(!this.options)return{};let t=Array.isArray(this.options)?this.options:[this.options],e={};for(let i of t){let n=t.indexOf(i),r=this.getLayoutData(i),s=await this.stepLayout(r,{...this.presetOptions,...i,animation:!1},n);e=s}return e}async stepLayout(t,e,i){return!function(t){let{type:e}=t;return["compact-box","mindmap","dendrogram","indented"].includes(e)}(e)?await this.graphLayout(t,e,i):await this.treeLayout(t,e,i)}async graphLayout(t,e,i){let{animation:n,enableWorker:r,iterations:s=300}=e,a=this.initGraphLayout(e);if(!a)return{};if(this.instances[i]=a,this.instance=a,r)return this.supervisor=new oB(a.graphData2LayoutModel(t),a.instance,{iterations:s}),rX(await this.supervisor.execute());if((0,oF.h)(a))return n?await a.execute(t,{onTick:t=>{this.updateElementPosition(t,!1)}}):(a.execute(t),a.stop(),a.tick(s));let o=await a.execute(t);return n&&this.updateElementPosition(o,n),o}async treeLayout(t,e,i){let{type:n,animation:r}=e,s=t0("layout",n);if(!s)return{};let{nodes:a=[],edges:o=[]}=t,l=new rK.k({nodes:a.map(t=>({id:t7(t),data:t.data||{}})),edges:o.map(t=>({id:t7(t),source:t.source,target:t.target,data:t.data||{}}))});!function(t){if(t.hasTreeStructure(tJ))return;t.attachTreeStructure(tJ);let e=t.getAllEdges();for(let i of e){let{source:e,target:n}=i;t.setParent(n,e,tJ)}}(l);let h={nodes:[],edges:[]},c={nodes:[],edges:[]},d=l.getRoots(tJ);d.forEach(t=>{e6(t,t=>{t.children=l.getSuccessors(t.id)},t=>l.getSuccessors(t.id),"TB");let i=s(t,e),{x:n,y:r,z:a=0}=i;e6(i,t=>{let{id:e,x:i,y:s,z:o=0}=t;h.nodes.push({id:e,style:{x:n,y:r,z:a}}),c.nodes.push({id:e,style:{x:i,y:s,z:o}})},t=>t.children,"TB")});let u=this.inferTreeLayoutOffset(c);return oz(c,u),r&&(oz(h,u),this.updateElementPosition(h,!1),this.updateElementPosition(c,r)),c}inferTreeLayoutOffset(t){var e;let[i,n]=[1/0,-1/0],[r,s]=[1/0,-1/0];null===(e=t.nodes)||void 0===e||e.forEach(t=>{let{x:e=0,y:a=0}=t.style||{};i=Math.min(i,e),n=Math.max(n,e),r=Math.min(r,a),s=Math.max(s,a)});let{canvas:a}=this.context,o=a.getSize(),[l,h]=a.getCanvasByViewport([0,0]),[c,d]=a.getCanvasByViewport(o);return i>=l&&n<=c&&r>=h&&s<=d?[0,0]:[(l+c)/2-(i+n)/2,(h+d)/2-(r+s)/2]}stopLayout(){this.instance&&(0,oF.h)(this.instance)&&(this.instance.stop(),this.instance=void 0),this.supervisor&&(this.supervisor.stop(),this.supervisor=void 0),this.animationResult&&(this.animationResult.finish(),this.animationResult=void 0)}getLayoutData(t){let{nodeFilter:e=()=>!0}=t,{nodes:i,edges:n,combos:r}=this.context.model.getData(),s=t=>this.context.element.getElement(t),a=i.filter(t=>{let i=t7(t),n=s(i);return!(!n||rz(n))&&e(t)}),o=new Map(a.map(t=>[t7(t),t])),l=n.filter(t=>{let{source:e,target:i}=t;return!!(o.has(e)&&o.has(i))});return{nodes:a,edges:l,combos:r}}initGraphLayout(t){var e,i;let{element:n,viewport:r}=this.context,{type:s,enableWorker:a,animation:o,iterations:l,...h}=t,[c,d]=r.getCanvasSize(),u=[c/2,d/2],p=null!==(e=null==t?void 0:t.nodeSize)&&void 0!==e?e:t=>{let e=null==n?void 0:n.getElement(t.id),{size:i}=(null==e?void 0:e.attributes)||{};return Math.max(...il(i))},g=t0("layout",s);if(!g)return t2.warn("The layout of ".concat(s," is not registered."));let f=Object.getPrototypeOf(g.prototype)===r$.prototype?g:(i=this.context,class extends r${async execute(t,e){return rX(await this.instance.execute(this.graphData2LayoutModel(t),this.transformOptions((0,t5.Z)({},this.options,e))))}transformOptions(t){let{onTick:e}=t;return e&&(t.onTick=t=>e(rX(t))),t}graphData2LayoutModel(t){let{nodes:e=[],edges:n=[],combos:r=[]}=t,s=e.map(t=>{let e=t7(t),{data:i,style:n,combo:r}=t,s={id:e,data:{...i,...r?{parentId:r}:{}},style:{...n}};return(null==n?void 0:n.x)&&Object.assign(s.data,{x:n.x}),(null==n?void 0:n.y)&&Object.assign(s.data,{y:n.y}),(null==n?void 0:n.z)&&Object.assign(s.data,{z:n.z}),s}),a=new Map(s.map(t=>[t.id,t])),o=n.filter(t=>{let{source:e,target:i}=t;return a.has(e)&&a.has(i)}).map(t=>{let{source:e,target:i,data:n,style:r}=t;return{id:t7(t),source:e,target:i,data:{...n},style:{...r}}}),l=r.map(t=>({id:t7(t),data:{_isCombo:!0,...t.data},style:{...t.style}})),h=new rK.k({nodes:[...s,...l],edges:o});return i.model.model.hasTreeStructure(tq)&&(h.attachTreeStructure(tq),s.forEach(t=>{let e=i.model.model.getParent(t.id,tq);e&&h.hasNode(e.id)&&h.setParent(t.id,e.id,tq)})),h}constructor(t,e){if(super(t,e),this.instance=new g({}),this.id=this.instance.id,"stop"in this.instance&&"tick"in this.instance){let t=this.instance;this.stop=t.stop.bind(t),this.tick=e=>{let i=t.tick(e);return rX(i)}}}}),m=new f(this.context),y={nodeSize:p,width:c,height:d,center:u};switch(m.id){case"d3-force":case"d3-force-3d":Object.assign(y,{center:{x:c/2,y:d/2,z:0}})}return(0,t5.Z)(m.options,y,h),m}updateElementPosition(t,e){let{model:i,element:n}=this.context;return n?(i.updateData(t),n.draw({animation:e,silence:!0})):null}destroy(){var t;this.stopLayout(),this.context={},null===(t=this.supervisor)||void 0===t||t.kill(),this.supervisor=void 0,this.instance=void 0,this.instances=[],this.animationResult=void 0}constructor(t){this.instances=[],this.context=t}}let oz=(t,e)=>{var i;let[n,r]=e;null===(i=t.nodes)||void 0===i||i.forEach(t=>{if(t.style){let{x:e=0,y:i=0}=t.style;t.style.x=e+n,t.style.y=i+r}else t.style={x:n,y:r}})};class oZ extends el{setPlugins(t){this.setExtensions(t)}getPluginInstance(t){let e=this.extensionMap[t];if(e)return e;t2.warn("Cannot find the plugin ".concat(t,", will try to find it by type."));let i=this.extensions.find(e=>e.type===t);if(i)return this.extensionMap[i.key]}constructor(t){super(t),this.category="plugin",this.setPlugins(this.context.options.plugins||[])}}let oW=["update-related-edges","collapse-expand-node","collapse-expand-combo","get-edge-actual-ends","arrange-draw-order"];class oG extends el{getTransforms(){}setTransforms(t){this.setExtensions([...oW.slice(0,oW.length-1),...t,oW[oW.length-1]])}getTransformInstance(t){return t?this.extensionMap[t]:this.extensionMap}constructor(t){super(t),this.category="transform",this.setTransforms(this.context.options.transforms||[])}}class oH{get padding(){return ef(this.context.options.padding)}get paddingOffset(){let[t,e,i,n]=this.padding,[r,s,a]=[(n-e)/2,(t-i)/2,0];return[r,s,a]}get camera(){let{canvas:t}=this.context;return new Proxy(t.getCamera(),{get:(e,i)=>{let n=Object.entries(t.getLayers()).filter(t=>{let[e]=t;return!["main"].includes(e)}),r=n.map(t=>{let[,e]=t;return e.getCamera()}),s=e[i];if("function"==typeof s)return function(){for(var t=arguments.length,n=Array(t),a=0;a<t;a++)n[a]=arguments[a];let o=s.apply(e,n);return r.forEach(t=>{t[i].apply(t,n)}),o}}})}createLandmark(t){return this.camera.createLandmark("landmark-".concat(this.landmarkCounter++),t)}getAnimation(t){let e=t9(this.context.options,t);return!!e&&(0,nz.Z)({...e},["easing","duration"])}getCanvasSize(){let{canvas:t}=this.context,{width:e=0,height:i=0}=t.getConfig();return[e,i]}getCanvasCenter(){let{canvas:t}=this.context,{width:e=0,height:i=0}=t.getConfig();return[e/2,i/2,0]}getViewportCenter(){let[t,e]=this.camera.getPosition();return[t,e,0]}getGraphCenter(){return this.context.graph.getViewportByCanvas(this.getCanvasCenter())}getZoom(){return this.camera.getZoom()}getRotation(){return this.camera.getRoll()}getTranslateOptions(t){let{camera:e}=this,{mode:i,translate:n=[]}=t,r=this.getZoom(),s=e.getPosition(),a=e.getFocalPoint(),[o,l]=this.getCanvasCenter(),[h=0,c=0,d=0]=n,u=ek([-h,-c,-d],r);return"relative"===i?{position:eM(s,u),focalPoint:eM(a,u)}:{position:eM([o,l,s[2]],u),focalPoint:eM([o,l,a[2]],u)}}getRotateOptions(t){let{mode:e,rotate:i=0}=t,n="relative"===e?this.camera.getRoll()+i:i;return{roll:n}}getZoomOptions(t){let{zoomRange:e}=this.context.options,i=this.camera.getZoom(),{mode:n,scale:r=1}=t;return(0,q.Z)("relative"===n?i*r:r,...e)}async transform(t,e){let{graph:i}=this.context,{translate:n,rotate:r,scale:s,origin:a}=t;this.cancelAnimation();let o=this.getAnimation(e);if(ov(i,new oy(M.BEFORE_TRANSFORM,t)),!r&&s&&!n&&a&&!o){this.camera.setZoomByViewportPoint(this.getZoomOptions(t),a),ov(i,new oy(M.AFTER_TRANSFORM,t));return}let l={};if(n&&Object.assign(l,this.getTranslateOptions(t)),(0,F.Z)(r)&&Object.assign(l,this.getRotateOptions(t)),(0,F.Z)(s)&&Object.assign(l,{zoom:this.getZoomOptions(t)}),o)return ov(i,new of(M.BEFORE_ANIMATE,x.TRANSFORM,null,t)),new Promise(e=>{this.transformResolver=e,this.camera.gotoLandmark(this.createLandmark(l),{...o,onfinish:()=>{ov(i,new of(M.AFTER_ANIMATE,x.TRANSFORM,null,t)),ov(i,new oy(M.AFTER_TRANSFORM,t)),this.transformResolver=void 0,e()}})});this.camera.gotoLandmark(this.createLandmark(l),{duration:0}),ov(i,new oy(M.AFTER_TRANSFORM,t))}async fitView(t,e){let[i,n,r,s]=this.padding,{when:a="always",direction:o="both"}=t||{},[l,h]=this.context.canvas.getSize(),c=l-s-n,d=h-i-r,u=this.context.canvas.getBounds(),p=this.getBBoxInViewport(u),[g,f]=ev(p);if("overflow"===a&&!("x"===o&&g>=c||"y"===o&&f>=d||"both"===o&&g>=c&&f>=d))return await this.fitCenter(e);let m=c/g,y=d/f,v="x"===o?m:"y"===o?y:Math.min(m,y),b=this.getAnimation(e);await this.transform({mode:"relative",scale:v,translate:eM(eD(this.getCanvasCenter(),this.getBBoxInViewport(u).center),ek(this.paddingOffset,v))},b)}async fitCenter(t){let e=this.context.canvas.getBounds();await this.focus(e,t)}async focusElements(t,e){let{element:i}=this.context;if(!i)return;let n=ex(t.map(t=>i.getElement(t).getRenderBounds()));await this.focus(n,e)}async focus(t,e){let i=this.context.graph.getViewportByCanvas(t.center),n=this.getCanvasCenter(),r=eD(n,i);await this.transform({mode:"relative",translate:eM(r,this.paddingOffset)},e)}getBBoxInViewport(t){let{min:e,max:i}=t,{graph:n}=this.context,[r,s]=n.getViewportByCanvas(e),[a,o]=n.getViewportByCanvas(i),l=new I.mN;return l.setMinMax([r,s,0],[a,o,0]),l}isInViewport(t){let{graph:e}=this.context,i=this.getCanvasSize(),[n,r]=e.getCanvasByViewport([0,0]),[s,a]=e.getCanvasByViewport(i),o=new I.mN;return o.setMinMax([n,r,0],[s,a,0]),ep(t)?ew(t,o):o.intersects(t)}cancelAnimation(){var t,e;(null===(t=this.camera.landmarks)||void 0===t?void 0:t.length)&&this.camera.cancelLandmarkAnimation(),null===(e=this.transformResolver)||void 0===e||e.call(this)}constructor(t){this.landmarkCounter=0,this.context=t;let[e,i]=this.paddingOffset,{zoom:n,rotation:r,x:s=e,y:a=i}=t.options;this.transform({mode:"absolute",scale:n,translate:[s,a],rotate:r},!1)}}class oV extends s2.Z{getOptions(){return this.options}setOptions(t){var e,i,n;let{behaviors:r,combo:s,data:a,edge:o,height:l,layout:h,node:c,plugins:d,theme:u,transforms:p,width:g,cursor:f,renderer:m}=t;if(m){let t=this.context.canvas;t&&(this.emit(M.BEFORE_RENDERER_CHANGE,{renderer:this.options.renderer}),t.setRenderer(m),this.emit(M.AFTER_RENDERER_CHANGE,{renderer:m}))}Object.assign(this.options,t),f&&(null===(e=this.context.canvas)||void 0===e||e.setCursor(f)),r&&this.setBehaviors(r),s&&this.setCombo(s),a&&this.setData(a),o&&this.setEdge(o),h&&this.setLayout(h),c&&this.setNode(c),u&&this.setTheme(u),d&&this.setPlugins(d),p&&this.setTransforms(p),((0,F.Z)(g)||(0,F.Z)(l))&&this.setSize(null!==(i=null!=g?g:this.options.width)&&void 0!==i?i:0,null!==(n=null!=l?l:this.options.height)&&void 0!==n?n:0)}getSize(){return this.context.canvas?this.context.canvas.getSize():[this.options.width||0,this.options.height||0]}setSize(t,e){var i;Object.assign(this.options,{width:t,height:e}),null===(i=this.context.canvas)||void 0===i||i.resize(t,e)}setZoomRange(t){this.options.zoomRange=t}getZoomRange(){return this.options.zoomRange}setNode(t){this.options.node=t,this.context.model.refreshData()}setEdge(t){this.options.edge=t,this.context.model.refreshData()}setCombo(t){this.options.combo=t,this.context.model.refreshData()}getTheme(){return this.options.theme}setTheme(t){this.options.theme=(0,ed.Z)(t)?t(this.getTheme()):t}setLayout(t){this.options.layout=(0,ed.Z)(t)?t(this.getLayout()):t}getLayout(){return this.options.layout}setBehaviors(t){var e;this.options.behaviors=(0,ed.Z)(t)?t(this.getBehaviors()):t,null===(e=this.context.behavior)||void 0===e||e.setBehaviors(this.options.behaviors)}updateBehavior(t){this.setBehaviors(e=>e.map(e=>"object"==typeof e&&e.key===t.key?{...e,...t}:e))}getBehaviors(){return this.options.behaviors||[]}setPlugins(t){var e;this.options.plugins=(0,ed.Z)(t)?t(this.getPlugins()):t,null===(e=this.context.plugin)||void 0===e||e.setPlugins(this.options.plugins)}updatePlugin(t){this.setPlugins(e=>e.map(e=>"object"==typeof e&&e.key===t.key?{...e,...t}:e))}getPlugins(){return this.options.plugins||[]}getPluginInstance(t){return this.context.plugin.getPluginInstance(t)}setTransforms(t){var e;this.options.transforms=(0,ed.Z)(t)?t(this.getTransforms()):t,null===(e=this.context.transform)||void 0===e||e.setTransforms(this.options.transforms)}updateTransform(t){this.setTransforms(e=>e.map(e=>"object"==typeof e&&e.key===t.key?{...e,...t}:e)),this.context.model.refreshData()}getTransforms(){return this.options.transforms||[]}getData(){return this.context.model.getData()}getElementData(t){return Array.isArray(t)?t.map(t=>this.context.model.getElementDataById(t)):this.context.model.getElementDataById(t)}getNodeData(t){var e;return void 0===t?this.context.model.getNodeData():Array.isArray(t)?this.context.model.getNodeData(t):null===(e=this.context.model.getNodeData([t]))||void 0===e?void 0:e[0]}getEdgeData(t){var e;return void 0===t?this.context.model.getEdgeData():Array.isArray(t)?this.context.model.getEdgeData(t):null===(e=this.context.model.getEdgeData([t]))||void 0===e?void 0:e[0]}getComboData(t){var e;return void 0===t?this.context.model.getComboData():Array.isArray(t)?this.context.model.getComboData(t):null===(e=this.context.model.getComboData([t]))||void 0===e?void 0:e[0]}setData(t){this.context.model.setData((0,ed.Z)(t)?t(this.getData()):t)}addData(t){this.context.model.addData((0,ed.Z)(t)?t(this.getData()):t)}addNodeData(t){this.context.model.addNodeData((0,ed.Z)(t)?t(this.getNodeData()):t)}addEdgeData(t){this.context.model.addEdgeData((0,ed.Z)(t)?t(this.getEdgeData()):t)}addComboData(t){this.context.model.addComboData((0,ed.Z)(t)?t(this.getComboData()):t)}addChildrenData(t,e){this.context.model.addChildrenData(t,e)}updateData(t){this.context.model.updateData((0,ed.Z)(t)?t(this.getData()):t)}updateNodeData(t){this.context.model.updateNodeData((0,ed.Z)(t)?t(this.getNodeData()):t)}updateEdgeData(t){this.context.model.updateEdgeData((0,ed.Z)(t)?t(this.getEdgeData()):t)}updateComboData(t){this.context.model.updateComboData((0,ed.Z)(t)?t(this.getComboData()):t)}removeData(t){this.context.model.removeData((0,ed.Z)(t)?t(this.getData()):t)}removeNodeData(t){this.context.model.removeNodeData((0,ed.Z)(t)?t(this.getNodeData()):t)}removeEdgeData(t){this.context.model.removeEdgeData((0,ed.Z)(t)?t(this.getEdgeData()):t)}removeComboData(t){this.context.model.removeComboData((0,ed.Z)(t)?t(this.getComboData()):t)}getElementType(t){return this.context.model.getElementType(t)}getRelatedEdgesData(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"both";return this.context.model.getRelatedEdgesData(t,e)}getNeighborNodesData(t){return this.context.model.getNeighborNodesData(t)}getAncestorsData(t,e){return this.context.model.getAncestorsData(t,e)}getParentData(t,e){return this.context.model.getParentData(t,e)}getChildrenData(t){return this.context.model.getChildrenData(t)}getElementDataByState(t,e){return this.context.model.getElementDataByState(t,e)}async initCanvas(){if(this.context.canvas)return await this.context.canvas.ready;let{container:t="container",width:e,height:i,renderer:n,cursor:r,background:s}=this.options;if(t instanceof oM)this.context.canvas=t,r&&t.setCursor(r),n&&t.setRenderer(n),await t.ready;else{let a=(0,B.Z)(t)?document.getElementById(t):t,o=sm(a);this.emit(M.BEFORE_CANVAS_INIT,{container:a,width:e,height:i});let l=new oM({container:a,width:e||o[0],height:i||o[1],background:s,renderer:n,cursor:r});this.context.canvas=l,await l.ready,this.emit(M.AFTER_CANVAS_INIT,{canvas:l})}}initRuntime(){this.context.options=this.options,this.context.batch||(this.context.batch=new oE(this.context)),this.context.plugin||(this.context.plugin=new oZ(this.context)),this.context.viewport||(this.context.viewport=new oH(this.context)),this.context.transform||(this.context.transform=new oG(this.context)),this.context.element||(this.context.element=new oI(this.context)),this.context.animation||(this.context.animation=new ob(this.context)),this.context.layout||(this.context.layout=new oj(this.context)),this.context.behavior||(this.context.behavior=new ox(this.context))}async prepare(){if(await Promise.resolve(),this.destroyed)throw Error(t1("The graph instance has been destroyed"));await this.initCanvas(),this.initRuntime()}async render(){await this.prepare(),ov(this,new og(M.BEFORE_RENDER));let t=this.context.element.draw({type:"render"});await Promise.all([null==t?void 0:t.finished,this.context.layout.layout()]),await this.autoFit(),ov(this,new og(M.AFTER_RENDER))}async draw(){var t;await this.prepare(),await (null===(t=this.context.element.draw())||void 0===t?void 0:t.finished)}async layout(){await this.context.layout.layout()}stopLayout(){this.context.layout.stopLayout()}async clear(){this.context.model.setData({}),await this.draw()}destroy(){ov(this,new og(M.BEFORE_DESTROY));let{layout:t,animation:e,element:i,model:n,canvas:r,behavior:s,plugin:a}=this.context;null==a||a.destroy(),null==s||s.destroy(),null==t||t.destroy(),null==e||e.destroy(),null==i||i.destroy(),n.destroy(),null==r||r.destroy(),this.options={},this.context={},this.off(),window.removeEventListener("resize",this.onResize),this.destroyed=!0,ov(this,new og(M.AFTER_DESTROY))}getCanvas(){return this.context.canvas}resize(t,e){let i=t&&e?[t,e]:sm(this.context.canvas.getContainer());(0,tU.Z)(i,this.getSize())||(ov(this,new og(M.BEFORE_SIZE_CHANGE,{size:i})),this.context.canvas.resize(...i),ov(this,new og(M.AFTER_SIZE_CHANGE,{size:i})))}async fitView(t,e){var i;await (null===(i=this.context.viewport)||void 0===i?void 0:i.fitView(t,e))}async fitCenter(t){var e;await (null===(e=this.context.viewport)||void 0===e?void 0:e.fitCenter(t))}async autoFit(){let{autoFit:t}=this.context.options;if(t){if((0,B.Z)(t))"view"===t?await this.fitView():"center"===t&&await this.fitCenter();else{let{type:e,animation:i}=t;"view"===e?await this.fitView(t.options,i):"center"===e&&await this.fitCenter(i)}}}async focusElement(t,e){var i;await (null===(i=this.context.viewport)||void 0===i?void 0:i.focusElements(Array.isArray(t)?t:[t],e))}async zoomBy(t,e,i){await this.context.viewport.transform({mode:"relative",scale:t,origin:i},e)}async zoomTo(t,e,i){this.context.viewport.transform({mode:"absolute",scale:t,origin:i},e)}getZoom(){return this.context.viewport.getZoom()}async rotateBy(t,e,i){await this.context.viewport.transform({mode:"relative",rotate:t,origin:i},e)}async rotateTo(t,e,i){await this.context.viewport.transform({mode:"absolute",rotate:t,origin:i},e)}getRotation(){return this.context.viewport.getRotation()}async translateBy(t,e){await this.context.viewport.transform({mode:"relative",translate:t},e)}async translateTo(t,e){await this.context.viewport.transform({mode:"absolute",translate:t},e)}getPosition(){return eD([0,0],this.getCanvasByViewport([0,0]))}async translateElementBy(t,e){var i;let n=!(arguments.length>2)||void 0===arguments[2]||arguments[2],[r,s]=(0,tK.Z)(t)?[t,null==e||e]:[{[t]:e},n];Object.entries(r).forEach(t=>{let[e,i]=t;return this.context.model.translateNodeLikeBy(e,i)}),await (null===(i=this.context.element.draw({animation:s,stage:"translate"}))||void 0===i?void 0:i.finished)}async translateElementTo(t,e){var i;let n=!(arguments.length>2)||void 0===arguments[2]||arguments[2],[r,s]=(0,tK.Z)(t)?[t,null==e||e]:[{[t]:e},n];Object.entries(r).forEach(t=>{let[e,i]=t;return this.context.model.translateNodeLikeTo(e,i)}),await (null===(i=this.context.element.draw({animation:s,stage:"translate"}))||void 0===i?void 0:i.finished)}getElementPosition(t){return this.context.model.getElementPosition(t)}getElementRenderStyle(t){return(0,sg.Z)(this.context.element.getElement(t).attributes,["context"])}async setElementVisibility(t,e){var i;let n=!(arguments.length>2)||void 0===arguments[2]||arguments[2],[r,s]=(0,tK.Z)(t)?[t,null==e||e]:[{[t]:e},n],a={nodes:[],edges:[],combos:[]};Object.entries(r).forEach(t=>{let[e,i]=t,n=this.getElementType(e);a["".concat(n,"s")].push({id:e,style:{visibility:i}})});let{model:o,element:l}=this.context;o.preventUpdateNodeLikeHierarchy(()=>{o.updateData(a)}),await (null===(i=l.draw({animation:s,stage:"visibility"}))||void 0===i?void 0:i.finished)}async showElement(t,e){let i=Array.isArray(t)?t:[t];await this.setElementVisibility(Object.fromEntries(i.map(t=>[t,"visible"])),e)}async hideElement(t,e){let i=Array.isArray(t)?t:[t];await this.setElementVisibility(Object.fromEntries(i.map(t=>[t,"hidden"])),e)}getElementVisibility(t){var e,i;let n=this.context.element.getElement(t);return null!==(i=null==n?void 0:null===(e=n.style)||void 0===e?void 0:e.visibility)&&void 0!==i?i:"visible"}async setElementZIndex(t,e){var i;let n={nodes:[],edges:[],combos:[]},r=(0,tK.Z)(t)?t:{[t]:e};Object.entries(r).forEach(t=>{let[e,i]=t,r=this.getElementType(e);n["".concat(r,"s")].push({id:e,style:{zIndex:i}})});let{model:s,element:a}=this.context;s.preventUpdateNodeLikeHierarchy(()=>s.updateData(n)),await (null===(i=a.draw({animation:!1,stage:"zIndex"}))||void 0===i?void 0:i.finished)}async frontElement(t){let e=Array.isArray(t)?t:[t],{model:i,element:n}=this.context,r={};e.map(t=>{let e=n.getFrontZIndex(t),s=i.getElementType(t);if("combo"===s){let s=i.getAncestorsData(t,tq).at(-1)||this.getComboData(t),a=[s,...i.getDescendantsData(t7(s))],o=e-n.getElementZIndex(t);a.forEach(t=>{r[t7(t)]=this.getElementZIndex(t7(t))+o})}else r[t]=e}),await this.setElementZIndex(r)}getElementZIndex(t){var e,i,n;let{model:r,element:s}=this.context;return null!==(n=null===(e=r.getElementDataById(t))||void 0===e?void 0:null===(i=e.style)||void 0===i?void 0:i.zIndex)&&void 0!==n?n:s.getElementZIndex(t)}async setElementState(t,e){var i;let n=!(arguments.length>2)||void 0===arguments[2]||arguments[2],[r,s]=(0,tK.Z)(t)?[t,null==e||e]:[{[t]:e},n],a=t=>t?Array.isArray(t)?t:[t]:[],o={nodes:[],edges:[],combos:[]};Object.entries(r).forEach(t=>{let[e,i]=t,n=this.getElementType(e);o["".concat(n,"s")].push({id:e,states:a(i)})}),this.updateData(o),await (null===(i=this.context.element.draw({animation:s}))||void 0===i?void 0:i.finished)}getElementState(t){return this.context.model.getElementState(t)}getElementRenderBounds(t){return this.context.element.getElement(t).getRenderBounds()}async collapseElement(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],{model:i,element:n}=this.context;if(e7(i.getNodeLikeData([t])[0])||this.isCollapsingExpanding)return;let r=i.getElementType(t);await this.frontElement(t),this.isCollapsingExpanding=!0,this.setElementCollapsibility(t,!0),"node"===r?await n.collapseNode(t,e):"combo"===r&&await n.collapseCombo(t,e),this.isCollapsingExpanding=!1}async expandElement(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],{model:i,element:n}=this.context;if(!e7(i.getNodeLikeData([t])[0])||this.isCollapsingExpanding)return;let r=i.getElementType(t);this.isCollapsingExpanding=!0,this.setElementCollapsibility(t,!1),"node"===r?await n.expandNode(t,e):"combo"===r&&await n.expandCombo(t,e),this.isCollapsingExpanding=!1}setElementCollapsibility(t,e){let i=this.getElementType(t);"node"===i?this.updateNodeData([{id:t,style:{collapsed:e}}]):"combo"===i&&this.updateComboData([{id:t,style:{collapsed:e}}])}async toDataURL(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.context.canvas.toDataURL(t)}getCanvasByViewport(t){return this.context.canvas.getCanvasByViewport(t)}getViewportByCanvas(t){return this.context.canvas.getViewportByCanvas(t)}getClientByCanvas(t){return this.context.canvas.getClientByCanvas(t)}getCanvasByClient(t){return this.context.canvas.getCanvasByClient(t)}getViewportCenter(){return this.context.viewport.getViewportCenter()}getCanvasCenter(){return this.context.viewport.getCanvasCenter()}on(t,e,i){return super.on(t,e,i)}once(t,e){return super.once(t,e)}off(t,e){return super.off(t,e)}constructor(t){super(),this.destroyed=!1,this.context={model:new oL},this.isCollapsingExpanding=!1,this.onResize=(0,rV.Z)(()=>{this.resize()},300),this.options=Object.assign({},oV.defaultOptions,t),this.setOptions(this.options),this.context.graph=this,this.options.autoResize&&window.addEventListener("resize",this.onResize)}}oV.defaultOptions={autoResize:!1,theme:"light",rotation:0,zoom:1,zoomRange:[.01,10]};let oY=(t,e)=>{let{source:i,target:n}=e,r=t.getElementDataById(i),s=t.getElementDataById(n),a=re(r,e=>t.getParentData(e,tq)),o=re(s,e=>t.getParentData(e,tq)),l=t7(a),h=t7(o),c={sourceNode:l,targetNode:h};return e.style?Object.assign(e.style,c):e.style=c,e};var oU=i(62240);let oK=["top","top-right","right","right-bottom","bottom","bottom-left","left","left-top"];class o$ extends oc{beforeDraw(t){let e=this.getAffectedParallelEdges(t);return 0===e.size||("bundle"===this.options.mode?this.applyBundlingStyle(t,e,this.options.distance):this.applyMergingStyle(t,e)),t}constructor(t,e){super(t,Object.assign({},o$.defaultOptions,e)),this.cacheMergeStyle=new Map,this.getAffectedParallelEdges=t=>{let{add:{edges:e},update:{nodes:i,edges:n,combos:r},remove:{edges:s}}=t,{model:a}=this.context,o=new Map,l=(t,e)=>{let i=a.getRelatedEdgesData(e);i.forEach(t=>!o.has(t7(t))&&o.set(t7(t),t))};i.forEach(l),r.forEach(l);let h=t=>{let e=a.getEdgeData().map(t=>oY(a,t)),i=oq(t,e,!0);i.forEach(t=>!o.has(t7(t))&&o.set(t7(t),t))};if(s.size&&s.forEach(h),e.size&&e.forEach(h),n.size){let t=s6(s3(a.getChanges())).update.edges;n.forEach(e=>{var i;h(e);let n=null===(i=t.find(t=>t7(t.value)===t7(e)))||void 0===i?void 0:i.original;n&&!oJ(e,n)&&h(n)})}iA(this.options.edges)||o.forEach((t,e)=>!this.options.edges.includes(e)&&o.delete(e));let c=a.getEdgeData().map(t7);return new Map([...o].sort((t,e)=>c.indexOf(t[0])-c.indexOf(e[0])))},this.applyBundlingStyle=(t,e,i)=>{let{edgeMap:n,reverses:r}=oX(e);n.forEach(e=>{e.forEach((e,n,s)=>{var a;let o=Object.assign(e,{type:"quadratic",style:(()=>{let t=s.length,a={};if(e.source===e.target){let t=oK.length;a.loopPlacement=oK[n%t],a.loopDist=Math.floor(n/t)*i+50}else if(1===t)a.curveOffset=0;else{let s=(n%2==0?1:-1)*(r["".concat(e.source,"|").concat(e.target,"|").concat(n)]?-1:1);a.curveOffset=t%2==1?s*Math.ceil(n/2)*i*2:s*(Math.floor(n/2)*i*2+i)}return Object.assign({},e.style,a)})()}),l=null===(a=this.context.element)||void 0===a?void 0:a.getElement(t7(e));l?ei(t,"update","edge",o,!0):ei(t,"add","edge",o,!0)})})},this.resetEdgeStyle=t=>{let e=t.style||{},i=this.cacheMergeStyle.get(t7(t))||{};return Object.keys(i).forEach(n=>{(0,tU.Z)(e[n],i[n])&&(t[n]?e[n]=t[n]:delete e[n])}),Object.assign(t,{style:e})},this.applyMergingStyle=(t,e)=>{let{edgeMap:i,reverses:n}=oX(e);i.forEach(e=>{if(1===e.length){var i;let n=e[0],r=null===(i=this.context.element)||void 0===i?void 0:i.getElement(t7(n));ei(t,r?"update":"add","edge",this.resetEdgeStyle(n),!0);return}let r=e.map((t,e)=>{let{source:i,target:r,style:s={}}=t,{startArrow:a,endArrow:o}=s,l={},[h,c]=n["".concat(i,"|").concat(r,"|").concat(e)]?["endArrow","startArrow"]:["startArrow","endArrow"];return(0,oU.Z)(a)&&(l[h]=a),(0,oU.Z)(o)&&(l[c]=o),l}).reduce((t,e)=>({...t,...e}),{});e.forEach((e,i,n)=>{if(0===i){var s;let i=Object.assign({},(0,ed.Z)(this.options.style)?this.options.style(n):this.options.style,{childrenData:n});this.cacheMergeStyle.set(t7(e),i);let a={...e,type:"line",style:{...r,...i}},o=null===(s=this.context.element)||void 0===s?void 0:s.getElement(t7(e));ei(t,o?"update":"add","edge",a,!0)}else ei(t,"remove","edge",e)})})}}}o$.defaultOptions={mode:"bundle",edges:void 0,distance:15};let oX=t=>{let e=new Map,i=new Set,n={};for(let[r,s]of t){if(i.has(r))continue;let{source:a,target:o}=s,l="".concat(a,"-").concat(o);for(let[h,c]of(e.has(l)||e.set(l,[]),e.get(l).push(s),i.add(r),t))!i.has(h)&&oJ(s,c)&&(e.get(l).push(c),i.add(h),a===c.target&&o===c.source&&(n["".concat(c.source,"|").concat(c.target,"|").concat(e.get(l).length-1)]=!0))}return{edgeMap:e,reverses:n}},oq=(t,e,i)=>e.filter(e=>(i||t7(e)!==t7(t))&&oJ(e,t)),oJ=(t,e)=>{let{sourceNode:i,targetNode:n}=t.style||{},{sourceNode:r,targetNode:s}=e.style||{};return i===r&&n===s||i===s&&n===r},oQ={animation:{"combo-collapse":ea,"combo-expand":ea,"node-collapse":er,"node-expand":er,"path-in":es,"path-out":es,fade:[{fields:["opacity"]}],translate:[{fields:["x","y"]}]},behavior:{"brush-select":e1,"click-select":e5,"collapse-expand":rZ,"create-edge":rH,"drag-canvas":rY,"drag-element-force":class extends rU{get forceLayoutInstance(){return this.context.layout.getLayoutInstance().find(t=>["d3-force","d3-force-3d"].includes(null==t?void 0:t.id))}validate(t){return!!this.context.layout&&(this.forceLayoutInstance?super.validate(t):(t2.warn("DragElementForce only works with d3-force or d3-force-3d layout"),!1))}async moveElement(t,e){let i=this.forceLayoutInstance;this.context.graph.getNodeData(t).forEach((n,r)=>{let{x:s=0,y:a=0}=n.style||{};i&&rq(i,"setFixedPosition",t[r],[...eM([+s,+a],e)])})}onDragStart(t){if(this.enable=this.validate(t),!this.enable)return;this.target=this.getSelectedNodeIDs([t.target.id]),this.hideEdge(),this.context.graph.frontElement(this.target);let e=this.forceLayoutInstance;e&&rJ(e,"simulation").alphaTarget(.3).restart(),this.context.graph.getNodeData(this.target).forEach(t=>{let{x:i=0,y:n=0}=t.style||{};e&&rq(e,"setFixedPosition",t7(t),[+i,+n])})}onDrag(t){if(!this.enable)return;let e=this.getDelta(t);this.moveElement(this.target,e)}onDragEnd(){let t=this.forceLayoutInstance;t&&rJ(t,"simulation").alphaTarget(0),this.context.graph.getNodeData(this.target).forEach(e=>{t&&rq(t,"setFixedPosition",t7(e),[null,null,null])})}},"drag-element":rU,"fix-element-size":r6,"focus-element":r4,"hover-activate":r8,"lasso-select":class extends e1{onPointerDown(t){if(!super.validate(t)||!super.isKeydown()||this.points)return;let{canvas:e}=this.context;this.pathShape=new I.y$({id:"g6-lasso-select",style:this.options.style}),e.appendChild(this.pathShape),this.points=[e2(t)]}onPointerMove(t){var e;if(!this.points)return;let{immediately:i,mode:n}=this.options;this.points.push(e2(t)),null===(e=this.pathShape)||void 0===e||e.setAttribute("d",function(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=[];return t.forEach((t,e)=>{i.push([0===e?"M":"L",...t])}),e&&i.push(["Z"]),i}(this.points)),i&&"default"===n&&this.points.length>2&&super.updateElementsStates(this.points)}onPointerUp(){if(this.points){if(this.points.length<2){this.clearLasso();return}super.updateElementsStates(this.points),this.clearLasso()}}clearLasso(){var t;null===(t=this.pathShape)||void 0===t||t.remove(),this.pathShape=void 0,this.points=void 0}},"optimize-viewport-transform":r9,"scroll-canvas":r5,"zoom-canvas":r7},combo:{circle:class extends nV{drawKeyShape(t,e){return this.upsert("key",I.Cd,this.getKeyStyle(t),e)}getKeyStyle(t){let{collapsed:e}=t,i=super.getKeyStyle(t),[n]=this.getKeySize(t);return{...i,...e&&is(i,"collapsed"),r:n/2}}getCollapsedKeySize(t){let[e,i]=il(t.collapsedSize),n=Math.max(e,i)/2;return[2*n,2*n,0]}getExpandedKeySize(t){let e=this.getContentBBox(t),[i,n]=ev(e),r=Math.sqrt(i**2+n**2)/2;return[2*r,2*r,0]}getIntersectPoint(t){let e=this.getShape("key").getBounds();return e$(t,e)}constructor(t){super(t)}},rect:class extends nV{drawKeyShape(t,e){return this.upsert("key",I.UL,this.getKeyStyle(t),e)}getKeyStyle(t){let e=super.getKeyStyle(t),[i,n]=this.getKeySize(t);return{...e,...t.collapsed&&is(e,"collapsed"),width:i,height:n,x:-i/2,y:-n/2}}constructor(t){super(t)}}},edge:{cubic:rc,line:rp,polyline:rT,quadratic:rC,"cubic-horizontal":rd,"cubic-vertical":ru},layout:{"antv-dagre":se.b,"combo-combined":sn.u,"compact-box":st.compactBox,"force-atlas2":so.E,circular:si.S,concentric:sr.W,"d3-force":ss.j,dagre:sa.V,dendrogram:st.dendrogram,force:sl.y,fruchterman:sh.O,grid:sc.M,indented:st.indented,mds:sd.A,mindmap:st.mindmap,radial:su.D,random:sp._},node:{circle:iV,diamond:class extends iY{getPoints(t){let[e,i]=this.getSize(t);return[[0,-i/2],[e/2,0],[0,i/2],[-e/2,0]]}constructor(t){super(t)}},ellipse:iJ,hexagon:class extends iY{getOuterR(t){return t.outerR||Math.min(...this.getSize(t))/2}getPoints(t){var e;return[[0,e=this.getOuterR(t)],[e*Math.sqrt(3)/2,e/2],[e*Math.sqrt(3)/2,-e/2],[0,-e],[-e*Math.sqrt(3)/2,-e/2],[-e*Math.sqrt(3)/2,e/2]]}getIconStyle(t){let e=super.getIconStyle(t),i=.8*this.getOuterR(t);return!!e&&{width:i,height:i,...e}}constructor(t){super(t)}},html:nW,image:nG,rect:class extends iH{getKeyStyle(t){let[e,i]=this.getSize(t);return{...super.getKeyStyle(t),width:e,height:i,x:-e/2,y:-i/2}}getIconStyle(t){let e=super.getIconStyle(t),{width:i,height:n}=this.getShape("key").attributes;return!!e&&{width:.8*i,height:.8*n,...e}}drawKeyShape(t,e){return this.upsert("key",I.UL,this.getKeyStyle(t),e)}constructor(t){super(t)}},star:class extends iY{getInnerR(t){return t.innerR||3*this.getOuterR(t)/8}getOuterR(t){return Math.min(...this.getSize(t))/2}getPoints(t){var e,i;return[[0,-(e=this.getOuterR(t))],[(i=this.getInnerR(t))*Math.cos(3*Math.PI/10),-i*Math.sin(3*Math.PI/10)],[e*Math.cos(Math.PI/10),-e*Math.sin(Math.PI/10)],[i*Math.cos(Math.PI/10),i*Math.sin(Math.PI/10)],[e*Math.cos(3*Math.PI/10),e*Math.sin(3*Math.PI/10)],[0,i],[-e*Math.cos(3*Math.PI/10),e*Math.sin(3*Math.PI/10)],[-i*Math.cos(Math.PI/10),i*Math.sin(Math.PI/10)],[-e*Math.cos(Math.PI/10),-e*Math.sin(Math.PI/10)],[-i*Math.cos(3*Math.PI/10),-i*Math.sin(3*Math.PI/10)]]}getIconStyle(t){let e=super.getIconStyle(t),i=2*this.getInnerR(t)*.8;return!!e&&{width:i,height:i,...e}}getPortXY(t,e){let{placement:i="top"}=e,n=this.getShape("key").getLocalBounds(),r=function(t,e){let i={};return i.top=[0,-t],i.left=[-t*Math.cos(Math.PI/10),-t*Math.sin(Math.PI/10)],i["left-bottom"]=[-t*Math.cos(3*Math.PI/10),t*Math.sin(3*Math.PI/10)],i.bottom=[0,e],i["right-bottom"]=[t*Math.cos(3*Math.PI/10),t*Math.sin(3*Math.PI/10)],i.right=i.default=[t*Math.cos(Math.PI/10),-t*Math.sin(Math.PI/10)],i}(this.getOuterR(t),this.getInnerR(t));return rk(n,i,r,!1)}constructor(t){super(t)}},donut:iU,triangle:nH},palette:{spectral:["rgb(158, 1, 66)","rgb(213, 62, 79)","rgb(244, 109, 67)","rgb(253, 174, 97)","rgb(254, 224, 139)","rgb(255, 255, 191)","rgb(230, 245, 152)","rgb(171, 221, 164)","rgb(102, 194, 165)","rgb(50, 136, 189)","rgb(94, 79, 162)"],tableau:["rgb(78, 121, 167)","rgb(242, 142, 44)","rgb(225, 87, 89)","rgb(118, 183, 178)","rgb(89, 161, 79)","rgb(237, 201, 73)","rgb(175, 122, 161)","rgb(255, 157, 167)","rgb(156, 117, 95)","rgb(186, 176, 171)"],oranges:["rgb(255, 245, 235)","rgb(254, 230, 206)","rgb(253, 208, 162)","rgb(253, 174, 107)","rgb(253, 141, 60)","rgb(241, 105, 19)","rgb(217, 72, 1)","rgb(166, 54, 3)","rgb(127, 39, 4)"],greens:["rgb(247, 252, 245)","rgb(229, 245, 224)","rgb(199, 233, 192)","rgb(161, 217, 155)","rgb(116, 196, 118)","rgb(65, 171, 93)","rgb(35, 139, 69)","rgb(0, 109, 44)","rgb(0, 68, 27)"],blues:["rgb(247, 251, 255)","rgb(222, 235, 247)","rgb(198, 219, 239)","rgb(158, 202, 225)","rgb(107, 174, 214)","rgb(66, 146, 198)","rgb(33, 113, 181)","rgb(8, 81, 156)","rgb(8, 48, 107)"]},theme:{dark:ol,light:oh},plugin:{"bubble-sets":sY,"edge-filter-lens":sq,"grid-line":s1,background:sE,contextmenu:s$,fisheye:sQ,fullscreen:s0,history:s4,hull:an,legend:aa,minimap:al,snapline:au,timebar:a3,toolbar:a9,tooltip:a7,watermark:on},transform:{"update-related-edges":class extends oc{beforeDraw(t,e){let{stage:i}=e;if("visibility"===i)return t;let{model:n}=this.context,{update:{nodes:r,edges:s,combos:a}}=t,o=(t,e)=>{let i=n.getRelatedEdgesData(e);i.forEach(t=>!s.has(t7(t))&&s.set(t7(t),t))};return r.forEach(o),a.forEach(o),t}},"arrange-draw-order":class extends oc{beforeDraw(t){let{model:e}=this.context,i=t.add.combos,n=t=>{let i=[];return t.forEach((t,n)=>{let r=e.getAncestorsData(n,"combo"),s=r.map(t=>t7(t)).reverse();i.push([n,t,s.length])}),new Map(i.sort((t,e)=>{let[,,i]=t,[,,n]=e;return n-i}).map(t=>{let[e,i]=t;return[e,i]}))};return t.add.combos=n(i),t.update.combos=n(t.update.combos),t}},"collapse-expand-combo":class extends oc{beforeDraw(t,e){if("visibility"===e.stage)return t;let{model:i}=this.context,{add:n,update:r}=t,s=[...t.update.combos.entries(),...t.add.combos.entries()];for(;s.length;){let[e,a]=s.pop();if(e7(a)){let a=i.getDescendantsData(e),o=a.map(t7),{internal:l,external:h}=rt(o,t=>i.getRelatedEdgesData(t));a.forEach(e=>{let n=t7(e),r=s.findIndex(t=>{let[e]=t;return e===n});-1!==r&&s.splice(r,1);let a=i.getElementType(n);od(t,"remove",a,e)}),l.forEach(e=>od(t,"remove","edge",e)),h.forEach(t=>{var e;let i=t7(t),s=null===(e=this.context.element)||void 0===e?void 0:e.getElement(i);s?r.edges.set(i,t):n.edges.set(i,t)})}else{let n=i.getChildrenData(e),r=n.map(t7),{edges:a}=rt(r,t=>i.getRelatedEdgesData(t));[...n,...a].forEach(e=>{var n;let r=t7(e),a=i.getElementType(r),o=null===(n=this.context.element)||void 0===n?void 0:n.getElement(r);o?od(t,"update",a,e):od(t,"add",a,e),"combo"===a&&s.push([r,e])})}}return t}},"collapse-expand-node":class extends oc{getElement(t){return this.context.element.getElement(t)}handleExpand(t,e){if(ou(e,"add","node",t),e7(t))return;let i=t7(t);ou(e,"add","node",t);let n=this.context.model.getRelatedEdgesData(i,"out");n.forEach(t=>{od(e,"add","edge",t)});let r=this.context.model.getChildrenData(i);r.forEach(t=>{this.handleExpand(t,e)})}beforeDraw(t){let{graph:e,model:i}=this.context,{add:{nodes:n,edges:r},update:{nodes:s}}=t,a=new Map,o=new Map;n.forEach((t,e)=>{e7(t)&&a.set(e,t)}),r.forEach(t=>{if("node"!==e.getElementType(t.source))return;let i=e.getNodeData(t.source);e7(i)&&a.set(t.source,i)}),s.forEach((t,e)=>{let i=this.getElement(e);if(!i)return;let n=i.attributes.collapsed;e7(t)?n||a.set(e,t):n&&o.set(e,t)});let l=new Set;return a.forEach((e,n)=>{let r=i.getDescendantsData(n);r.forEach(e=>{let n=t7(e);if(l.has(n))return;od(t,"remove","node",e);let r=i.getRelatedEdgesData(n);r.forEach(e=>{od(t,"remove","edge",e)}),l.add(n)})}),o.forEach((e,n)=>{let r=i.getAncestorsData(n,tJ);if(r.some(e7)){od(t,"remove","node",e);return}this.handleExpand(e,t)}),t}},"process-parallel-edges":o$,"get-edge-actual-ends":class extends oc{beforeDraw(t){let{add:e,update:i}=t,{model:n}=this.context;return[...e.edges.entries(),...i.edges.entries()].forEach(t=>{let[,e]=t;oY(n,e)}),t}}},shape:{circle:I.Cd,ellipse:I.Pj,group:I.ZA,html:I.k9,image:iB,line:I.x1,path:I.y$,polygon:I.mg,polyline:I.aH,rect:I.UL,text:I.xv,label:iR,badge:iN}};I.GZ.enableCSSParsing=!1,Object.entries(oQ).forEach(t=>{let[e,i]=t;Object.entries(i).forEach(t=>{let[i,n]=t;!function(t,e,i){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=tQ[t][e];!n&&r?r!==i&&t2.warn("The extension ".concat(e," of ").concat(t," has been registered before.")):Object.assign(tQ[t],{[e]:i})}(e,i,n)})})},56666:function(t,e,i){"use strict";i.d(e,{P3:function(){return d}});var n=i(38497),r=n.createContext({graph:null,isReady:!1}),s=i(50198),a=function(){return(a=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},o=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var n,r,s=i.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=s.next()).done;)a.push(n.value)}catch(t){r={error:t}}finally{try{n&&!n.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}return a},l=function(){return(l=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},h=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&0>e.indexOf(n)&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(t);r<n.length;r++)0>e.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]]);return i},c=(0,n.forwardRef)(function(t,e){var i,c,d,u,p,g,f,m,y,v,b=t.style,E=t.children,x=(c=(i=h(t,["style","children"])).onInit,d=i.onReady,u=i.onDestroy,p=i.options,f=(g=o((0,n.useState)(!1),2))[0],m=g[1],y=(0,n.useRef)(null),v=(0,n.useRef)(null),(0,n.useEffect)(function(){if(!y.current&&v.current){var t=new s.kJ(a({container:v.current},p));return y.current=t,m(!0),null==c||c(y.current),function(){var t=y.current;t&&(t.destroy(),null==u||u(),y.current=null)}}},[]),(0,n.useEffect)(function(){var t=v.current,e=y.current;p&&t&&e&&!e.destroyed&&(e.setOptions(p),e.render().then(function(){return null==d?void 0:d(e)}))},[p]),{graph:y.current,containerRef:v,isReady:f}),w=x.graph,S=x.containerRef,T=x.isReady;(0,n.useImperativeHandle)(e,function(){return w},[w]);var C=l({height:"inherit",position:"relative"},b);return E?n.createElement(r.Provider,{value:{graph:w,isReady:T}},n.createElement("div",{ref:S,style:C},T&&E)):n.createElement("div",{ref:S,style:C})}),d=(0,n.memo)(c)},19512:function(t,e,i){"use strict";i.d(e,{Ud:function(){return d},Yy:function(){return s}});/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let n=Symbol("Comlink.proxy"),r=Symbol("Comlink.endpoint"),s=Symbol("Comlink.releaseProxy"),a=Symbol("Comlink.finalizer"),o=Symbol("Comlink.thrown"),l=t=>"object"==typeof t&&null!==t||"function"==typeof t,h=new Map([["proxy",{canHandle:t=>l(t)&&t[n],serialize(t){let{port1:e,port2:i}=new MessageChannel;return function t(e,i=globalThis,r=["*"]){i.addEventListener("message",function s(l){let h;if(!l||!l.data)return;if(!function(t,e){for(let i of t)if(e===i||"*"===i||i instanceof RegExp&&i.test(e))return!0;return!1}(r,l.origin)){console.warn(`Invalid origin '${l.origin}' for comlink proxy`);return}let{id:d,type:u,path:p}=Object.assign({path:[]},l.data),g=(l.data.argumentList||[]).map(b);try{var f;let i=p.slice(0,-1).reduce((t,e)=>t[e],e),r=p.reduce((t,e)=>t[e],e);switch(u){case"GET":h=r;break;case"SET":i[p.slice(-1)[0]]=b(l.data.value),h=!0;break;case"APPLY":h=r.apply(i,g);break;case"CONSTRUCT":{let t=new r(...g);h=Object.assign(t,{[n]:!0})}break;case"ENDPOINT":{let{port1:i,port2:n}=new MessageChannel;t(e,n),f=[i],y.set(i,f),h=i}break;case"RELEASE":h=void 0;break;default:return}}catch(t){h={value:t,[o]:0}}Promise.resolve(h).catch(t=>({value:t,[o]:0})).then(t=>{let[n,r]=v(t);i.postMessage(Object.assign(Object.assign({},n),{id:d}),r),"RELEASE"===u&&(i.removeEventListener("message",s),c(i),a in e&&"function"==typeof e[a]&&e[a]())}).catch(t=>{let[e,n]=v({value:TypeError("Unserializable return value"),[o]:0});i.postMessage(Object.assign(Object.assign({},e),{id:d}),n)})}),i.start&&i.start()}(t,e),[i,[i]]},deserialize:t=>(t.start(),d(t))}],["throw",{canHandle:t=>l(t)&&o in t,serialize:({value:t})=>[t instanceof Error?{isError:!0,value:{message:t.message,name:t.name,stack:t.stack}}:{isError:!1,value:t},[]],deserialize(t){if(t.isError)throw Object.assign(Error(t.value.message),t.value);throw t.value}}]]);function c(t){"MessagePort"===t.constructor.name&&t.close()}function d(t,e){return function t(e,i=[],n=function(){}){let a=!1,o=new Proxy(n,{get(n,r){if(u(a),r===s)return()=>{f&&f.unregister(o),p(e),a=!0};if("then"===r){if(0===i.length)return{then:()=>o};let t=E(e,{type:"GET",path:i.map(t=>t.toString())}).then(b);return t.then.bind(t)}return t(e,[...i,r])},set(t,n,r){u(a);let[s,o]=v(r);return E(e,{type:"SET",path:[...i,n].map(t=>t.toString()),value:s},o).then(b)},apply(n,s,o){u(a);let l=i[i.length-1];if(l===r)return E(e,{type:"ENDPOINT"}).then(b);if("bind"===l)return t(e,i.slice(0,-1));let[h,c]=m(o);return E(e,{type:"APPLY",path:i.map(t=>t.toString()),argumentList:h},c).then(b)},construct(t,n){u(a);let[r,s]=m(n);return E(e,{type:"CONSTRUCT",path:i.map(t=>t.toString()),argumentList:r},s).then(b)}});return!function(t,e){let i=(g.get(e)||0)+1;g.set(e,i),f&&f.register(t,e,t)}(o,e),o}(t,[],e)}function u(t){if(t)throw Error("Proxy has been released and is not useable")}function p(t){return E(t,{type:"RELEASE"}).then(()=>{c(t)})}let g=new WeakMap,f="FinalizationRegistry"in globalThis&&new FinalizationRegistry(t=>{let e=(g.get(t)||0)-1;g.set(t,e),0===e&&p(t)});function m(t){var e;let i=t.map(v);return[i.map(t=>t[0]),(e=i.map(t=>t[1]),Array.prototype.concat.apply([],e))]}let y=new WeakMap;function v(t){for(let[e,i]of h)if(i.canHandle(t)){let[n,r]=i.serialize(t);return[{type:"HANDLER",name:e,value:n},r]}return[{type:"RAW",value:t},y.get(t)||[]]}function b(t){switch(t.type){case"HANDLER":return h.get(t.name).deserialize(t.value);case"RAW":return t.value}}function E(t,e,i){return new Promise(n=>{let r=[,,,,].fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-");t.addEventListener("message",function e(i){i.data&&i.data.id&&i.data.id===r&&(t.removeEventListener("message",e),n(i.data))}),t.start&&t.start(),t.postMessage(Object.assign({id:r},e),i)})}},36348:function(t,e,i){"use strict";i.d(e,{CR:function(){return c},Jh:function(){return l},XA:function(){return h},ZT:function(){return r},_T:function(){return a},ev:function(){return d},mG:function(){return o},pi:function(){return s}});var n=function(t,e){return(n=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)};function r(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var s=function(){return(s=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function a(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&0>e.indexOf(n)&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(t);r<n.length;r++)0>e.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]]);return i}function o(t,e,i,n){return new(i||(i=Promise))(function(r,s){function a(t){try{l(n.next(t))}catch(t){s(t)}}function o(t){try{l(n.throw(t))}catch(t){s(t)}}function l(t){var e;t.done?r(t.value):((e=t.value)instanceof i?e:new i(function(t){t(e)})).then(a,o)}l((n=n.apply(t,e||[])).next())})}function l(t,e){var i,n,r,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=o(0),a.throw=o(1),a.return=o(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(o){return function(l){return function(o){if(i)throw TypeError("Generator is already executing.");for(;a&&(a=0,o[0]&&(s=0)),s;)try{if(i=1,n&&(r=2&o[0]?n.return:o[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,o[1])).done)return r;switch(n=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],n=0}finally{i=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}}function h(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],n=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function c(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var n,r,s=i.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=s.next()).done;)a.push(n.value)}catch(t){r={error:t}}finally{try{n&&!n.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}return a}function d(t,e,i){if(i||2==arguments.length)for(var n,r=0,s=e.length;r<s;r++)!n&&r in e||(n||(n=Array.prototype.slice.call(e,0,r)),n[r]=e[r]);return t.concat(n||Array.prototype.slice.call(e))}"function"==typeof SuppressedError&&SuppressedError}}]);