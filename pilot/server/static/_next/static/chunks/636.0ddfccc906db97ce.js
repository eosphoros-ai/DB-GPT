(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[636],{39156:function(e,l,a){"use strict";a.d(l,{Z:function(){return p}});var n=a(85893),t=a(41118),r=a(30208),c=a(40911),s=a(75227),i=a(67294);function o(e){let{chart:l}=e,a=(0,i.useRef)(null),o=(0,i.useRef)({chart:null});return(0,i.useEffect)(()=>{a.current&&(o.current.chart&&o.current.chart.destroy(),o.current.chart=new s.sg(a.current,{data:l.values,xField:"name",yField:"value",seriesField:"type",legend:{position:"bottom"},animation:{appear:{animation:"wave-in",duration:3e3}}}),o.current.chart.render())},[l.values]),(0,n.jsx)("div",{className:"flex-1 min-w-0",children:(0,n.jsx)(t.Z,{className:"h-full",sx:{background:"transparent"},children:(0,n.jsxs)(r.Z,{className:"h-full",children:[(0,n.jsx)(c.ZP,{gutterBottom:!0,component:"div",children:l.chart_name}),(0,n.jsx)(c.ZP,{gutterBottom:!0,level:"body3",children:l.chart_desc}),(0,n.jsx)("div",{className:"h-[300px]",ref:a})]})})})}function d(e){let{chart:l}=e,a=(0,i.useRef)(null),o=(0,i.useRef)({chart:null});return(0,i.useEffect)(()=>{a.current&&(o.current.chart&&o.current.chart.destroy(),o.current.chart=new s.x1(a.current,{data:l.values,xField:"name",yField:"value",seriesField:"type",smooth:!0,area:{style:{fillOpacity:.15}},legend:{position:"bottom"},animation:{appear:{animation:"wave-in",duration:3e3}}}),o.current.chart.render())},[l.values]),(0,n.jsx)("div",{className:"flex-1 min-w-0",children:(0,n.jsx)(t.Z,{className:"h-full",sx:{background:"transparent"},children:(0,n.jsxs)(r.Z,{className:"h-full",children:[(0,n.jsx)(c.ZP,{gutterBottom:!0,component:"div",children:l.chart_name}),(0,n.jsx)(c.ZP,{gutterBottom:!0,level:"body3",children:l.chart_desc}),(0,n.jsx)("div",{className:"h-[300px]",ref:a})]})})})}var u=a(61685),m=a(96486);function h(e){var l,a;let{chart:s}=e,i=(0,m.groupBy)(s.values,"type");return(0,n.jsx)("div",{className:"flex-1 min-w-0",children:(0,n.jsx)(t.Z,{className:"h-full overflow-auto",sx:{background:"transparent"},children:(0,n.jsxs)(r.Z,{className:"h-full",children:[(0,n.jsx)(c.ZP,{gutterBottom:!0,component:"div",children:s.chart_name}),(0,n.jsx)(c.ZP,{gutterBottom:!0,level:"body3",children:s.chart_desc}),(0,n.jsx)("div",{className:"flex-1",children:(0,n.jsxs)(u.Z,{"aria-label":"basic table",stripe:"odd",hoverRow:!0,borderAxis:"bothBetween",children:[(0,n.jsx)("thead",{children:(0,n.jsx)("tr",{children:Object.keys(i).map(e=>(0,n.jsx)("th",{children:e},e))})}),(0,n.jsx)("tbody",{children:null===(l=Object.values(i))||void 0===l?void 0:null===(a=l[0])||void 0===a?void 0:a.map((e,l)=>{var a;return(0,n.jsx)("tr",{children:null===(a=Object.keys(i))||void 0===a?void 0:a.map(e=>{var a;return(0,n.jsx)("td",{children:(null==i?void 0:null===(a=i[e])||void 0===a?void 0:a[l].value)||""},e)})},l)})})]})})]})})})}var p=function(e){let{chartsData:l}=e,a=(0,i.useMemo)(()=>{if(l){let e=[],a=null==l?void 0:l.filter(e=>"IndicatorValue"===e.chart_type);a.length>0&&e.push({charts:a,type:"IndicatorValue"});let n=null==l?void 0:l.filter(e=>"IndicatorValue"!==e.chart_type),t=n.length,r=0;return[[0],[1],[2],[1,2],[1,3],[2,1,2],[2,1,3],[3,1,3],[3,2,3]][t].forEach(l=>{if(l>0){let a=n.slice(r,r+l);r+=l,e.push({charts:a})}}),e}},[l]);return(0,n.jsx)("div",{className:"flex flex-col gap-3",children:null==a?void 0:a.map((e,l)=>(0,n.jsx)("div",{className:"".concat((null==e?void 0:e.type)!=="IndicatorValue"?"flex gap-3":""),children:e.charts.map(e=>"IndicatorValue"===e.chart_type?(0,n.jsx)("div",{className:"flex flex-row gap-3",children:e.values.map(e=>(0,n.jsx)("div",{className:"flex-1",children:(0,n.jsx)(t.Z,{sx:{background:"transparent"},children:(0,n.jsxs)(r.Z,{className:"justify-around",children:[(0,n.jsx)(c.ZP,{gutterBottom:!0,component:"div",children:e.name}),(0,n.jsx)(c.ZP,{children:e.value})]})})},e.name))},e.chart_uid):"LineChart"===e.chart_type?(0,n.jsx)(d,{chart:e},e.chart_uid):"BarChart"===e.chart_type?(0,n.jsx)(o,{chart:e},e.chart_uid):"Table"===e.chart_type?(0,n.jsx)(h,{chart:e},e.chart_uid):void 0)},"chart_row_".concat(l)))})}},2712:function(e,l,a){"use strict";a.d(l,{Z:function(){return P}});var n=a(85893),t=a(67294),r=a(2453),c=a(83062),s=a(41667),i=a(71577),o=a(49591),d=a(88484),u=a(29158),m=a(50489),h=a(41468),p=function(e){var l;let{convUid:a,chatMode:p,onComplete:x,...g}=e,[b,v]=(0,t.useState)(!1),[f,j]=r.ZP.useMessage(),[y,w]=(0,t.useState)([]),[_,Z]=(0,t.useState)(),{model:N}=(0,t.useContext)(h.p),P=async e=>{var l;if(!e){r.ZP.error("Please select the *.(csv|xlsx|xls) file");return}if(!/\.(csv|xlsx|xls)$/.test(null!==(l=e.file.name)&&void 0!==l?l:"")){r.ZP.error("File type must be csv, xlsx or xls");return}w([e.file])},C=async()=>{v(!0);try{let e=new FormData;e.append("doc_file",y[0]),f.open({content:"Uploading ".concat(y[0].name),type:"loading",duration:0});let[l]=await (0,m.Vx)((0,m.qn)({convUid:a,chatMode:p,data:e,model:N,config:{timeout:36e5,onUploadProgress:e=>{let l=Math.ceil(e.loaded/(e.total||0)*100);Z(l)}}}));if(l)return;r.ZP.success("success"),null==x||x()}catch(e){r.ZP.error((null==e?void 0:e.message)||"Upload Error")}finally{v(!1),f.destroy()}};return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"flex items-start gap-2",children:[j,(0,n.jsx)(c.Z,{placement:"bottom",title:"File cannot be changed after upload",children:(0,n.jsx)(s.default,{disabled:b,className:"mr-1",beforeUpload:()=>!1,fileList:y,name:"file",accept:".csv,.xlsx,.xls",multiple:!1,onChange:P,showUploadList:{showDownloadIcon:!1,showPreviewIcon:!1,showRemoveIcon:!1},itemRender:()=>(0,n.jsx)(n.Fragment,{}),...g,children:(0,n.jsx)(i.ZP,{className:"flex justify-center items-center",type:"primary",disabled:b,icon:(0,n.jsx)(o.Z,{}),children:"Select File"})})}),(0,n.jsx)(i.ZP,{type:"primary",loading:b,className:"flex justify-center items-center",disabled:!y.length,icon:(0,n.jsx)(d.Z,{}),onClick:C,children:b?100===_?"Analysis":"Uploading":"Upload"}),!!y.length&&(0,n.jsxs)("div",{className:"mt-2 text-gray-500 text-sm flex items-center",children:[(0,n.jsx)(u.Z,{className:"mr-2"}),(0,n.jsx)("span",{children:null===(l=y[0])||void 0===l?void 0:l.name})]})]})})},x=function(e){let{onComplete:l}=e,{currentDialogue:a,scene:r,chatId:c}=(0,t.useContext)(h.p);return"chat_excel"!==r?null:(0,n.jsx)("div",{className:"max-w-md h-full relative",children:a?(0,n.jsxs)("div",{className:"flex h-8 overflow-hidden rounded",children:[(0,n.jsx)("div",{className:"flex items-center justify-center px-2 bg-gray-600 text-lg",children:(0,n.jsx)(u.Z,{className:"text-white"})}),(0,n.jsx)("div",{className:"flex items-center justify-center px-3 bg-gray-100 text-xs rounded-tr rounded-br dark:text-gray-800 truncate",children:a.select_param})]}):(0,n.jsx)(p,{convUid:c,chatMode:r,onComplete:l})})};a(23293);var g=a(78045),b=a(16165),v=a(96991),f=function(){return(0,n.jsx)("svg",{width:"1em",height:"1em",fill:"currentColor",viewBox:"0 0 1024 1024",version:"1.1",children:(0,n.jsx)("path",{d:"M602.24 246.72a17.28 17.28 0 0 0-11.84-16.32l-42.88-14.4A90.56 90.56 0 0 1 490.24 160l-14.4-42.88a17.28 17.28 0 0 0-32 0L428.8 160a90.56 90.56 0 0 1-57.28 57.28l-42.88 14.4a17.28 17.28 0 0 0 0 32l42.88 14.4a90.56 90.56 0 0 1 57.28 57.28l14.4 42.88a17.28 17.28 0 0 0 32 0l14.4-42.88a90.56 90.56 0 0 1 57.28-57.28l42.88-14.4a17.28 17.28 0 0 0 12.48-16.96z m301.12 221.76l-48.32-16a101.44 101.44 0 0 1-64-64l-16-48.32a19.2 19.2 0 0 0-36.8 0l-16 48.32a101.44 101.44 0 0 1-64 64l-48.32 16a19.2 19.2 0 0 0 0 36.8l48.32 16a101.44 101.44 0 0 1 64 64l16 48.32a19.2 19.2 0 0 0 36.8 0l16-48.32a101.44 101.44 0 0 1 64-64l48.32-16a19.2 19.2 0 0 0 0-36.8z m-376.64 195.52l-64-20.8a131.84 131.84 0 0 1-83.52-83.52l-20.8-64a25.28 25.28 0 0 0-47.68 0l-20.8 64a131.84 131.84 0 0 1-82.24 83.52l-64 20.8a25.28 25.28 0 0 0 0 47.68l64 20.8a131.84 131.84 0 0 1 83.52 83.84l20.8 64a25.28 25.28 0 0 0 47.68 0l20.8-64a131.84 131.84 0 0 1 83.52-83.52l64-20.8a25.28 25.28 0 0 0 0-47.68z","p-id":"3992"})})};function j(){let{isContract:e,setIsContract:l,scene:a}=(0,t.useContext)(h.p),r=a&&["chat_with_db_execute","chat_dashboard"].includes(a);return r?(0,n.jsxs)(g.ZP.Group,{value:e,defaultValue:!0,buttonStyle:"solid",onChange:()=>{l(!e)},children:[(0,n.jsxs)(g.ZP.Button,{value:!1,children:[(0,n.jsx)(b.Z,{component:f,className:"mr-1"}),"Preview"]}),(0,n.jsxs)(g.ZP.Button,{value:!0,children:[(0,n.jsx)(v.Z,{className:"mr-1"}),"Editor"]})]}):null}var y=a(48567),w=function(){return(0,n.jsx)("svg",{width:"1em",height:"1em",fill:"currentColor",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4870",children:(0,n.jsx)("path",{d:"M511.875 128.125c-211.875 0-383.75 76.25-383.75 170.625 0 94.375 171.875 170.625 383.75 170.625 211.875 0 383.75-76.25 383.75-170.625C896.25 204.375 724.375 128.125 511.875 128.125M128.125 383.75l0 128.125c0 94.375 171.875 170.625 383.75 170.625 211.875 0 383.75-76.25 383.75-170.625l0-128.125c0 94.375-171.875 170.625-383.75 170.625C300 555 128.125 478.125 128.125 383.75M128.125 597.5l0 128.125c0 94.375 171.875 170.625 383.75 170.625 211.875 0 383.75-76.25 383.75-170.625l0-128.125c0 94.375-171.875 170.625-383.75 170.625C300 768.125 128.125 691.875 128.125 597.5z","p-id":"4871"})})},_=a(2093),Z=a(51009),N=function(){let{scene:e,dbParam:l,setDbParam:a}=(0,t.useContext)(h.p),[r,c]=(0,t.useState)({});(0,_.Z)(async()=>{let[,l]=await (0,m.Vx)((0,m.vD)(e));c(null!=l?l:{})},[e]);let s=(0,t.useMemo)(()=>Object.entries(r).map(e=>{let[l,a]=e;return{label:l,value:a}}),[r]);return((0,t.useEffect)(()=>{s.length&&a(s[0].value)},[s]),s.length)?(0,n.jsx)(Z.default,{value:l,className:"w-36",onChange:e=>{a(e)},children:s.map(e=>(0,n.jsxs)(Z.default.Option,{children:[(0,n.jsx)(b.Z,{component:w,className:"mr-1"}),e.label]},e.value))}):null},P=function(e){let{refreshHistory:l,modelChange:a}=e,{refreshDialogList:r}=(0,t.useContext)(h.p);return(0,n.jsxs)("div",{className:"w-full py-2 px-4 md:px-4 flex flex-wrap items-center justify-center border-b border-gray-100 gap-1 md:gap-4",children:[(0,n.jsx)(y.Z,{onChange:a}),(0,n.jsx)(N,{}),(0,n.jsx)(x,{onComplete:()=>{null==r||r(),null==l||l()}}),(0,n.jsx)(j,{})]})}},48567:function(e,l,a){"use strict";a.d(l,{Z:function(){return m},A:function(){return u}});var n=a(85893),t=a(41468),r=a(51009);let c={proxyllm:{label:"Proxy LLM",icon:"/models/chatgpt.png"},"flan-t5-base":{label:"flan-t5-base",icon:"/models/google.png"},"vicuna-13b":{label:"vicuna-13b",icon:"/models/vicuna.jpeg"},"vicuna-7b":{label:"vicuna-7b",icon:"/models/vicuna.jpeg"},"vicuna-13b-v1.5":{label:"vicuna-13b-v1.5",icon:"/models/vicuna.jpeg"},"vicuna-7b-v1.5":{label:"vicuna-7b-v1.5",icon:"/models/vicuna.jpeg"},"codegen2-1b":{label:"codegen2-1B",icon:"/models/vicuna.jpeg"},"codet5p-2b":{label:"codet5p-2b",icon:"/models/vicuna.jpeg"},"chatglm-6b-int4":{label:"chatglm-6b-int4",icon:"/models/chatglm.png"},"chatglm-6b":{label:"chatglm-6b",icon:"/models/chatglm.png"},"chatglm2-6b":{label:"chatglm2-6b",icon:"/models/chatglm.png"},"chatglm2-6b-int4":{label:"chatglm2-6b-int4",icon:"/models/chatglm.png"},"guanaco-33b-merged":{label:"guanaco-33b-merged",icon:"/models/huggingface.svg"},"falcon-40b":{label:"falcon-40b",icon:"/models/falcon.jpeg"},"gorilla-7b":{label:"gorilla-7b",icon:"/models/gorilla.png"},"gptj-6b":{label:"ggml-gpt4all-j-v1.3-groovy.bin",icon:""},chatgpt_proxyllm:{label:"chatgpt_proxyllm",icon:"/models/chatgpt.png"},bard_proxyllm:{label:"bard_proxyllm",icon:"/models/bard.gif"},claude_proxyllm:{label:"claude_proxyllm",icon:"/models/claude.png"},wenxin_proxyllm:{label:"wenxin_proxyllm",icon:""},tongyi_proxyllm:{label:"tongyi_proxyllm",icon:"/models/qwen2.png"},zhipu_proxyllm:{label:"zhipu_proxyllm",icon:"/models/zhipu.png"},"llama-2-7b":{label:"Llama-2-7b-chat-hf",icon:"/models/llama.jpg"},"llama-2-13b":{label:"Llama-2-13b-chat-hf",icon:"/models/llama.jpg"},"llama-2-70b":{label:"Llama-2-70b-chat-hf",icon:"/models/llama.jpg"},"baichuan-13b":{label:"Baichuan-13B-Chat",icon:"/models/baichuan.png"},"baichuan-7b":{label:"baichuan-7b",icon:"/models/baichuan.png"},"baichuan2-7b":{label:"Baichuan2-7B-Chat",icon:"/models/baichuan.png"},"baichuan2-13b":{label:"Baichuan2-13B-Chat",icon:"/models/baichuan.png"},"wizardlm-13b":{label:"WizardLM-13B-V1.2",icon:"/models/wizardlm.png"},"llama-cpp":{label:"ggml-model-q4_0.bin",icon:"/models/huggingface.svg"},"internlm-7b":{label:"internlm-chat-7b-v1_1",icon:"/models/internlm.png"},"internlm-7b-8k":{label:"internlm-chat-7b-8k",icon:"/models/internlm.png"}};var s=a(25675),i=a.n(s),o=a(67294),d=a(67421);function u(e,l){var a;let{width:t,height:r}=l||{};return e?(0,n.jsx)(i(),{className:"rounded-full border border-gray-200 object-contain bg-white inline-block",width:t||24,height:r||24,src:(null===(a=c[e])||void 0===a?void 0:a.icon)||"/models/huggingface.svg",alt:"llm"}):null}var m=function(e){let{onChange:l}=e,{t:a}=(0,d.$G)(),{modelList:s,model:i}=(0,o.useContext)(t.p);return!s||s.length<=0?null:(0,n.jsx)(r.default,{value:i,placeholder:a("choose_model"),onChange:e=>{null==l||l(e)},children:s.map(e=>{var l;return(0,n.jsx)(r.default.Option,{children:(0,n.jsxs)("div",{className:"flex items-center justify-center",children:[u(i),(0,n.jsx)("span",{className:"ml-2",children:(null===(l=c[i])||void 0===l?void 0:l.label)||i})]})},e)})})}},99513:function(e,l,a){"use strict";a.d(l,{Z:function(){return d}});var n=a(85893),t=a(77119),r=a(63764),c=a(94184),s=a.n(c),i=a(67294),o=a(36782);function d(e){let{className:l,value:a,language:t="mysql",onChange:c,thoughts:d}=e,u=(0,i.useMemo)(()=>"mysql"!==t?a:d&&d.length>0?(0,o.WU)("-- ".concat(d," \n").concat(a)):(0,o.WU)(a),[a,d]);return(0,n.jsx)(r.ZP,{className:s()(l),value:u,language:t,onChange:c,theme:"vs-dark",options:{minimap:{enabled:!1},wordWrap:"on"}})}r._m.config({monaco:t})},30119:function(e,l,a){"use strict";a.d(l,{Tk:function(){return i},PR:function(){return o},Ej:function(){return d}});var n=a(2453),t=a(6154),r=a(83454);let c=t.Z.create({baseURL:r.env.API_BASE_URL});c.defaults.timeout=1e4,c.interceptors.response.use(e=>e.data,e=>Promise.reject(e)),a(96486);let s={"content-type":"application/json"},i=(e,l)=>{if(l){let a=Object.keys(l).filter(e=>void 0!==l[e]&&""!==l[e]).map(e=>"".concat(e,"=").concat(l[e])).join("&");a&&(e+="?".concat(a))}return c.get("/api"+e,{headers:s}).then(e=>e).catch(e=>{n.ZP.error(e),Promise.reject(e)})},o=(e,l)=>c.post(e,l,{headers:s}).then(e=>e).catch(e=>{n.ZP.error(e),Promise.reject(e)}),d=(e,l)=>c.post(e,l).then(e=>e).catch(e=>{n.ZP.error(e),Promise.reject(e)})},23293:function(){}}]);