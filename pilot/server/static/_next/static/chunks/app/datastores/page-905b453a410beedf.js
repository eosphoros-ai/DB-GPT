(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6043],{66162:function(e,t,r){Promise.resolve().then(r.bind(r,44323))},44323:function(e,t,r){"use strict";r.r(t);var n=r(9268),s=r(56008),o=r(86006),i=r(72474),a=r(59534),l=r(29382),c=r(68949),x=r(74852),d=r(53195),p=r(21628),u=r(50645),h=r(5737),g=r(90545),m=r(80937),j=r(34112),f=r(35086),Z=r(53113),b=r(96323),P=r(22046),w=r(47611),y=r(30530),k=r(50318),S=r(78915);let{Dragger:C}=d.default,F=(0,u.Z)(h.Z)(e=>{let{theme:t}=e;return{width:"33%",backgroundColor:"dark"===t.palette.mode?t.palette.background.level1:"#fff",...t.typography.body2,padding:t.spacing(1),textAlign:"center",borderRadius:4,color:t.vars.palette.text.secondary}}),R=["Knowledge Space Config","Choose a Datasource type","Setup the Datasource"],v=[{type:"text",title:"Text",subTitle:"Fill your raw text"},{type:"webPage",title:"URL",subTitle:"Fetch the content of a URL"},{type:"file",title:"Document",subTitle:"Upload a document, document type can be PDF, CSV, Text, PowerPoint, Word, Markdown"}];t.default=()=>{let e=(0,s.useRouter)(),[t,r]=(0,o.useState)(0),[d,u]=(0,o.useState)(""),[_,A]=(0,o.useState)([]),[N,T]=(0,o.useState)(!1),[B,E]=(0,o.useState)(""),[z,D]=(0,o.useState)(""),[W,U]=(0,o.useState)(""),[O,L]=(0,o.useState)(""),[G,I]=(0,o.useState)(""),[K,M]=(0,o.useState)(""),[J,V]=(0,o.useState)(""),[H,X]=(0,o.useState)(null),[Y,q]=(0,o.useState)(!0),[Q,$]=(0,o.useState)(!1),[ee,et]=(0,o.useState)({});return(0,o.useEffect)(()=>{(async function(){let e=await (0,S.PR)("/knowledge/space/list",{});e.success&&A(e.data)})()},[]),(0,n.jsxs)(g.Z,{sx:{width:"100%",height:"100%"},className:"bg-[#F1F2F5] dark:bg-[#212121]",children:[(0,n.jsx)(g.Z,{className:"page-body p-4",sx:{"&":{height:"90%",overflow:"auto"},"&::-webkit-scrollbar":{display:"none"}},children:(0,n.jsxs)(m.Z,{direction:"row",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",sx:{"& i":{width:"430px",marginRight:"30px"}},children:[(0,n.jsxs)(g.Z,{sx:{display:"flex",alignContent:"start",boxSizing:"content-box",width:"390px",height:"79px",padding:"33px 20px 40px",marginRight:"30px",marginBottom:"30px",fontSize:"18px",fontWeight:"bold",color:"black",flexShrink:0,flexGrow:0,cursor:"pointer",borderRadius:"16px","&: hover":{boxShadow:"0 10px 15px -3px rgba(0,0,0,.1),0 4px 6px -4px rgba(0,0,0,.1);"}},onClick:()=>T(!0),className:"bg-[#E9EBEE] dark:bg-[#484848]",children:[(0,n.jsx)(g.Z,{sx:{width:"32px",height:"32px",lineHeight:"28px",border:"1px solid #2AA3FF",textAlign:"center",borderRadius:"5px",marginRight:"5px",fontWeight:"300",color:"#2AA3FF"},children:"+"}),(0,n.jsx)(g.Z,{sx:{fontSize:"16px"},children:"space"})]}),_.map((t,r)=>(0,n.jsxs)(g.Z,{sx:{position:"relative",padding:"30px 20px 40px",marginRight:"30px",marginBottom:"30px",borderTop:"4px solid rgb(84, 164, 248)",flexShrink:0,flexGrow:0,cursor:"pointer",borderRadius:"10px","&: hover":{boxShadow:"0 10px 15px -3px rgba(0,0,0,.1),0 4px 6px -4px rgba(0,0,0,.1);"}},onClick:()=>{e.push("/datastores/documents?name=".concat(t.name))},className:"bg-[#FFFFFF] dark:bg-[#484848]",children:[(0,n.jsxs)(g.Z,{sx:{fontSize:"18px",marginBottom:"10px",fontWeight:"bold",color:"black"},children:[(0,n.jsx)(l.Z,{sx:{marginRight:"5px",color:"#2AA3FF"}}),t.name]}),(0,n.jsxs)(g.Z,{sx:{display:"flex",justifyContent:"flex-start"},children:[(0,n.jsxs)(g.Z,{sx:{width:"130px",flexGrow:0,flexShrink:0},children:[(0,n.jsx)(g.Z,{sx:{color:"#2AA3FF"},children:t.vector_type}),(0,n.jsx)(g.Z,{sx:{fontSize:"12px",color:"black"},children:"Vector"})]}),(0,n.jsxs)(g.Z,{sx:{width:"130px",flexGrow:0,flexShrink:0},children:[(0,n.jsx)(g.Z,{sx:{color:"#2AA3FF"},children:t.owner}),(0,n.jsx)(g.Z,{sx:{fontSize:"12px",color:"black"},children:"Owner"})]}),(0,n.jsxs)(g.Z,{sx:{width:"130px",flexGrow:0,flexShrink:0},children:[(0,n.jsx)(g.Z,{sx:{color:"#2AA3FF"},children:t.docs||0}),(0,n.jsx)(g.Z,{sx:{fontSize:"12px",color:"black"},children:"Docs"})]})]}),(0,n.jsx)(g.Z,{sx:{position:"absolute",right:"10px",top:"10px",color:"rgb(205, 32, 41)"},onClick:e=>{e.stopPropagation(),et(t),$(!0)},children:(0,n.jsx)(c.Z,{sx:{fontSize:"30px"}})})]},r)),(0,n.jsx)("i",{}),(0,n.jsx)("i",{}),(0,n.jsx)("i",{}),(0,n.jsx)("i",{}),(0,n.jsx)("i",{}),(0,n.jsx)("i",{}),(0,n.jsx)("i",{}),(0,n.jsx)("i",{}),(0,n.jsx)("i",{}),(0,n.jsx)("i",{}),(0,n.jsx)("i",{}),(0,n.jsx)("i",{}),(0,n.jsx)("i",{}),(0,n.jsx)("i",{}),(0,n.jsx)("i",{}),(0,n.jsx)("i",{}),(0,n.jsx)("i",{}),(0,n.jsx)("i",{}),(0,n.jsx)("i",{}),(0,n.jsx)("i",{})]})}),(0,n.jsx)(j.Z,{sx:{display:"flex",justifyContent:"center",alignItems:"center","z-index":1e3},open:N,onClose:()=>T(!1),children:(0,n.jsxs)(h.Z,{variant:"outlined",sx:{width:800,borderRadius:"md",p:3,boxShadow:"lg"},children:[(0,n.jsx)(g.Z,{sx:{width:"100%"},children:(0,n.jsx)(m.Z,{spacing:2,direction:"row",children:R.map((e,r)=>(0,n.jsxs)(F,{sx:{fontWeight:t===r?"bold":"",color:t===r?"#2AA3FF":""},children:[r<t?(0,n.jsx)(a.Z,{}):"".concat(r+1,"."),"".concat(e)]},e))})}),0===t?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(g.Z,{sx:{margin:"30px auto"},children:["Knowledge Space Name:",(0,n.jsx)(f.ZP,{placeholder:"Please input the name",onChange:e=>E(e.target.value),sx:{marginBottom:"20px"}}),"Owner:",(0,n.jsx)(f.ZP,{placeholder:"Please input the owner",onChange:e=>D(e.target.value),sx:{marginBottom:"20px"}}),"Description:",(0,n.jsx)(f.ZP,{placeholder:"Please input the description",onChange:e=>U(e.target.value),sx:{marginBottom:"20px"}})]}),(0,n.jsx)(Z.Z,{variant:"outlined",onClick:async()=>{if(""===B){p.ZP.error("please input the name");return}if(/[^\u4e00-\u9fa50-9a-zA-Z_-]/.test(B)){p.ZP.error('the name can only contain numbers, letters, Chinese characters, "-" and "_"');return}if(""===z){p.ZP.error("please input the owner");return}if(""===W){p.ZP.error("please input the description");return}let e=await (0,S.PR)("/knowledge/space/add",{name:B,vector_type:"Chroma",owner:z,desc:W});if(e.success){p.ZP.success("success"),r(1);let e=await (0,S.PR)("/knowledge/space/list",{});e.success&&A(e.data)}else p.ZP.error(e.err_msg||"failed")},children:"Next"})]}):1===t?(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(g.Z,{sx:{margin:"30px auto"},children:v.map(e=>(0,n.jsxs)(h.Z,{sx:{boxSizing:"border-box",height:"80px",padding:"12px",display:"flex",flexDirection:"column",justifyContent:"space-between",border:"1px solid gray",borderRadius:"6px",marginBottom:"20px",cursor:"pointer"},onClick:()=>{u(e.type),r(2)},children:[(0,n.jsx)(h.Z,{sx:{fontSize:"20px",fontWeight:"bold"},children:e.title}),(0,n.jsx)(h.Z,{children:e.subTitle})]},e.type))})}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(g.Z,{sx:{margin:"30px auto"},children:["Name:",(0,n.jsx)(f.ZP,{placeholder:"Please input the name",onChange:e=>I(e.target.value),sx:{marginBottom:"20px"}}),"webPage"===d?(0,n.jsxs)(n.Fragment,{children:["Web Page URL:",(0,n.jsx)(f.ZP,{placeholder:"Please input the Web Page URL",onChange:e=>L(e.target.value)})]}):"file"===d?(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(C,{name:"file",multiple:!1,beforeUpload:()=>!1,onChange(e){if(0===e.fileList.length){X(null),I("");return}X(e.file),I(e.file.name)},children:[(0,n.jsx)("p",{className:"ant-upload-drag-icon",children:(0,n.jsx)(i.Z,{})}),(0,n.jsx)("p",{style:{color:"rgb(22, 108, 255)",fontSize:"20px"},children:"Select or Drop file"}),(0,n.jsx)("p",{className:"ant-upload-hint",style:{color:"rgb(22, 108, 255)"},children:"PDF, PowerPoint, Excel, Word, Text, Markdown,"})]})}):(0,n.jsxs)(n.Fragment,{children:["Text Source(Optional):",(0,n.jsx)(f.ZP,{placeholder:"Please input the text source",onChange:e=>M(e.target.value),sx:{marginBottom:"20px"}}),"Text:",(0,n.jsx)(b.Z,{onChange:e=>V(e.target.value),minRows:4,sx:{marginBottom:"20px"}})]}),(0,n.jsx)(P.ZP,{component:"label",sx:{marginTop:"20px"},endDecorator:(0,n.jsx)(w.Z,{checked:Y,onChange:e=>q(e.target.checked)}),children:"Synch:"})]}),(0,n.jsxs)(m.Z,{direction:"row",justifyContent:"flex-start",alignItems:"center",sx:{marginBottom:"20px"},children:[(0,n.jsx)(Z.Z,{variant:"outlined",sx:{marginRight:"20px"},onClick:()=>r(1),children:"< Back"}),(0,n.jsx)(Z.Z,{variant:"outlined",onClick:async()=>{if(""===G){p.ZP.error("Please input the name");return}if("webPage"===d){if(""===O){p.ZP.error("Please input the Web Page URL");return}let e=await (0,S.PR)("/knowledge/".concat(B,"/document/add"),{doc_name:G,content:O,doc_type:"URL"});e.success?(p.ZP.success("success"),T(!1),Y&&(0,S.PR)("/knowledge/".concat(B,"/document/sync"),{doc_ids:[e.data]})):p.ZP.error(e.err_msg||"failed")}else if("file"===d){if(!H){p.ZP.error("Please select a file");return}let e=new FormData;e.append("doc_name",G),e.append("doc_file",H),e.append("doc_type","DOCUMENT");let t=await (0,S.Ej)("/knowledge/".concat(B,"/document/upload"),e);t.success?(p.ZP.success("success"),T(!1),Y&&(0,S.PR)("/knowledge/".concat(B,"/document/sync"),{doc_ids:[t.data]})):p.ZP.error(t.err_msg||"failed")}else{if(""===J){p.ZP.error("Please input the text");return}let e=await (0,S.PR)("/knowledge/".concat(B,"/document/add"),{doc_name:G,source:K,content:J,doc_type:"TEXT"});e.success?(p.ZP.success("success"),T(!1),Y&&(0,S.PR)("/knowledge/".concat(B,"/document/sync"),{doc_ids:[e.data]})):p.ZP.error(e.err_msg||"failed")}},children:"Finish"})]})]})]})}),(0,n.jsx)(j.Z,{open:Q,onClose:()=>$(!1),children:(0,n.jsxs)(y.Z,{variant:"outlined",role:"alertdialog","aria-labelledby":"alert-dialog-modal-title","aria-describedby":"alert-dialog-modal-description",children:[(0,n.jsx)(P.ZP,{id:"alert-dialog-modal-title",component:"h2",startDecorator:(0,n.jsx)(x.Z,{style:{color:"rgb(205, 32, 41)"}}),sx:{color:"black"},children:"Confirmation"}),(0,n.jsx)(k.Z,{}),(0,n.jsxs)(P.ZP,{id:"alert-dialog-modal-description",textColor:"text.tertiary",sx:{fontWeight:"500",color:"black"},children:["Sure to delete ",null==ee?void 0:ee.name,"?"]}),(0,n.jsxs)(g.Z,{sx:{display:"flex",gap:1,justifyContent:"flex-end",pt:2},children:[(0,n.jsx)(Z.Z,{variant:"outlined",color:"neutral",onClick:()=>$(!1),children:"Cancel"}),(0,n.jsx)(Z.Z,{variant:"outlined",color:"danger",onClick:async()=>{$(!1);let e=await (0,S.PR)("/knowledge/space/delete",{name:null==ee?void 0:ee.name});if(e.success){p.ZP.success("success");let e=await (0,S.PR)("/knowledge/space/list",{});e.success&&A(e.data)}else p.ZP.error(e.err_msg||"failed")},children:"Yes"})]})]})})]})}},78915:function(e,t,r){"use strict";r.d(t,{Tk:function(){return x},Kw:function(){return d},PR:function(){return p},Ej:function(){return u}});var n=r(21628),s=r(24214),o=r(52040);let i=s.Z.create({baseURL:o.env.API_BASE_URL});i.defaults.timeout=1e4,i.interceptors.response.use(e=>e.data,e=>Promise.reject(e));var a=r(84835);let l={"content-type":"application/json"},c=e=>{if(!(0,a.isPlainObject)(e))return JSON.stringify(e);let t={...e};for(let e in t){let r=t[e];"string"==typeof r&&(t[e]=r.trim())}return JSON.stringify(t)},x=(e,t)=>{if(t){let r=Object.keys(t).filter(e=>void 0!==t[e]&&""!==t[e]).map(e=>"".concat(e,"=").concat(t[e])).join("&");r&&(e+="?".concat(r))}return i.get("/api"+e,{headers:l}).then(e=>e).catch(e=>{n.ZP.error(e),Promise.reject(e)})},d=(e,t)=>{let r=c(t);return i.post("/api"+e,{body:r,headers:l}).then(e=>e).catch(e=>{n.ZP.error(e),Promise.reject(e)})},p=(e,t)=>i.post(e,t,{headers:l}).then(e=>e).catch(e=>{n.ZP.error(e),Promise.reject(e)}),u=(e,t)=>i.post(e,t).then(e=>e).catch(e=>{n.ZP.error(e),Promise.reject(e)})}},function(e){e.O(0,[2180,877,5230,8942,7192,5935,5086,2149,1450,9253,5769,1744],function(){return e(e.s=66162)}),_N_E=e.O()}]);